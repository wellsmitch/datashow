!function(B,c,V){"use strict";var v="ht";if(!B[v]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),B.performance&&B.performance.now||function(){var u=Date.now();B.performance||(B.performance={}),B.performance.now=function(){return Date.now()-u}}();for(var r=Date.now(),w=16,L=["ms","moz","webkit","o"],y=0;y<L.length&&!B.requestAnimationFrame;++y)B.requestAnimationFrame=B[L[y]+"RequestAnimationFrame"],B.cancelAnimationFrame=B[L[y]+"CancelAnimationFrame"]||B[L[y]+"CancelRequestAnimationFrame"];B.requestAnimationFrame||(B.requestAnimationFrame=function(q){var n=Date.now(),o=w+r-n;return 0>o&&(o=0),r=n,B.setTimeout(function(){r=Date.now(),q(performance.now())},o)}),B.cancelAnimationFrame||(B.cancelAnimationFrame=function(s){return B.clearTimeout(s)}),c.assign===V&&(c.assign=function(z){if(z===V||null===z)throw new TypeError("Cannot convert undefined or null to object");for(var q=c(z),Z=1;Z<arguments.length;Z++){var F=arguments[Z];if(F!==V&&null!==F)for(var d in F)c.prototype.hasOwnProperty.call(F,d)&&(q[d]=F[d])}return q})}();var b=B.document,k=null,C=B[v]={},f=B[v+"config"],I=C.Default=f&&f.Default||{},_=C.Style=f&&f.Style||{},z=C.Attr=f&&f.Attr||{},X=C.Color=f&&f.Color||{},w=C.IsGetter=f&&f.IsGetter||{};!function(){var J=!1;try{var m=c.defineProperty({},"passive",{get:function(){J=!0}});B.addEventListener("test",m,m),B.removeEventListener("test",m,m)}catch(p){J=!1}I.passiveSupported=J}();var u,s,n,S,G=I.passiveSupported,m=I.eventListenerOptionsFalse=G?{passive:!1,capture:!1}:!1,Z=I.eventListenerOptionsTrue=G?{passive:!1,capture:!0}:!0,H=Math,L=H.round,E=H.floor,g=H.ceil,i=H.sqrt,j=H.max,$=H.min,F=H.abs,P=H.cos,M=H.acos,e=H.sin,l=H.pow,D=H.asin,K=H.PI,o=2*K,r=K/2,A=H.tan,q=H.atan2,y=H.random,J=H.log,a=!0,U=!1,d=B.parseInt||global.parseInt,R="2018-12-31",p=B.navigator?B.navigator.platform.indexOf("Win")>-1:!1,t=function(I){return I*I},N=B.setTimeout,T=B.clearTimeout,Q=B.location,W=B.navigator?B.navigator.userAgent.toLowerCase():"",x=function(x){return x.test(W)},h=x(/msie/),Y=x(/msie/)||x(/trident/),O=x(/msie 10/),oe=x(/edge/),Kb=x(/firefox/),vk=x(/mac/),uh=I.isTouchable===V?p?!1:b?"ontouchend"in b:!1:I.isTouchable,Rk="default",Hj="single",Je="multiple",Vi="front",ze="back",fq="left",nb="right",Bp="top",sm="bottom",Op="center",Zp="eye",vo="middle",ih="east",Vj="west",Ck="north",yp="none",cp="px",Tb="absolute",Yg="border",Kk="triangle",Xd="rect",Dn="circle",zk="cylinder",Dq="shape",Ak="items",Dd="normal",ro="remove",Ef="clear",Qg="width",Ch="height",Jj="ingroup",Vr="check",Md="uncheck",Wn="radio",Cg="radioOn",Gm="radioOff",Rh="points",mo="values",Xn="series",Jn="body",Sr="label",$h="label2",Fk="note",zq="note2",wf="icons",to="labelFont",vh="labelColor",ce="labelSelectColor",Xc="note.expanded",Qp="note2.expanded",Og="edge.expanded",ee="edge.points",fp="edge.type",Qj="rotation",Pq="hidden",Mb="visible",Pc="tuv",Ue="no",ik="draw",pj="select",Lp="currentSubGraph",en="selectBackground",ci="autoMakeVisible",Yp="autoHideScrollBar",Td="scrollBarColor",df="scrollBarSize",ki="indent",$j="rowHeight",Am="columnLineColor",Bg="rowLineColor",Sf="columnLineVisible",zg="rowLineVisible",wd="visibleFunc",Hf="expandIcon",vj="collapseIcon",Pk="checkMode",le="sortFunc",Tn="editable",Nn="batchEditable",de="tristate",Ep="asc",Qc="desc",hs="position",xc="elevation",td="children",Up="translateX",Dp="translateY",Jc="dataModel",Me="maxSize",il="shape3d",zs="shape3d.resolution",er="shape3d.visible",Qe="shape3d.from.visible",Zh="shape3d.to.visible",ek="shape3d.top.visible",re="shape3d.bottom.visible",dd="repeat.uv.length",ii="serializeValue",yl="deserializeValue",yr="centerUniform",Fh="uniform",ks="rgba(255,255,255,0)",_n="style",Xj="attr",ne="field",fh="string",md="boolean",Nb="color",Zl="int",he="number",rf="ew-resize",Pr="ns-resize",Mh="pointer",Ni="auto",Af="mousedown",wr="mousemove",cs="mouseup",Go="mouseout",oq="touchstart",wq="touchmove",$k="touchend",Xg="keydown",Ge="keyup",Fb=["DOMMouseScroll","mousewheel"],Sb=Kb?Fb[0]:Fb[1],pi=uh?[oq,wq,$k,Xg,Ge,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Xg,Ge,"keypress","input",Af,wr,cs,Go,Sb,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],jk=k,dq=k,Yq=k,Ab=cs.length,jq=function(){Yq&&(T(Yq.timeout),Yq=k)},Bc=function(){Yq&&Cb(Yq.e,Yq.info)};B.addEventListener&&(uh||(B.addEventListener(Go,function(){jq()},m),B.addEventListener(Sb,function(){xm()},m)),B.addEventListener(Ge,function(J){91===J.keyCode?Gh={}:delete Gh[J.keyCode]},Z),B.addEventListener(Xg,function($){Gh[$.keyCode]=!0},Z),B.addEventListener("blur",function(){Gh={}},m));var Np,ho,Mr,xp=0,Io=k,si=function(i,W){var y=N(function(){delete Io[y],cq(Io)&&(Io=k),i()},W);return y},Vb=k,jh=k,dm={},cl={},se={},ec={},bc={},Gh={},zp={},tk={},xh={},uf={},Ln=/.json$/,We=/^data:image\/svg\+xml/,qf={},or=[],dk={},nf=k,Zo=k,ql=function(){},He=function(){throw"Oops!"},wk=[0,0,0],dl=[0,0,0,0],Bf={x:0,y:0,width:0,height:0},on=k,sk=k,Zc=k,Ci=function(b){sk&&!b._72O&&(Zc||(Zc={}),Zc[b._72O=No()]=b),Np!=k?Ke()<.05&&S&&!ho&&(Ko=jq):Ko=Wq},om=function(o,i,O,U){sk||(sk={});var F=sk[o];if(F){if(F.url===i)return;F.image?(F.image.onload=ql,F.image.onerror=ql):F.request&&(F.request.onload=ql,F.request.onerror=ql)}if(Ln.test(i)){var H=new ib;if(sk[o]={request:H,url:i},i=I.beforeLoadURL(i),i.data){var s=I.parse(i.data);Sg(o,s),I.handleImageLoaded(o,s)}else{H.onload=function(W){if(200===this.status||0===this.status){var E=I.parse(W.target.response||W.target.responseText);Sg(o,E),I.handleImageLoaded(o,E)}else Sg(o,I.handleUnfoundImage(o,i)||k)},H.onerror=function(){Sg(o,I.handleUnfoundImage(o,i)||k)};var q={};q.url=encodeURI(i),q.sync=!1,H.send(q)}}else{var s=new Image;sk[o]={image:s,url:i},/^data:image/.test(i)||(i=I.beforeLoadURL(i),i=I.appendTimeStamp(i),i=encodeURI(i),s.crossOrigin=I.crossOrigin),I.convertImageSrc(i,function(X){Y&&(i.toLowerCase().indexOf(".svg")>0||We.test(i))?(b.body.appendChild(s),s.style.visibility="hidden",s.onload=function(){N(function(){if(O&&(s.width=O),U&&(s.height=U),!s.width||!s.height){var c=s.width||s.clientWidth,X=s.height||s.clientHeight;s.width=c,s.height=X}I.handleImageLoaded(o,s),Sg(o,s),b.body.removeChild(s),s.style.visibility=""},180)},s.onerror=function(){Sg(o,I.handleUnfoundImage(o,i)||k),b.body.removeChild(s),s.style.visibility=""}):(s.onload=function(){O&&(s.width=O),U&&(s.height=U),I.handleImageLoaded(o,s),Sg(o,s)},s.onerror=function(){Sg(o,I.handleUnfoundImage(o,i)||k)}),s.src=X})}},Sg=function(Z,d){if(cl[Z]=d,delete sk[Z],cq(sk)&&(sk=k,Zc)){for(var h in Zc){var j=Zc[h];j._2O&&(j._2O={}),j.invalidateAll&&j.invalidateAll(V,"imageLoaded",Z),j.redraw&&j.redraw(),j.iv(),delete j._72O}Zc=k}if(d&&Zc)for(var h in Zc){var j=Zc[h];j.invalidateAll&&j.invalidateAll(V,"imageLoading",Z),j.redraw&&j.redraw(),j.iv()}},sp=function(){return J=H&&Date,function(){return B.performance&&B.performance.now?B.performance.now():Date.now()}}(),be=function(a,e){e?T(a):B.cancelAnimationFrame(a)},qd=function(q,j,J){return{width:q,height:j,comps:sn(J)?J:[J]}},ff=function(u,r){return{type:Dn,rect:[u,r,1.6,1.6],borderWidth:1,borderColor:Lo,gradient:Nd,gradientColor:xf,background:Lo}},Jo=function(i,H){return qd(16,16,{type:Kk,rect:[4,4,10,8],background:i,rotation:H?1.57:3.14})},li=function(s,Y){return qd(16,16,{type:Kk,rect:[4,4,8,7],background:s,rotation:Y?3.14:0})},Rn=function(y){var p=y._orientation;return"horizontal"===p||"h"===p},Of=function(m){var B=k||4,n=k||1,G=k||1;0>B?B=0:B>.25&&(B=.25);var x,R,A,p,L,E,j,Z=.5,$=[],y=[],F=[],b=o/G,r=o/n,D=Z-B;for(R=0;n>=R;R++)for(p=-K+R*r,E=P(p),L=e(p),x=0;G>=x;x++)A=x*b,j=D+B*E,$.push(P(A)*j,L*B,-e(A)*j),(s=m)&&y.push(x/G,1-R/n);for(R=0;n>R;R++){var h=R*(G+1),l=(R+1)*(G+1);for(x=0;G>x;x++)F.push(h+x,l+x+1,l+x,h+x,h+x+1,l+x+1),po.z=vm.z=m}},Cn=function(N){var C=2,G=0;for(var P in N)P.length===C&&d(P,32)===ac&&(nf=Zo=N[P]),G++;return G},pe=function(d,Z,B,H){return B||(B=uh?5:3,B/=H||1),{x:d-B,y:Z-B,width:2*B,height:2*B}},zb=function(S,Z,N,W){var c=this;Z||(Z=uh?5:3,N=20,W=20);var b={x:S,y:Z,width:N,height:W};if(N)for(var O=0;N>O;O++)if(3===N)W=20;else for(var f=0;W>f;f++)c=B?B:N;var E={x:K,y:2*K};if(Wi(b,E)){var m=Ch[0]+Bp[0]+Ef[1]+(Ep.length-1);Nl[Zp]=c[m],c[m]=di[Zp]}},sl=function(h){return(/ble$/.test(h)||/ed$/.test(h)||w[h]?"is":"get")+h.charAt(0).toUpperCase()+h.slice(1)},di=function(S){return"set"+S.charAt(0).toUpperCase()+S.slice(1)},Uc=function(i){return typeof i===fh||i instanceof String},tg=function(P){return typeof P===he},Wq=function(z){return typeof z===md},wb=function(W){return W&&"object"==typeof W},od=function(q){return"function"==typeof q},sn=function(t){return t instanceof Array},Zq=function(J){return J instanceof pq},Uj=function(X){return sn(X)?new pq(X):X},tn=function(n){return n instanceof gd},hk=function(j){return j instanceof al},Qb=function(w){return w instanceof te},Kl=function(u,M){if(!(u instanceof C.Group))return!1;if(!M)return u.isExpanded();var T=M.getDataUI(u);return T&&T._88I?!0:!1},Tm=function(E){return E instanceof as},cb=function(m){return m&&"IFRAME"===m.tagName},Jh=function(d){return d==k||I.numberDigits==k?d:parseFloat(d.toFixed(I.numberDigits))},ke=function(g,C,u){var v,r=C.length;if(u)for(var Z=0;u>Z;Z++)if(3===r)g.push(C[0]),g.push(C[1]),g.push(C[2]);else for(v=0;r>v;v++)g.push(C[v]);else if(3===r)g.push(C[0]),g.push(C[1]),g.push(C[2]);else for(v=0;r>v;v++)g.push(C[v])},rg=function(Y){return Y?wb(Y)?Y:{}:!1},fs=function(o,w,x){var Z,E=wb(o)?o:o.prototype;for(Z in w)x&&E[Z]!==V||(E[Z]=w[Z]);return o},rp=function(R){return String.fromCharCode(R)},Xk=function(d){for(var U,f=0,L="";f<d.length;f++)U=d[d.length-1-f],"%"===U?U="'":"a"===U?U='"':"]"===U&&(U="\\"),L+=rp(U.charCodeAt(0)-1);return L},uj=function(o,A,K){o.superClass.constructor.apply(A,K)},cq=function(T){for(var c in T)return!1;return!0},Jp=function(t){return t?0===t.length:!0},yk=function(){var Z="";return[Md[0],Bg[0],Sr[0]].forEach(function(M){Z+=di(M).slice(3)}),Fh=b&&b[Z]||yr,function(x,Y){return x===Y?!0:x.x===Y.x&&x.y===Y.y&&x.width===Y.width&&x.height===Y.height}}(),iq=function(g,D,l){return D>g?D:g>l?l:g},Pf=function(x){return 0>x?-1:x>0?1:0},Ke=function(){var z=1e4*e(Ab++);return z-E(z)},Cj=function(_,K,M){return no(_.x,_.y,K.x,K.y,M.x,M.y,M.x+M.width,M.y,!0)||no(_.x,_.y,K.x,K.y,M.x+M.width,M.y,M.x+M.width,M.y+M.height,!0)||no(_.x,_.y,K.x,K.y,M.x+M.width,M.y+M.height,M.x,M.y+M.height,!0)||no(_.x,_.y,K.x,K.y,M.x,M.y+M.height,M.x,M.y,!0)},no=function(b,V,c,Y,C,A,r,D,O){var H=(r-C)*(V-A)-(D-A)*(b-C),P=(D-A)*(c-b)-(r-C)*(Y-V);if(0!==P){var t=H/P,X=b+t*(c-b),F=V+t*(Y-V);return O&&(X+Ri<$(b,c)||X-Ri>j(b,c)||X+Ri<$(C,r)||X-Ri>j(C,r)||F+Ri<$(V,Y)||F-Ri>j(V,Y)||F+Ri<$(A,D)||F-Ri>j(A,D))?k:[X,F]}return k},Xp=function(l,C,h){if(l&&h)if(C){if(C===_n)return l.getStyle(h);if(C===Xj)return l.getAttr(h);if(C===ne)return l[h]}else if(h=sl(h),l[h])return l[h]();return V},Il=function(f,D,G,$){if(f&&G)if(D){if(D===_n)f.s(G,$);else if(D===Xj)f.a(G,$);else if(D===ne){var m=f[G];f[G]=$,f.fp("f:"+G,m,$)}}else G=di(G),f[G]&&f[G]($)},Qf=function(F,u,s){return u&&"top"!==u?"bottom"===u?{x:F.x,y:F.y,width:F.width,height:F.height*s}:"right"===u?{x:F.x,y:F.y,width:F.width*s,height:F.height}:"left"===u?{x:F.x+F.width*(1-s),y:F.y,width:F.width*s,height:F.height}:void 0:{x:F.x,y:F.y+F.height*(1-s),width:F.width,height:F.height*s}},xn=function(D,C,i,p,B){C&&yq(D,i,p,1,B,C)},_l=function(z,v,n,H){var V=1-z;return V*V*v+2*z*V*n+z*z*H},po=function(x,z,c,q,w){var d=1-x;return d*d*d*z+3*d*d*x*c+3*d*x*x*q+x*x*x*w},Ao=function(T){var m,E,p,y,r=0;return T.forEach(function(I){if(m=I.length,m>0)for(E=I[0],y=1;m>y;y++)p=I[y],r+=wh(E,p),E=p}),r},hd=function(u,G,A){var V="__"+u,v=function(b){A.disabled||A["handle_"+u](b)};A[V]||(A[V]=v,G.addEventListener(u,v,m))},pg=function(k,I,J){var D="__"+k,f=J[D];f&&(I.removeEventListener(k,f,m),delete J[D])},vp=function(q,$){var v="_"+$;q[sl($)]=function(){return this[v]},q[di($)]=function(U){var j=this[v];this[v]=U,this.fp($,j,U)}},Gi=function(i){return c.create(i)},fm=function(m){if(!m.element){var X,W;(X=m.textField)?W=kq(ag.TextField,X):(X=m.textArea)?W=kq(ag.TextArea,X):(X=m.button)?W=kq(ag.Button,X):(X=m.comboBox)?W=kq(ag.ComboBox,X):(X=m.checkBox)?W=kq(ag.CheckBox,X):(X=m.radioButton)?W=kq(ag.RadioButton,X):(X=m.slider)?W=kq(ag.Slider,X):(X=m.colorPicker)?W=kq(ag.ColorPicker,X):(X=m.image)&&(W=kq(ag.Image,X)),W&&(m.element=W)}},Hb=function(_,U){var V=Xf(_);return V._ht=U,V},Xf=function(X,F){var p=b.createElement("div"),G=p.style;return p.tabIndex=-1,p.onkeydown=_d,G.msTouchAction=yp,gk(p,k,0),uh&&G.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",k),X&&(G.overflow=Pq),F&&Ll(F,p),p},os=function(L,G){var p=b.createElement("canvas"),B=p.style;return B.msTouchAction=yp,G||(B.pointerEvents=yp),gk(p,k,0),L&&Ll(L,p),p},gk=function(i,H,M){var S=i.style;S.border=H?H+" solid 1px":0,S.outline=0,S.padding=M?"0 "+M+cp:0,hp(i)},hp=function(Z){var o=Z.style;o.position=Tb,o.margin=0,o.setProperty("box-sizing","border-box",k),o.setProperty("-moz-box-sizing","border-box",k)},Oi=function(Q,W,K,u){u||(u=Wg),W!=k&&(Q.width=W*u,Q.style.width=W+cp),K!=k&&(Q.height=K*u,Q.style.height=K+cp)},Ll=function(K,J,h){K.appendChild(J),h&&(J.style.position=Tb)},So=function(I,W){W.split||(W+="");for(var O,P=W.split("\n"),o=0,T=P.length,V=0;T>V;V++){var s=Qk(I.font,P[V]);s.width>o&&(o=s.width),O||(O=s.height)}return I.ss=P,{width:o,height:O*T}},ir=function(V,A,K,r,f,C){var N=A.length;if(1===N)ah(V,A[0],K,r,f);else for(var D=K.height/N,s={x:K.x,y:K.y,width:K.width,height:D},p=0;p<A.length;p++)C?qg(V,A[p],r,f,s.x,s.y,s.width,s.height,C):ah(V,A[p],s,r,f),s.y+=D},ah=function(M,O,J,w,B){M.font=w?w:sd,M.fillStyle=B?B:zn,M.textAlign=Op,M.textBaseline=vo;var u,h;J?J.width===V?(u=J.x,h=J.y):(u=J.x+J.width/2,h=J.y+J.height/2):(u=0,h=0),M.fillText(O,L(u),L(h))},To=function(b){b.getView&&(b=b.getView());var w=b.offsetWidth||b.scrollWidth;return!w&&b.style.width&&(w=d(b.style.width)),w},yf=function(O){O.getView&&(O=O.getView());var A=O.offsetHeight||O.scrollHeight;return!A&&O.style.height&&(A=d(O.style.height)),A},ll=function(P,O,G){var l=O[0].toUpperCase()+O.substring(1,O.length);P["webkit"+l]=G,P["moz"+l]=G,P["ms"+l]=G,P["o"+l]=G,P[O]=G},Wo=function(){var E=function(D){_d(D),D.stopPropagation()},i=function(Y){_d(Y)},$=uh?[oq]:[Xg,Af];return function(l,D){var x=Xf(),t=x.style;return t.backgroundColor=I.disabledBackground,l&&(t.backgroundImage="url("+l+")",t.backgroundPosition="50% 50%",t.backgroundRepeat="no-repeat no-repeat"),D===!1?$.forEach(function(_){x.addEventListener(_,i,m)}):$.forEach(function(q){x.addEventListener(q,E,m)}),x}}(),Rq=function(H){var E=H.getContext("2d");return E.save(),E.lineCap=Ad,E.lineJoin=Eb,E},Ko=function(t,f,X,x){Ig(t,f*Wg,X*Wg),x*=Wg,1!==x&&t.scale(x,x)},Ig=function(t,q,A){t.translate(q,A)},ef=function(v,M){M&&v.rotate(M)},go=function(w,f,Z){f===V&&(f=1),Z===V&&(Z=1),(1!==f||1!==Z)&&w.scale(f,Z)},es=!1,jj=function(t){var K=b.activeElement;if(b.activeElement!==t){K&&K.forceOnblur&&K.forceOnblur();for(var E=[],Z=t.parentNode;Z;)E.push([Z,Z.scrollLeft,Z.scrollTop]),Z=Z.parentNode;if(!es){var C=[],I=[];try{for(var l=B.parent,z=B;l!==z;)C.push([l,l.scrollX,l.scrollY]),z=l,l=B.parent;var f=B.frameElement;if(f)for(var J=f.parentNode;J;)I.push([J,J.scrollLeft,J.scrollTop]),J=J.parentNode}catch(M){es=!0}}if(uh)t.focus();else{var j=Zd(),v=j.target;t.focus(),v.scrollLeft=j.left,v.scrollTop=j.top}E.forEach(function(N){N[0].scrollLeft=N[1],N[0].scrollTop=N[2]}),es||(C.forEach(function(J){J[0].scrollTo(J[1],J[2])}),I.forEach(function(e){e[0].scrollLeft=e[1],e[0].scrollTop=e[2]}))}},Dk=function(A){return A&&A.getView?A.getView():A},qi=function(O,H,E,K,c){if(2===arguments.length&&(E=H.y,K=H.width,c=H.height,H=H.x),O.isSelfViewEvent)O.setX(H),O.setY(E),O.setWidth(K),O.setHeight(c);else{var l=Dk(O),j=l.style;if((b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement)!==l)H!==V&&(j.left=H+cp),E!==V&&(j.top=E+cp),K!==V&&(j.width=K+cp),c!==V&&(j.height=c+cp);else{var x=I.getWindowInfo();j.left=(H=x.left)+cp,j.top=(E=x.top)+cp,j.width=(K=x.width)+cp,j.height=(c=x.height)+cp}O.endEditing&&!uh&&O.endEditing(),O.redraw&&O.redraw(),O.invalidate&&O.invalidate(),O.onLayouted&&O.onLayouted(H,E,K,c),O.fireViewEvent&&O.fireViewEvent("layout")}},Wk=function(n){if(!n.touches)return n;var $=n.touches[0];return $?$:n.changedTouches[0]},kp=function(a){return uh?Wk(a).target:a.target},Fj=function(Y){I.popup&&I.popup.close(),I.popup=Y},Pg=k,vq=function(T){Pg.handleWindowTouchMove(T)},wo=function(L){Pg.handleWindowTouchEnd(L),B.removeEventListener(wq,vq,m),B.removeEventListener($k,wo,m),Pg=k},Jg=function(o){Pg.handleWindowMouseMove(o)},Uo=function(M){Pg.handleWindowMouseUp(M),B.removeEventListener(wr,Jg,m),B.removeEventListener(cs,Uo,m),Pg=k},js=function(s){return 1===Nc(s)},Co=function(F,q){return q?q.keyCode===F:Gh[F]},Ah=function(K){return pr(K)&&Co(65,K)},Fm=function(N){return Co(46,N)||Co(8,N)},Do=function(B){return function(k){return k?k.keyCode===B:Gh[B]}},ac=573,Kd=[65,83,68,87,37,38,39,40,32,13,27],pn=Do(Kd[0]),lk=Do(Kd[1]),bo=Do(Kd[2]),_c=Do(Kd[3]),_o=Do(Kd[4]),yc=Do(Kd[5]),_b=Do(Kd[6]),Vc=Do(Kd[7]),Eg=Do(Kd[8]),Wh=Do(Kd[9]),_m=Do(Kd[10]),mi={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Nj=[2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,2237],rb=k,$d=k,Mn=function(V,A){rb||(rb=os()),Oi(rb,V,A,1);var v=Rq(rb);return v.clearRect(0,0,V,A),v},Ze=function(){var F,R={};for(var l in B){var P=Je.length;if(l.length==P&&l[0]===Je[2]&&l[1]===yp[1]&&l[4]===Je[3]&&l[5]===Je[4]&&l.substr(P-2)===yp[1]+yp[2]){var A=B[l];for(var f in A)f.length===P&&f.substr(0,3)===nb[3]+ro[3]+pj[0]&&f.substr(P-2)===Je[0]+Fk[3]&&(Fb=A[f])}}return function(q){var z,o=R[q];return o||(F||(F=os(),Oi(F,1,1,1)),z=F.getContext("2d"),z.clearRect(0,0,1,1),yq(z,0,0,1,1,q),o=z.getImageData(0,0,1,1).data,o=R[q]=[o[0],o[1],o[2],o[3]]),o}}(),rd=function(O){if(!Uc(O))return O;var M=Ze(O);return M.CA||(M.CA=[M[0]/255,M[1]/255,M[2]/255,M[3]/255]),M.CA},ur=function(H,l,b,L,h){var X=os();X.width=b,X.height=L;var W=X.getContext("2d");W.drawImage(H,0,0,b,L);try{for(var a=W.getImageData(0,0,b,L),P=a.data,z=0,D=P.length;D>z;z+=4){var B=P[z+0],x=P[z+1],_=P[z+2],J=P[z+3];"override_a"===h?P[z+3]=255*l[3]:"override_rgb"===h?(P[z+0]=255*l[0],P[z+1]=255*l[1],P[z+2]=255*l[2]):"override"===h?(P[z+0]=255*l[0],P[z+1]=255*l[1],P[z+2]=255*l[2],P[z+3]=255*l[3]):(P[z+0]=l[0]*B,P[z+1]=l[1]*x,P[z+2]=l[2]*_,P[z+3]=l[3]*J)}W.putImageData(a,0,0)}catch(k){return H}return X},Nl=function(b,L,V){return L&&(L="miter"===V?8*L+20:L+1,b&&Oq(b,L)),L},rc=function(l,P){if(P){var M=new pf(P),W=l.width/2,C=l.height/2,F=Fd([M.tf(-W,-C),M.tf(W,-C),M.tf(W,C),M.tf(-W,C)]);return F.x+=l.x+W,F.y+=l.y+C,F}return l},zh=function(x,Y,y,d,F,C,J,V){d*=Math.PI/180;var G={x:Math.cos(d)*(x.x-J.x)/2+Math.sin(d)*(x.y-J.y)/2,y:-Math.sin(d)*(x.x-J.x)/2+Math.cos(d)*(x.y-J.y)/2},B=Math.pow(G.x,2)/Math.pow(Y,2)+Math.pow(G.y,2)/Math.pow(y,2);B>1&&(Y*=Math.sqrt(B),y*=Math.sqrt(B));var s=(F==C?-1:1)*Math.sqrt((Math.pow(Y,2)*Math.pow(y,2)-Math.pow(Y,2)*Math.pow(G.y,2)-Math.pow(y,2)*Math.pow(G.x,2))/(Math.pow(Y,2)*Math.pow(G.y,2)+Math.pow(y,2)*Math.pow(G.x,2)));isNaN(s)&&(s=0);var m={x:s*Y*G.y/y,y:s*-y*G.x/Y},S={x:(x.x+J.x)/2+Math.cos(d)*m.x-Math.sin(d)*m.y,y:(x.y+J.y)/2+Math.sin(d)*m.x+Math.cos(d)*m.y},Z=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2))},L=function(P,y){return(P[0]*y[0]+P[1]*y[1])/(Z(P)*Z(y))},e=function(l,p){return(l[0]*p[1]<l[1]*p[0]?-1:1)*Math.acos(L(l,p))},K=e([1,0],[(G.x-m.x)/Y,(G.y-m.y)/y]),h=[(G.x-m.x)/Y,(G.y-m.y)/y],w=[(-G.x-m.x)/Y,(-G.y-m.y)/y],A=e(h,w);L(h,w)<=-1&&(A=Math.PI),L(h,w)>=1&&(A=0);var L=Y>y?Y:y,t=Y>y?1:Y/y,c=Y>y?y/Y:1;if(null==V){var H={x:0,y:0,width:0,height:0};Oq(H,L),H.x*=t,H.width*=t,H.y*=c,H.height*=c;var p=new pf(d);return H=Fd([p.tf(H.x,H.y),p.tf(H.x+H.width,H.y),p.tf(H.x+H.width,H.y+H.height),p.tf(H.x,H.y+H.height)]),H.x+=S.x,H.y+=S.y,[{x:H.x,y:H.y},{x:H.x+H.width,y:H.y},{x:H.x+H.width,y:H.y+H.height},{x:H.x,y:H.y+H.height}]}V.translate(S.x,S.y),V.rotate(d),V.scale(t,c),V.arc(0,0,L,K,K+A,1-C),V.scale(1/t,1/c),V.rotate(-d),V.translate(-S.x,-S.y)},Xe=function(K,c){K&&K.beginPath();for(var f,U,H,d=[],B=function(m){for(var X,g=/(\-{0,1}[\d\.]+)/gi,b=[];X=g.exec(m);)b.push(parseFloat(X[0]));return b},W=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,a={x:0,y:0};f=W.exec(c);){var w=f[0],l=w.substr(0,1);if("M"===l||"m"===l){for(var u=B(w),i=0;i<u.length;i+=2){var I=u[i],h=u[i+1];"m"===l&&(I+=a.x,h+=a.y),K&&K.moveTo(I,h),d.push({x:I,y:h}),a.x=I,a.y=h}U=H=null}else if("H"===l||"h"===l){for(var u=B(w),i=0;i<u.length;i+=1){var I=u[i];"h"===l&&(I+=a.x),K&&K.lineTo(I,a.y),d.push({x:I,y:a.y}),a.x=I}U=H=null}else if("C"===l||"c"===l){for(var u=B(w),i=0;i<u.length;i+=6){var s=u[i],k=u[i+1],J=u[i+2],R=u[i+3],I=u[i+4],h=u[i+5];"c"===l&&(s+=a.x,k+=a.y,J+=a.x,R+=a.y,I+=a.x,h+=a.y),K&&K.bezierCurveTo(s,k,J,R,I,h),d.push({x:s,y:k}),d.push({x:J,y:R}),d.push({x:I,y:h}),a.x=I,a.y=h}U=[s,k,J,R,I,h],H=null}else if("S"===l||"s"===l){for(var u=B(w),i=0;i<u.length;i+=4){var s,k;U?(s=2*U[4]-U[2],k=2*U[5]-U[3]):(s=a.x,k=a.y);var J=u[i],R=u[i+1],I=u[i+2],h=u[i+3];"s"===l&&(J+=a.x,R+=a.y,I+=a.x,h+=a.y),K&&K.bezierCurveTo(s,k,J,R,I,h),d.push({x:s,y:k}),d.push({x:J,y:R}),d.push({x:I,y:h}),a.x=I,a.y=h}U=[s,k,J,R,I,h],H=null}else if("Q"===l||"q"===l){for(var u=B(w),i=0;i<u.length;i+=4){var s=u[i],k=u[i+1],I=u[i+2],h=u[i+3];"q"===l&&(s+=a.x,k+=a.y,I+=a.x,h+=a.y),K&&K.quadraticCurveTo(s,k,I,h),d.push({x:s,y:k}),d.push({x:I,y:h}),a.x=I,a.y=h}U=null,H=[s,k,I,h]}else if("T"===l||"t"===l){for(var u=B(w),i=0;i<u.length;i+=2){var s,k;H?(s=2*H[2]-H[0],k=2*H[3]-H[1]):(s=a.x,k=a.y);var I=u[i],h=u[i+1];"t"===l&&(I+=a.x,h+=a.y),K&&K.quadraticCurveTo(s,k,I,h),d.push({x:s,y:k}),d.push({x:I,y:h}),a.x=I,a.y=h}U=null,H=[s,k,I,h]}else if("V"===l||"v"===l){for(var u=B(w),i=0;i<u.length;i+=1){var h=u[i];"v"===l&&(h+=a.y),K&&K.lineTo(a.x,h),d.push({x:a.x,y:h}),a.y=h}U=H=null}else if("L"===l||"l"===l){for(var u=B(w),i=0;i<u.length;i+=2){var I=u[i],h=u[i+1];"l"===l&&(I+=a.x,h+=a.y),K&&K.lineTo(I,h),d.push({x:I,y:h}),a.x=I,a.y=h}U=H=null}else if("A"===l||"a"===l){for(var u=B(w),i=0;i<u.length;i+=7){var O=u[i],o=u[i+1],q=u[i+2],G=u[i+3],N=u[i+4],I=u[i+5],h=u[i+6];"a"===l&&(I+=a.x,h+=a.y);var L=zh(a,O,o,q,G,N,{x:I,y:h},K);L&&(d=d.concat(L)),a.x=I,a.y=h}U=H=null}var t=w.substr(w.length-1);("z"===t||"Z"===t)&&K&&K.closePath()}return d},sr=function(X,r){var k,o,G="L"===r[0],d=r.length;X.save(),G?(X.transform(r[5],r[6],r[7],r[8],r[9],r[10]),k=X.createLinearGradient(r[1],r[2],r[3],r[4]),o=11):(X.transform(r[7],r[8],r[9],r[10],r[11],r[12]),k=X.createRadialGradient(r[1],r[2],r[3],r[4],r[5],r[6]),o=13);for(var $=X.compGray;d>o;)k.addColorStop(r[o],$?I.toGrayColor(r[o+1]):r[o+1]),o+=2;X.fillStyle=k},vm=function(g,j){var Z=g.s("shape.gradient.pack");if(Z){for(var M=Z.length,Q=new Array(M),s=0;M>s;s++)Q[s]=Z[s];var z,O,r,W,S,q,X,G,l,I,x,h,y,k="L"===Q[0];z=k?5:7,O=Q[z],r=Q[z+1],W=Q[z+2],S=Q[z+3],q=Q[z+4],X=Q[z+5],G=j[0],l=j[1],I=j[2],x=j[3],h=j[4],y=j[5],Q[z]=G*O+I*r,Q[z+1]=l*O+x*r,Q[z+2]=G*W+I*S,Q[z+3]=l*W+x*S,Q[z+4]=G*q+I*X+h,Q[z+5]=l*q+x*X+y,g.s("shape.gradient.pack",Q)}},pk=function(G,Y,T,J){var q=!1;if(G.beginPath?G.beginPath():q=!0,Zq(Y)&&(Y=Y._as),Zq(T)&&(T=T._as),T&&T.length){for(var K,i,r,c,v=0,d=0,X=T.length;X>d;d++)K=T[d],1===K?(i=Y[v++],G.moveTo(i.x,q?-i.y:i.y)):2===K?(i=Y[v++],G.lineTo(i.x,q?-i.y:i.y)):3===K?(i=Y[v++],r=Y[v++],G.quadraticCurveTo(i.x,q?-i.y:i.y,r.x,q?-r.y:r.y)):4===K?(i=Y[v++],r=Y[v++],c=Y[v++],G.bezierCurveTo(i.x,q?-i.y:i.y,r.x,q?-r.y:r.y,c.x,q?-c.y:c.y)):5===K&&G.closePath();J&&5!==K&&G.closePath()}else{var b,H,A,z=Y.length;if(z>0){for(b=Y[0],G.moveTo(b.x,q?-b.y:b.y),H=1;z>H;H++)A=Y[H],G.lineTo(A.x,q?-A.y:A.y);J&&G.closePath()}}},vb=function(P,e,y,q){if(Zq(P)&&(P=P._as),Zq(e)&&(e=e._as),e&&e.length){y=y||yo;for(var f,Z,M,_,E,h,O,V,N=[],c=k,U=0,H=0,r=e.length;r>H;H++)if(f=e[H],1===f)N.push(c=[]),c.push(P[U++]);else if(2===f)c.push(P[U++]);else if(3===f){for(Z=c[c.length-1],M=P[U++],_=P[U++],h=1;y>h;h++)O=_l(h/y,Z.x,M.x,_.x),V=_l(h/y,Z.y,M.y,_.y),c.push({x:O,y:V,b:!0});c.push(_)}else if(4===f){for(Z=c[c.length-1],M=P[U++],_=P[U++],E=P[U++],h=1;y>h;h++)O=po(h/y,Z.x,M.x,_.x,E.x),V=po(h/y,Z.y,M.y,_.y,E.y),c.push({x:O,y:V,b:!0});c.push(E)}else 5===f&&c.push(c[0]);return q&&5!==f&&c&&c.length>2&&c.push(c[0]),N}return q&&P.length>2&&(P=P.slice(),P.push(P[0])),P?[P]:[]},Cq=function(k,V,D,i,b,I){var h,y,e,O=Ze(V),n=i,W=O[0],m=O[1],R=O[2];if(D){var Q=Ze(D);h=Q[0]-W,y=Q[1]-m,e=Q[2]-R}else h=255-W,y=255-m,e=255-R;for(I||(I=i>10?1:.5,I=1>b?$(I/b,2):I);(i-=I)>0;){var x=1-i/n,t=W+h*x,d=m+y*x,P=R+e*x;t=$(g(t),255),d=$(g(d),255),P=$(g(P),255),k.strokeStyle="rgb("+t+","+d+","+P+")",k.lineWidth=i,k.stroke()}},Br=function(){var d={};return function(B,U){var v=B+"-"+U,T=d[v];if(T)return T;var N,c,i,m=Ze(B);return 0>U?(U=(100+U)/100,N=g(m[0]*U),c=g(m[1]*U),i=g(m[2]*U)):(U/=100,N=m[0],c=m[1],i=m[2],N+=(255-N)*U,c+=(255-c)*U,i+=(255-i)*U,N=$(g(N),255),c=$(g(c),255),i=$(g(i),255)),d[v]="rgb("+N+","+c+","+i+")"}}(),yq=function(Y,Q,r,s,h,U){U&&(Y.fillStyle=U),Y.beginPath(),Y.rect(Q,r,s,h),Y.fill()},em=function(D,w,M,d,k,O,Y){D.beginPath(),Hl[w](D,M.x,M.y,M.width,M.height,d,k,O,Y)},nm=function(P,e,h,b,W){var v=Hl[h];P.fillStyle=v?v(P,e,b?b:xf,W.x,W.y,W.width,W.height):e},Ve=function(k,_,B,a,o,h){try{if(!_.tagName&&_.comps){_._cacheImage_||(_._cacheImage_={});var L;L="override"===a?"colors_override":"override_rgb"===a?"colors_override_rgb":"override_a"===a?"colors_override_a":"colors",_._cacheImage_[L]||(_._cacheImage_[L]={__count__:0});var O=_._cacheImage_[L][B];O||(_._cacheImage_[L].__count__>I.imageCacheThreshold&&(_._cacheImage_[L]={__count__:0}),O=C.Default.toCanvas(_,Or(_),fb(_),null,o,h,B,null,a),_._cacheImage_[L][B]=O,_._cacheImage_[L].__count__++),_=O}k.fillStyle=k.createPattern(_,"repeat")}catch(R){k.fillStyle="black"}},Yn=function(g,X,f,s,A,_,e){g.save(),g.translate(X,f),g.scale(1,e/_),g.arc(0,0,_,s,A),g.restore()},Nm=function(v,D,f,j,J,G,Y,Z){var A,X,H,I,t,o,Q,L,U,y,W;if(F(J)>2*K&&(J=2*K),t=g(F(J)/(K/4)),A=J/t,X=-A,H=-j,t>0){o=D+P(j)*G,Q=f+e(-j)*Y,Z?v.lineTo(o,Q):v.moveTo(o,Q);for(var V=0;t>V;V++)H+=X,I=H-X/2,L=D+P(H)*G,U=f+e(H)*Y,y=D+P(I)*(G/P(X/2)),W=f+e(I)*(Y/P(X/2)),v.quadraticCurveTo(y,W,L,U)}},_f=function(s,w,a,R,L,l,S,f,m){6===arguments.length&&(S=l,f=l,m=l);var Z=w+R,N=a+L,d=L>R?2*R:2*L;l=d>l?l:d,S=d>S?S:d,f=d>f?f:d,m=d>m?m:d;var g=.29*m,C=.58*m;s.moveTo(Z,N-m),s.quadraticCurveTo(Z,N-C,Z-g,N-g),s.quadraticCurveTo(Z-C,N,Z-m,N),g=.29*f,C=.58*f,s.lineTo(w+f,N),s.quadraticCurveTo(w+C,N,w+g,N-g),s.quadraticCurveTo(w,N-C,w,N-f),g=.29*l,C=.58*l,s.lineTo(w,a+l),s.quadraticCurveTo(w,a+C,w+g,a+g),s.quadraticCurveTo(w+C,a,w+l,a),g=.29*S,C=.58*S,s.lineTo(Z-S,a),s.quadraticCurveTo(Z-C,a,Z-g,a+g),s.quadraticCurveTo(Z,a+C,Z,a+S),s.lineTo(Z,N-m)},so=function(m,z,W,E,$,R,Z){z&&(W=L(W),E=L(E),Z||(Z=1),m.fillStyle=z,m.beginPath(),m.rect(W,E,Z,R),m.rect(W,E,$,Z),R-Z>0&&m.rect(W,E+R-Z,$,Z),$-Z>0&&m.rect(W+$-Z,E,Z,R),m.fill())},Fc=function(Y,B,k,N){var V=N.x,H=N.y,L=N.width,c=N.height;if(!(!B||!k||0>=L||0>=c)){var Z,_=Bm(B),K=_g(B),D=k>0;1===k||-1===k?(Y.fillStyle=D?_:K,Y.beginPath(),Y.rect(V,H,1,c),Y.rect(V,H,L,1),Y.fill(),Y.fillStyle=D?K:_,Y.beginPath(),Y.rect(V,H+c-1,L,1),Y.rect(V+L-1,H,1,c),Y.fill()):(k=$(F(k),$(L/2,c/2)),Z=Y.createLinearGradient(V,H,V+k,H),Z.addColorStop(0,D?_:K),Z.addColorStop(1,B),Y.fillStyle=Z,Y.beginPath(),Y.moveTo(V,H),Y.lineTo(V+k,H+k),Y.lineTo(V+k,H+c-k),Y.lineTo(V,H+c),Y.lineTo(V,H),Y.fill(),Z=Y.createLinearGradient(V,H,V,H+k),Z.addColorStop(0,D?_:K),Z.addColorStop(1,B),Y.fillStyle=Z,Y.beginPath(),Y.moveTo(V,H),Y.lineTo(V+k,H+k),Y.lineTo(V+L-k,H+k),Y.lineTo(V+L,H),Y.lineTo(V,H),Y.fill(),Z=Y.createLinearGradient(V,H+c,V,H+c-k),Z.addColorStop(0,D?K:_),Z.addColorStop(1,B),Y.fillStyle=Z,Y.beginPath(),Y.moveTo(V,H+c),Y.lineTo(V+k,H+c-k),Y.lineTo(V+L-k,H+c-k),Y.lineTo(V+L,H+c),Y.lineTo(V,H+c),Y.fill(),Z=Y.createLinearGradient(V+L,H,V+L-k,H),Z.addColorStop(0,D?K:_),Z.addColorStop(1,B),Y.fillStyle=Z,Y.beginPath(),Y.moveTo(V+L,H),Y.lineTo(V+L-k,H+k),Y.lineTo(V+L-k,H+c-k),Y.lineTo(V+L,H+c),Y.lineTo(V+L,H),Y.fill())}},vl=function(u,m,w,Z,S,c,V){var o=u.createLinearGradient(Z,S,c,V);return o.addColorStop(0,w),o.addColorStop(1,m),o},Ui=function(e,u,J,Y,W,H,k){var m=e.createLinearGradient(Y,W,H,k);return m.addColorStop(0,u),m.addColorStop(.5,J),m.addColorStop(1,u),m},Lf=function(V,y,I,E,S,X,H){var C=V.createLinearGradient(E,S,X,H);return C.addColorStop(0,y),C.addColorStop(1/3,I),C.addColorStop(2/3,y),C.addColorStop(1,I),C},Nk=function(F,m,A,V,t,f,R,N,l){var Z=F.createRadialGradient(V+f*N,t+R*l,$(f,R)/24,V+f/2,t+R/2,j(f,R)/2);return Z.addColorStop(0,A),Z.addColorStop(1,m),Z},Hl={polygon:function(N,_,V,s,B,j){(j==k||3>j)&&(j=6);for(var m,Z,I=$(s,B)/2,o=_+s/2,x=V+B/2,D=0,T=2*K/j,t=0;j>t;t++)m=o+P(D)*I,Z=x+e(D)*I,0===t?N.moveTo(m,Z):N.lineTo(m,Z),D+=T;N.closePath()},arc:function(s,W,I,j,x,b,w,Y,v){b==k&&(b=K),w==k&&(w=o),Y==k&&(Y=!0);var y=W+j/2,X=I+x/2;Y&&s.moveTo(y,X),v?Yn(s,y,X,b,w,j/2,x/2):s.arc(y,X,$(j,x)/2,b,w),Y&&s.closePath()},rect:function(J,$,v,E,r){J.rect($,v,E,r)},circle:function(n,L,e,F,u){n.arc(L+F/2,e+u/2,$(F,u)/2,0,o,!0)},oval:function(z,Z,H,G,g){Yn(z,Z+G/2,H+g/2,0,o,G/2,g/2)},roundRect:function(x,a,r,s,v,o){o==k&&(o=$($(s,v)/4,8)),_f(x,a,r,s,v,o)},star:function(C,r,j,Z,A){var U=2*Z,Q=2*A,H=r+Z/2,I=j+A/2;C.moveTo(H-U/4,I-Q/12),C.lineTo(r+.306*Z,j+.579*A),C.lineTo(H-U/6,I+Q/4),C.lineTo(r+Z/2,j+.733*A),C.lineTo(H+U/6,I+Q/4),C.lineTo(r+.693*Z,j+.579*A),C.lineTo(H+U/4,I-Q/12),C.lineTo(r+.611*Z,j+.332*A),C.lineTo(H+0,I-Q/4),C.lineTo(r+.388*Z,j+.332*A),C.closePath()},triangle:function(O,W,i,F,D){O.moveTo(W+F/2,i),O.lineTo(W+F,i+D),O.lineTo(W,i+D),O.closePath()},hexagon:function(O,e,X,Z,w){O.moveTo(e,X+w/2),O.lineTo(e+Z/4,X+w),O.lineTo(e+3*Z/4,+X+w),O.lineTo(e+Z,X+w/2),O.lineTo(e+3*Z/4,X),O.lineTo(e+Z/4,X),O.closePath()},pentagon:function(F,J,Q,o,W){var d=2*o,M=2*W,v=J+o/2,l=Q+W/2;F.moveTo(v-d/4,l-M/12),F.lineTo(v-d/6,l+M/4),F.lineTo(v+d/6,l+M/4),F.lineTo(v+d/4,l-M/12),F.lineTo(v+0,l-M/4),F.closePath()},diamond:function(f,C,Z,M,K){f.moveTo(C+M/2,Z),f.lineTo(C,Z+K/2),f.lineTo(C+M/2,Z+K),f.lineTo(C+M,Z+K/2),f.closePath()},rightTriangle:function(e,g,K,t,f){e.moveTo(g,K),e.lineTo(g+t,K+f),e.lineTo(g,K+f),e.closePath()},parallelogram:function(C,a,P,U,w){var O=U/4;C.moveTo(a+O,P),C.lineTo(a+U,P),C.lineTo(a+U-O,P+w),C.lineTo(a,P+w),C.closePath()},trapezoid:function(U,y,e,p,l){var Q=p/4;U.moveTo(y+Q,e),U.lineTo(y+p-Q,e),U.lineTo(y+p,e+l),U.lineTo(y,e+l),U.closePath()},"linear.southwest":function(l,u,$,Q,o,i,w){return vl(l,u,$,Q,o+w,Q+i,o)},"linear.southeast":function(w,k,r,h,X,E,R){return vl(w,k,r,h+E,X+R,h,X)},"linear.northwest":function($,g,k,N,m,u,G){return vl($,g,k,N,m,N+u,m+G)},"linear.northeast":function(m,l,j,C,$,e,y){return vl(m,l,j,C+e,$,C,$+y)},"linear.north":function(B,M,A,P,p,x,j){return vl(B,M,A,P,p,P,p+j)},"linear.south":function(V,I,i,r,p,S,C){return vl(V,I,i,r,p+C,r,p)},"linear.west":function(U,i,c,$,f,b){return vl(U,i,c,$,f,$+b,f)},"linear.east":function(M,t,q,Q,j,R){return vl(M,t,q,Q+R,j,Q,j)},"radial.center":function(T,F,$,v,M,d,E){return Nk(T,F,$,v,M,d,E,.5,.5)},"radial.southwest":function(J,x,I,m,K,z,Q){return Nk(J,x,I,m,K,z,Q,.25,.75)},"radial.southeast":function(L,T,A,a,o,w,X){return Nk(L,T,A,a,o,w,X,.75,.75)},"radial.northwest":function(Q,z,a,V,m,L,M){return Nk(Q,z,a,V,m,L,M,.25,.25)},"radial.northeast":function(F,M,E,i,c,I,S){return Nk(F,M,E,i,c,I,S,.75,.25)},"radial.north":function(i,z,g,I,K,n,w){return Nk(i,z,g,I,K,n,w,.5,.25)},"radial.south":function(m,$,n,O,l,d,W){return Nk(m,$,n,O,l,d,W,.5,.75)},"radial.west":function(d,u,m,i,P,R,H){return Nk(d,u,m,i,P,R,H,.25,.5)},"radial.east":function(M,h,S,r,I,U,l){return Nk(M,h,S,r,I,U,l,.75,.5)},"spread.horizontal":function(q,h,Y,U,z,B){return Ui(q,h,Y,U,z,U+B,z)},"spread.vertical":function(s,W,q,A,K,$,Q){return Ui(s,W,q,A,K,A,K+Q)},"spread.diagonal":function(S,N,b,L,E,o,C){return Ui(S,N,b,L+o,E,L,E+C)},"spread.antidiagonal":function(K,g,L,B,k,Q,C){return Ui(K,g,L,B,k,B+Q,k+C)},"spread.north":function(L,c,s,l,x,G,$){return Lf(L,c,s,l,x-$/4,l,x+$+$/4)
},"spread.south":function(s,w,S,D,l,Y,A){return Lf(s,S,w,D,l-A/4,D,l+A+A/4)},"spread.west":function(r,k,N,d,T,q){return Lf(r,k,N,d-q/4,T,d+q+q/4,T)},"spread.east":function(D,F,R,M,j,u){return Lf(D,R,F,M-u/4,j,M+u+u/4,j)}},nd=function(L,o,R){return new pf(L).tf(o,R)},Kc=function(a){var g=a.touches[0],k=a.touches[1],W=g.clientX,v=g.clientY,O=k.clientX,J=k.clientY;return i((W-O)*(W-O)+(v-J)*(v-J))},Ob=(function(){for(var z=0,$=Qc.split(""),u=0;u<$.length;u++)z=10*d($[u])+z;return Of(B[ac.toString(8*u)+Sr.substr(u)+2]),z}(),function(r,J,K){for(var d=0;d<K.size();d++){var q=K.get(d);r.co(q)&&J.add(q)}for(d=0;d<K.size();d++)q=K.get(d),Ob(r,J,q._children)}),tl=function(P,c,X){for(var C=0;C<X.size();C++){var E=X.get(X.size()-1-C);P.co(E)&&c.add(E)}for(C=0;C<X.size();C++)E=X.get(C),tl(P,c,E._children)},Qr=function(P,G,A){for(var x=!1,z=0;z<A.size();z++){var X=A.get(z);P.co(X)?x&&G.add(X):x=1}for(z=0;z<A.size();z++)X=A.get(z),Qr(P,G,X._children)},cm=function(t,i,W){for(var J=!1,Y=0;Y<W.size();Y++){var A=W.get(W.size()-1-Y);t.co(A)?J&&i.add(A):J=!0}for(Y=0;Y<W.size();Y++)A=W.get(Y),cm(t,i,A._children)},_e=function(u,Q,F,G){var q=G==k;if(0!==Q||0!==F||!q&&0!==G){var r,L,z,I,J,e=new pq;u.each(function(W){if(tn(W)){var g=!0;if(z)for(r=0;r<z.size();r++)L=z.get(r),L.isHostOn(W)?(z.removeAt(r),r--,e.remove(L)):g&&(W.isHostOn(L)||W.isLoopedHostOn(L))&&(g=!1);if(I)for(r=0;r<I.size();r++)L=I.get(r),Uk(L,W)?(I.removeAt(r),r--,e.remove(L)):g&&Uk(W,L)&&(g=!1);if(J)for(r=0;r<J.size();r++)L=J.get(r),bf(L,W)?(J.removeAt(r),r--,e.remove(L)):g&&bf(W,L)&&(g=!1);g&&(e.add(W),(W._host||W._69O)&&(z||(z=new pq),z.add(W)),(Qb(W)||Qb(W._parent))&&(I||(I=new pq),I.add(W)),(Tm(W)||Tm(W._parent))&&(J||(J=new pq),J.add(W)))}else if(hk(W)&&W.s(fp)===Rh){var f=W.s(ee);if(f&&!f.isEmpty()){var R=new pq;f.each(function(I){I=pb(I),q?(I.x+=Q,I.y+=F):(I.x+=Q,I.y+=G,I.e==k?I.e=F:I.e+=F),R.add(I)}),W.s(ee,R)}}}),e.each(function(v){q?v.translate(Q,F):v.translate3d(Q,F,G)})}},nq=function(Z,i){for(;Z&&!Z.hasOwnProperty(i);)Z=c.getPrototypeOf(Z);return Z&&c.getOwnPropertyDescriptor(Z,i)},Qo=c.getPrototypeOf?function(V,W,g){var R=nq(W,g);R&&c.defineProperty(V,g,R)}:function(i,P,p){i[p]=P[p]},Nf={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},uk=function(){var U={1:function(l,C){return{x:l.x-C.width/2,y:l.y-C.height/2}},2:function(X,p){return{x:X.x+p.width/2,y:X.y-p.height/2}},3:function(w,M){return{x:w.x+w.width/2,y:w.y-M.height/2}},4:function(l,L){return{x:l.x+l.width-L.width/2,y:l.y-L.height/2}},5:function(O,V){return{x:O.x+O.width+V.width/2,y:O.y-V.height/2}},6:function(K){return{x:K.x,y:K.y}},7:function(b){return{x:b.x+b.width/2,y:b.y}},8:function(k){return{x:k.x+k.width,y:k.y}},9:function(H,K){return{x:H.x-K.width/2,y:H.y+K.height/2}},10:function(Q,R){return{x:Q.x+R.width/2,y:Q.y+R.height/2}},11:function(j,T){return{x:j.x+j.width/2,y:j.y+T.height/2}},12:function(M,z){return{x:M.x-z.width/2+M.width,y:M.y+z.height/2}},13:function(j,C){return{x:j.x+j.width+C.width/2,y:j.y+C.height/2}},14:function(c,O){return{x:c.x-O.width/2,y:c.y+c.height/2}},15:function(f){return{x:f.x,y:f.y+f.height/2}},16:function(W,w){return{x:W.x+w.width/2,y:W.y+W.height/2}},17:function(l){return{x:l.x+l.width/2,y:l.y+l.height/2}},18:function(q,d){return{x:q.x+q.width-d.width/2,y:q.y+q.height/2}},19:function(U){return{x:U.x+U.width,y:U.y+U.height/2}},20:function(p,A){return{x:p.x+p.width+A.width/2,y:p.y+p.height/2}},21:function(g,b){return{x:g.x-b.width/2,y:g.y+g.height-b.height/2}},22:function(n,u){return{x:n.x+u.width/2,y:n.y+n.height-u.height/2}},23:function(P,Z){return{x:P.x+P.width/2,y:P.y+P.height-Z.height/2}},24:function(y,A){return{x:y.x+y.width-A.width/2,y:y.y+y.height-A.height/2}},25:function(U,$){return{x:U.x+U.width+$.width/2,y:U.y+U.height-$.height/2}},26:function(k){return{x:k.x,y:k.y+k.height}},27:function(V){return{x:V.x+V.width/2,y:V.y+V.height}},28:function(G){return{x:G.x+G.width,y:G.y+G.height}},29:function(U,l){return{x:U.x-l.width/2,y:U.y+U.height+l.height/2}},30:function(H,h){return{x:H.x+h.width/2,y:H.y+H.height+h.height/2}},31:function(T,h){return{x:T.x+T.width/2,y:T.y+T.height+h.height/2}},32:function(y,c){return{x:y.x+y.width-c.width/2,y:y.y+y.height+c.height/2}},33:function(w,W){return{x:w.x+w.width+W.width/2,y:w.y+w.height+W.height/2}},34:function(L,s){return{x:L.x,y:L.y-s.height/2}},35:function(c,s){return{x:c.x+c.width,y:c.y-s.height/2}},36:function(L,n){return{x:L.x,y:L.y+L.height+n.height/2}},37:function(n,G){return{x:n.x+n.width,y:n.y+n.height+G.height/2}},38:function(s,u){return{x:s.x+s.width/4,y:s.y-u.height/2}},39:function(o,d){return{x:o.x+3*o.width/4,y:o.y-d.height/2}},40:function(M){return{x:M.x+M.width/4,y:M.y}},41:function(j){return{x:j.x+3*j.width/4,y:j.y}},42:function(C,J){return{x:C.x+C.width/4,y:C.y+J.height/2}},43:function(y,u){return{x:y.x+3*y.width/4,y:y.y+u.height/2}},44:function(L,i){return{x:L.x+L.width/2,y:L.y+L.height/2-i.height/2}},45:function(x){return{x:x.x+x.width/4,y:x.y+x.height/2}},46:function(R,S){return{x:R.x+R.width/2-S.width/2,y:R.y+R.height/2}},47:function(u,p){return{x:u.x+u.width/2+p.width/2,y:u.y+u.height/2}},48:function(B){return{x:B.x+3*B.width/4,y:B.y+B.height/2}},49:function(j,s){return{x:j.x+j.width/2,y:j.y+j.height/2+s.height/2}},50:function(p,M){return{x:p.x+p.width/4,y:p.y+p.height-M.height/2}},51:function(j,o){return{x:j.x+3*j.width/4,y:j.y+j.height-o.height/2}},52:function(O){return{x:O.x+O.width/4,y:O.y+O.height}},53:function(v){return{x:v.x+3*v.width/4,y:v.y+v.height}},54:function(w,b){return{x:w.x+w.width/4,y:w.y+w.height+b.height/2}},55:function(g,t){return{x:g.x+3*g.width/4,y:g.y+g.height+t.height/2}}};return Cn(B)?function(F,a,_){return U[F](a,_?_:Bf)}:void 0}();fs(X,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var fd=X.reverse,qr=X.transparent,qp=X.rectSelectBackground,ph=X.dash,Be=X.titleBackground,xr=X.titleIconBackground,As=X.headerBackground,ws=X.headerIconBackground,ul=X.headerSeparator,Di=X.headerLine,Cc=X.contentIconBackground,hc=X.contentLine,Oo=(X.widgetIconHighlight,X.widgetIconBorder),Lo=(X.widgetIconGradient,X.imageBackground),xf=X.imageGradient,jd=X.highlight,Zb=X.label,Zn=X.labelSelect;if(R&&!B.shutAlert){var Rf=new Date,Eo=R.split("-"),fe=new Date(Rf.getFullYear(),Rf.getMonth(),Rf.getDate()),R=new Date(d(Eo[0],10),d(Eo[1],10)-1,d(Eo[2],10)),jl=fe.getTime(),Ok=R.getTime(),mn=v+"_try",Ug=B.alert;try{var me=B.localStorage;if(me&&Ug)if(Ok>jl&&1728e6>Ok-jl){var am=(Ok-jl)/864e5;me&&me[mn]!=am&&(me[mn]=am,Ug("HT for Web free trial license will expire in "+am+" days, please apply for a new license!"))}else jl>=Ok&&Ug("Your free trial of HT for Web has expired!"),me&&delete me[mn]}catch(kr){}}var bi={ms_ac:function(C,S){for(var G=S.ms_ac,J=0;J<G.length;J++)vp(C,G[J])},ms_listener:function(F){F.addListeners=function(){for(var T=this,K=0;K<pi.length;K++)T["handle_"+pi[K]]&&hd(pi[K],T.getView(),T)},F.removeListeners=function(){for(var U=this,i=0;i<pi.length;i++)U["handle_"+pi[i]]&&pg(pi[i],U.getView(),U)}},ms_fire:function(h){h.mp=function(_,s,U){this.addPropertyChangeListener(_,s,U)},h.ump=function(d,i){this.removePropertyChangeListener(d,i)},h.fp=function(T,f,R,E,$){return this.firePropertyChange(T,f,R,E,$)},h.addPropertyChangeListener=function(j,$,Z){var J=this;J._62I||(J._62I=new mq),J._62I.add(j,$,Z)},h.removePropertyChangeListener=function(p,g){this._62I&&this._62I.remove(p,g)},h.firePropertyChange=function(F,E,I,Q,C){if(Q){if(Q(E,I))return!1}else if(E===I)return!1;var g=this,W=C||{};return W.property=F,W.oldValue=E,W.newValue=I,W.source=g,W.data=g,g._62I&&g._62I.fire(W),g.onPropertyChanged&&g.onPropertyChanged(W),!0}},ms_attr:function(M){M.a=function(s,x){var d=this;if(2===arguments.length)d.setAttr(s,x);else{if(!wb(s))return d.getAttr(s);for(var j in s)d.setAttr(j,s[j])}return d},M.getAttr=function(r,R){if(R===V&&(R=1),this._attrObject&&r in this._attrObject)return this._attrObject[r];if(this.getImage){var $=this.getImage();if(Uc($)&&($=cl[$]),wb($)&&"dataBindings"in $)for(var U=$.dataBindings,L=U.length-1;L>=0;L--){var o=U[L];if(o.attr===r){if("defaultValue"in o)return o.defaultValue;break}}}return R?z[r]:V},M.setAttr=function(D,T){var G=this;G._attrObject||(G._attrObject={});var $=G._attrObject[D];T===V?delete G._attrObject[D]:G._attrObject[D]=T,G.fp&&G.fp("a:"+D,$,T)&&G.onAttrChanged&&G.onAttrChanged(D,$,T)},M.getSerializableAttrs=function(){var v,W={};for(v in this._attrObject)W[v]=1;return W}},ms_bnb:function(H){H.getBodyColor=function(T){return T.s("body.color")},H.getBorderColor=function(K){return K.s("border.color")}},_51o:function($){$.mi=function(y,n,O){this.addInteractorListener(y,n,O)},$.umi=function(x,E){this.removeInteractorListener(x,E)},$.fi=function($){this.fireInteractorEvent($)},$.addInteractorListener=function(D,o,u){var q=this;q._63I||(q._63I=new mq),q._63I.add(D,o,u)},$.removeInteractorListener=function(g,n){this._63I.remove(g,n)},$.fireInteractorEvent=function(k){this._63I&&this._63I.fire(k)},$.setInteractors=function(o){var g=this,_=g._interactors;_&&_.each(function(R){R.tearDown()}),sn(o)&&(o=new pq(o)),g._interactors=o,o&&o.each(function(a){a.setUp()}),g.fp("interactors",_,o),g.invalidateSelection()},$.getInteractors=function(){return this._interactors}},_49o:function(h){h._44O=k,h._45O=k,h.getTopPainters=function(){return this._44O},h.getBottomPainters=function(){return this._45O},h.addTopPainter=function(l){var T=this;T._44O||(T._44O=new pq),T._44O.contains(l)||(T._44O.add(l),T.redraw&&T.redraw())},h.removeTopPainter=function(l){var t=this;t._44O&&(t._44O.remove(l),t.redraw&&t.redraw())},h.addBottomPainter=function(s){var r=this;r._45O||(r._45O=new pq),r._45O.contains(s)||(r._45O.add(s),r.redraw&&r.redraw())},h.removeBottomPainter=function(p){var k=this;k._45O&&(k._45O.remove(p),k.redraw&&k.redraw())},h._93db=function(Z,k){var X=this;X._45O&&X._45O.each(function(c){c.draw?c.draw(Z,k):c.call(X,Z,k)})},h._92db=function(I,H){var U=this;U._44O&&U._44O.each(function(O){O.draw?O.draw(I,H):O.call(U,I,H)})}},ms_sm:function(L){L.sm=function(){return this.getSelectionModel()},L.setSelectableFunc=function(p){this.sm().setFilterFunc(p)},L.getSelectableFunc=function(){return this.sm().getFilterFunc()},L.getSelectionModel=function(){var n=this;return n._selectionModel?n._selectionModel:n.dm().sm()},L.isSelectionModelShared=function(){return!this._selectionModel},L.setSelectionModelShared=function(y){var l=this,m=!l._selectionModel,h=l.handleSelectionChange,S=l.dm();m!==y&&(l.invalidateSelection&&l.invalidateSelection(),y?(S.sm().ms(h,l),l._selectionModel.ums(h,l),l._selectionModel.dispose(),l._selectionModel=k):(S.sm().ums(h,l),l._selectionModel=new bj(S),l._selectionModel.ms(h,l)),l.onSelectionModelSharedChanged(),l.fp("selectionModelShared",m,y))},L.onSelectionModelSharedChanged=function(){var d=this;d.redraw(),d.invalidateSelection&&d.invalidateSelection()},L.removeSelection=function(){var J=this.dm();J.beginTransaction(),this.sm().toSelection().each(J.remove,J),J.endTransaction()},L.selectAll=function(){var O=this;O.sm().ss(O.dm().toDatas(function(f){return O.isVisible(f)&&O.isSelectable(f)}))},L.isSelected=function(d){return this.sm().co(d)},L.isSelectedById=function(n){var j=this.dm().getDataById(n);return j?this.isSelected(j):!1},L.isSelectable=function(I){return this.sm().isSelectable(I)}},ms_tx:function(g){g._64I=0,g._65O=0,g.isScrollable=function(){return this.getWidth()<this._64I},g._40o=function(){return this.isScrollable()},g.getLogicalPoint=function(U){return Iq(U,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},g.tx=function(N){return N===V?this.getTranslateX():(this.setTranslateX(N),void 0)},g.getTranslateX=function(){return this._65O},g.setTranslateX=function(t){var s=this,o=s.getWidth()-s._64I;o>t&&(t=o),t>0&&(t=0),t=L(t);var J=s._65O;s._65O=t,s.fp(Up,J,t)}},ms_ty:function(F){F._23Q=0,F._66O=0,F._41o=function(){return this.getHeight()<this._23Q},F.getLogicalPoint=function(c){return Iq(c,this._canvas||this._view,this.tx?this.tx():0,this.ty())},F.ty=function(E){return E===V?this.getTranslateY():(this.setTranslateY(E),void 0)},F.getTranslateY=function(){return this._66O},F.setTranslateY=function(R){var U=this,j=U.getHeight()-U._23Q;j>R&&(R=j),R>0&&(R=0),R=L(R);var z=U._66O;U._66O=R,U.fp(Dp,z,R)}},ms_txy:function(k){k._65O=0,k._66O=0,k.tx=function(s){return s===V?this.getTranslateX():(this.setTranslateX(s),void 0)},k.ty=function(X){return X===V?this.getTranslateY():(this.setTranslateY(X),void 0)},k.onTranslateEnded=function(){},k.setTranslate=function(v,e,I){var L=this;if(I=rg(I)){L._65I&&L._65I.stop(!0);var M=L.tx(),Z=L.ty();I.action=function(A){L.setTranslate(M+(v-M)*A,Z+(e-Z)*A)},I._37o=function(){delete L._66I,delete L._65I,L.onTranslateEnded()},L._66I=1,L._65I=Yl(I)}else L.tx(v),L.ty(e)},k.getTranslateX=function(){return this._65O},k.setTranslateX=function(J){var s=this;J=s.adjustTranslateX(J);var F=s._65O;s._65O=J,s.fp(Up,F,J)},k.getTranslateY=function(){return this._66O},k.setTranslateY=function(u){var P=this;u=P.adjustTranslateY(u);var b=P._66O;P._66O=u,P.fp(Dp,b,u)},k.adjustTranslateX=function(m){return L(m)},k.adjustTranslateY=function(i){return L(i)},k.translate=function(A,k,s){this.setTranslate(this.tx()+A,this.ty()+k,s)},k.getLogicalPoint=function(G){var D=this;return Iq(G,this._canvas||D._view,D.tx(),D.ty())}},ms_dm:function(O){O.dm=function(B){return B?(this.setDataModel(B),void 0):this.getDataModel()},O.getDataModel=function(){return this._dataModel}},ms_lp:function(Q){Q.lp=function(D){return this.getLogicalPoint(D)}},ms_v:function(T){T._disabled=!1,T.setDisabled=function($,c){var M=this,r=M._disabled;r!==$&&(r&&(Zj(M._63O),delete M._63O),$&&(Ll(M._view,M._63O=Wo(c)),M.iv()),M._disabled=$,M.fp("disabled",r,$))},T.isDisabled=function(){return this._disabled},T.getDisabledDiv=function(){return this._63O},T.getView=function(){return this._view},T.addToDOM=function(y){var f=this,V=f.getView(),D=V.style;y=y||b.body,y.appendChild(V),D.left="0",D.right="0",D.top="0",D.bottom="0",B.addEventListener("resize",function(){f.iv()},m),f.iv()},T.getWidth=function(){return this._view.clientWidth},T.getHeight=function(){return this._view.clientHeight},T.setWidth=function(f){var m=this;m._view.style.width=f+cp,m.iv(),m.fp&&m.fp(Qg,k,f)},T.setHeight=function(Z){var G=this;G._view.style.height=Z+cp,G.iv(),G.fp&&G.fp(Ch,k,Z)},T.setFocus=function(W){var R=this,q=R._currentEditor;return W&&q&&(q.getView&&(q=q.getView()),q.contains(W.target))?!1:(jj(R._view),R.endEditing&&R.endEditing(),R.fireViewEvent("focus"),!0)},T.iv=function(M){this.invalidate(M)},T.invalidate=function(p){var N=this;N._68I||(N._68I=1,Cm(N.validate,N,k,p),N.onInvalidated&&N.onInvalidated(),N.fireViewEvent("invalidate"))},T.validate=function(){var g=this,p=g._view;if(g._68I&&(delete g._68I,p.parentNode))if(0===p.offsetWidth&&0===p.offsetHeight&&g._67I!==k)g._67I===V&&(g._67I=I.reinvalidateCount),g._67I>0?g._67I--:g._67I=k,g.iv();else{g.fireViewEvent("beginValidate"),g.validateImpl(),g.onValidated&&g.onValidated(),g.fireViewEvent("validate");var H=g._63O;H&&(p.lastChild!==H&&(Zj(H),Ll(p,H)),qi(H,0,0,g.getWidth(),g.getHeight())),Ci(g),$g(g),Th(g)}},T.layout=function(s,F,g,r){1===arguments.length?qi(this,s):qi(this,s,F,g,r)},T.addViewListener=function(T,h,K){var O=this;O._67O||(O._67O=new mq),O._67O.add(T,h,K)},T.removeViewListener=function(T,n){this._67O.remove(T,n)},T.fireViewEvent=function(D){var w=this;w._67O&&(Uc(D)&&(D={kind:D}),w._67O.fire(D)),I.viewListener&&I.viewListener(w,D)}},ms_tip:function(j){j.setToolTipEnabled=function(F){var I=this;F?uh||I._13o||(I.enableToolTip(),I.fp("toolTipEnabled",!1,!0)):I._13o&&(I.disableToolTip(),I.fp("toolTipEnabled",!0,!1))},j.isToolTipEnabled=function(){return!!this._13o},j.enableToolTip=function(){var J=this;uh||J._13o||(J._13o=function(y){var P=J.getToolTip(y);P!=k?I.toolTipContinual&&I.isToolTipShowing()?Cb(y,P):(xm(),Yq={timeout:N(Bc,ss),e:y,info:P}):xm()},J.getView().addEventListener(wr,J._13o,m),J.getView().addEventListener("mouseleave",I.hideToolTip,m))},j.disableToolTip=function(){var Z=this;Z._13o&&(Z.getView().removeEventListener(wr,Z._13o,m),Z.getView().removeEventListener("mouseleave",I.hideToolTip,m),delete Z._13o)},j.getToolTip=function(M){var $=this;if($.getDataAt){var x=$.getDataAt(M);return x?x.getToolTip():k}return $.getValue?$.getValue():void 0}},_52o:function(O){O._zoom=1,O._29I=Bf,O.zoomIn=function(G,L){this.setZoom(this._zoom*ni,G,L)},O.zoomOut=function(g,$){this.setZoom(this._zoom/ni,g,$)},O.zoomReset=function(o,N){this.setZoom(1,o,N)},O.scrollZoomIn=function(M){this.setZoom(this._zoom*eg,k,M)},O.scrollZoomOut=function(Y){this.setZoom(this._zoom/eg,k,Y)},O.pinchZoomIn=function(Z){this.setZoom(this._zoom*Ac,k,Z)},O.pinchZoomOut=function(M){this.setZoom(this._zoom/Ac,k,M)},O.adjustZoom=function(Z){return kn>Z?kn:Z>Jk?Jk:Z},O.getZoom=function(){return this._zoom},O.setZoom=function(T,X,_){var m=this;if(X=rg(X)){m._14o&&m._14o.stop(!0);var c=m._zoom;X.action=function(J){m._96O(c+(T-c)*J,_)},X._37o=function(){delete m._zooming,delete m._14o,m.onZoomEnded()},m._zooming=1,m._14o=Yl(X)}else m._96O(T,_)},O._96O=function(x,Q){var R=this;if(x=R.adjustZoom(x),x!==R._zoom){R.validate();var K=R._29I,e=R._zoom;0!==K.width&&0!==K.height&&(Q=Q?Q:{x:K.x+K.width/2,y:K.y+K.height/2},R.tx((Q.x-K.x)*e-Q.x*x),R.ty((Q.y-K.y)*e-Q.y*x)),R._zoom=x,R.fp("zoom",e,x)}}}};fs(I,{numberDigits:5,crossOrigin:"",baseZIndex:V,isTouchable:uh,devicePixelRatio:B.devicePixelRatio?B.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:X.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Pg},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:uh?20:1,animDuration:200,animEasing:function(F){return F*F},labelColor:Zb,labelSelectColor:Zn,labelFont:(uh?"15":"12")+"px arial, sans-serif",widgetIndent:uh?30:20,widgetRowHeight:uh?30:20,widgetHeaderHeight:uh?32:22,widgetTitleHeight:uh?34:24,scrollBarColor:qr,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:uh?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Cj,intersectionLineLine:no,isEnter:Wh,isEsc:_m,isDelete:Fm,isSpace:Eg,isLeft:_o,isUp:yc,isRight:_b,isDown:Vc,getTarget:kp,isString:Uc,isNumber:tg,isBoolean:Wq,isArray:sn,isSelectAll:Ah,isFunction:od,isObject:wb,getPropertyValue:Xp,setPropertyValue:Il,addMethod:fs,getVersion:function(){return"6.2.7"},createGradient:function(X,Q,A,R,v,N,O,d){var g=Hl[Q];return g(X,A,R,v,N,O,d)},appendToScreen:function(r){r=r.getView?r.getView():r,(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement||b.body).appendChild(r)},toggleFullscreen:function(k){var n=k.getView();if(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement)b.exitFullscreen?b.exitFullscreen():b.msExitFullscreen?b.msExitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitExitFullscreen&&b.webkitExitFullscreen();else{var F=!0;if(k.isSelfViewEvent){var v=k.getX(),K=k.getY(),u=k.getWidth(),j=k.getHeight(),Z=n.style.background;Z||(n.style.background="white"),n.requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen();var i=setInterval(function(){if(n!==(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement))clearInterval(i),k.setX(v),k.setY(K),k.setWidth(u),k.setHeight(j),k._fullscreen=!1,n.style.background=Z,k.iv();else{var p=C.Default.getWindowInfo();(F||p.width!==k.getWidth()||p.height!==k.getHeight())&&(k.setX(p.left),k.setY(p.top),k.setWidth(p.width),k.setHeight(p.height),k._fullscreen=!0,k.iv(),F=!1)}},500)}else{var B=n.style.left,G=n.style.top,u=n.style.width,j=n.style.height,Z=n.style.background;Z||(n.style.background="white"),n.requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen();var i=setInterval(function(){if(n!==(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement))clearInterval(i),n.style.left=B,n.style.top=G,n.style.width=u,n.style.height=j,n.style.background=Z,k.iv();else{var K=C.Default.getWindowInfo();(F||K.width!==k.getWidth()||K.height!==k.getHeight())&&(qi(k),F=!1)}},500)}}},appendTimeStamp:function(i){return i},setCompType:function(S,k){od(k)||wb(k)?zp[S]=k:Wf(S)},getCompType:function(W){var Q=zp[W];return Q===V&&Ln.test(W)&&Wf(W),Q},getCompTypeMap:function(){return zp},drawCompType:function(H,x,B,w,u,C){H(x,B,w,u,C)},numberListener:function(){var D={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(U){var G=U.keyCode;D[G]||65===G&&I.isCtrlDown(U)||86===G&&I.isCtrlDown(U)||67===G&&I.isCtrlDown(U)||88===G&&I.isCtrlDown(U)||G>=35&&40>=G||(U.shiftKey||48>G||G>57)&&(96>G||G>105)&&U.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(G){var R=G.target.tagName;("DIV"===R||"CANVAS"===R)&&!(I.ignoreKeyCodes.indexOf(G.keyCode)>=0)&&("keydown"!==G.type||_o(G)||_b(G)||yc(G)||Vc(G)||Fm(G)||65===G.keyCode&&(G.metaKey||G.ctrlKey))&&(G.preventDefault(),G.preventManipulation&&G.preventManipulation())},getWindowInfo:function(){var m=b.documentElement,M=m&&(m.scrollLeft||m.scrollTop)?m:b.body;return{target:M,left:M.scrollLeft,top:M.scrollTop,width:B.innerWidth||M.clientWidth,height:B.innerHeight||M.clientHeight}},isDragging:function(){return!!Pg},isLeftButton:function($){return uh?!0:0===$.button},isInput:function(G){if(!G)return!1;var r=G.tagName;return"INPUT"===r||"TEXTAREA"===r||"SELECT"===r},getTouchCount:function(u){return uh?u.touches.length:1},isDoubleClick:function(){function s(Q){Q.details=0,Q.timeout=null,Q.lastPoint=null}var g={};return Vb=new J,jh=Vb.getTime(),function(w){if(w.touches&&w.touches.length>1)return!1;var i=w.button==k?"":w.button,e=w.type+i,q=e+"_isDoubleClick",A=g[e];if(A||(A=g[e]={details:0,timeout:null,lastPoint:null}),w[q]===V){w[q]=!0;var B=ms(w);A.timeout&&(T(A.timeout),A.timeout=null),A.lastPoint&&wh(A.lastPoint,B)>I.doubleClickRange&&s(A),A.lastPoint=B,A.details++,A.timeout=N(function(){s(this)}.bind(A),500)}return 2===A.details}}(),isShiftDown:function(k){return k?k.shiftKey:Gh["16"]},isCtrlDown:function(M){return M?vk?M.metaKey:M.ctrlKey:vk?Gh["91"]:Gh["17"]},getClientPoint:function(V){return uh&&(V=Wk(V)),{x:V.clientX,y:V.clientY}},isMouseEvent:function(T){return T instanceof MouseEvent||0===T.type.indexOf("mouse")},getTargetElement:function(g){if(I.isMouseEvent(g)||!b.elementFromPoint)return g.target;var Y=Ji(g);return b.elementFromPoint(Y.x,Y.y)},getPagePoint:function(F){return uh&&(F=Wk(F)),{x:F.pageX,y:F.pageY}},createObject:function(c,$){var K=new c;for(var B in $){var Z=$[B];if(od(Z))K[B]=Z;else if(0===B.indexOf("s:"))K.s(B.substr(2),$[B]);else if(0===B.indexOf("a:"))K.a(B.substr(2),$[B]);else{var d=di(B),Z=$[B];K[d]?(K[d](Z),"setToolTip"===d&&K.enableToolTip&&K.enableToolTip()):K[B]=Z}}return K},setImage:function(A,i,B,b){var H=arguments.length;4===H?om(A,b,i,B):2===H?Uc(i)?om(A,i):cl[A]=i:1===H&&om(A,A)},getImage:function(r,K,S){var x;if(r==k)return k;if(wb(r)?x=r:(x=cl[r],r&&x===V&&(sk&&sk[r]||om(r,r))),K&&x&&x.tagName){var Z;Z="override"===S?"colors_override":"override_rgb"===S?"colors_override_rgb":"override_a"===S?"colors_override_a":"colors",x[Z]||(x[Z]={__count__:0});var o=x[Z][K];return o||(x[Z].__count__>I.imageCacheThreshold&&(x[Z]={__count__:0}),o=ur(x,rd(K),x.width,x.height,S),x[Z][K]=o,x[Z].__count__++),o}return x},isImageComplete:function(h,A,B){var $=wb(h)?h:cl[h];if(!$)return!1;if($.tagName)return $.complete;for(var z,h,H,r=$.comps,c=!0,w=0,K=r.length;K>w;w++)if(z=r[w],H=z.type,"image"===z.type){h=z.name,h&&h.func&&(h=Sq(h,A));var q=kg(h,A,B);if(!q){c=!1;break}}else if(Ln.test(H)&&I.getCompType(H)===V){c=!1;break}return c},getId:function(){var o=1;return function(){return++o}}(),callLater:function(P,D,u,T){var Q=function(){P.apply(D,u)};return T?N(Q,T):B.requestAnimationFrame(Q)},clone:function(m){if(null==m||"object"!=typeof m)return m;if(m instanceof Date){var V=new Date;return V.setTime(m.getTime()),V}if(m instanceof Array){for(var V=[],w=0,O=m.length;O>w;w++)V[w]=pb(m[w]);return V}if(m instanceof pq){for(var V=new pq,w=0,O=m.length;O>w;w++)V.set(w,pb(m.get(w)));return V}if(m instanceof Sk)return m;if(m instanceof c){var V={};for(var F in m)m.hasOwnProperty(F)&&(V[F]=pb(m[F]));return V}return m},callWhenLoaded:function(P,H){H=H||100;var v=si(P,H);Io||(Io={}),Io[v]={tick:v,cb:P,delay:H}},beforeLoadURL:function(K){if(Io){var k={};for(var N in Io){var E=Io[N];T(E.tick);var i=si(E.cb,E.delay);k[i]={tick:i,delay:E.delay,cb:E.cb}}Io=k}return I.convertURL?I.convertURL(K):K},convertURL:function(Q){return Q},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return I.getImage("default_blank")},sortFunc:function(m,h){if(m===h)return 0;if(m==k&&h!=k)return 1;if(m!=k&&h==k)return-1;if(m==k&&h==k)return 0;var S,H=typeof m,F=typeof h;return H===fh&&F===fh?S=m.localeCompare(h):H===he&&F===he&&(S=m-h),S===V&&(S=(""+m).localeCompare(""+h)),S>0?1:0>S?-1:0},getClassMap:function(){return dm},getClass:function(b){if(Uc(b)){var L,k=dm[b];if(!k){L=b.split("."),k=B;for(var x=0;x<L.length;x++)k=k[L[x]];dm[b]=k}return k}return b},def:function(z,i,b){var Y,B,p,u=function(){};if(u.prototype=i.prototype,Y=new u,Uc(z)){if(dm[z])throw"'"+z+"' already defined";p=sg(z),Y.getClassName=function(){return z}}else p=z;if(Y.constructor=p,Y.getClass=function(){return p},Y.getSuperClass=function(){return i},b)for(B in b)bi[B]&&bi.hasOwnProperty(B)?bi[B](Y,b):Qo(Y,b,B);p.prototype=Y,p.superClass=i.prototype},startAnim:function(){var N=function(h){h.duration&&(h.startTime=sp()),h.timeId=Cm(h.tick,k,k,h.interval)};return function(Z){return Z=pb(Z),Z.easing=Z.easing||I.animEasing,Z.duration||Z.frames||(Z.duration=I.animDuration),Z.t=0,Z.duration?Z.interval=0:(Z.frame=0,Z.interval=Z.interval||10),Z.tick=function(){if(Z.duration){var C=(sp()-Z.startTime)/Z.duration;C>1&&(C=1),Z.t=C,Z.action(Z.easing(C),C),1===C?Z.stop():Z._isPaused||(Z.timeId=Cm(Z.tick))}else Z.frame++,C=Z.t=Z.frame/Z.frames,Z.action(Z.easing(C),C),Z.frame<Z.frames?Z._isPaused||(Z.timeId=Cm(Z.tick,k,k,Z.interval)):Z.stop()},Z.resume=function(){Z._isPaused&&(delete Z._isPaused,Z.duration?Z.t<1&&(Z.startTime=sp()-Z.duration*Z.t,Z.timeId=Cm(Z.tick)):Z.frame<Z.frames&&(Z.timeId=Cm(Z.tick,k,k,Z.interval)))},Z.pause=function(){Z._isPaused=!0},Z.isPaused=function(){return this._isPaused},Z.stop=function(R){Z.isRunning()&&(Z.duration?Z.t<1&&R&&(Z.t=1,Z.action(Z.easing(1),1)):Z.frame<Z.frames&&R&&(Z.frame=Z.frames,Z.action(Z.easing(1),1)),Z._37o&&Z._37o(),Z.finishFunc&&Z.finishFunc(),be(Z.timeId,!Z.duration),delete Z.timeId)},Z.isRunning=function(){return Z.timeId!=k},Z.delay?Cm(N,k,[Z],Z.delay):N(Z),Z}}(),getTextSize:function(){var M={},D=b?os().getContext("2d"):k;return function(N,y){D.font=N?N:sd;var Y=M[D.font];return Y||(Y=2*D.measureText("e").width+4,M[D.font]=Y),{width:D.measureText(y).width+4,height:Y}}}(),drawText:function(A,T,N,X,g,m,B,Q,p,S){if(T!=k){var b=Qk(N,T),v={};v.y=S&&S!==vo?S===Bp?m+b.height/2:m+Q-b.height/2:m+Q/2,v.x=p&&p!==fq?p===nb?g+B-b.width/2:g+B/2:g+b.width/2,ah(A,T,v,N,X)}},getDistance:function(N,J){var f=N.length;return J?3===f?i(t(N[0]-J[0])+t(N[1]-J[1])+t(N[2]-J[2])):2===f?i(t(N[0]-J[0])+t(N[1]-J[1])):N.z===V?i(t(J.x-N.x)+t(J.y-N.y)):i(t(J.x-N.x)+t(J.y-N.y)+t(J.z-N.z)):3===f?i(t(N[0])+t(N[1])+t(N[2])):2===f?i(t(N[0])+t(N[1])):void 0},brighter:function(i,k){return 0>k&&(k=-k),Br(i,k?k:40)},darker:function(N,l){return l>0&&(l=-l),Br(N,l?l:-40)},unionPoint:function(L,U){if(!L)return k;if(2===arguments.length)return L&&U?{x:$(L.x,U.x),y:$(L.y,U.y),width:F(L.x-U.x),height:F(L.y-U.y)}:k;var z=L;if(z._as&&(z=z._as),z.length===V)return k;var M=z.length;if(0>=M)return k;for(var Y=1,E=z[0],W={x:E.x,y:E.y,width:0,height:0};M>Y;Y++){E=z[Y];var q=$(W.x,E.x),X=j(W.x+W.width,E.x),y=$(W.y,E.y),u=j(W.y+W.height,E.y);W.x=q,W.y=y,W.width=X-q,W.height=u-y}return W},unionRect:function(F,M){if(F&&!M)return pb(F);if(!F&&M)return pb(M);if(F&&M){var D={x:$(F.x,M.x),y:$(F.y,M.y)};return D.width=j(F.x+F.width,M.x+M.width)-D.x,D.height=j(F.y+F.height,M.y+M.height)-D.y,D}return k},containsPoint:function(z,o,x,T){if(T!=k&&1!==T){var J=z.x+z.width/2,a=z.y+z.height/2;z={x:J-z.width/2*T,y:a-z.height/2*T,width:z.width*T,height:z.height*T}}if(x){var n=z.width/2,f=z.height/2,$=e(-x),W=P(-x),v=o.x-z.x-n,E=o.y-z.y-f;return o={x:W*v-$*E,y:$*v+W*E},Wi({x:-n,y:-f,width:z.width,height:z.height},o)}return!(!z||o.x<z.x||o.y<z.y||o.x>z.x+z.width||o.y>z.y+z.height)},containsRect:function(O,N){if(!O||!N)return!1;var G=N.x,l=N.y,P=N.width,S=N.height,K=O.width,Z=O.height;if(0>(K|Z|P|S))return!1;var u=O.x,n=O.y;if(u>G||n>l)return!1;if(K+=u,P+=G,G>=P){if(K>=u||P>K)return!1}else if(K>=u&&P>K)return!1;if(Z+=n,S+=l,l>=S){if(Z>=n||S>Z)return!1}else if(Z>=n&&S>Z)return!1;return!0},intersectsRect:function(t,z){if(!t||!z)return!1;var X=z.width,Y=z.height,N=t.width,S=t.height;if(0>=N||0>=S||0>=X||0>=Y)return!1;var $=z.x,o=z.y,B=t.x,G=t.y;return N+=B,S+=G,X+=$,Y+=o,N>$&&S>o&&X>B&&Y>G},intersection:function(N,t){if(!N||!t)return k;var s=t.x,P=t.y,$=N.x,w=N.y,D=s,u=P,z=$,v=w;return D+=t.width,u+=t.height,z+=N.width,v+=N.height,$>s&&(s=$),w>P&&(P=w),D>z&&(D=z),u>v&&(u=v),D-=s,u-=P,0>=D||0>=u?k:{x:s,y:P,width:D,height:u}},grow:function(E,z,C){C===V&&(C=z),E.x-=z,E.y-=C,E.width=E.width+2*z,E.height=E.height+2*C},getScreenPoint:function(v,l,R,X,B,V,J){var I,D,O=R.getBoundingClientRect(),K=v*(V||1)+O.left-R.scrollLeft+(X||0),S=l*(J||1)+O.top-R.scrollTop+(B||0),p={x:K,y:S};return(I=R.parentElement)&&(D=I.maxtrixAppend)?D.applyInverse(p,{}):p},getLogicalPoint:function(T,d,r,L,O,K){var h,j,n=d.getBoundingClientRect();T.target?(pr(T)?vk?Gh["91"]=!0:Gh["17"]=!0:vk?Gh["91"]=!1:Gh["17"]=!1,Gh["16"]=ub(T)?!0:!1,T=uh?Wk(T):T,h=T.clientX,j=T.clientY):(h=T.x,j=T.y);var v,Z;if((v=d.parentElement)&&(Z=v.maxtrixAppend)){var S=Z.apply({x:h,y:j},{});return S.x=(S.x+d.scrollLeft-(r||0))/(O||1),S.y=(S.y+d.scrollTop-(L||0))/(K||1),S}return{x:(h-n.left+d.scrollLeft-(r||0))/(O||1),y:(j-n.top+d.scrollTop-(L||0))/(K||1)}},removeHTML:function(){var V;return function(L){return L&&L.getView&&(L=L.getView()),L&&L.parentNode?V===L?!0:(V=L,L.parentNode.removeChild(L),V=k,!0):!1}}(),getToolTipDiv:function(){if(!jk){jk=Xf(),dq=Xf();var c=jk.style;I.baseZIndex!=k&&(c.zIndex=d(I.baseZIndex)+3+""),c.whiteSpace="nowrap",c.color=I.toolTipLabelColor,c.background=I.toolTipBackground,c.font=I.toolTipLabelFont,c.padding="5px",c.boxShadow="0px 0px 3px "+I.toolTipShadowColor
}return jk},isToolTipShowing:function(){return jk&&jk.parentNode?!0:dq&&dq.parentNode?!0:!1},hideToolTip:function(){Zj(jk),Zj(dq),jq()},showToolTip:function(X,V){if(!X||V==k)return xm(),void 0;I.getToolTipDiv();var B,b;if(V.html?(V=V.html,B=dq,Zj(jk)):(B=jk,Zj(dq)),b=B.style,B.innerHTML=V,B.parentNode||C.Default.appendToScreen(B),X.target){X=Ji(X);var O=Zd(),e=X.x,u=X.y,f=uh?60:12;if(uh){var U=B.getBoundingClientRect();b.left=e-U.width/2+cp,b.top=u-U.height-f<O.top?u+f+cp:u-U.height-f+cp}else{b.left=e+f+cp,b.top=u+f+cp;var U=B.getBoundingClientRect();U.left+U.width>O.width&&(b.left=e-f-U.width+cp),U.top+U.height>O.height&&(b.top=u-f-U.height+cp),U.left<0&&(b.left=e+f+cp),U.top<0&&(b.top=u+f+cp)}}else b.left=X.x+cp,b.top=X.y+cp;jq()},startDragging:function(F,M,r){r==V&&(r=!0),F!==Pg&&(Pg?r&&(uh?Pg.handleWindowTouchEnd(M):Pg.handleWindowMouseUp(M)):uh?(B.addEventListener(wq,vq,m),B.addEventListener($k,wo,m)):(B.addEventListener(wr,Jg,m),B.addEventListener(cs,Uo,m)),Pg=F)},getImageMap:function(){return cl},toBoundaries:function(Q,g,R,u){var w=[];return vb(Q,g,R,u).forEach(function(Z){var U=[];Z.forEach(function(q){U.push(q.x,q.y)}),w.push(U)}),w},getCurrentKeyCodeMap:function(){return Gh},drawCenterImage:function(j,V,v,E,d,c,P,I){var l=Or(V,d,c),B=fb(V,d,c);Gb(j,V,L(v-l/2),L(E-B/2),l,B,d,c,P,I)},drawStretchImage:function(i,B,p,Y,w,x,N,V,v,E,u,F){var k,a=Or(B,V,v,x),A=fb(B,V,v,N);"uniform"===p?(k=$(x/a,N/A),a*=k,A*=k,Y+=L((x-a)/2),w+=L((N-A)/2),x=a,N=A):"centerUniform"===p&&((a>x||A>N)&&(k=$(x/a,N/A),a*=k,A*=k),Y+=L((x-a)/2),w+=L((N-A)/2),x=a,N=A);var n=i.interactiveInfo;if(n){var h;if(h="center"===p?{x:Y+x/2-a/2,y:w+N/2-A/2,width:a,height:A}:{x:Y,y:w,width:x,height:N},n.rect){var m=n.compInfos,j=m.length;j&&(m[j-1].rect.image=B)}else n.rect=h}if("center"===p){var Z=u!==!1&&(a>x||A>N);Z&&(i.save(),i.beginPath(),i.rect(Y,w,x,N),i.clip()),Gb(i,B,Y+x/2-a/2,w+N/2-A/2,a,A,V,v,E,F),Z&&i.restore()}else Gb(i,B,Y,w,x,N,V,v,E,F)},toCanvas:function(N,j,G,_,D,e,z,w,t){N=Ne(N,z),j=j||Or(N,D),G=G||fb(N,D);var i=os(),P=Rq(i);return w?(Oi(i,j,G,w),P.scale(w,w)):Oi(i,j,G,1),fo(P,N,_,0,0,j,G,D,e,z,t),N&&N.clampToEdge&&(i.clampToEdge=N.clampToEdge),P.restore(),i},toGrayColor:function(l){if(!l)return l;var d=Ze(l),G=.299*d[0]+.587*d[1]+.114*d[2];return"rgba("+G+","+G+","+G+","+d[3]/255+")"},createGradientImage:function(r,j,B,E){for(var N=["L",0,0,r,0,1,0,0,1,0,0],l=0,d=Math.min(j.length,B.length);d>l;l++)N.push(B[l],j[l]);var L=C.Default.toCanvas({width:r,height:r,clampToEdge:!0,comps:[{type:"shape",rotation:E||0,points:[0,0,r,0,r,r,0,r],background:"#ffffff",gradientPack:N}]});return L},createElement:function(q,m,f,T){var z=b.createElement(q);return gk(z,m||X.widgetBorder,2),z.style.font=f?f:sd,T!=k&&(z.value=T),I.onElementCreated&&I.onElementCreated(z),z},containedInView:function(b,j){var C=Dk(j).getBoundingClientRect();return Wi({x:C.left,y:C.top,width:C.width,height:C.height},ms(b))},isIsolating:function(){return xp>0},setIsolating:function(B){B?xp++:xp--},getMSMap:function(){return bi},stringify:function(c,z){var u=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var G=JSON.stringify(c,function(k,a){return"function"==typeof a?"__ht__"+(a.__ht__||a.toString()):tg(a)?Jh(a):a instanceof C.List?"__ht__list"+(a.__ht__list||I.stringify(a._as)):a},z==k?2:z);return Date.prototype.toJSON=u,G},parse:function(U){return Uc(U)?JSON.parse(U,function(p,B){if(Uc(B))if("__ht__function"==B.substr(0,14)){var Z=B.indexOf("{")+1,o=B.lastIndexOf("}"),x=B.indexOf("(")+1,K=B.indexOf(")");if(Z&&o&&x&&K){var G=new Function(B.substring(x,K),B.substring(Z,o));return G.__ht__=B.substr(6),G}}else{if("__ht__date"==B.substr(0,10))return new Date(d(B.substr(10)));if("__ht__list"===B.substr(0,10))return new pq(I.parse(B.substr(10)))}return B}):U},loadJS:function(w,P){P&&w.push(P);var i=w.shift();if(sn(i))w=i.contact(w),I.loadJS(w);else if(od(i))i(),I.loadJS(w);else if(Uc(i)){var t=b.createElement("script");t.onload=function(){I.loadJS(w)},t.setAttribute("src",i),b.getElementsByTagName("head")[0].appendChild(t)}else w.length&&I.loadJS(w)},toRoundedCorner:function(k,H){var Q=k.size();if(0>=H)return{points:k};var v,h=new pq,c=new pq,y=k.get(0);h.add(y),c.add(1);for(var J=1;Q>J;J++)if(Q>J+1){var R=k.get(J),I=k.get(J+1),G=y.x,l=y.y,j=R.x,u=R.y,C=u-l,r=j-G,w=q(C,r);v=$(.99*wh(y,R),H),h.add({x:j-v*P(w),y:u-v*e(w)}),h.add(R),G=R.x,l=R.y,j=I.x,u=I.y,C=u-l,r=j-G,w=q(C,r),v=$(.99*wh(R,I),H),y={x:G+v*P(w),y:l+v*e(w)},h.add(y),c.addAll([2,3])}else h.add(k.get(J)),c.add(2);return{points:h,segments:c}},toColorData:Ze,setCanvas:Oi,createDiv:Xf,createDisabledDiv:Wo,createView:Hb,createCanvas:os,appendChild:Ll,initContext:Rq,checkLoadingImage:Ci,translateAndScale:Ko,layout:qi,getPosition:uk,drawPoints:pk,drawRoundRect:_f,drawBorder:so,setFocus:jj,getter:sl,setter:di,isEmptyObject:cq},!0),fs(w,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var xg=I.disabledOpacity,ss=I.toolTipDelay,Wg=I.devicePixelRatio,km=I.autoMakeVisible,mm=I.autoHideScrollBar,Nd=I.imageGradient,Cb=I.showToolTip,xm=I.hideToolTip,af=I.dashPattern,Ad=I.lineCap,Eb=I.lineJoin,zn=I.labelColor,ls=I.labelSelectColor,sd=I.labelFont,Rj=I.widgetIndent,ys=I.widgetRowHeight,Nq=I.widgetHeaderHeight,Ho=I.widgetTitleHeight,gg=I.scrollBarColor,lb=I.scrollBarSize,Gk=I.scrollBarTimeout,Pb=I.scrollBarMinLength,oo=I.scrollBarInteractiveSize,ni=I.zoomIncrement,eg=I.scrollZoomIncrement,Ac=I.pinchZoomIncrement,Jk=I.zoomMax,kn=I.zoomMin,kq=I.createObject,_d=I.preventDefault,yg=I.setImage,Ne=I.getImage,kg=I.isImageComplete,Cd=I.drawCenterImage,fo=I.drawStretchImage,No=I.getId,Cm=I.callLater,hb=I.sortFunc,pb=I.clone,sg=I.getClass,Yl=I.startAnim,Bm=I.brighter,_g=I.darker,qg=I.drawText,Qk=I.getTextSize,Bn=I.isLeftButton,Nc=I.getTouchCount,sj=I.isDoubleClick,ub=I.isShiftDown,pr=I.isCtrlDown,ms=I.getClientPoint,Ji=I.getPagePoint,wh=I.getDistance,Fd=I.unionPoint,je=I.unionRect,Wi=I.containsPoint,Ii=I.containsRect,Fi=I.intersectsRect,_h=I.intersection,Zd=I.getWindowInfo,Oq=I.grow,Iq=I.getLogicalPoint,Xq=I.getScreenPoint,rk=I.startDragging,Zj=I.removeHTML,eo=I.createElement,yo=I.segmentResolution,ak=I.shapeResolution,$f=I.shapeSide,Zi=I.def,zo=function(A,f,e){Zi(v+"."+A,f,e)},Mo=function(P,N){P.childNodes.forEach(function(X){N(X),Mo(X,N)})};fs(I,{toolTipLabelColor:zn,toolTipLabelFont:sd,toolTipBackground:X.toolTipBackground,toolTipShadowColor:qr,drawBreakableText:ir,setDevicePixelRatio:function(r){Wg=I.devicePixelRatio="number"==typeof r?r:B.devicePixelRatio,Mo(b.body,function(W){var h=W._ht;h&&h._canvas&&(Oi(h._canvas,h.getWidth(),h.getHeight()),h.redraw?h.redraw():h.iv())})}},!0);var Ri=1e-6,Df="undefined"!=typeof Uint16Array?Uint16Array:Array,vn="undefined"!=typeof Float32Array?Float32Array:Array,rr=function(f,q,Q){var L=[f[0]-q[0],f[1]-q[1],f[2]-q[2]];if(Q){var t=wh(L);t>0&&(L[0]/=t,L[1]/=t,L[2]/=t)}return L},tr=function(){var W="charCodeAt",Z=2*(2*Tb.length+1);for(var H in B)if(H===v+fq[0]+cp.length){var c=B[H];if(!c)break;for(var F=c.length,w=0;F>w;w++)if(c[w][W](0)===Z&&c[w+1]!=k&&c[w+1]===cp[0]&&c[w+2]!=k&&c[w+2][W](0)===Z){for(var X=w+3;F>X;X++)if(c[X][W](0)===Z){if(0==c[X+1])for(var g,r=X+2;F>r;r++){if(c[r][W](0)===Z){0==c[r-1]&&g&&(h=g.substr(0,g.length-1));break}g==k?g=c[r]:g+=c[r]}break}break}break}return function(Z){return[-Z[0],-Z[1],-Z[2]]}}(),Lj=function(k,G){return 3===k.length?k[0]*G[0]+k[1]*G[1]+k[2]*G[2]:k[0]*G[0]+k[1]*G[1]},cn=function(){var Z=new vn(16);return Z[0]=1,Z[1]=0,Z[2]=0,Z[3]=0,Z[4]=0,Z[5]=1,Z[6]=0,Z[7]=0,Z[8]=0,Z[9]=0,Z[10]=1,Z[11]=0,Z[12]=0,Z[13]=0,Z[14]=0,Z[15]=1,Z},Yi=cn(),Te=function(J){var U=new vn(16);return U[0]=J[0],U[1]=J[1],U[2]=J[2],U[3]=J[3],U[4]=J[4],U[5]=J[5],U[6]=J[6],U[7]=J[7],U[8]=J[8],U[9]=J[9],U[10]=J[10],U[11]=J[11],U[12]=J[12],U[13]=J[13],U[14]=J[14],U[15]=J[15],U},Ld=function(h,C){return h[0]=C[0],h[1]=C[1],h[2]=C[2],h[3]=C[3],h[4]=C[4],h[5]=C[5],h[6]=C[6],h[7]=C[7],h[8]=C[8],h[9]=C[9],h[10]=C[10],h[11]=C[11],h[12]=C[12],h[13]=C[13],h[14]=C[14],h[15]=C[15],h},Km=function(I){return I[0]=1,I[1]=0,I[2]=0,I[3]=0,I[4]=0,I[5]=1,I[6]=0,I[7]=0,I[8]=0,I[9]=0,I[10]=1,I[11]=0,I[12]=0,I[13]=0,I[14]=0,I[15]=1,I},nc=function(j,z){var k=j[0],s=j[1],c=j[2];return j[0]=z[0]*k+z[4]*s+z[8]*c+z[12],j[1]=z[1]*k+z[5]*s+z[9]*c+z[13],j[2]=z[2]*k+z[6]*s+z[10]*c+z[14],j},dr=function(g,z){var B=g[0],J=g[1],N=g[2],n=g[3];return g[0]=z[0]*B+z[4]*J+z[8]*N+z[12]*n,g[1]=z[1]*B+z[5]*J+z[9]*N+z[13]*n,g[2]=z[2]*B+z[6]*J+z[10]*N+z[14]*n,g[3]=z[3]*B+z[7]*J+z[11]*N+z[15]*n,g},ed=function(){var h,k,n,K,b=rp(Kd[1]+Kd[7]),L=rp(Kd[0]+Kd[3]-Kd[10]),m=rp(Kd[8]+2),x=function(){return k=n.charAt(h),h+=1,k},J=function(){var L="";if(k===m)for(;x();){if(k===m)return x(),L;L+=k}else x()},l=function(){for(;k&&" ">=k;)x()},o=function(){var T,H={};if(k===b){if(x(),l(),k===L)return x(),H;for(;k;){if(T=J(),l(),x(),H[T]=K(),l(),k===L)return x(),H;x(),l()}}};return K=function(){switch(l(),k){case b:return o();default:return J()}},function(L){if(S={},L){var C;if(n=L,h=0,k=" ",C=K(),l(),!k)return C}}}(),Hr=function(X,H){if(H){var Y=e(H),F=P(H),h=X[4],V=X[5],U=X[6],m=X[7],i=X[8],a=X[9],Q=X[10],A=X[11];X[4]=h*F+i*Y,X[5]=V*F+a*Y,X[6]=U*F+Q*Y,X[7]=m*F+A*Y,X[8]=i*F-h*Y,X[9]=a*F-V*Y,X[10]=Q*F-U*Y,X[11]=A*F-m*Y}},pp=function(a,W){if(W){var X=e(W),o=P(W),q=a[0],c=a[1],V=a[2],F=a[3],y=a[8],d=a[9],p=a[10],A=a[11];a[0]=q*o-y*X,a[1]=c*o-d*X,a[2]=V*o-p*X,a[3]=F*o-A*X,a[8]=q*X+y*o,a[9]=c*X+d*o,a[10]=V*X+p*o,a[11]=F*X+A*o}},bq=function(T,l){if(l){var j=e(l),K=P(l),i=T[0],$=T[1],N=T[2],M=T[3],d=T[4],X=T[5],U=T[6],L=T[7];T[0]=i*K+d*j,T[1]=$*K+X*j,T[2]=N*K+U*j,T[3]=M*K+L*j,T[4]=d*K-i*j,T[5]=X*K-$*j,T[6]=U*K-N*j,T[7]=L*K-M*j}},_k=function(o,J,N){return fl(k,N===!1?k:o.getFinalScale3d(),o.getFinalRotation3d(),o.getRotationMode(),o.p3(),k,J)},fl=function(Z,z,P,d,y,l,H){return l||(l=cn()),y&&xl(l,y),wi(l,P,d),H&&bg(l,l,H),z&&ch(l,z),Z&&bg(l,l,Z),l},Fr=function(t,Z,k){Z=d(Z),k=d(k);var w=this;w.g=t,w._84O=Z,w._85O=k,w._70I=!0,w.F=0,w._83O=Z+k,w.pen={x:0,y:0}},Od="lineDashOffset",Lh="setLineDash",Se=function(g){for(var y in g)1===y.length&&(Od=g[y]);return y?1:0},ve=function(K,c,X){return Jp(c)?K:K[Lh]?(K[Lh](c),X&&(K.lineDashOffset=X),K):new Fr(K,c[0],c.length>1?c[1]:c[0])},Bb=function(W,Q){!Jp(Q)&&W[Lh]&&(W[Lh](or),W.lineDashOffset=0)};if(Zi(Fr,c,{_69I:6,moveTo:function(B,W){var u=this,O=u.pen;O.x=B,O.y=W,u.g.moveTo(B,W),u.start||(u.start={x:B,y:W})},lineTo:function(W,g){var _=this,p=_.pen,I=W-p.x,d=g-p.y,x=q(d,I),M=P(x),y=e(x),G=_._23O(p.x,p.y,W,g),T=_._85O,o=_._84O,Q=_._83O;if(_.F){if(_.F>G)return _._70I?_._72I(W,g):_.moveTo(W,g),_.F-=G,void 0;if(_._70I?_._72I(p.x+M*_.F,p.y+y*_.F):_.moveTo(p.x+M*_.F,p.y+y*_.F),G-=_.F,_.F=0,_._70I=!_._70I,!G)return}var i=E(G/Q);if(i){for(var A=M*o,V=y*o,t=M*T,D=y*T,c=0;i>c;c++)_._70I?(_._72I(p.x+A,p.y+V),_.moveTo(p.x+t,p.y+D)):(_.moveTo(p.x+t,p.y+D),_._72I(p.x+A,p.y+V));G-=Q*i}_._70I?G>o?(_._72I(p.x+M*o,p.y+y*o),_.moveTo(W,g),_.F=T-(G-o),_._70I=!1):(_._72I(W,g),G===o?(_.F=0,_._70I=!_._70I):(_.F=o-G,_.moveTo(W,g))):G>T?(_.moveTo(p.x+M*T,p.y+y*T),_._72I(W,g),_.F=o-(G-T),_._70I=!0):(_.moveTo(W,g),G===T?(_.F=0,_._70I=!_._70I):_.F=T-G)},quadraticCurveTo:function(H,j,x,$){var Q,w=this,r=w.pen,e=r.x,R=r.y,A=w._22O(e,R,H,j,x,$),G=0,N=0,P=w._85O,K=w._84O;if(w.F){if(w.F>A)return w._70I?w._71I(H,j,x,$):w.moveTo(x,$),w.F-=A,void 0;if(G=w.F/A,Q=w._20O(e,R,H,j,x,$,G),w._70I?w._71I(Q[2],Q[3],Q[4],Q[5]):w.moveTo(Q[4],Q[5]),w.F=0,w._70I=!w._70I,!A)return}var M=A-A*G,t=E(M/w._83O),b=K/A,V=P/A;if(t)for(var y=0;t>y;y++)w._70I?(N=G+b,Q=w._21O(e,R,H,j,x,$,G,N),w._71I(Q[2],Q[3],Q[4],Q[5]),G=N,N=G+V,Q=w._21O(e,R,H,j,x,$,G,N),w.moveTo(Q[4],Q[5])):(N=G+V,Q=w._21O(e,R,H,j,x,$,G,N),w.moveTo(Q[4],Q[5]),G=N,N=G+b,Q=w._21O(e,R,H,j,x,$,G,N),w._71I(Q[2],Q[3],Q[4],Q[5])),G=N;M=A-A*G,w._70I?M>K?(N=G+b,Q=w._21O(e,R,H,j,x,$,G,N),w._71I(Q[2],Q[3],Q[4],Q[5]),w.moveTo(x,$),w.F=P-(M-K),w._70I=!1):(Q=w._19O(e,R,H,j,x,$,G),w._71I(Q[2],Q[3],Q[4],Q[5]),A===K?(w.F=0,w._70I=!w._70I):(w.F=K-M,w.moveTo(x,$))):M>P?(N=G+V,Q=w._21O(e,R,H,j,x,$,G,N),w.moveTo(Q[4],Q[5]),Q=w._19O(e,R,H,j,x,$,N),w._71I(Q[2],Q[3],Q[4],Q[5]),w.F=K-(M-P),w._70I=!0):(w.moveTo(x,$),M===P?(w.F=0,w._70I=!w._70I):w.F=P-M)},bezierCurveTo:function(){var s=arguments;this.pen={x:s[4],y:s[5]},this.g.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])},arc:function(u,n,y,F,D,Z){Z||(F=-F,D=-D),Nm(this,u,n,F,D-F,y,y,!1)},rect:function(d,Y,L,V){var $=this;$.pen={x:d,y:Y},$.moveTo(d,Y),$.lineTo(d,Y+V),$.lineTo(d+L,Y+V),$.lineTo(d+L,Y),$.lineTo(d,Y)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(u,G,R,e){var X=R-u,F=e-G;return i(X*X+F*F)},_22O:function(X,c,V,K,W,G,P){for(var m,l,C,O,h,i,y,v=0,u=X,f=c,q=P>0?P:this._69I,U=1;q>=U;U++)C=U/q,O=1-C,h=O*O,i=2*C*O,y=C*C,m=h*X+i*V+y*W,l=h*c+i*K+y*G,v+=this._23O(u,f,m,l),u=m,f=l;return v},_21O:function(i,u,l,k,h,z,H,S){var V=this;if(0===H)return V._20O(i,u,l,k,h,z,S);if(1===S)return V._19O(i,u,l,k,h,z,H);var j=V._20O(i,u,l,k,h,z,S);return j.push(H/S),V._19O.apply(V,j)},_20O:function(y,Q,q,i,t,W,r){if(1!==r){var $=q+(t-q)*r,w=i+(W-i)*r;q=y+(q-y)*r,i=Q+(i-Q)*r,t=q+($-q)*r,W=i+(w-i)*r}return[y,Q,q,i,t,W]},_19O:function(e,O,F,g,r,H,Q){if(1!==Q){var S=e+(F-e)*Q,V=O+(g-O)*Q;F+=(r-F)*Q,g+=(H-g)*Q,e=S+(F-S)*Q,O=V+(g-V)*Q}return[e,O,F,g,r,H]},_72I:function(N,n){var h=this.pen;(N!==h.x||n!==h.y)&&(h.x=N,h.y=n,this.g.lineTo(N,n))},_71I:function(Q,o,w,g){var t=this.pen;(Q!==w||o!==g||w!==t.x||g!==t.y)&&(t.x=w,t.y=g,this.g.quadraticCurveTo(Q,o,w,g))}}),a&&Q){var Ik=Q.toString();U=Ik.indexOf(Pq.substr(0,2))>0&&Ik.indexOf(Bp+Bp.substr(1,1))>1||Ik.indexOf(ne.substr(0,2)+Pq.substr(2,2)+fq[0]+Pq[4])>1?!0:!1}!0&&B.console&&(B.navigator&&B.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?B.console.log.apply(console,["Hightopo - Version："+C.Default.getVersion()+" - %c申请试用：http://hightopo.com/request.html","color: #f00;"]):B.console.log("Hightopo - Version："+C.Default.getVersion()+" - 申请试用：http://hightopo.com/request.html"));var Wr=k,nr=k,$g=function(q){Wr&&!q._72O&&(nr||(nr={}),nr[q._72O=No()]=q)},Wf=function(y,X){if(X||(X=y),X&&(Wr||(Wr={}),!Wr[y])){var B=new ib;if(Wr[X]={request:B,url:X},X=I.beforeLoadURL(X),X.data){var n=I.parse(X.data);Ki(y,n),I.handleCompTypeLoaded(y,n)}else{B.onload=function(o){if(200===this.status||0===this.status){var n=I.parse(o.target.response||o.target.responseText);Ki(y,n),I.handleCompTypeLoaded(y,n)}else Ki(y,k)},B.onerror=function(){Ki(y,k)};var x={};x.url=encodeURI(X),x.sync=!1,B.send(x)}}},Ki=function(X,N){if(zp[X]=N,delete Wr[X],cq(Wr)&&(Wr=k,nr)){for(var S in nr){var s=nr[S];s.invalidateAll&&s.invalidateAll(V,"compTypeLoaded",X),s.redraw&&s.redraw(),s.iv(),delete s._72O}nr=k}if(N&&nr)for(var S in nr){var s=nr[S];s.invalidateAll&&s.invalidateAll(V,"compTypeLoading",X),s.redraw&&s.redraw(),s.iv()}},Aj=X.chart,gh=I.compStack=[],hn=/^style@/,Mc=/^attr@/,cj=/^field@/,Bo={x:.5,y:.5},Or=function(z,b,B,u){if(!z)return 0;if(Sq(z.fitSize,b,B)&&u)return u;var A=Sq(z.width,b,B);return null==A?20:A},fb=function(Y,y,h,B){if(!Y)return 0;if(Sq(Y.fitSize,y,h)&&B)return B;var E=Sq(Y.height,y,h);return null==E?20:E},Sq=function(K,i,L){if(!K||!K.func)return K;var Q,$=K.func,b=K.value;return Q=od($)?L&&L.vectorDataBindingDisabled&&!K.isSafeFunc?b:$(i,L):i instanceof Sk?Mc.test($)?i.a($.slice(5)):hn.test($)?i.s($.slice(6)):cj.test($)?i[$.slice(6)]:i[$]?i[$](L):b:b,b!==V&&Q==k?b:Q},Gb=I.drawImage=function(){var p,g,N,C,J,n,R=function(Y,w){Y.getValue&&Y.getValue.compType===w||(Y.getValue=function(J){var K=f(Y,J);if(K===V&&w.properties){var T=w.properties[J];T&&(K=T.defaultValue)}return K},Y.getValue.compType=w)},f=function(r,O,Z){var z=r[O];return z&&z.func?(z=Sq(z,g,N),Z&&(z=Z(z))):Z&&(z=r[O]=Z(z)),z},D=function(W,D){var w;if(w=D?f(W,D):W,p&&p.compGray&&w)return I.toGrayColor(w);if(J&&w){if("override"===n)return J;if("override_rgb"===n){var M=rd(J);return w=Ze(w),"rgba("+E(255*M[0])+","+E(255*M[1])+","+E(255*M[2])+","+w[3]/255+")"}if("override_a"===n){var M=rd(J);return w=Ze(w),"rgba("+w[0]+","+w[1]+","+w[2]+","+M[3]+")"}var M=rd(J);return w=Ze(w),"rgba("+E(w[0]*M[0])+","+E(w[1]*M[1])+","+E(w[2]*M[2])+","+w[3]/255*M[3]+")"}return w},u=function(E){if(sn(E)){for(var D=new pq,P=E.length,F=0;P>F;F+=2)D.add({x:E[F],y:E[F+1]});E=D}return E},v=function(L){var M=f(L,"anchorX"),y=f(L,"anchorY");if(M!==V||y!==V)return{x:M===V?Bo.x:M,y:y===V?Bo.y:y};var K=f(L,"type"),G=f(L,"name");if("image"!==K||!G)return Bo;var O=Ne(G);return O&&O.anchorX!==V&&O.anchorY!==V?{x:O.anchorX,y:O.anchorY}:Bo},i=function(S,O){var Z=f(S,Xd),l=v(S);if(sn(Z)){var h=Z.length,W=f(S,"relative"),x=O.width,V=O.height;if(4===h)Z={x:Z[0],y:Z[1],width:Z[2],height:Z[3]},W&&(Z.x*=x,Z.y*=V,Z.width*=x,Z.height*=V);else if(3===h){var D=Z[0];Z={width:Z[1],height:Z[2]},W&&(Z.width*=x,Z.height*=V),"object"==typeof D?D.length&&(D={x:D[0],y:D[1]}):D=uk(D,O,Z),Z.x=D.x-Z.width*l.x,Z.y=D.y-Z.height*l.y}Z.x+=f(S,"offsetX")||0,Z.y+=f(S,"offsetY")||0,!W&&O.fitSize&&(Z=r(S,Z,O))}return Z},r=function(M,O,t){if(O){var j,B,a,T={x:O.x,y:O.y,width:O.width,height:O.height},z=v(M),r=f(M,"layoutH"),i=f(M,"layoutV"),y=1,V=1,Q=0,g=0,m=1,n=1;switch(r){case"left":break;case"right":T.x+=t.width-t.rw;break;case"center":T.x+=.5*(t.width-t.rw);break;case"scale":case"leftright":default:j=f(M,Qj)||0,j&&(Q=Math.abs(g=Math.sin(j)),m=Math.abs(n=Math.cos(j))),"leftright"!==r?(y+=m*(t.widthScale-1),V+=Q*(t.widthScale-1)):(y+=m*(t.width-t.rw)/T.width,V+=Q*(t.width-t.rw)/T.height,B=-Math.min(-z.x*n+z.y*g,-z.x*n-(1-z.y)*g,(1-z.x)*n+z.y*g,(1-z.x)*n-(1-z.y)*g))}switch(i){case"top":break;case"bottom":T.y+=t.height-t.rh;break;case"center":T.y+=.5*(t.height-t.rh);break;case"scale":case"topbottom":default:j==k&&(j=f(M,Qj),j&&(Q=Math.abs(g=Math.sin(j)),m=Math.abs(n=Math.cos(j)))),"topbottom"!==i?(y+=Q*(t.heightScale-1),V+=m*(t.heightScale-1)):(y+=Q*(t.height-t.rh)/T.width,V+=m*(t.height-t.rh)/T.height,a=-Math.min(-z.x*g-z.y*n,-z.x*g+(1-z.y)*n,(1-z.x)*g-z.y*n,(1-z.x)*g+(1-z.y)*n))}return(1!==y||1!==V)&&("scale"!==r&&r?"leftright"===r&&(T.x+=T.width*(1-y)*z.x+B*(t.width-t.rw)):T.x+=T.x*(t.widthScale-1)+z.x*T.width*(t.widthScale-y),"scale"!==i&&i?"topbottom"===i&&(T.y+=T.height*(1-V)*z.y+a*(t.height-t.rh)):T.y+=T.y*(t.heightScale-1)+z.y*T.height*(t.heightScale-V),T.width*=y,T.height*=V),T}},A=function(H){return sn(H)?new pq(H):H},G=function(M,N,L,o,x,S,m){var H=p.interactiveInfo,D=M.transform;if(D)return p.save(),p.setTransform(D.a,D.b,D.c,D.d,D.tx,D.ty),H&&H.compInfos.push({comp:M,rect:N,matrix:D.clone()}),!0;x===V&&(x=1),S===V&&(S=1);var A=f(M,"clipPercentage"),y=yk(L,N);if(y&&!o&&1===x&&1===S&&!(1>A))return H&&H.compInfos.push({comp:M,rect:N,matrix:H.matrix.clone()}),!1;m=m||Bo;var e=N.x+N.width*m.x,b=N.y+N.height*m.y,g=L.x+L.width*m.x,r=L.y+L.height*m.y,k=L.width?x*(N.width/L.width):1,F=L.height?S*(N.height/L.height):1;if(p.save(),H&&(H.matrix.appendTranslate(e,b).appendRotate(o).appendScale(k,F).appendTranslate(-g,-r),H.compInfos.push({comp:M,rect:N,matrix:H.matrix.clone()})),Ig(p,e,b),ef(p,o||0),go(p,k,F),Ig(p,-g,-r),1>A){0>A&&(A=0);var I=Qf(L,f(M,"clipDirection"),A);p.beginPath(),p.rect(I.x,I.y,I.width,I.height),p.clip()}return!0},K=function(){p.restore()},d=function(w,j,n){var S=f(w,"path"),q=f(w,Qj),Q=f(w,"scaleX"),I=f(w,"scaleY"),V=v(w),m=k,z=Xe(null,S);if(n||(n=w.unionRect,n||(n=Fd(z),w.path.func||(w.unionRect=n)),m=n),n){m||(m=w.unionRect,m||(m=Fd(z),w.path.func||(w.unionRect=m)));var O=G(w,n,m,q,Q,I,V),h=f(w,"borderPattern"),y=ve(p,h),g=D(w,"background"),b=D(w,"borderColor"),J=f(w,"borderWidth"),X=f(w,"gradient"),c=D(w,"gradientColor"),x=f(w,"border3d"),F=f(w,"border3dColor"),L=f(w,"border3dAccuracy"),s=p.lineJoin,W=p.lineCap;if(p.lineJoin=f(w,"borderJoin")||Eb,p.lineCap=f(w,"borderCap")||Ad,g?(nm(p,g,X,c,m),Xe(p,S),p.fill(),y!==p&&Xe(p,S)):Xe(p,S),J&&b){var t=f(w,"borderWidthAbsolute");t&&(p.save(),p.setTransform(1,0,0,1,0,0)),p.lineWidth=J,p.strokeStyle=b,p.stroke(),t&&p.restore(),x&&Cq(p,b,F,J,C,L)}if(Bb(p,h),f(w,"dash")){var Y=f(w,"dashWidth")||J;if(Y>0){h=f(w,"dashPattern")||af;var y=ve(p,h,f(w,"dashOffset")),E=D(w,"dashColor")||D(ph);y!==p&&Xe(p,S),p.strokeStyle=E,p.lineWidth=Y,p.stroke(),f(w,"dash3d")&&Cq(p,E,D(w,"dash3dColor"),Y,C,f(w,"dash3dAccuracy")),Bb(p,h)}}j===Xd&&Fc(p,g,f(w,"depth"),m),p.lineJoin=s,p.lineCap=W,O&&K()}},_=function(d,X,h,U){var x=f(d,Rh,u),F=f(d,Qj),P=v(d);if(x&&U.fitSize){var i=new pq,y=Fd(x),$=r(d,y,U),t=y.x+P.x*y.width,O=y.y+P.y*y.height,j=$.x+P.x*$.width,Y=$.y+P.y*$.height,l=$.width/y.width,s=$.height/y.height;x.each(function(P){i.add({x:j+(P.x-t)*l,y:Y+(P.y-O)*s})}),x=i,d.unionRect=null}var _=f(d,"scaleX"),c=f(d,"scaleY"),o=X===Dq,H=k;if(!h&&o&&(h=d.unionRect,h||(h=Fd(x),d.points.func||(d.unionRect=h)),H=h),h){o?H||(H=d.unionRect,H||(H=Fd(x),d.points.func||(d.unionRect=H))):H=h;var L,I,V,Z,e=G(d,h,H,F,_,c,P),B=f(d,"borderPattern"),M=ve(p,B),w=D(d,"background"),W=Ne(f(d,"repeatImage"),J,n),Q=f(d,"gradientPack"),z=D(d,"borderColor"),T=f(d,"borderWidth"),S=f(d,"segments",A),b=f(d,"gradient"),E=D(d,"gradientColor"),q=f(d,"border3d"),m=f(d,"border3dColor"),R=f(d,"border3dAccuracy"),a=f(d,"closePath"),Fl=f(d,"fillRule")||"nonzero",mg=p.lineJoin,Zq=p.lineCap;if(p.lineJoin=f(d,"borderJoin")||Eb,p.lineCap=f(d,"borderCap")||Ad,o)if(w||W||Q){var fn=f(d,"fillClipPercentage");if(1>fn){0>fn&&(fn=0);var Km=Qf(H,f(d,"fillClipDirection"),fn);p.save(),p.beginPath(),p.rect(Km.x,Km.y,Km.width,Km.height),p.clip()}if(pk(p,x,S,a),Q)sr(p,Q);else if(W){var Ib=p,hs=J,Pl=n;Ve(p,W,J,n,g,N),p=Ib,J=hs,n=Pl}else{var Ib=p;nm(p,w,b,E,H),p=Ib}p.fill(Fl),1>fn&&p.restore(),Q&&p.restore(),M!==p&&pk(M,x,S,a)}else pk(M,x,S,a);else if("roundRect"===X?L=f(d,"cornerRadius"):"polygon"===X?L=f(d,"polygonSide"):"arc"===X&&(L=f(d,"arcFrom"),I=f(d,"arcTo"),V=f(d,"arcClose"),Z=f(d,"arcOval")),w||W||Q){var fn=f(d,"fillClipPercentage");if(1>fn){0>fn&&(fn=0);var Km=Qf(H,f(d,"fillClipDirection"),fn);p.save(),p.beginPath(),p.rect(Km.x,Km.y,Km.width,Km.height),p.clip()}if(em(p,X,H,L,I,V,Z),Q)sr(p,Q);else if(W){var Ib=p,hs=J,Pl=n;Ve(p,W,J,n,g,N),p=Ib,J=hs,n=Pl}else nm(p,w,b,E,H);p.fill(Fl),1>fn&&p.restore(),Q&&p.restore(),p!==M&&em(M,X,H,L,I,V,Z)}else em(M,X,H,L,I,V,Z);if(T&&z){var mp=f(d,"borderWidthAbsolute");mp&&(p.save(),p.setTransform(1,0,0,1,0,0)),p.lineWidth=T,p.strokeStyle=z,p.stroke(),mp&&p.restore(),q&&Cq(p,z,m,T,C,R)}if(Bb(p,B),f(d,"dash")){var gj=f(d,"dashWidth")||T;if(gj>0){B=f(d,"dashPattern")||af;var M=ve(p,B,f(d,"dashOffset")),eo=D(d,"dashColor")||D(ph);M!==p&&(o?pk(M,x,S,a):em(M,X,H,L,I,V,Z)),p.strokeStyle=eo,p.lineWidth=gj,p.stroke(),f(d,"dash3d")&&Cq(p,eo,D(d,"dash3dColor"),gj,C,f(d,"dash3dAccuracy")),Bb(p,B)}}X===Xd&&Fc(p,w,f(d,"depth"),H),p.lineJoin=mg,p.lineCap=Zq,e&&K()}},X=function(i,q){var t=J,Q=n,F=J||f(i,Nb),C=n||f(i,"blendMode"),v=Ne(f(i,"name"),F,C);v&&(fo(p,v,f(i,"stretch"),q.x,q.y,q.width,q.height,g,N,F,null,C),J=t,n=Q)},H=function(L,o){var F=f(L,"text");F!=k&&qg(p,F,f(L,"font"),D(L,Nb),o.x,o.y,o.width,o.height,f(L,"align"),f(L,"vAlign"))},F=function(g,W){so(p,D(g,Nb),W.x,W.y,W.width,W.height,f(g,"width"))},Y=function(l,N){var t=f(l,mo),T=0;if(t&&(t.forEach(function(r){T+=r}),T>0)){for(var z=f(l,"colors")||Aj,G=f(l,"startAngle")||0,q=f(l,"hollow"),K=f(l,Sr),m=f(l,to),b=f(l,vh),v=K?new pq:k,L=N.x,j=N.y,H=N.width,B=N.height,r=L+H/2,C=j+B/2,x=$(H,B)/2,Q=0,i=0;i<t.length;i++){var s=t[i],Y=o*s/T,D=G+Y;if(p.fillStyle=z[Q++],Q===z.length&&(Q=0),p.beginPath(),q){var S=r+P(G)*x/2,c=C+e(G)*x/2,n=r+P(D)*x,d=C+e(D)*x;p.moveTo(S,c),p.arc(r,C,x/2,G,D,!1),p.lineTo(n,d),p.arc(r,C,x,D,G,!0)}else p.moveTo(r,C),p.arc(r,C,x,D,G,!0);v&&(Y=(G+D)/2,v.add({text:od(K)?K(s,i,T,g):s,x:r+.75*P(Y)*x,y:C+.75*e(Y)*x})),p.closePath(),p.fill(),G=D}v&&v.each(function(R){qg(p,R.text,m,b,R.x,R.y,0,0,Op)})}},W=function(z,b){var Q=f(z,Xn);if(Q&&Q.length>0){var M=Q.length,y=f(z,Sr),h=f(z,to),O=f(z,vh),C=y?new pq:k,R=f(z,"minValue")||0,H=f(z,"maxValue");if(H==k&&(H=0,Q.forEach(function(b){f(b,mo).forEach(function(O){H=j(H,O)})})),R===H)return;for(var J=b.height/(H-R),q=b.y+H*J,Z=f(Q[0],mo).length,I=b.width/(3*Z+1),V=2*I/M,d=0,c=0;M>c;c++)for(var N=Q[c],n=f(N,Nb),Y=f(N,"colors"),a=f(N,mo),D=0;Z>D;D++){Y?p.fillStyle=Y[D]:n?p.fillStyle=n:(p.fillStyle=Aj[d++],d===Aj.length&&(d=0));var E=a[D],w=E*J,U=b.x+(1+3*D)*I+c*V;if(yq(p,U,q-w,V,w),C){var T=od(y)?y(E,D,N,g):E,_=Qk(h,T).height;C.add({x:U,y:q-w-_,width:V,height:_,text:T})}}C&&C.each(function(C){qg(p,C.text,h,O,C.x,C.y,C.width,C.height,Op)})}},T=function(w,W){var a=f(w,Xn);if(a&&a.length>0){var I=a.length,Q=f(a[0],mo).length,B=W.width/(3*Q+1),N=0,J=f(w,"maxValue"),z=f(w,Sr),K=f(w,to),l=f(w,vh),s=z?new pq:k;if(J==k){J=0;for(var Z=0;Q>Z;Z++){for(var e=0,q=0;I>q;q++)e+=f(a[q],mo)[Z];J=j(J,e)}}if(J>0){for(var Z=0;Q>Z;Z++)for(var y=W.y+W.height,q=0;I>q;q++){var o=a[q],M=f(o,Nb),u=f(o,mo)[Z],x=u/J*W.height;M?p.fillStyle=M:(p.fillStyle=Aj[N++],N===Aj.length&&(N=0)),y-=x;var c={x:W.x+(1+3*Z)*B,y:y,width:2*B,height:x};yq(p,c.x,c.y,c.width,c.height),s&&(c.text=od(z)?z(u,Z,o,g):u,s.add(c))}s&&s.each(function(W){qg(p,W.text,K,l,W.x,W.y,W.width,W.height,Op)})}}},l=function(R,E){var y=f(R,Xn);if(y&&y.length>0){for(var Q=y.length,n=f(y[0],mo).length,d=E.width/(3*n+1),z=0,F=f(R,Sr),X=f(R,to),b=f(R,vh),u=F?new pq:k,W=0;n>W;W++){for(var A=0,V=0;Q>V;V++)A+=f(y[V],mo)[W];if(A>0){var r=E.y+E.height;for(V=0;Q>V;V++){var o=y[V],s=f(o,Nb),t=f(o,mo)[W],v=t/A*E.height;s?p.fillStyle=s:(p.fillStyle=Aj[z++],z===Aj.length&&(z=0)),r-=v;var I={x:E.x+(1+3*W)*d,y:r,width:2*d,height:v};yq(p,I.x,I.y,I.width,I.height),u&&(I.text=od(F)?F(t,W,o,g):t,u.add(I))}}}u&&u.each(function(G){qg(p,G.text,X,b,G.x,G.y,G.width,G.height,Op)})}},q=function(U,H){var P=f(U,Xn);if(P&&P.length>0){var E=P.length,r=f(U,"minValue")||0,i=f(U,"maxValue");if(i==k&&(i=0,P.forEach(function(w){f(w,mo).forEach(function(W){i=j(i,W)})})),r===i)return;for(var x=H.height/(i-r),$=H.y+i*x,M=f(P[0],mo).length,J=H.width/(3*M+1),L=0,m=f(U,"lineWidth")||2,T=f(U,"line3d"),Q=f(U,"linePoint"),I=f(U,Sr),B=f(U,to),W=f(U,vh),h=0;E>h;h++){var n=P[h],d=f(n,Nb),F=f(n,mo);d?p.strokeStyle=d:(d=p.strokeStyle=Aj[L++],L===Aj.length&&(L=0)),p.beginPath();for(var D=0;M>D;D++){var X=H.x+(2+3*D)*J,q=$-F[D]*x;0===D?p.moveTo(X,q):p.lineTo(X,q)}if(p.lineWidth=m,p.stroke(),T&&Cq(p,d,k,m,C),Q||I){var Z,l=m/2+2;for(D=0;M>D;D++){var N=F[D];if(X=H.x+(2+3*D)*J,q=$-N*x,od(Q)?Q(p,X,q,d,D,n,g):Q&&(p.fillStyle=d,p.beginPath(),p.arc(X,q,l,0,o,!0),p.fill()),od(I)?Z=I(N,D,n,g):I&&(Z=N),Z){var t=Qk(B,Z).height,v=p.shadowBlur;if(v){var V=p.shadowOffsetX,A=p.shadowOffsetY,s=p.shadowColor;p.shadowOffsetX=0,p.shadowOffsetY=0,p.shadowBlur=0,p.shadowColor=k}qg(p,Z,B,W,X,q-t-l+2,0,t,Op),v&&(p.shadowOffsetX=V,p.shadowOffsetY=A,p.shadowBlur=v,p.shadowColor=s)}}}}}},L=function(){p=null,g=null,N=null},x={border:F,image:X,text:H,pieChart:Y,columnChart:W,stackedColumnChart:T,percentageColumnChart:l,lineChart:q};return function(j,y,Z,X,F,o,s,U,$,l){if(y&&F&&o){var P=p?!1:!0;p=j,g=s,N=U,C=N?N._zoom?N._zoom:1:1,J=$,n=l;var b=F,r=o;if(of()){var m,W,c;0===p[Me]?of[0]&&(m=!0):m=!0,p.texureImage2D?of[1]&&(W=!0):W=!0,p.texureImage3D?of[2]&&(c=!0):c=!0,m&&W&&c&&(b=Z,r=X)}if(y.tagName)return Uc(h)&&!B[h]||p.drawImage(y,b,r,F,o),P&&L(),void 0;if(f(y,"visible")===!1)return P&&L(),void 0;J||(J=Sq(y.color,g,N)),l||(n=Sq(y.blendMode,g,N)),Uc(h)&&!B[h]&&(F=b,o=r);var T=Or(y,g,N,F),S=fb(y,g,N,o),E={x:0,y:0,width:T,height:S,fitSize:f(y,"fitSize")},H=f(y,"clip"),Y=f(y,"opacity");if(E.fitSize){var M=E.rw=Sq(y.width,g,N)||20;E.widthScale=T/M;var a=E.rh=Sq(y.height,g,N)||20;E.heightScale=S/a}if(p.save(),p.interactiveInfo){var t=p.interactiveInfo.matrix,q=t.clone();t.appendTranslate(b,r).appendScale(F/T,o/S)}Ig(p,b,r),(T!==F||S!==o)&&p.scale(F/T,o/S),H&&(od(H)?H(p,T,S,g,N,y):(p.beginPath(),p.rect(0,0,T,S),p.clip())),Y!=k&&(p.globalAlpha*=Y),f(y,"comps").forEach(function(X){if(f(X,Mb)!==!1){if(gh.splice(0,0,X),p.interactiveInfo)var c=p.interactiveInfo.matrix.clone();var W=f(X,"opacity"),s=f(X,"shadow"),q=f(X,"type"),Z=i(X,E);if(W!=k){var z=p.globalAlpha;p.globalAlpha*=W}if(s){var h=p.shadowOffsetX,$=p.shadowOffsetY,e=p.shadowBlur,t=p.shadowColor,L=f(X,"shadowOffsetX"),y=f(X,"shadowOffsetY"),w=f(X,"shadowBlur"),T=D(X,"shadowColor");p.shadowOffsetX=(L==k?3:L)*C,p.shadowOffsetY=(y==k?3:y)*C,p.shadowBlur=(w==k?6:w)*C,p.shadowColor=T||D(jd)}if("save"===q)p.save();else if("endClip"===q||"restore"===q)p.restore();else if("clip"===q)p.save(),pk(p,f(X,"points",u),f(X,"segments",A),!0),p.clip();else if(Hl[q])Z=Z||{x:0,y:0,width:E.width,height:E.height},_(X,q,Z,E);else if(q===Dq)_(X,q,Z,E);else if("SVGPath"===q)d(X,q,Z);else{Z=Z||{x:0,y:0,width:E.width,height:E.height};var b=f(X,Qj),S=f(X,"scaleX"),Q=f(X,"scaleY"),P=v(X),M=G(X,Z,Z,b,S,Q,P);if(od(q))R(X,q),I.drawCompType(q,p,Z,X,g,N);else if(I.getCompType(q)){var n=I.getCompType(q),Y=n.func||n;R(X,n),I.drawCompType(Y,p,Z,X,g,N)}else x[q]?x[q](X,Z):I.getCompType(q)===V&&Ln.test(q)&&Wf(q);M&&K()}s&&(p.shadowOffsetX=h,p.shadowOffsetY=$,p.shadowBlur=e,p.shadowColor=t),W!=k&&(p.globalAlpha=z),p.interactiveInfo&&(p.interactiveInfo.matrix=c),gh.splice(0,1)}}),p.interactiveInfo&&(p.interactiveInfo.matrix=q),p.restore(),P&&L()}}}();I.getCurrentComp=function(){return gh[0]},I.getParentComp=function(){return gh[1]},I.getInternal=function(){return{isEnter:Wh,isEsc:_m,isSpace:Eg,isLeft:_o,isUp:yc,isRight:_b,isDown:Vc,addMethod:fs,superCall:uj,toPointsArray:vb,translateAndScale:Ko,appendArray:ke,createWorldMatrix:fl,vec3TransformMat4:nc,setCanvas:Oi,createDiv:Xf,createView:Hb,createCanvas:os,createImage:qd,initContext:Rq,layout:qi,fillRect:yq,Mat:pf,drawBorder:so,isString:Uc,setBorder:gk,getPropertyValue:Xp,setPropertyValue:Il,drawVerticalLine:xn,draw3DRect:Fc,getPinchDist:Kc,isSameRect:yk,getPosition:uk,intersectionLineRect:Cj,getNodeRect:Fn,getEdgeAgentPosition:Dh,getImageWidth:Or,getImageHeight:fb,initItemElement:fm,drawPoints:pk,createG2:ve,closePopup:Fj,isH:Rn,createAnim:rg,createNormalMatrix:If,createNormals:ri,toFloatArray:ic,glMV:vi,batchShape:ie,createNodeMatrix:_k,getFaceInfo:Uh,transformAppend:$p,drawFaceInfo:hr,to3dPointsArray:Gj,setGLDebugMode:function($){yh=$},cube:function(){return{vs:ej,is:$e,uv:Rm}},ui:function(){return{DataUI:Ir,NodeUI:On,EdgeUI:Vq,GroupUI:lc,ShapeUI:Ek,GridUI:Mm,Data3dUI:Pe,Node3dUI:Yh,Shape3dUI:dj}},getInternalVersion:function(){return"U2FsdGVkX1/JEzCv244rFlVGqTfUUFBiW/SyaJ5SFrU="},getDragger:function(){return Pg},addMSMap:function(p){fs(bi,p)},k:u}},function(p){function w(R,W){R!=k&&(W==k&&fh!=typeof R?this._54O(R,256):this._54O(R,W))}function D(){return new w(k)}function N(X,H,_,g,y,x){for(;--x>=0;){var i=H*this[X++]+_[g]+y;y=E(i/67108864),_[g++]=67108863&i}return y}function c(R,l,J,Y,G,H){for(var I=32767&l,s=l>>15;--H>=0;){var r=32767&this[R],n=this[R++]>>15,h=s*r+n*I;r=I*r+((32767&h)<<15)+J[Y]+(1073741823&G),G=(r>>>30)+(h>>>15)+s*n+(G>>>30),J[Y++]=1073741823&r}return G}function b(E,S,d,f,w,t){for(var G=16383&S,r=S>>14;--t>=0;){var a=16383&this[E],Q=this[E++]>>14,h=r*a+Q*G;a=G*a+((16383&h)<<14)+d[f]+w,w=(a>>28)+(h>>14)+r*Q,d[f++]=268435455&a}return w}function V(J){return Yd.charAt(J)}function B(e,$){var f=Sf[e.charCodeAt($)];return f==k?-1:f}function S(b){for(var P=this.t-1;P>=0;--P)b[P]=this[P];b.t=this.t,b.s=this.s}function _(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+this.DV:this.t=0}function q(O){var M=D();return M._58O(O),M}function Z(V,r){var D,x=this;if(16==r)D=4;else if(8==r)D=3;else if(256==r)D=8;else if(2==r)D=1;else if(32==r)D=5;else{if(4!=r)return x.fromRadix(V,r),void 0;D=2}x.t=0,x.s=0;for(var S=V.length,g=!1,X=0;--S>=0;){var T=8==D?255&V[S]:B(V,S);0>T?"-"==V.charAt(S)&&(g=!0):(g=!1,0==X?x[x.t++]=T:X+D>x.DB?(x[x.t-1]|=(T&(1<<x.DB-X)-1)<<X,x[x.t++]=T>>x.DB-X):x[x.t-1]|=T<<X,X+=D,X>=x.DB&&(X-=x.DB))}8==D&&0!=(128&V[0])&&(x.s=-1,X>0&&(x[x.t-1]|=(1<<x.DB-X)-1<<X)),x._57O(),g&&w.ZERO._78O(x,x)}function s(){for(var u=this,_=u.s&u.DM;u.t>0&&u[u.t-1]==_;)--u.t}function G(v){var L=this;if(L.s<0)return"-"+L._85O()[_m](v);var p;if(16==v)p=4;else if(8==v)p=3;else if(2==v)p=1;else if(32==v)p=5;else{if(4!=v)return L.toRadix(v);
p=2}var k,C=(1<<p)-1,R=!1,y="",P=L.t,F=L.DB-P*L.DB%p;if(P-->0)for(F<L.DB&&(k=L[P]>>F)>0&&(R=!0,y=V(k));P>=0;)p>F?(k=(L[P]&(1<<F)-1)<<p-F,k|=L[--P]>>(F+=L.DB-p)):(k=L[P]>>(F-=p)&C,0>=F&&(F+=L.DB,--P)),k>0&&(R=!0),R&&(y+=V(k));return R?y:"0"}function L(){var e=D();return w.ZERO._78O(this,e),e}function C(){return this.s<0?this._85O():this}function U(y){var D=this,G=D.s-y.s;if(0!=G)return G;var N=D.t;if(G=N-y.t,0!=G)return D.s<0?-G:G;for(;--N>=0;)if(0!=(G=D[N]-y[N]))return G;return 0}function x(d){var u,j=1;return 0!=(u=d>>>16)&&(d=u,j+=16),0!=(u=d>>8)&&(d=u,j+=8),0!=(u=d>>4)&&(d=u,j+=4),0!=(u=d>>2)&&(d=u,j+=2),0!=(u=d>>1)&&(d=u,j+=1),j}function Q(){var K=this;return K.t<=0?0:K.DB*(K.t-1)+x(K[K.t-1]^K.s&K.DM)}function H(Z,a){var q;for(q=this.t-1;q>=0;--q)a[q+Z]=this[q];for(q=Z-1;q>=0;--q)a[q]=0;a.t=this.t+Z,a.s=this.s}function z(r,m){for(var F=r;F<this.t;++F)m[F-r]=this[F];m.t=j(this.t-r,0),m.s=this.s}function J(q,X){var m,K=this,$=q%K.DB,F=K.DB-$,e=(1<<F)-1,Z=E(q/K.DB),C=K.s<<$&K.DM;for(m=K.t-1;m>=0;--m)X[m+Z+1]=K[m]>>F|C,C=(K[m]&e)<<$;for(m=Z-1;m>=0;--m)X[m]=0;X[Z]=C,X.t=K.t+Z+1,X.s=K.s,X._57O()}function W(P,R){var O=this;R.s=O.s;var I=E(P/O.DB);if(I>=O.t)return R.t=0,void 0;var i=P%O.DB,C=O.DB-i,G=(1<<i)-1;R[0]=O[I]>>i;for(var c=I+1;c<O.t;++c)R[c-I-1]|=(O[c]&G)<<C,R[c-I]=O[c]>>i;i>0&&(R[O.t-I-1]|=(O.s&G)<<C),R.t=O.t-I,R._57O()}function R(S,a){for(var T=this,G=0,z=0,e=$(S.t,T.t);e>G;)z+=T[G]-S[G],a[G++]=z&T.DM,z>>=T.DB;if(S.t<T.t){for(z-=S.s;G<T.t;)z+=T[G],a[G++]=z&T.DM,z>>=T.DB;z+=T.s}else{for(z+=T.s;G<S.t;)z-=S[G],a[G++]=z&T.DM,z>>=T.DB;z-=S.s}a.s=0>z?-1:0,-1>z?a[G++]=T.DV+z:z>0&&(a[G++]=z),a.t=G,a._57O()}function T(S,c){var n=this.abs(),B=S.abs(),t=n.t;for(c.t=t+B.t;--t>=0;)c[t]=0;for(t=0;t<B.t;++t)c[t+n.t]=n.am(0,B[t],c,t,0,n.t);c.s=0,c._57O(),this.s!=S.s&&w.ZERO._78O(c,c)}function X(o){for(var r=this.abs(),v=o.t=2*r.t;--v>=0;)o[v]=0;for(v=0;v<r.t-1;++v){var M=r.am(v,r[v],o,2*v,0,1);(o[v+r.t]+=r.am(v+1,2*r[v],o,2*v+1,M,r.t-v-1))>=r.DV&&(o[v+r.t]-=r.DV,o[v+r.t+1]=1)}o.t>0&&(o[o.t-1]+=r.am(v,r[v],o,2*v,0,1)),o.s=0,o._57O()}function r(F,I,u){var X=F.abs(),L=this;if(!(X.t<=0)){var o=L.abs();if(o.t<X.t)return I!=k&&I._58O(0),u!=k&&L._77O(u),void 0;u==k&&(u=D());var G=D(),H=L.s,l=F.s,P=L.DB-x(X[X.t-1]);P>0?(X._44O(P,G),o._44O(P,u)):(X._77O(G),o._77O(u));var U=G.t,Y=G[U-1];if(0!=Y){var s=Y*(1<<L.F1)+(U>1?G[U-2]>>L.F2:0),K=L.FV/s,r=(1<<L.F1)/s,T=1<<L.F2,z=u.t,$=z-U,f=I==k?D():I;for(G._59O($,f),u._52O(f)>=0&&(u[u.t++]=1,u._78O(f,u)),w.ONE._59O(U,f),f._78O(G,G);G.t<U;)G[G.t++]=0;for(;--$>=0;){var O=u[--z]==Y?L.DM:E(u[z]*K+(u[z-1]+T)*r);if((u[z]+=G.am(0,O,u,$,0,U))<O)for(G._59O($,f),u._78O(f,u);u[z]<--O;)u._78O(f,u)}I!=k&&(u._45O(U,I),H!=l&&w.ZERO._78O(I,I)),u.t=U,u._57O(),P>0&&u._46O(P,u),0>H&&w.ZERO._78O(u,u)}}}function F(H){var M=D();return this.abs()._49O(H,k,M),this.s<0&&M._52O(w.ZERO)>0&&H._78O(M,M),M}function A(p){this.m=p}function O(P){return P.s<0||P._52O(this.m)>=0?P.mod(this.m):P}function K(Y){return Y}function t(S){S._49O(this.m,k,S)}function f(L,N,b){L._47O(N,b),this._74O(b)}function m(b,M){b._48O(M),this._74O(M)}function h(){if(this.t<1)return 0;var H=this[0];if(0==(1&H))return 0;var g=3&H;return g=15&g*(2-(15&H)*g),g=255&g*(2-(255&H)*g),g=65535&g*(2-(65535&(65535&H)*g)),g=g*(2-H*g%this.DV)%this.DV,g>0?this.DV-g:-g}function I(K){var X=this;X.m=K,X.mp=K._50O(),X.mpl=32767&X.mp,X.mph=X.mp>>15,X.um=(1<<K.DB-15)-1,X.mt2=2*K.t}function M(s){var V=D();return s.abs()._59O(this.m.t,V),V._49O(this.m,k,V),s.s<0&&V._52O(w.ZERO)>0&&this.m._78O(V,V),V}function Y(U){var T=D();return U._77O(T),this._74O(T),T}function a(D){for(var C=this;D.t<=C.mt2;)D[D.t++]=0;for(var F=0;F<C.m.t;++F){var B=32767&D[F],m=B*C.mpl+((B*C.mph+(D[F]>>15)*C.mpl&C.um)<<15)&D.DM;for(B=F+C.m.t,D[B]+=C.m.am(0,m,D,F,0,C.m.t);D[B]>=D.DV;)D[B]-=D.DV,D[++B]++}D._57O(),D._45O(C.m.t,D),D._52O(C.m)>=0&&D._78O(C.m,D)}function db(W,D){W._48O(D),this._74O(D)}function uf(H,i,O){H._47O(i,O),this._74O(O)}function Sc(){return 0==(this.t>0?1&this[0]:this.s)}function Vi(m,U){if(m>4294967295||1>m)return w.ONE;var Z=D(),f=D(),s=U._73O(this),J=x(m)-1;for(s._77O(Z);--J>=0;)if(U._76O(Z,f),(m&1<<J)>0)U._75O(f,s,Z);else{var N=Z;Z=f,f=N}return U.revert(Z)}function Wo(j,N){var E;return E=256>j||N._51O()?new A(N):new I(N),this.exp(j,E)}function Jk(){var S=this;if(S.s<0){if(1==S.t)return S[0]-S.DV;if(0==S.t)return-1}else{if(1==S.t)return S[0];if(0==S.t)return 0}return(S[1]&(1<<32-S.DB)-1)<<S.DB|S[0]}function Yk(e,A){return new w(e,A)}function bb(){var j=this;j.n=k,j.e=0,j.d=k,j.p=k,j.q=k,j.dmp1=k,j.dmq1=k,j._10A=k}function mr(z){return z._53O(this.e,this.n)}function ej(c){var M,w,o,R="",W=0;for(M=0;M<c.length&&c.charAt(M)!=Gb;++M)o=Wf.indexOf(c.charAt(M)),0>o||(0==W?(R+=V(o>>2),w=3&o,W=1):1==W?(R+=V(w<<2|o>>4),w=15&o,W=2):2==W?(R+=V(w),R+=V(o>>2),w=3&o,W=3):(R+=V(w<<2|o>>4),R+=V(15&o),W=0));return 1==W&&(R+=V(w<<2)),R}function lp(u){var r=u.split(""),B=ej(u);return r.forEach(function(r){var x=r.length;x>0&&B&&(Np+=d(r))}),B}function Do(D,x){var I=xs._4O.Util._56O(D,"ss"),F={},u=0;return F.v=I==x,F.t=1,F.s=0>u?-1:0,ho=F.v,u>0?F[0]=u:-1>u?F[0]=u+F.DV:F.t=0,[I,F]}function ei(l){var q=38,e=l.substring(0,q);if(e&&30==e.indexOf("05000420")){var u=["ss",l.substring(q)];return u}return[]}function kq(s,q){q=q.replace(hl,""),q=q.replace(/[ \n]+/g,"");var F=Yk(q,16);if(F._55O()>this.n._55O())return 0;var Y=this._37O(F),O=Y[_m](16).replace(/^1f+00/,""),f=ei(O);if(0==f.length)return!1;for(var p,m,H,d=.5,Z=$f,B=[0,.5,.75,.875,.9375],J=[],l=[],W=[],L=o/Z,A=f[1],h=Do(s,A)[0],I=0,N=0;I<B.length;I++){var G=0===I%2?0:.5;for(p=0;Z>=p;p++)m=(p+G)*L,H=1-B[I],J.push(P(m)*d*H,-d+2*B[I]*d,-e(m)*d*H),l.push((p+G)/Z,H)}for(I=0;I<B.length-1;I++){var R=I*(Z+1),x=(I+1)*(Z+1);for(p=0;Z>p;p++)W.push(R+p,x+p+1,x+p,R+p,R+p+1,x+p+1)}return W.forEach(function(V){N+=V}),A==h&&N>10}var Jr,Pj=0xdeadbeefcafe,ec=15715070==(16777215&Pj),_m="toString",pj="",xn="nat",fm=function(){};n=p["D"+11182[_m](l(2,5))];var pc=w.prototype;Ue+=Vj.substr(0,1);var cj=p.navigator?p.navigator.appName:"";ec&&"Microsoft Internet Explorer"==cj?(pc.am=c,Jr=30):ec&&"Netscape"!=cj?(pc.am=N,Jr=26):(pc.am=b,Jr=28),pc.DB=Jr,pc.DM=(1<<Jr)-1,pc.DV=1<<Jr;var mo=52;pc.FV=l(2,mo),pc.F1=mo-Jr,pc.F2=2*Jr-mo;var Un,mc,Yd="0123456789abcdefghijklmnopqrstuvwxyz",Sf=[],Go=function(T){return String.fromCharCode(T)};for(Un="0".charCodeAt(0),mc=0;9>=mc;++mc)Sf[Un++]=mc;for(Un="a".charCodeAt(0),mc=10;36>mc;++mc)Sf[Un++]=mc;for(Un="A".charCodeAt(0),mc=10;36>mc;++mc)Sf[Un++]=mc;var hm=A.prototype;hm._73O=O,hm.revert=K,hm._74O=t,hm._75O=f,hm._76O=m;var og=I.prototype;og._73O=M,og.revert=Y,og._74O=a,og._75O=uf,og._76O=db,pc._77O=S,pc._58O=_,pc._54O=Z,pc._57O=s,pc._59O=H,pc._45O=z,pc._44O=J,pc._46O=W,pc._78O=R,pc._47O=T,pc._48O=X,pc._49O=r,pc._50O=h,pc._51O=Sc,pc.exp=Vi,pc.toString=G,pc._85O=L,pc.abs=C,pc._52O=U,pc._55O=Q,pc.mod=F,pc._53O=Wo,w.ZERO=q(0),w.ONE=q(1),pc._86O=Jk;var Mm=function(B,W){var R=this;R.isPublic=!0,typeof B!==fh?(R.n=B,R.e=W):B!=k&&W!=k&&B.length>0&&W.length>0&&(R.n=Yk(B,16),R.e=d(W,16))};$d=function(){var X,B,y=lp($p),S=y.substr(0,4),A=y.substr(4,2),g=y.substr(6,2),i=1,w=!i,Y=u,m=[],z=Pr.charAt(7);if(n&&(n[_m]().indexOf(xn)<0||n[Ue][_m]().indexOf(xn)<0||!y?X=ed(vm[z]):(y=new n(S-0,A-i,g-0),B=y.setHours(9),n[Ue]()>B?X=ed(vm[z]):w=!0)),y&&X&&Y){for(var V in X)m.push(V);var R,c=0,p=X[m[c++]],d=X[m[c++]],J=X[m[c++]],F=X[m[c++]],O=X[m[c++]],h=X[m[c++]],M=X[m[c++]],C=le._27O(Y);if(C&&M){R=p+d+J+F+O+h;var v=!h||h===Fb;if(!v&&h)for(var P,N=0,W=h.length;W>N;N++)h[N]===wd[c]?P===Fb?v=!0:P=k:(P==k?P=h[N]:P+=h[N],N===W-1&&P===Fb&&(v=!0));R&&C._31O(R,M)&&v&&(!O||n[Ue]()<O)&&(w=!0)}}return w||(em=Jp),z};var cb=bb.prototype;cb._37O=mr,cb._38O=Mm;var Wf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Gb="=",Tg=25,Uj=10,$p="IBgSMQ==",hh=hh||function(u,p){var x={},E=x._7A={},U=E._6A=function(){function S(){}return{_80O:function(M){S.prototype=this;var F=new S;return M&&F._5A(M),F.hasOwnProperty("_82O")||(F._82O=function(){F.$super._82O.apply(this,arguments)}),F._82O.prototype=F,F.$super=this,F},_3A:function(){var J=this._80O();return J._82O.apply(J,arguments),J},_82O:function(){},_5A:function(B){for(var z in B)B.hasOwnProperty(z)&&(this[z]=B[z]);B.hasOwnProperty(_m)&&(this.toString=B.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),h=E._39O=U._80O({_82O:function(m,g){m=this._84O=m||[],this._65O=g!=p?g:4*m.length},toString:function(n){return(n||b).stringify(this)},_89O:function(P){var i=this._84O,y=P._84O,D=this._65O,Z=P._65O;if(this._57O(),D%4)for(var H=0;Z>H;H++){var f=255&y[H>>>2]>>>24-8*(H%4);i[D+H>>>2]|=f<<24-8*((D+H)%4)}else if(y.length>65535)for(var H=0;Z>H;H+=4)i[D+H>>>2]=y[H>>>2];else i.push.apply(i,y);return this._65O+=Z,this},_57O:function(){var F=this._84O,P=this._65O;F[P>>>2]&=4294967295<<32-8*(P%4),F.length=g(P/4)},_88O:function(){var K=U._88O.call(this);return K._84O=this._84O.slice(0),K},_87O:function(c){for(var n=[],C=0;c>C;C+=4)n.push(0|4294967296*y);return new h._82O(n,c)}}),A=x._2A={},b=A._69O={stringify:function(B){var E,k=B._84O,p=B._65O,w=[];for(E=0;p>E;E++){var c=255&k[E>>>2]>>>24-8*(E%4);w.push((c>>>4).toString(16)),w.push((15&c).toString(16))}return w.join("")},_68O:function(q){for(var V=q.length,G=[],L=0;V>L;L+=2)G[L>>>3]|=d(q.substr(L,2),16)<<24-4*(L%8);return new h._82O(G,V/2)}},c=A._8A={stringify:function(C){var I,E=C._84O,n=C._65O,k=[];for(I=0;n>I;I++){var X=255&E[I>>>2]>>>24-8*(I%4);k.push(Go(X))}return k.join("")},_68O:function(G){var r,n=G.length,X=[];for(r=0;n>r;r++)X[r>>>2]|=(255&G.charCodeAt(r))<<24-8*(r%4);return new h._82O(X,n)}},B=A._9A={stringify:function(B){try{return decodeURIComponent(escape(c.stringify(B)))}catch(R){throw new Error("")}},_68O:function(Z){return c._68O(unescape(encodeURIComponent(Z)))}},m=E._32O=U._80O({_1A:function(){this._83O=new h._82O,this._23O=0},_33O:function(m){typeof m==fh&&(m=B._68O(m)),this._83O._89O(m),this._23O+=m._65O},_25O:function(v){var D=this._83O,o=D._84O,n=D._65O,s=this._79O,x=4*s,d=n/x;d=v?g(d):j((0|d)-this._22O,0);var Q=d*s,A=$(4*Q,n);if(Q){for(var J=0;Q>J;J+=s)this._20O(o,J);var k=o.splice(0,Q);D._65O-=A}return new h._82O(k,A)},_88O:function(){var g=U._88O.call(this);return g._83O=this._83O._88O(),g},_22O:0});E._66O=m._80O({cfg:U._80O(),_82O:function(w){this.cfg=this.cfg._80O(w),this._1A()},_1A:function(){m._1A.call(this),this._34O()},_81O:function(O){return this._33O(O),this._25O(),this},_72O:function(o){o&&this._33O(o);var a=this._21O();return a},_79O:16,_26O:function(R){return function(k,e){return new R._82O(e)._72O(k)}},_19O:function(t){return function(r,f){return new z._71O._82O(t,f)._72O(r)}}});var z=x._67O={};return x}();!function(){var v=hh,r=v._7A,y=r._39O,P=r._66O,o=v._67O,g=[],p=[];!function(){function J(u){for(var g=i(u),I=2;g>=I;I++)if(!(u%I))return!1;return!0}function K(i){return 0|4294967296*(i-(0|i))}for(var Q=2,S=0;64>S;)J(Q)&&(8>S&&(g[S]=K(l(Q,.5))),p[S]=K(l(Q,1/3)),S++),Q++}();var m=[],a=o._41O=P._80O({_34O:function(){this._64O=new y._82O(g.slice(0))},_20O:function(F,X){for(var J=this._64O._84O,c=J[0],N=J[1],y=J[2],C=J[3],j=J[4],L=J[5],u=J[6],M=J[7],O=0;64>O;O++){if(16>O)m[O]=0|F[X+O];else{var $=m[O-15],T=($<<25|$>>>7)^($<<14|$>>>18)^$>>>3,P=m[O-2],U=(P<<15|P>>>17)^(P<<13|P>>>19)^P>>>10;m[O]=T+m[O-7]+U+m[O-16]}var H=j&L^~j&u,a=c&N^c&y^N&y,Y=(c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22),b=(j<<26|j>>>6)^(j<<21|j>>>11)^(j<<7|j>>>25),D=M+b+H+p[O]+m[O],I=Y+a;M=u,u=L,L=j,j=0|C+D,C=y,y=N,N=c,c=0|D+I}J[0]=0|J[0]+c,J[1]=0|J[1]+N,J[2]=0|J[2]+y,J[3]=0|J[3]+C,J[4]=0|J[4]+j,J[5]=0|J[5]+L,J[6]=0|J[6]+u,J[7]=0|J[7]+M},_21O:function(){var k=this._83O,Q=k._84O,m=8*this._23O,C=8*k._65O;return Q[C>>>5]|=128<<24-C%32,Q[(C+64>>>9<<4)+14]=E(m/4294967296),Q[(C+64>>>9<<4)+15]=m,k._65O=4*Q.length,this._25O(),this._64O},_88O:function(){var x=P._88O.call(this);return x._64O=this._64O._88O(),x}});v._41O=P._26O(a),v._42O=P._19O(a)}();var hl=new RegExp("");hl.compile("[^0-9a-f]","gi"),bb._28O=-1,bb._29O=-2,cb._31O=kq,cb._63O=kq,bb._43O=-2;var Er=new function(){var X=this;X._5O=function(q,H){if("8"!=q.substring(H+2,H+3))return 1;var T=d(q.substring(H+3,H+4));return 0==T?-1:T>0&&10>T?T+1:-2},X._13O=function(N,t){var k=X._5O(N,t);return 1>k?"":N.substring(t+2,t+2+2*k)},X._12O=function(G,n){var A=X._13O(G,n);if(""==A)return-1;var j;return j=d(A.substring(0,1))<8?new w(A,16):new w(A.substring(2),16),j._86O()},X._6O=function(v,e){var H=X._5O(v,e);return 0>H?H:e+2*(H+1)},X._11O=function(n,W){var l=X._6O(n,W),B=X._12O(n,W);return n.substring(l,l+2*B)},X._10O=function(q,z){var O=X._6O(q,z),$=X._12O(q,z);return O+2*$},X._7O=function(K,P){var e=[],v=X._6O(K,P);e.push(v);for(var D=X._12O(K,P),R=v,G=0;;){var Y=X._10O(K,R);if(Y==k||Y-v>=2*D)break;if(G>=200)break;e.push(Y),R=Y,G++}return e}};if(Er._90O=Go(Uj+24),Er._91O=v+Go(Uj*Uj+8),xs==k||!xs)var xs={};xs._4O!=k&&xs._4O||(xs._4O={});var sg=xs._4O;xs._4O.Util=new function(){var l=this;l._56O=function(O){var e=new xs._4O._3O;return e._30O(O)},l._4A=function(V){var j=new xs._4O._3O;return j._36O(V)},l._11A=function(B){var T=new sg._3O;return T._30O(B)}},xs._4O._3O=function(){var A=this;A._8O=function(P,C){if("ss"==P&&"cj"==C){try{A.md=hh._67O._41O._3A()}catch(v){fm(pj)}A._24O=function(J){A.md._81O(J)},A._35O=function(w){var d=hh._2A._69O._68O(w);A.md._81O(d)},A._60O=function(){var o=A.md._72O();return o[_m](hh._2A._69O)},A._30O=function(X){return A._24O(X),A._60O()},A._36O=function(C){return A._35O(C),A._60O()}}},A._24O=function(){fm(pj)},A._35O=function(){fm(pj)},A._60O=function(){fm(pj)},A._30O=function(){fm(pj)},A._36O=function(){fm(pj)},A._8O("ss","cj")},Mr=function(r){var W=po[ii[7]],f=1,B=!1;if(Nj.a!=po[he])return Nj.a;if(Nj.forEach(function(s){f*=s}),r>f){if(W){W=W.split(Er._90O);var R=W[3],u=W[7],T=W[11],S=W[15],Q=W[19],i=W[23],K=W[27],U=R+u+T+S+Q+i,$=i?!1:!0;if(i){var c=i&&i.split(di("firefox")[3]);if(c)for(var e=0;e<c.length;e++)if(Fh.indexOf(c[e])>=0){$=!0;break}}B=on()(U,K)&&$&&(!Q||Q>r)}B||(Ir.prototype._42=Bc)}else B=!0;return Nj.a=B,B},Tg=String.fromCharCode(Tg+20);var Rb=function(n){return n=n.replace(hl,pj),n=n.replace(/[ \n]+/g,pj)},Jb="30",ng="06",Eo="02",_o="03",Dr=Yk,tp=/^1f+00/,le=function(){var G;return G={_18O:function(Z){var L=Z,N=L.replace(/\s+/g,""),i=ej(N);return i},_14O:function(E){var x=this._18O(E),l=this._15O(x);return l},_15O:function(X){var r=this._17O(X);if("2a864886f70d010101"==r._61O){var R=this._16O(r.key),d=new bb;return d._38O(R.n,R.e),d}fm(pj)},_16O:function(N){var J={};N.substr(0,2)!=Jb&&fm(pj);var H=Er._7O(N,0);return 2!=H.length&&fm(pj),N.substr(H[0],2)!=Eo&&fm(pj),J.n=Er._11O(N,H[0]),N.substr(H[1],2)!=Eo&&fm(pj),J.e=Er._11O(N,H[1]),J},_17O:function(T){var y={};y._40O=k;var O=Er._7O(T,0);2!=O.length&&fm(pj);var u=O[0];T.substr(u,2)!=Jb&&fm(pj);var Y=Er._7O(T,u);return 2!=Y.length&&fm(pj),T.substr(Y[0],2)!=ng&&fm(pj),y._61O=Er._11O(T,Y[0]),T.substr(Y[1],2)==ng?y._40O=Er._11O(T,Y[1]):T.substr(Y[1],2)==Jb&&(y._40O={},y._40O.p=Er._70O(T,Y[1],[0],Eo),y._40O.q=Er._70O(T,Y[1],[1],Eo),y._40O.g=Er._70O(T,Y[1],[2],Eo)),T.substr(O[1],2)!=_o&&fm(pj),y.key=Er._11O(T,O[1]).substr(2),y}},G._17O?G:k}(),Jc=le._27O=function(B){return le._14O(B)};on=function(){return function(T,Z){if(T&&Z){Z=Rb(Z);var R=Dr(Z,l(2,4)),L=this;if(!L||!L.n||R._55O()>L.n._55O())return 0;var C=L._37O(R),q=C[_m](l(2,4)).replace(tp,""),e=ei(q);if(0==e.length)return!1;var _=e[0],w=e[1],N=function(A){return xs._4O.Util._56O(A,_)},k=N(T);return w==k}}.bind(Jc(u))};var Jq,kr;return function(){var z=vj.length-Hf.length;if(z>0)for(var Q=0;z>Q;Q++)Jq=sg.Util,kr=Rb}(),qf=function(I,o){o=kr(o);var z=Jc(Od),w=cp.length,e=2*w,S=Dr(o,l(w,e)),Z=z,X=!0;if(Z){var c=Z[yp[0]];c&&S._55O()<=c._55O()&&(X=!1)}if(X)return 0;var C=Z._37O(S),a=C[_m](l(w,e)).replace(tp,""),Y=ei(a);if(0==Y.length)return!1;var D=Y[0],O=Y[1],V=Jq._11A(I,D);return O==V},le}(B,c),fs(I,{load:function(){var f={},L=function(T){return T?"c_"+(T.sync?"1":"0")+"_"+(T.post?"1":"0")+"_"+(T.responseType||"H")+"_"+(T.mimeType||"H")+"_"+(T.data?JSON.stringify(T.data):"H"):""};return function(Y,T,A){var U,s=f[Y],B=L(A);return s&&(U=s[B])?(U.push(T),void 0):(f[Y]||(s=f[Y]={count:0}),U=s[B]=[T],s.count++,I.xhrLoad(Y,function(H){delete s[B],s.count--,s.count||delete f[Y],U.forEach(function(c){c(H)})},A),void 0)}}(),asyncEach:function(Z,I,l){"function"!=typeof l&&(l=Function.prototype);var $=new Array(Z.length),H=0,E=!1;Z.forEach(function(f,J){I(f,function(v,T){return E?void 0:v?(E=!0,l(null)):($[J]=T,H++,H===Z.length?l($):void 0)})})},xhrLoad:function(l,q,E){var R=!1;sn(l)||(R=!0,l=[l]),E=E||{},l.length;var P=E.sync,W=!!E.post,o=null;return I.asyncEach(l,function(J,X){var G=new ib;J=I.beforeLoadURL(J),J.data?X(null,J.data):(E.url=encodeURI(J),E.method=W?"POST":"GET",E.responseType?G.setResponseType(E.responseType):G.setOverrideMimeType(E.mimeType||"text/plain"),G.onload=function(){200===this.status||0===this.status?X(null,G.getResponseText()):X(!0)},G.onerror=function(){X(!0)},G.send(E))},function(M){var K="function"==typeof q;(K||P)&&(o=R&&M?M[0]:M,K&&q(o))}),P?o:void 0}}),Math.sign===V&&(Math.sign=function(r){return 0>r?-1:r>0?1:+r}),C.Math={generateUUID:function(){for(var y=[],W=0;256>W;W++)y[W]=(16>W?"0":"")+W.toString(16).toUpperCase();return function(){var Z=0|4294967295*Math.random(),q=0|4294967295*Math.random(),g=0|4294967295*Math.random(),R=0|4294967295*Math.random();return y[255&Z]+y[255&Z>>8]+y[255&Z>>16]+y[255&Z>>24]+"-"+y[255&q]+y[255&q>>8]+"-"+y[64|15&q>>16]+y[255&q>>24]+"-"+y[128|63&g]+y[255&g>>8]+"-"+y[255&g>>16]+y[255&g>>24]+y[255&R]+y[255&R>>8]+y[255&R>>16]+y[255&R>>24]}}(),clamp:function(f,Y,N){return Math.max(Y,Math.min(N,f))},generateIncreasingID:function(){var n=0;return function(){return++n}}()};var sq=C.Matrix=C.Math.Matrix2d=function(V,R,r,B,d){this.setFromTransform(V,R,r,B,d)},pf=sq;sq.prototype={},sq.prototype.constructor=sq,sq.prototype.set=function(S,m,$,e,G,z){return this.a=S,this.b=m,this.c=$,this.d=e,this.tx=G,this.ty=z,this},sq.prototype.setFromTransform=function(m,X,i,W,$){var D=this;if(m===V)return D.a=1,D.b=0,D.c=0,D.d=1,D.tx=0,D.ty=0,void 0;m=m||0;var d=e(m),k=P(m);return W=W||1,$=$||1,D.a=k*W,D.b=d*W,D.c=-d*$,D.d=k*$,D.tx=X||0,D.ty=i||0,D},sq.prototype.apply=function(M,j){j=j||new lf;var Q=M.x,g=M.y;return j.x=this.a*Q+this.c*g+this.tx,j.y=this.b*Q+this.d*g+this.ty,j},sq.prototype.applyInverse=function(q,L){L=L||new lf;var r=1/(this.a*this.d+this.c*-this.b),A=q.x,T=q.y;return L.x=this.d*r*A+-this.c*r*T+(this.ty*this.c-this.tx*this.d)*r,L.y=this.a*r*T+-this.b*r*A+(-this.ty*this.a+this.tx*this.b)*r,L},sq.prototype.translate=function(i,J){return this.tx+=i,this.ty+=J,this},sq.prototype.scale=function(W,k){return this.a*=W,this.d*=k,this.c*=W,this.b*=k,this.tx*=W,this.ty*=k,this},sq.prototype.rotate=function(i){var D=Math.cos(i),g=Math.sin(i),F=this.a,a=this.c,I=this.tx;return this.a=F*D-this.b*g,this.b=F*g+this.b*D,this.c=a*D-this.d*g,this.d=a*g+this.d*D,this.tx=I*D-this.ty*g,this.ty=I*g+this.ty*D,this},sq.prototype.appendTranslate=function(b,r){return this.tx+=this.a*b+this.c*r,this.ty+=this.b*b+this.d*r,this},sq.prototype.appendScale=function(W,m){return this.a*=W,this.d*=m,this.c*=m,this.b*=W,this},sq.prototype.appendRotate=function(x){if(!x)return this;var U=Math.cos(x),I=Math.sin(x),s=this.a,X=this.b;return this.a=s*U+this.c*I,this.b=X*U+this.d*I,this.c=-s*I+this.c*U,this.d=-X*I+this.d*U,this},sq.prototype.append=function(X){var G=this.a,O=this.b,M=this.c,z=this.d;return this.a=X.a*G+X.b*M,this.b=X.a*O+X.b*z,this.c=X.c*G+X.d*M,this.d=X.c*O+X.d*z,this.tx=X.tx*G+X.ty*M+this.tx,this.ty=X.tx*O+X.ty*z+this.ty,this},sq.prototype.setTransform=function(K,N,d,g,C,T,i,R,m){var I,k,r,e,b,L,w,p,f,H;return b=Math.sin(i),L=Math.cos(i),w=Math.cos(m),p=Math.sin(m),f=-Math.sin(R),H=Math.cos(R),I=L*C,k=b*C,r=-b*T,e=L*T,this.a=w*I+p*r,this.b=w*k+p*e,this.c=f*I+H*r,this.d=f*k+H*e,this.tx=K+(d*I+g*r),this.ty=N+(d*k+g*e),this},sq.prototype.prepend=function(w){var r=this.tx;if(1!==w.a||0!==w.b||0!==w.c||1!==w.d){var B=this.a,b=this.c;this.a=B*w.a+this.b*w.c,this.b=B*w.b+this.b*w.d,this.c=b*w.a+this.d*w.c,this.d=b*w.b+this.d*w.d}return this.tx=r*w.a+this.ty*w.c+w.tx,this.ty=r*w.b+this.ty*w.d+w.ty,this},sq.prototype.transform=sq.prototype.prepend,sq.prototype.invert=function(){var s=this.a,$=this.b,J=this.c,C=this.d,R=this.tx,K=s*C-$*J;return this.a=C/K,this.b=-$/K,this.c=-J/K,this.d=s/K,this.tx=(J*this.ty-C*R)/K,this.ty=-(s*this.ty-$*R)/K,this},sq.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},sq.prototype.clone=function(){var J=new sq;return J.a=this.a,J.b=this.b,J.c=this.c,J.d=this.d,J.tx=this.tx,J.ty=this.ty,J},sq.prototype.copy=function(P){return P.a=this.a,P.b=this.b,P.c=this.c,P.d=this.d,P.tx=this.tx,P.ty=this.ty,P},sq.prototype.tf=function(p,u){1===arguments.length&&(u=p.y,p=p.x);var v=this;return{x:v.a*p+v.c*u+v.tx,y:v.b*p+v.d*u+v.ty}},sq.prototype.tfi=function(s,C){1===arguments.length&&(C=s.y,s=s.x);var x=this,K=1/(x.a*x.d+x.c*-x.b);return{x:x.d*K*s+-x.c*K*C+(x.ty*x.c-x.tx*x.d)*K,y:x.a*K*C+-x.b*K*s+(-x.ty*x.a+x.tx*x.b)*K}},sq.IDENTITY=new sq,sq.TEMP_MATRIX=new sq;var ge=C.Math.Vector3=function(h,d,p){"object"==typeof h?this.copy(h):this.set(h,d==V?h:d,p==V?h:p)};c.assign(ge.prototype,{set:function(C,L,Y){return this.x=C,this.y=L,this.z=Y,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(V){return this.x=V,this},setY:function(g){return this.y=g,this},setZ:function(w){return this.z=w,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(X){return X.x===V?(this.x=X[0],this.y=X[1],this.z=X[2]):(this.x=X.x,this.y=X.y,this.z=X.z),this},add:function(L){return this.x+=L.x,this.y+=L.y,this.z+=L.z,this},addScalar:function(N){return this.x+=N,this.y+=N,this.z+=N,this},addVectors:function(Z,C){return this.x=Z.x+C.x,this.y=Z.y+C.y,this.z=Z.z+C.z,this},addScaledVector:function(F,R){return this.x+=F.x*R,this.y+=F.y*R,this.z+=F.z*R,this},sub:function(E){return this.x-=E.x,this.y-=E.y,this.z-=E.z,this},subScalar:function(l){return this.x-=l,this.y-=l,this.z-=l,this},subVectors:function(w,h){return this.x=w.x-h.x,this.y=w.y-h.y,this.z=w.z-h.z,this},multiply:function(L){return this.x*=L.x,this.y*=L.y,this.z*=L.z,this},multiplyScalar:function(V){return this.x*=V,this.y*=V,this.z*=V,this},distanceTo:function(A){return Math.sqrt(this.distanceToSquared(A))},distanceToSquared:function(M){var j=this.x-M.x,d=this.y-M.y,K=this.z-M.z;return j*j+d*d+K*K},distanceToSquared2:function(F){var i=this.x-F[0],e=this.y-F[1],j=this.z-F[2];return i*i+e*e+j*j},multiplyVectors:function(L,K){return this.x=L.x*K.x,this.y=L.y*K.y,this.z=L.z*K.z,this},transformDirection:function(J){var s=this.x,q=this.y,F=this.z,w=J.el;return this.x=w[0]*s+w[4]*q+w[8]*F,this.y=w[1]*s+w[5]*q+w[9]*F,this.z=w[2]*s+w[6]*q+w[10]*F,this.normalize()},applyQuaternion:function(q){var p=this.x,I=this.y,c=this.z,g=q._x,U=q._y,A=q._z,M=q._w,z=M*p+U*c-A*I,_=M*I+A*p-g*c,b=M*c+g*I-U*p,W=-g*p-U*I-A*c;return this.x=z*M+W*-g+_*-A-b*-U,this.y=_*M+W*-U+b*-g-z*-A,this.z=b*M+W*-A+z*-U-_*-g,this},applyMatrix4:function(o){var j=this.x,C=this.y,m=this.z,l=o.el,s=1/(l[3]*j+l[7]*C+l[11]*m+l[15]);return this.x=(l[0]*j+l[4]*C+l[8]*m+l[12])*s,this.y=(l[1]*j+l[5]*C+l[9]*m+l[13])*s,this.z=(l[2]*j+l[6]*C+l[10]*m+l[14])*s,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(M){return this.x*M.x+this.y*M.y+this.z*M.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var t=this.length();return t?this.multiplyScalar(1/t):this},setLength:function(w){return this.normalize().multiplyScalar(w)},fromArray:function(e,K){return K===V&&(K=0),this.x=e[K],this.y=e[K+1],this.z=e[K+2],this},toArray:function(R,o){return R===V&&(R=[0,0,0]),o===V&&(o=0),R[o]=this.x,R[o+1]=this.y,R[o+2]=this.z,R},cross:function(n){return this.crossVectors(this,n)},angleTo:function(I){var q=this.dot(I)/Math.sqrt(this.lengthSq()*I.lengthSq());return q>1||-1>q?0:Math.acos(q)},lerpVectors:function(q,m,B){return this.subVectors(m,q).multiplyScalar(B).add(q)},crossVectors:function(L,v){var y=L.x,g=L.y,C=L.z,j=v.x,Z=v.y,I=v.z;return this.x=g*I-C*Z,this.y=C*j-y*I,this.z=y*Z-g*j,this},min:function(A){return this.x=Math.min(this.x,A.x),this.y=Math.min(this.y,A.y),this.z=Math.min(this.z,A.z),this},max:function(F){return this.x=Math.max(this.x,F.x),this.y=Math.max(this.y,F.y),this.z=Math.max(this.z,F.z),this}});var lf=C.Math.Vector2=function(K,k,I){"object"==typeof K&&(K.x!=V?(k=K.y,K=K.x,I=K.e):(I=K[2],k=K[1],K=K[0])),this.set(K||0,k||0,I)};lf.prototype={},lf.prototype.constructor=lf,c.defineProperties(lf.prototype,{width:{get:function(){return this.x},set:function(r){this.x=r}},height:{get:function(){return this.y},set:function(F){this.y=F}}}),lf.prototype.clone=function(){return new lf(this.x,this.y,this.e)},lf.prototype.copy=function(u){return this.set(u.x,u.y,u.e),this},lf.prototype.equals=function(s){return s.x===this.x&&s.y===this.y},lf.prototype.set=function(R,T,Q){return this.x=R||0,this.y=T||(0!==T?this.x:0),Q!=V&&(this.e=Q),this},lf.prototype.setScalar=function(z){return this.x=z,this.y=z,this},lf.prototype.setX=function(F){return this.x=F||0,this},lf.prototype.setY=function(Z){return this.y=Z||0,this},lf.prototype.add=function(W){return this.x+=W.x,this.y+=W.y,this},lf.prototype.addVectors=function(n,F){return this.x=n.x+F.x,this.y=n.y+F.y,this},lf.prototype.addScalar=function(l){return this.x+=l,this.y+=l,this},lf.prototype.addScaledVector=function(Y,j){return this.x+=Y.x*j,this.y+=Y.y*j,this},lf.prototype.sub=function(q){return this.x-=q.x,this.y-=q.y,this},lf.prototype.subScalar=function(v){return this.x-=v,this.y-=v,this},lf.prototype.subVectors=function(B,_){return this.x=B.x-_.x,this.y=B.y-_.y,this},lf.prototype.multiply=function(A){return this.x*=A.x,this.y*=A.y,this},lf.prototype.multiplyScalar=function(c){return this.x*=c,this.y*=c,this},lf.prototype.divide=function(z){return this.x/=z.x,this.y/=z.y,this},lf.prototype.divideScalar=function(c){return this.multiplyScalar(1/c)},lf.prototype.min=function(k){return this.x=Math.min(this.x,k.x),this.y=Math.min(this.y,k.y),this},lf.prototype.max=function(j){return this.x=Math.max(this.x,j.x),this.y=Math.max(this.y,j.y),this},lf.prototype.fromArray=function(o,F){return F===V&&(F=0),this.x=o[F],this.y=o[F+1],this},lf.prototype.clamp=function(T,D){return this.x=Math.max(T.x,Math.min(D.x,this.x)),this.y=Math.max(T.y,Math.min(D.y,this.y)),this},lf.prototype.clampScalar=function(){var m,P;return function(d,X){return m===V&&(m=new lf,P=new lf),m.set(d,d),P.set(X,X),this.clamp(m,P)}}(),lf.prototype.clampLength=function(X,Q){var a=this.length();return this.multiplyScalar(Math.max(X,Math.min(Q,a))/a)},lf.prototype.dot=function(L){return this.x*L.x+this.y*L.y},lf.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},lf.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lf.prototype.normalize=function(){return this.divideScalar(this.length())},lf.prototype.angle=function(){var C=Math.atan2(this.y,this.x);return 0>C&&(C+=2*Math.PI),C},lf.prototype.distanceTo=function(s){return Math.sqrt(this.distanceToSquared(s))},lf.prototype.distanceToSquared=function(w){var m=this.x-w.x,T=this.y-w.y;return m*m+T*T},lf.prototype.isNearEnough=function(V){return this.distanceToSquared(V)<1e-8},lf.prototype.setLength=function(Y){var z=this.length();return z?this.multiplyScalar(Y/z):this},lf.prototype.lerp=function(v,K){return this.x+=(v.x-this.x)*K,this.y+=(v.y-this.y)*K,this},lf.prototype.lerpVectors=function(f,Q,k){return this.subVectors(Q,f).multiplyScalar(k).add(f)},lf.prototype.rotateAround=function(w,L){var G=w?w.x:0,V=w?w.y:0,i=Math.cos(L),l=Math.sin(L),p=this.x-G,v=this.y-V;return this.x=p*i-v*l+G,this.y=p*l+v*i+V,this};var Oh=C.Math.Ray=function(F,g){this.origin=F!==V?F.clone():new ge,this.direction=g!==V?g.clone():new ge};c.assign(Oh.prototype,{set:function(m,c){return this.origin.copy(m),this.direction.copy(c),this},clone:function(){return(new this.constructor).copy(this)},copy:function(V){return this.origin.copy(V.origin),this.direction.copy(V.direction),this.maxHitLen=V.maxHitLen,this},at:function(p,g){var N=g||new ge;return N.copy(this.direction).multiplyScalar(p).add(this.origin)},setMaxHitLength:function(U){this.maxHitLen=U},lookAt:function(x){return this.direction.copy(x).sub(this.origin).normalize(),this},applyMatrix4:function(u){var G=this.maxHitLen;if(G){var R=this.direction.clone().multiplyScalar(G).add(this.origin);R.applyMatrix4(u)}return this.origin.applyMatrix4(u),this.direction.transformDirection(u),G&&(this.maxHitLen=this.origin.distanceTo(R)),this},intersectBox:function(H,J){var M,B,Y,V,S,c,z=1/this.direction.x,o=1/this.direction.y,_=1/this.direction.z,w=this.origin;if(z>=0?(M=(H.min.x-w.x)*z,B=(H.max.x-w.x)*z):(M=(H.max.x-w.x)*z,B=(H.min.x-w.x)*z),o>=0?(Y=(H.min.y-w.y)*o,V=(H.max.y-w.y)*o):(Y=(H.max.y-w.y)*o,V=(H.min.y-w.y)*o),M>V||Y>B)return null;if((Y>M||M!==M)&&(M=Y),(B>V||B!==B)&&(B=V),_>=0?(S=(H.min.z-w.z)*_,c=(H.max.z-w.z)*_):(S=(H.max.z-w.z)*_,c=(H.min.z-w.z)*_),M>c||S>B)return null;if((S>M||M!==M)&&(M=S),(B>c||B!==B)&&(B=c),0>B)return null;var k=M>=0?M:B,Z=this.maxHitLen;return Z&&k>Z?null:this.at(k,J)},intersectTriangle:function(){var e=new ge,b=new ge,N=new ge,R=new ge;return function(D,d,F,u,E){b.subVectors(d,D),N.subVectors(F,D),R.crossVectors(b,N);var T,B=this.direction.dot(R);if(B>0){if(u)return null;T=1}else{if(!(0>B))return null;T=-1,B=-B}e.subVectors(this.origin,D);var z=T*this.direction.dot(N.crossVectors(e,N));if(0>z)return null;var I=T*this.direction.dot(b.cross(e));if(0>I||z+I>B)return null;var s=-T*e.dot(R);if(0>s)return null;var x=s/B,Z=this.maxHitLen;return Z&&x>Z?null:this.at(x,E)}}()});var vf=C.Math.Box3=function(y,l){this.min=y!==V?y:new ge(1/0,1/0,1/0),this.max=l!==V?l:new ge(-1/0,-1/0,-1/0)};c.assign(vf.prototype,{set:function(e,h){return this.min.copy(e),this.max.copy(h),this},setFromArray:function(e){for(var O=1/0,G=1/0,C=1/0,X=-1/0,M=-1/0,E=-1/0,o=0,t=e.length;t>o;o+=3){var Q=e[o],z=e[o+1],f=e[o+2];O>Q&&(O=Q),G>z&&(G=z),C>f&&(C=f),Q>X&&(X=Q),z>M&&(M=z),f>E&&(E=f)}return this.min.set(O,G,C),this.max.set(X,M,E),this},setFromPoints:function(v){this.makeEmpty();for(var Z=0,u=v.length;u>Z;Z++)this.expandByPoint(v[Z]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(j){return this.min.copy(j.min),this.max.copy(j.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(q){return this.min.min(q),this.max.max(q),this}});var un=C.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};c.assign(un.prototype,{set:function(N,P,H,$,Z,x,F,X,D,m,o,R,n,S,Q,W){var M=this.el;return M[0]=N,M[4]=P,M[8]=H,M[12]=$,M[1]=Z,M[5]=x,M[9]=F,M[13]=X,M[2]=D,M[6]=m,M[10]=o,M[14]=R,M[3]=n,M[7]=S,M[11]=Q,M[15]=W,this},clone:function(){return(new un).fromArray(this.el)},fromArray:function(i,T){T===V&&(T=0);for(var G=this.el,R=0;16>R;R++)G[R]=i[R+T];return this},scale:function(Q){var t=this.el,q=Q.x,h=Q.y,H=Q.z;return t[0]*=q,t[4]*=h,t[8]*=H,t[1]*=q,t[5]*=h,t[9]*=H,t[2]*=q,t[6]*=h,t[10]*=H,t[3]*=q,t[7]*=h,t[11]*=H,this},makeRotationFromEuler:function(Q){var G=this.el,z=Q._x,R=Q._y,n=Q._z,k=Q._order,g=Math.cos(z),t=Math.sin(z),Z=Math.cos(R),f=Math.sin(R),L=Math.cos(n),u=Math.sin(n);if("XYZ"===k){var w=g*L,x=g*u,X=t*L,Y=t*u;G[0]=Z*L,G[4]=-Z*u,G[8]=f,G[1]=x+X*f,G[5]=w-Y*f,G[9]=-t*Z,G[2]=Y-w*f,G[6]=X+x*f,G[10]=g*Z}else if("YXZ"===k){var r=Z*L,y=Z*u,j=f*L,_=f*u;G[0]=r+_*t,G[4]=j*t-y,G[8]=g*f,G[1]=g*u,G[5]=g*L,G[9]=-t,G[2]=y*t-j,G[6]=_+r*t,G[10]=g*Z}else if("ZXY"===k){var r=Z*L,y=Z*u,j=f*L,_=f*u;G[0]=r-_*t,G[4]=-g*u,G[8]=j+y*t,G[1]=y+j*t,G[5]=g*L,G[9]=_-r*t,G[2]=-g*f,G[6]=t,G[10]=g*Z}else if("ZYX"===k){var w=g*L,x=g*u,X=t*L,Y=t*u;G[0]=Z*L,G[4]=X*f-x,G[8]=w*f+Y,G[1]=Z*u,G[5]=Y*f+w,G[9]=x*f-X,G[2]=-f,G[6]=t*Z,G[10]=g*Z
}else if("YZX"===k){var d=g*Z,W=g*f,h=t*Z,c=t*f;G[0]=Z*L,G[4]=c-d*u,G[8]=h*u+W,G[1]=u,G[5]=g*L,G[9]=-t*L,G[2]=-f*L,G[6]=W*u+h,G[10]=d-c*u}else if("XZY"===k){var d=g*Z,W=g*f,h=t*Z,c=t*f;G[0]=Z*L,G[4]=-u,G[8]=f*L,G[1]=d*u+c,G[5]=g*L,G[9]=W*u-h,G[2]=h*u-W,G[6]=t*L,G[10]=c*u+d}return G[3]=0,G[7]=0,G[11]=0,G[12]=0,G[13]=0,G[14]=0,G[15]=1,this},makeRotationFromQuaternion:function(Q){var C=this.el,F=Q._x,k=Q._y,s=Q._z,L=Q._w,b=F+F,E=k+k,M=s+s,u=F*b,I=F*E,U=F*M,_=k*E,z=k*M,j=s*M,X=L*b,P=L*E,f=L*M;return C[0]=1-(_+j),C[4]=I-f,C[8]=U+P,C[1]=I+f,C[5]=1-(u+j),C[9]=z-X,C[2]=U-P,C[6]=z+X,C[10]=1-(u+_),C[3]=0,C[7]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(f){var d=this.el,K=f.el,l=K[0],M=K[1],R=K[2],k=K[3],P=K[4],h=K[5],B=K[6],o=K[7],a=K[8],T=K[9],s=K[10],C=K[11],u=K[12],b=K[13],E=K[14],m=K[15],I=T*E*o-b*s*o+b*B*C-h*E*C-T*B*m+h*s*m,J=u*s*o-a*E*o-u*B*C+P*E*C+a*B*m-P*s*m,O=a*b*o-u*T*o+u*h*C-P*b*C-a*h*m+P*T*m,n=u*T*B-a*b*B-u*h*s+P*b*s+a*h*E-P*T*E,Y=l*I+M*J+R*O+k*n;if(0===Y)return this.identity();var N=1/Y;return d[0]=I*N,d[1]=(b*s*k-T*E*k-b*R*C+M*E*C+T*R*m-M*s*m)*N,d[2]=(h*E*k-b*B*k+b*R*o-M*E*o-h*R*m+M*B*m)*N,d[3]=(T*B*k-h*s*k-T*R*o+M*s*o+h*R*C-M*B*C)*N,d[4]=J*N,d[5]=(a*E*k-u*s*k+u*R*C-l*E*C-a*R*m+l*s*m)*N,d[6]=(u*B*k-P*E*k-u*R*o+l*E*o+P*R*m-l*B*m)*N,d[7]=(P*s*k-a*B*k+a*R*o-l*s*o-P*R*C+l*B*C)*N,d[8]=O*N,d[9]=(u*T*k-a*b*k-u*M*C+l*b*C+a*M*m-l*T*m)*N,d[10]=(P*b*k-u*h*k+u*M*o-l*b*o-P*M*m+l*h*m)*N,d[11]=(a*h*k-P*T*k-a*M*o+l*T*o+P*M*C-l*h*C)*N,d[12]=n*N,d[13]=(a*b*R-u*T*R+u*M*s-l*b*s-a*M*E+l*T*E)*N,d[14]=(u*h*R-P*b*R-u*M*B+l*b*B+P*M*E-l*h*E)*N,d[15]=(P*T*R-a*h*R+a*M*B-l*T*B-P*M*s+l*h*s)*N,this},makeRotationAxis:function(L,Q){var T=Math.cos(Q),o=Math.sin(Q),n=1-T,D=L.x,m=L.y,c=L.z,V=n*D,b=n*m;return this.set(V*D+T,V*m-o*c,V*c+o*m,0,V*m+o*c,b*m+T,b*c-o*D,0,V*c-o*m,b*c+o*D,n*c*c+T,0,0,0,0,1),this},multiply:function(i){return this.multiplyMatrices(this,i)},premultiply:function(L){return this.multiplyMatrices(L,this)},multiplyMatrices:function(c,B){var T=c.el,D=B.el,N=this.el,u=T[0],I=T[4],Q=T[8],J=T[12],F=T[1],j=T[5],p=T[9],X=T[13],V=T[2],i=T[6],r=T[10],g=T[14],z=T[3],q=T[7],M=T[11],d=T[15],x=D[0],y=D[4],l=D[8],G=D[12],$=D[1],o=D[5],e=D[9],b=D[13],t=D[2],v=D[6],K=D[10],Y=D[14],O=D[3],R=D[7],S=D[11],W=D[15];return N[0]=u*x+I*$+Q*t+J*O,N[4]=u*y+I*o+Q*v+J*R,N[8]=u*l+I*e+Q*K+J*S,N[12]=u*G+I*b+Q*Y+J*W,N[1]=F*x+j*$+p*t+X*O,N[5]=F*y+j*o+p*v+X*R,N[9]=F*l+j*e+p*K+X*S,N[13]=F*G+j*b+p*Y+X*W,N[2]=V*x+i*$+r*t+g*O,N[6]=V*y+i*o+r*v+g*R,N[10]=V*l+i*e+r*K+g*S,N[14]=V*G+i*b+r*Y+g*W,N[3]=z*x+q*$+M*t+d*O,N[7]=z*y+q*o+M*v+d*R,N[11]=z*l+q*e+M*K+d*S,N[15]=z*G+q*b+M*Y+d*W,this},lookAt:function(){var G=new ge,C=new ge,z=new ge;return function(u,h,Q){var p=this.el;return z.subVectors(u,h),0===z.lengthSq()&&(z.z=1),z.normalize(),G.crossVectors(Q,z),0===G.lengthSq()&&(1===Math.abs(Q.z)?z.x+=1e-4:z.z+=1e-4,z.normalize(),G.crossVectors(Q,z)),G.normalize(),C.crossVectors(z,G),p[0]=G.x,p[4]=C.x,p[8]=z.x,p[1]=G.y,p[5]=C.y,p[9]=z.y,p[2]=G.z,p[6]=C.z,p[10]=z.z,this}}()});var ig=C.Math.Quaternion=function(z,S,x,v){this.set(z,S,x,v)};c.assign(ig.prototype,{set:function(e,n,d,R){var K=this;return K._x=e||0,K._y=n||0,K._z=d||0,K._w=R!==V?R:1,K},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(F){var f=this;return f._x=F._x,f._y=F._y,f._z=F._z,f._w=F._w,f},fromArray:function(L,M){M===V&&(M=0);var T=this;return T._x=L[M],T._y=L[M+1],T._z=L[M+2],T._w=L[M+3],this},slerp:function(X,p){if(0===p)return this;if(1===p)return this.copy(X);var J=this._x,h=this._y,l=this._z,v=this._w,P=v*X._w+J*X._x+h*X._y+l*X._z;if(0>P?(this._w=-X._w,this._x=-X._x,this._y=-X._y,this._z=-X._z,P=-P):this.copy(X),P>=1)return this._w=v,this._x=J,this._y=h,this._z=l,this;var L=Math.sqrt(1-P*P);if(Math.abs(L)<.001)return this._w=.5*(v+this._w),this._x=.5*(J+this._x),this._y=.5*(h+this._y),this._z=.5*(l+this._z),this;var c=Math.atan2(L,P),k=Math.sin((1-p)*c)/L,b=Math.sin(p*c)/L;return this._w=v*k+this._w*b,this._x=J*k+this._x*b,this._y=h*k+this._y*b,this._z=l*k+this._z*b,this},setFromAxisAngle:function(Y,a){var k=a/2,j=Math.sin(k);return this._x=Y.x*j,this._y=Y.y*j,this._z=Y.z*j,this._w=Math.cos(k),this},setFromEuler:function(W){var c=W._x,w=W._y,o=W._z,r=W._order,b=Math.cos,Q=Math.sin,k=b(c/2),F=b(w/2),h=b(o/2),U=Q(c/2),N=Q(w/2),L=Q(o/2);return"XYZ"===r?(this._x=U*F*h+k*N*L,this._y=k*N*h-U*F*L,this._z=k*F*L+U*N*h,this._w=k*F*h-U*N*L):"YXZ"===r?(this._x=U*F*h+k*N*L,this._y=k*N*h-U*F*L,this._z=k*F*L-U*N*h,this._w=k*F*h+U*N*L):"ZXY"===r?(this._x=U*F*h-k*N*L,this._y=k*N*h+U*F*L,this._z=k*F*L+U*N*h,this._w=k*F*h-U*N*L):"ZYX"===r?(this._x=U*F*h-k*N*L,this._y=k*N*h+U*F*L,this._z=k*F*L-U*N*h,this._w=k*F*h+U*N*L):"YZX"===r?(this._x=U*F*h+k*N*L,this._y=k*N*h+U*F*L,this._z=k*F*L-U*N*h,this._w=k*F*h-U*N*L):"XZY"===r&&(this._x=U*F*h-k*N*L,this._y=k*N*h-U*F*L,this._z=k*F*L+U*N*h,this._w=k*F*h+U*N*L),this}});var th=C.Math.Triangle=function(D,v,M){this.a=D!==V?D:new ge,this.b=v!==V?v:new ge,this.c=M!==V?M:new ge};c.assign(th,{barycoordFromPoint:function(){var L=new ge,H=new ge,V=new ge;return function(O,b,f,$,j){L.subVectors($,b),H.subVectors(f,b),V.subVectors(O,b);var _=L.dot(L),k=L.dot(H),d=L.dot(V),w=H.dot(H),I=H.dot(V),x=_*w-k*k,z=j||new ge;if(0===x)return z.set(-2,-1,-1);var R=1/x,K=(w*d-k*I)*R,Q=(_*I-k*d)*R;return z.set(1-K-Q,Q,K)}}()});var Gl=C.Math.Euler=function(q,D,o,e,E){this.set(q,D,o,e,E)};Gl.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Gl.DefaultOrder="XYZ",Gl.ReverseOrder=function(w){return w=w[2]+w[1]+w[0],w.toUpperCase()},c.defineProperties(Gl.prototype,{x:{get:function(){return this._x},set:function(M){this._x=M,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(h){this._y=h,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(q){this._z=q,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(E){this._order=E,this.onChangeCallback()}}}),c.assign(Gl.prototype,{set:function(Q,g,B,D,R){return sn(Q)&&(R=B,D=g,B=Q[2],g=Q[1],Q=Q[0]),D?R&&(D=Gl.ReverseOrder(D)):D="ZYX",this._x=Q||0,this._y=g||0,this._z=B||0,this._order=D||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(W){return this._x=W._x,this._y=W._y,this._z=W._z,this._order=W._order,this.onChangeCallback(),this},setFromRotationMatrix:function(m,Y,i){var b=C.Math.clamp,q=m.el||m,J=q[0],p=q[4],k=q[8],O=q[1],I=q[5],d=q[9],S=q[2],e=q[6],W=q[10];return Y=Y||this._order,"XYZ"===Y?(this._y=Math.asin(b(k,-1,1)),Math.abs(k)<.99999?(this._x=Math.atan2(-d,W),this._z=Math.atan2(-p,J)):(this._x=Math.atan2(e,I),this._z=0)):"YXZ"===Y?(this._x=Math.asin(-b(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(k,W),this._z=Math.atan2(O,I)):(this._y=Math.atan2(-S,J),this._z=0)):"ZXY"===Y?(this._x=Math.asin(b(e,-1,1)),Math.abs(e)<.99999?(this._y=Math.atan2(-S,W),this._z=Math.atan2(-p,I)):(this._y=0,this._z=Math.atan2(O,J))):"ZYX"===Y?(this._y=Math.asin(-b(S,-1,1)),Math.abs(S)<.99999?(this._x=Math.atan2(e,W),this._z=Math.atan2(O,J)):(this._x=0,this._z=Math.atan2(-p,I))):"YZX"===Y?(this._z=Math.asin(b(O,-1,1)),Math.abs(O)<.99999?(this._x=Math.atan2(-d,I),this._y=Math.atan2(-S,J)):(this._x=0,this._y=Math.atan2(k,W))):"XZY"===Y?(this._z=Math.asin(-b(p,-1,1)),Math.abs(p)<.99999?(this._x=Math.atan2(e,I),this._y=Math.atan2(k,J)):(this._x=Math.atan2(-d,W),this._y=0)):console.warn("unsupported order: "+Y),this._order=Y,i!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var I=new un;return function(T,f,$){return I.makeRotationFromQuaternion(T),this.setFromRotationMatrix(I,f,$)}}(),setFromVector3:function(o,C){return this.set(o.x,o.y,o.z,C||this._order)},reorder:function(){var $=new ig;return function(a){return $.setFromEuler(this),this.setFromQuaternion($,a)}}(),equals:function(G){return G._x===this._x&&G._y===this._y&&G._z===this._z&&G._order===this._order},fromArray:function(y){return this._x=y[0],this._y=y[1],this._z=y[2],y[3]!==V&&(this._order=y[3]),this.onChangeCallback(),this},toArray:function(v,d){return v===V&&(v=[]),d===V&&(d=0),v[d]=this._x,v[d+1]=this._y,v[d+2]=this._z,v[d+3]=this._order,v},toVector3:function(p){return p?p.set(this._x,this._y,this._z):new ge(this._x,this._y,this._z)},onChange:function(y){return this.onChangeCallback=y,this},onChangeCallback:function(){}});var pq=C.List=function(){this._as=[];var w,e,J=arguments.length;if(1===J){var K=arguments[0];if(Zq(K)&&(K=K._as),sn(K))for(e=K.length,w=0;e>w;w++)this._as.push(K[w]);else K!=k&&this._as.push(K)}else if(J>1)for(w=0;J>w;w++)this._as.push(arguments[w])};zo("List",c,{forEach:function(t,W){this.each(t,W)},push:function(){for(var $=0;$<arguments.length;$++)this.add(arguments[$])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(Q,c){return c===V?this._as.push(Q):this._as.splice(c,0,Q)},addAll:function(j){Zq(j)&&(j=j._as),sn(j)?ke(this._as,j):this._as.push(j)},get:function(v){return this._as[v]},slice:function(r,b){return new pq(this._as.slice(r,b))},remove:function(Z){var G=this._as.indexOf(Z);return G>=0&&G<this._as.length&&this.removeAt(G),G},removeAt:function(X){return this._as.splice(X,1)[0]},set:function(s,J){return this._as[s]=J},clear:function(){return this._as.splice(0,this._as.length)},contains:function(w){return this._as.indexOf(w)>=0},indexOf:function(G){return this._as.indexOf(G)},each:function(s,K){for(var e=0,E=this._as.length;E>e;e++){var f=this._as[e];K?s.call(K,f,e,this):s(f,e,this)}},reverseEach:function(q,z){for(var R=this._as.length-1;R>=0;R--){var I=this._as[R];z?q.call(z,I):q(I)}},toArray:function(O,y){if(O){for(var p,k=[],N=0,d=this._as.length;d>N;N++)p=this._as[N],y?O.call(y,p)&&k.push(p):O(p)&&k.push(p);return k}return this._as.concat()},toList:function(s,y){if(s){for(var a,Z=new pq,I=0,R=this._as.length;R>I;I++)a=this._as[I],y?s.call(y,a)&&Z.add(a):s(a)&&Z.add(a);return Z}return new pq(this)},reverse:function(){this._as.reverse()},sort:function(w){return this._as.sort(w?w:hb),this},toString:function(){return this._as.toString()}}),c.defineProperties(pq.prototype,{length:{get:function(){return this._as.length},set:function(K){this._as.length=K}}});var kb=new pq;fs(kb,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:ql,each:ql,reverseEach:ql,toArray:function(){return[]},toList:function(){return new pq},add:He,addAll:He,set:He,remove:He,removeAt:He,clear:He});var mq=C.Notifier=function(){this._f=0};zo("Notifier",c,{contains:function(k,b){if(this._ls)for(var P,g=0,r=this._ls.size();r>g;g++)if(P=this._ls.get(g),k===P.l&&b===P.s)return!0;return!1},add:function(H,E,D){var X=this,n={l:H,s:E,a:D};X._ls||(X._ls=new pq),X._f?(X._as||(X._as=new pq),X._as.add(n)):n.a?X._ls.add(n,0):X._ls.add(n)},remove:function(o,c){var t=this;t._ls&&(t._f?(t._rs||(t._rs=new pq),t._rs.add({l:o,s:c})):t._remove(o,c))},_remove:function(e,O){for(var M,y=this._ls,w=0,A=y.size();A>w;w++)if(M=y.get(w),M.l===e&&M.s===O)return y.removeAt(w),void 0},fire:function(U){var $=this,A=$._ls;if($._b=1e4,A){++$._f;try{for(var C,J=0,e=A.size();e>J;J++)C=A.get(J),C.s?C.l.call(C.s,U):C.l(U)}finally{if(--$._f)return;if($._rs){for(e=$._rs.size(),J=0;e>J;J++)C=$._rs.get(J),$._remove(C.l,C.s);delete $._rs}if($._as){for(e=$._as.size(),J=0;e>J;J++)C=$._as.get(J),C.a?A.add(C,0):A.add(C);delete $._as}}}}});var Sk=C.Data=function(){this._id=No()};zo("Data",c,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:k,_parent:k,_children:kb,_childMap:k,_styleMap:k,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return k},_22Q:function(){return k},s:function(V,Z){var X=this;if(2===arguments.length)X.setStyle(V,Z);else{if(!wb(V))return X.getStyle(V);for(var v in V)X.setStyle(v,V[v])}return X},fp:function(_,S,i,r,q){return this.firePropertyChange(_,S,i,r,q)},firePropertyChange:function(y,t,G,z,r){if(z){if(z(t,G))return!1}else if(t===G)return!1;var A=this,q=r||{};return q.property=y,q.oldValue=t,q.newValue=G,q.data=A,A._dataModel&&A._dataModel.handleDataPropertyChange(q),A.onPropertyChanged(q),!0},onPropertyChanged:function(N){var e=this,i=e._parent,n=N.property;if(Qb(i)){var f=e.s(Jj),u="s:ingroup"===n;(f&&Al[n]||n===u)&&i._81I(),(f||u)&&i.fp("childChange",!0,!1)}Tm(i)&&Al[n]&&i.updateFromChildren()},_21I:function(Q){var F=this;if(Q&&F._dataModel)throw"Remove data from dataModel before adding";F._dataModel=Q},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var h=0,S=this._children.toArray(),C=S.length;C>h;h++)S[h].removeFromDataModel()},getId:function(){return this._id},setId:function(e){this._id=e},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(d,H){return this._children.toList(d,H)},eachChild:function(D,P){this._children.each(D,P)},addChild:function(m,s){var h=this;m!==h&&(h._children===kb&&(h._children=new pq,h._childMap={}),s>=0||(s=h._children.size()),h._childMap[m._id]||h.isDescendantOf(m)||(m._parent&&m._parent.removeChild(m),(0>s||s>h._children.size())&&(s=h._children.size()),h._children.add(m,s),h._childMap[m._id]=m,m.setParent(h),h.onChildAdded(m,s),h.fp(td,k,m)))},onChildAdded:function(){},removeChild:function(q){var n=this;if(n._childMap&&n._childMap[q._id]){var e=n._children.remove(q);delete n._childMap[q._id],n.fp(td,q,k),q.setParent(k,e),n.onChildRemoved(q,e)}},onChildRemoved:function(){},getChildAt:function(m){return this._children.get(m)},clearChildren:function(){var t=this;if(!t._children.isEmpty())for(var h=0,f=t._children.toArray(),l=f.length;l>h;h++)t.removeChild(f[h])},getParent:function(){return this._parent},setParent:function(j,U){var N=this;if(!(N._73I||N._parent===j||N===j||j&&j.isDescendantOf(N))){var S,c=N._parent;N._parent=j,N._73I=1,c?(U==k&&(U=c.getChildren().indexOf(N)),c.removeChild(N)):N._dataModel&&U==k&&(U=N._dataModel.getRoots().indexOf(N)),j&&(j.addChild(N),S=j.getChildren().indexOf(N)),delete N._73I,N.fp("parent",c,j,V,{oldIndex:U,newIndex:S}),N.onParentChanged(c,j)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(C){return C?this.isDescendantOf(C)||C.isDescendantOf(this):!1},isParentOf:function(g){return g&&this._childMap?!!this._childMap[g._id]:!1},isDescendantOf:function(b){if(!b||b.isEmpty())return!1;for(var q=this._parent;q;){if(b===q)return!0;q=q._parent}return!1},getStyle:function(K,u){u===V&&(u=1);var k=this._styleMap?this._styleMap[K]:V;return k===V&&u?_[K]:k},setStyle:function(D,e){var N=this;N._styleMap||(N._styleMap={});var t=N._styleMap[D];e===V?delete N._styleMap[D]:N._styleMap[D]=e,N.fp("s:"+D,t,e)&&N.onStyleChanged(D,t,e)},onStyleChanged:function(){},iv:function(W){this.invalidate(W)},invalidate:function(u){this.fp(u||"*",!1,!0)},toString:function(){var s=this;return s._displayName||s._name||s._tag||s._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(Y,M){var v=this,t=v.s(wf);t||v.s(wf,t={}),M?t[Y]=M:delete t[Y],v.fp(wf,k,t)},removeStyleIcon:function(C){var s=this.s(wf);if(s){var P=s[C];delete s[C],this.fp(wf,k,s)}return P},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var r,b={};for(r in this._styleMap)b[r]=1;return b}});var $b=C.DataModel=function(){var m=this;m._datas=new pq,m._dataMap={},m._roots=new pq,m._rootMap={},m._fsDataMap={},m._78O={},m._36I=new mq,m._35I=new mq,m._serializeNotifier=new mq,m._selectionModel=new bj(m);var i=m._29Q=[],T=m._scheduleCallback=function(){for(var L=Date.now(),n=0;n<i.length;n++){var g=i[n];g.enabled&&L-g.lastTime>g.interval&&(g.beforeAction&&g.beforeAction(),m.each(function($){g.action($)}),g.afterAction&&g.afterAction(),g.lastTime=L)}i.length&&(m._30Q=B.requestAnimationFrame(T))}};zo("DataModel",c,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:V,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:V,_init:V,_envmap:V,_postProcessingData:V,sm:function(){return this.getSelectionModel()},mm:function(e,W,U){this.addDataModelChangeListener(e,W,U)},umm:function(V,i){this.removeDataModelChangeListener(V,i)},md:function(B,g,y){this.addDataPropertyChangeListener(B,g,y)},umd:function(T,N){this.removeDataPropertyChangeListener(T,N)},mh:function(E,R,o){this.addHierarchyChangeListener(E,R,o)},umh:function(h,k){this.removeHierarchyChangeListener(h,k)},getAttrObject:function(){return this._attrObject},setAttrObject:function(j){return this._attrObject=j},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(p){return this._dataMap[p]},removeDataById:function(e){this.remove(this.getDataById(e))},toDatas:function(U,s){return this._datas.toList(U,s)},each:function(p,B){this._datas.each(p,B)},getDataByTag:function(I){return this._78O[I]},getTagMap:function(){return this._78O},removeDataByTag:function(s){this.remove(this.getDataByTag(s))},add:function(b,J,K){var G=this,h=b._id,i=b._tag,j=G._roots;if(G._dataMap[h])throw"'"+h+"' already exists";i!=k&&(G._78O[i]=b),G._dataMap[h]=b,K>=0?G._datas.add(b,K):G._datas.add(b),b._parent||(G._rootMap[h]=b,J>=0?j.add(b,J):j.add(b)),b.s("fullscreen")!==V&&(G._fsDataMap[h]=b),b._21I(G),G.onAdded(b),G._36I.fire({kind:"add",data:b,rootsIndex:J,datasIndex:K})},onAdded:function(){},remove:function(D,B){if(D){var L=this,n=D._id,V=B&&B.keepStructure,o=B&&B.keepChildren,A=D.getTag();if(D._dataModel===L){this.beginTransaction(),V?L._removingData||(L._removingData=D):L.prepareRemove(D),o||D.toChildren().each(function(o){L.remove(o,B)},L),V?L._removingData===D&&(D._parent&&D._parent.removeChild(D),delete L._removingData):D._parent&&D._parent.removeChild(D);var c=L._datas.remove(D);delete L._dataMap[n],A!=k&&delete L._78O[A];var J;L._rootMap[n]&&(delete L._rootMap[n],J=L._roots.remove(D)),L._fsDataMap[n]&&delete L._fsDataMap[n],D._21I(k),L.onRemoved(D),L._36I.fire({kind:ro,data:D,rootsIndex:J,datasIndex:c}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var i=this;if(i._datas.size()){var L=i._historyManager?this.toJSON():V;i._datas.toArray().forEach(function(w){w._21I(k)}),i._datas.clear(),i._dataMap={},i._roots.clear(),i._rootMap={},i._fsDataMap={},i._78O={},i._36I.fire({kind:Ef,json:L})}},contains:function(Q){return Q&&Q._dataModel===this},handleDataPropertyChange:function(i){var P=this,u=i.data,s=i.property;if("parent"===s){var c=u._id,p=P._rootMap,n=P._roots;u._parent?p[c]&&(delete p[c],n.remove(u)):p[c]||(p[c]=u,n.add(u))}else if("tag"===s){var L=i.oldValue,h=i.newValue,J=P._78O;L!=k&&delete J[L],h!=k&&(J[h]=u)}else if("s:fullscreen"===s){var c=u._id,w=P._fsDataMap;i.oldValue!=k&&delete w[c],i.newValue!=k&&(w[c]=u)}this.onDataPropertyChanged(u,i),this._35I.fire(i)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(e,Q,T){this._36I.add(e,Q,T)},removeDataModelChangeListener:function(P,S){this._36I.remove(P,S)},addSerializeListener:function(b,W,s){this._serializeNotifier.add(b,W,s)},removeSerializeListener:function($,N){this._serializeNotifier.remove($,N)},fireSerializeEvent:function(i){this._serializeNotifier.fire(i)},addDataPropertyChangeListener:function(b,l,D){this._35I.add(b,l,D)},removeDataPropertyChangeListener:function(k,N){this._35I.remove(k,N)},_38I:function(k,_,u){this._37I&&this._37I.fire({data:k,oldIndex:_,newIndex:u})},addHierarchyChangeListener:function(D,G,k){this._37I||(this._37I=new mq),this._37I.add(D,G,k)},removeHierarchyChangeListener:function(P,u){this._37I.remove(P,u)},getSiblings:function(X){var C=X._parent;return C?C._children:this._roots},eachByHierarchical:function(F,z,P){if(z)return this._eachByHierarchical(F,z,P);for(var s=0,S=this._roots,K=S.size();K>s;s++)if(this._eachByHierarchical(F,S.get(s),P)===!1)return!1;return!0},_eachByHierarchical:function(R,S,k){if(k){if(R.call(k,S)===!1)return!1}else if(R(S)===!1)return!1;for(var P=S.size(),m=0;P>m;m++)if(this._eachByHierarchical(R,S.getChildAt(m),k)===!1)return!1;return!0},reverseEachByHierarchical:function(h,i,c){if(i)return this._reverseEachByHierarchical(h,i,c);for(var v=this._roots,O=v.size(),G=O-1;G>=0;G--)if(this._reverseEachByHierarchical(h,v.get(G),c)===!1)return!1;return!0},_reverseEachByHierarchical:function(X,Q,J){for(var D=Q.size(),T=D-1;T>=0;T--)if(this._reverseEachByHierarchical(X,Q.getChildAt(T),J)===!1)return!1;if(J){if(X.call(J,Q)===!1)return!1}else if(X(Q)===!1)return!1;return!0},eachByDepthFirst:function(N,e,E){if(e)return this._11I(N,e,E);for(var y=0,j=this._roots,Y=j.size();Y>y;y++)if(this._11I(N,j.get(y),E)===!1)return!1;return!0},_11I:function(c,J,m){for(var F=J.size(),k=0;F>k;k++)if(this._11I(c,J.getChildAt(k),m)===!1)return!1;if(m){if(c.call(m,J)===!1)return!1}else if(c(J)===!1)return!1;return!0},eachByBreadthFirst:function(s,u,r){var Q=new pq;for(u?Q.add(u):this._roots.each(Q.add,Q);Q.size()>0;)if(u=Q.removeAt(0),u.eachChild(Q.add,Q),r){if(s.call(r,u)===!1)return!1}else if(s(u)===!1)return!1;return!0},moveTo:function(S,D){var Q=this.getSiblings(S),d=Q.indexOf(S);d===D||0>d||D>=0&&D<=Q.size()&&(Q.remove(S),D>Q.size()&&D--,Q.add(S,D),this._38I(S,d,D))},moveUp:function(w){this.moveTo(w,this.getSiblings(w).indexOf(w)-1)},moveDown:function(J){this.moveTo(J,this.getSiblings(J).indexOf(J)+1)},moveToTop:function(D){this.moveTo(D,0)},moveToBottom:function(d){this.moveTo(d,this.getSiblings(d).size())},moveSelectionUp:function(o){this.beginTransaction(),o||(o=this.sm());var O=new pq;Qr(o,O,this._roots),O.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(k){this.beginTransaction(),k||(k=this.sm());var G=new pq;cm(k,G,this._roots),G.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(X){this.beginTransaction(),X||(X=this.sm());var s=new pq;tl(X,s,this._roots),s.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(x){this.beginTransaction(),x||(x=this.sm());var F=new pq;Ob(x,F,this._roots),F.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(w,g,a){var o=this.getDatas();null==a&&(a=o.indexOf(w)),a===g||0>a||g>=0&&g<=o.size()&&(o.remove(w),g>o.size()&&g--,o.add(w,g),this._76I(w,a,g))},bringForward:function(H){this.moveToIndex(H,this.getDatas().indexOf(H)+1)},bringToFront:function(q){this.moveToIndex(q,this.size())},sendBackward:function(s){this.moveToIndex(s,this.getDatas().indexOf(s)-1)},sendToBack:function(s){this.moveToIndex(s,0)},bringSelectionForward:function(l){this.beginTransaction(),l||(l=this.sm());for(var c=new pq,w=this.getDatas(),G=!1,v=0;v<w.size();v++){var Z=w.get(w.size()-1-v);l.contains(Z)?G&&c.add(Z):G=!0}c.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(w){this.beginTransaction(),w||(w=this.sm());for(var E=new pq,y=this.getDatas(),c=0;c<y.size();c++){var e=y.get(c);w.contains(e)&&E.add(e)}E.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(W){this.beginTransaction(),W||(W=this.sm());for(var d=new pq,T=this.getDatas(),l=!1,H=0;H<T.size();H++){var b=T.get(H);W.contains(b)?l&&d.add(b):l=!0}d.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(W){this.beginTransaction(),W||(W=this.sm());for(var C=new pq,h=this.getDatas(),v=0;v<h.size();v++){var j=h.get(h.size()-1-v);W.contains(j)&&C.add(j)}C.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(u){var Y=this;Y.removeScheduleTask(u),u.enabled==k&&(u.enabled=!0),u.interval==k&&(u.interval=10),u.action==k&&(u.action=ql),u.lastTime=Date.now(),Y._29Q.push(u),Y._30Q==k&&(Y._30Q=B.requestAnimationFrame(Y._scheduleCallback))},removeScheduleTask:function(I){var n=this,r=n._29Q,H=r.indexOf(I);H>=0&&r.splice(H,1),r.length||n._30Q==k||(B.cancelAnimationFrame(n._30Q),delete n._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function($){this._historyManager||new C.HistoryManager(this),null!=$&&this._historyManager.setMaxHistoryCount($),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(P){this._historyManager&&this._historyManager.undo(P)},redo:function(G){this._historyManager&&this._historyManager.redo(G)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(F){this._historyManager&&this._historyManager.addHistory(F)},onHistoryManagerChanged:function(){}});var bj=C.SelectionModel=function(W){var y=this;y._68O=Je,y._map={},y._73O=new pq,y._74I=new mq,y._21I(W)};zo("SelectionModel",c,{ms_fire:1,ms_dm:1,ms:function(j,y,Z){this.addSelectionChangeListener(j,y,Z)},ums:function(r,E){this.removeSelectionChangeListener(r,E)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Hj},co:function(H){return this._map[H._id]!=k},ss:function(j){this.setSelection(j)},as:function(x){this.appendSelection(x)},rs:function(l){this.removeSelection(l)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(n){var S=this;if(S._68O!==n&&(n===yp||n===Hj||n===Je)){S.cs();var R=S._68O;S._68O=n,S.fp("selectionMode",R,n)}},_21I:function(R){var V=this,d=V._dataModel;d!==R&&(d&&(V.cs(),d.umm(V.handleDataModelChange,V)),V._dataModel=R,R.mm(V.handleDataModelChange,V,!0),V.fp(Jc,d,R))},dispose:function(){var f=this;f.cs(),f._dataModel.umm(f.handleDataModelChange,f)},handleDataModelChange:function(l){var j=this;if(l.kind===ro){var N=l.data;j.co(N)&&(j._73O.remove(N),delete j._map[N._id],j._75I(ro,new pq(N)))}else l.kind===Ef&&j.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(A){var V=this;if(V._filterFunc!==A){V.cs();var J=V._filterFunc;V._filterFunc=A,V.fp("filterFunc",J,V._filterFunc)}},_75I:function(j,K,W,P){W&&(this._73O.each(function(_){P[_._id]?W.remove(_):W.add(_)}),K=W.toList()),this._74I.fire({kind:j,datas:new pq(K)})},addSelectionChangeListener:function(q,m,I){this._74I.add(q,m,I)},removeSelectionChangeListener:function(S,R){this._74I.remove(S,R)},_97O:function($,L){for(var j,b=this,i=0,H=new pq($);i<H.size();i++)j=H.get(i),(b._filterFunc&&!b._filterFunc(j)||L&&b.co(j)||!L&&!b.co(j)||!b._dataModel.contains(j))&&(H.removeAt(i),i--);return H},appendSelection:function(Z){var P=this;if(P._68O!==yp){var u,B,O=P._73O,f=P._97O(Z,!0);f.isEmpty()||(P.sg()&&(u=new pq(O),B=P._map,O.clear(),P._map={},f=new pq(f.get(f.size()-1))),f.each(function(W){O.add(W),P._map[W._id]=W}),P._75I("append",f,u,B))}},removeSelection:function(l){var m=this,T=m._97O(l),q=0,O=T.size();if(0!==O){for(;O>q;q++){var A=T.get(q);m._73O.remove(A),delete m._map[A._id]}m._75I(ro,T)}},toSelection:function(G,Q){return this._73O.toList(G,Q)},getSelection:function(){return this._73O},each:function(X,z){this._73O.each(X,z)},setSelection:function(J){var A=this,x=A._73O;if(A._68O!==yp&&!(x.isEmpty()&&!J||1===x.size()&&A.ld()===J)){var a=new pq(x),f=A._map;x.clear(),A._map={};var Y=A._97O(J,!0);A.sg()&&Y.size()>1&&(Y=new pq(Y.get(Y.size()-1))),Y.each(function(r){x.add(r),A._map[r._id]=r}),A._75I("set",k,a,f)}},clearSelection:function(){var w=this,T=w._73O;if(T.size()>0){var M=T.toList();T.clear(),w._map={},w._75I(Ef,M)}},selectAll:function(){var q=this;if(q._68O!==yp){var D,c,x=q._dataModel.toDatas();if(q._filterFunc)for(D=0;D<x.size();D++)c=x.get(D),q._filterFunc(c)||(x.removeAt(D),D--);var a=q._73O,z=new pq(a),W=q._map;a.clear(),q._map={},q.sg()&&x.size()>1&&(x=new pq(x.get(x.size()-1)));var d=x.size();for(D=0;d>D;D++)c=x.get(D),a.add(c),q._map[c._id]=c;q._75I("all",k,z,W)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(s){return this._map[s._id]!=k},getLastData:function(){var D=this._73O;return D.size()>0?D.get(D.size()-1):k},getFirstData:function(){var v=this._73O;return v.size()>0?v.get(0):k},isSelectable:function(j){var Q=this;return j&&Q._68O!==yp?Q._filterFunc?Q._filterFunc(j):!0:!1},getTopSelection:function(){var i=this,r=new pq;return i._73O.each(function(G){for(var B=G.getParent();B;){if(i.contains(B)){G=k;break}B=B.parent}G&&r.add(G)}),r}});var Fn=function(){return zb(0),function(X,q){var u;if(Kl(q)){var A=X.getDataUI(q);A&&A._88I&&(u=A._88I.rect)}return u?u:q.getRect()}}();fs(I,{edgeGroupAgentFunc:k,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:X.rectSelectBorder,graphViewRectSelectBackground:qp,graphViewEditPointSize:uh?17:7,graphViewEditPointBorderColor:X.editPointBorder,graphViewEditPointBackground:X.editPointBackground,setEdgeType:function(d,S,p){tk[d]=S,uf[d]=p},getEdgeType:function(h){return tk[h]},getEdgeTypeMap:function(){return tk},getNodeRect:Fn},!0),fs(_,{layout:!1,"layout.h":V,"layout.h.value":V,"layout.v":V,"layout.v.value":V,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":V,interactive:!1,"image.stretch":"fill",icons:V,ingroup:!0,"body.color":V,"2d.gray":!1,fullscreen:V,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:V,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":jd,"select.width":1,"select.padding":2,"select.type":Xd,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":V,"border.width":2,"border.padding":2,"border.type":Xd,label:V,"label.font":V,"label.color":zn,"label.background":V,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":V,"label.max":V,"label.opacity":V,"label.scale":1,"label.align":V,"label.selectable":!0,label2:V,"label2.font":V,"label2.color":zn,"label2.background":V,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":V,"label2.max":V,"label2.opacity":V,"label2.scale":1,"label2.align":V,"label2.selectable":!0,note:V,"note.expanded":!0,"note.font":V,"note.color":ls,"note.background":jd,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":V,"note.toggleable":!0,"note.border.width":1,"note.border.color":V,"note.opacity":V,"note.scale":1,"note.align":V,note2:V,"note2.expanded":!0,"note2.font":V,"note2.color":ls,"note2.background":jd,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":V,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":V,"note2.opacity":V,"note2.scale":1,"note2.align":V,"group.type":V,"group.image":V,"group.image.stretch":"fill","group.repeat.image":V,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":V,"group.title.color":ls,"group.title.background":X.groupTitleBackground,"group.title.align":fq,"group.title.orientation":Bp,"group.background":X.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":V,"group.border.color":Lo,"group.border.radius":0,"group.border.cap":Ad,"group.border.join":Eb,"group.splitLine":!1,"group.gradient":k,"group.gradient.color":"#FFF",shape:V,"shape.background":Lo,"shape.repeat.image":V,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Lo,"shape.border.3d":!1,"shape.border.3d.color":V,"shape.border.3d.accuracy":V,"shape.border.cap":Ad,"shape.border.join":Eb,"shape.border.pattern":V,"shape.gradient":k,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":af,"shape.dash.offset":0,"shape.dash.color":ph,"shape.dash.width":V,"shape.dash.3d":!1,"shape.dash.3d.color":V,"shape.dash.3d.accuracy":V,"shape.polygon.side":6,"shape.arc.from":K,"shape.arc.to":o,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":V,"shape.gradient.pack":V,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":V,"shape.foreground.gradient":k,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":V,"autolayout.hgap":V,"autolayout.vgap":V,"edge.type":V,"edge.points":V,"edge.segments":V,"edge.color":Lo,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":V,"edge.3d.accuracy":V,"edge.cap":Ad,"edge.join":Eb,"edge.source.position":17,"edge.source.anchor.x":V,"edge.source.anchor.y":V,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":V,"edge.target.anchor.y":V,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":V,"edge.dash":!1,"edge.dash.pattern":af,"edge.dash.offset":0,"edge.dash.color":ph,"edge.dash.width":V,"edge.dash.3d":!1,"edge.dash.3d.color":V,"edge.dash.3d.accuracy":V,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":V,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":V,"grid.column.percents":V,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":X.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":X.gridCellBorderColor,"grid.block":V,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":X.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":zn,"text.font":sd,"text.shadow":!1,"text.shadow.color":jd,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),fs($b,{_76I:function(i,m,P){this._39I&&this._39I.fire({data:i,oldIndex:m,newIndex:P})
},addIndexChangeListener:function(O,u,L){var b=this;b._39I||(b._39I=new mq),b._39I.add(O,u,L)},removeIndexChangeListener:function(o,u){this._39I.remove(o,u)},prepareRemove:function(a){hk(a)&&(a.setSource(k),a.setTarget(k)),a._70O&&a._70O.toList().each(this.remove,this),a._69O&&a._69O.toList().each(function(A){A.setHost(k)}),a._host&&a.setHost(k)},onAdded:function(u){this.isAutoAdjustIndex()&&this.adjustIndex(u)},onDataPropertyChanged:function(G,y){Ff[y.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(G)},isAdjustable:function(n){return tn(n)||hk(n)},isAdjustedToBottom:function(Z){return Qb(Z)?Z.isExpanded()&&Gr(Z):!1},adjustIndex:function(E){var n=this;this.isHierarchicalRendering()||(n.isAdjustedToBottom(E)?(n.sendToBottom(E),E.eachChild(n.adjustIndex,n)):n.sendToTop(E))},sendToTop:function(L){var m=this;if(m.contains(L)&&m.isAdjustable(L)){var S=m._datas;if(L!==S.get(m.size()-1)){var F=S.indexOf(L);S.removeAt(F),S.add(L),m._76I(L,F,m.size()-1)}if(hk(L)){var c=L._40I;c&&!m.isAdjustedToBottom(c)&&m.sendToTop(c),c=L._41I,c&&!m.isAdjustedToBottom(c)&&m.sendToTop(c)}L._69O&&L._69O.each(function(I){I.isRelatedTo(L)||tn(L)&&I.isLoopedHostOn(L)||m.sendToTop(I)}),L.ISubGraph||(!Qb(L)||L.isExpanded())&&L._adjustChildrenToTop&&L.eachChild(function(_){hk(_)||m.sendToTop(_)})}},sendToBottom:function(U,o){var E=this;if(U!==o&&E.contains(U)&&E.isAdjustable(U)&&(!o||E.contains(o))){var D=E._datas,s=D.remove(U),d=o?E._datas.indexOf(o):0;if(D.add(U,d),s!==d){E._76I(U,s,d);var A=U._parent;!A||A.ISubGraph||hk(A)||E.sendToBottom(U._parent,U)}}}}),fs(bi,{ms_edit:function(w){w._46O=function(v){var d=this,Q=d.gv.dm(),O=d._index,A=d._89I,t=d._node,n=d._shape,h=d._edge,$=d._77I;t&&A?(this.fi({kind:"endEditRect",event:v,data:t,direction:A}),Q.endTransaction()):n&&O>=0?(d.fi({kind:"endEditPoint",event:v,data:n,index:O}),Q.endTransaction()):h&&O>=0?(d.fi({kind:"endEditPoint",event:v,data:h,index:O}),Q.endTransaction()):$&&(d.fi({kind:"endEditRotation",event:v,data:$}),Q.endTransaction())},w._78I=function(Z){var c=this;c.autoScroll(Z);var H=c.gv.lp(Z),X=c._index,g=c._89I,z=c._node,f=c._shape,u=c._edge,n=c._77I;if(z&&g)c._80O(H),c.fi({kind:"betweenEditRect",event:Z,data:z,direction:g});else if(f&&X>=0)H.e=f.getPoints().get(X).e,f.setPoint(X,H),c.fi({kind:"betweenEditPoint",event:Z,data:f,index:X});else if(u&&X>=0){var Q=u.s(ee);H.e=Q.get(X).e,Q.set(X,H),u.fp(ee,k,Q),c.fi({kind:"betweenEditPoint",event:Z,data:u,index:X})}else if(n){var G=n.p(),Y=n.getScale(),m=r+q(H.y-G.y,H.x-G.x);Y.y<0&&(m+=K),F(m)<.04&&(m=0),n.setRotation(m),c.fi({kind:"betweenEditRotation",event:Z,data:n})}},w._80O=function(K){var i=this,k=i._node,j=i._rect,h=j.x,D=j.y,u=j.width,l=j.height,n=i._89I,V=i._anchor,M=i._matrix,K=M.tfi(K);"northwest"===n?j=Fd(K,{x:h+u,y:D+l}):n===Ck?j=Fd({x:h,y:K.y},{x:h+u,y:D+l}):"northeast"===n?j=Fd({x:h,y:K.y},{x:K.x,y:D+l}):n===Vj?j=Fd({x:K.x,y:D},{x:h+u,y:D+l}):n===ih?j=Fd({x:h,y:D},{x:K.x,y:D+l}):"southwest"===n?j=Fd({x:K.x,y:D},{x:h+u,y:K.y}):"south"===n?j=Fd({x:h,y:D},{x:h+u,y:K.y}):"southeast"===n&&(j=Fd({x:h,y:D},K)),k.setPosition(M.tf(j.x+j.width*V.x,j.y+j.height*V.y)),k.setWidth(j.width),k.setHeight(j.height)},w._80I=function(l,y,f,U){var o=this,E=o.gv._zoom,s=(o.gv.getEditPointSize()+2)/E;return Wi({x:y-s/2,y:f-s/2,width:s,height:s},l)?(o._89I!==U&&(o._89I=U),!0):!1},w._79I=function(A,Q,K){var x=this,q=x.gv,y=Q?q.getDataUI(Q):k,M=y?y._55O:k;if(M){var b,j,C,O,f=q._zoom,t=(q.getEditPointSize()+2)/f,X=q.lp(A);if(tn(Q)){if(M._56O&&tn(Q)&&(j=M._98o,Wi({x:j.x-t/2,y:j.y-t/2,width:t,height:t},X)))return x._77I=Q,K&&x.fi({kind:"beginEditRotation",event:A,data:Q}),x.setCursor("crosshair"),!0;if(M._43O&&Q instanceof ld)for(C=Q.getPoints(),b=C.size()-1;b>=0;b--)if(j=C.get(b),Wi({x:j.x-t/2,y:j.y-t/2,width:t,height:t},X))return x._index=b,x._shape=Q,K&&x.fi({kind:"beginEditPoint",event:A,data:Q,index:b}),x.setCursor("crosshair"),!0;if(M._42O)for(var _=Q.getEditControlPoints(),N=["northwest",-1,-1,Vj,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,ih,1,0,"northeast",1,-1,Ck,0,-1],b=0,O=_.length;O>b;b++){var i=N[3*b],Z=_[b];if(x._80I(X,Z.x,Z.y,i)){x._node=Q;var T=Q.getWidth(),a=Q.getHeight(),V=Q.getAnchor();x._rect={x:-T*V.x,y:-a*V.y,width:T,height:a},x._anchor=V,x._matrix=Q.getMatrix();var h=Q.getRotation(),u=P(h),S=e(h),p=N[3*b+1]*Pf(Q.getScale().x),J=N[3*b+2]*Pf(Q.getScale().y),m=Math.atan2(-S*p-u*J,u*p-S*J),F=(Math.round(m/(Math.PI/4))+8)%8,Y=[rf,"nesw-resize",Pr,"nwse-resize",rf,"nesw-resize",Pr,"nwse-resize"][F];return x.setCursor(Y),K&&x.fi({kind:"beginEditRect",event:A,data:Q,direction:x._89I}),!0}}}if(M._43O&&hk(Q)&&Q.s(fp)===Rh&&(C=Q.s(ee)))for(b=C.size()-1;b>=0;b--)if(j=C.get(b),Wi({x:j.x-t/2,y:j.y-t/2,width:t,height:t},X))return x._index=b,x._edge=Q,K&&x.fi({kind:"beginEditPoint",event:A,data:Q,index:b}),x.setCursor("crosshair"),!0}return!1}},ms_gv:function($){$._currentSubGraph=k,$.upSubGraph=function(){this.setCurrentSubGraph(xq(this._currentSubGraph))},$.isVisible=function(W){var A=this;if(xq(W)!==A._currentSubGraph)return!1;if(hk(W)){var U=W._40I,R=W._41I;if(!U||!R)return!1;if(!(W.s("edge.independent")||A.isVisible(U)&&A.isVisible(R)))return!1;if(W.isEdgeGroupHidden())return!1}else for(var k=W._parent;k&&!k.ISubGraph;){if(Qb(k)&&(!k.isExpanded()||!A.isVisible(k)))return!1;k=k._parent}if(W._parent instanceof as&&!A.isVisible(W._parent))return!1;if(W._refGraph instanceof Zf&&!A.isVisible(W._refGraph))return!1;if(A instanceof yj){if(!W.s("3d.visible"))return!1}else{var f=A.getLayersInfo();if(f){var S=f[W._layer];if(S&&S.visible===!1)return!1}if(!W.s("2d.visible"))return!1}return A._visibleFunc?A._visibleFunc(W):!0},$.handleSelectionChange=function(E){var Y=this;E.datas.each(function(j){Y.invalidateData(j);var x=j._parent;Qb(x)&&tn(j)&&j.s(Jj)&&(Y.invalidateData(x),x._49I&&x._49I.each(function(b){Y.invalidateData(b)}))}),Y.onSelectionChanged(E)},$.onSelectionChanged=function(v){var N=this,E=N.sm();if(1===E.size()&&("set"===v.kind||"append"===v.kind)){var o=E.ld();N.isAutoMakeVisible()&&N.makeVisible(o),N.adjustIndex&&N._dataModel.isAutoAdjustIndex()&&N.adjustIndex(o)}},$.makeVisible=function(r){if(r){var k=this,T=k.getDataUI?k.getDataUI(r):k.getData3dUI(r);if(T){var N=r,v=xq(r);for(v!==k._currentSubGraph&&k.setCurrentSubGraph(v);(N=N._parent)&&N!==v;)Qb(N)&&N.setExpanded(!0);k._23I=r,k.iv()}}},$.getLabel=function(R){var y=R.getStyle(Sr);return y===V?R.getName():y},$.getLabelBackground=function(d){return d.getStyle("label.background")},$.getLabelColor=function(B){return B.getStyle("label.color")},$.getLabel2=function(Y){return Y.getStyle("label2")},$.getLabel2Background=function(C){return C.getStyle("label2.background")},$.getLabel2Color=function(c){return c.getStyle("label2.color")},$.getNote=function(b){return b.getStyle(Fk)},$.getNoteBackground=function(Y){return Y.getStyle("note.background")},$.getNote2=function(h){return h.getStyle(zq)},$.getNote2Background=function(_){return _.getStyle("note2.background")},$.handleClick=function(i,w,Z){var b=this;w?(b.fi({kind:"clickData",event:i,data:w,part:Z}),b.onDataClicked(w,i)):(b.fi({kind:"clickBackground",event:i}),b.onBackgroundClicked(i))},$.handleDoubleClick=function(R,$,t){var L=this;Bn(R)&&($?(L.fi({kind:"doubleClickData",event:R,data:$,part:t}),L.onDataDoubleClicked($,R,t),L.checkDoubleClickOnNote(R,$,t)||L.checkDoubleClickOnRotation&&L.checkDoubleClickOnRotation(R,$,t)||(hk($)?L.onEdgeDoubleClicked($,R,t):$.ISubGraph?L.onSubGraphDoubleClicked($,R,t):Qb($)?L.onGroupDoubleClicked($,R,t):$.IDoorWindow?L.onDoorWindowDoubleClicked($,R,t):$.ICSGBox&&L.onCSGBoxDoubleClicked($,R,t))):(L.fi({kind:"doubleClickBackground",event:R}),L.onBackgroundDoubleClicked(R)))},$.onSubGraphDoubleClicked=function(f){this.setCurrentSubGraph(f)},$.onEdgeDoubleClicked=function(H,N){H.ISubGraph&&!pr(N)?this.setCurrentSubGraph(H):H.s("edge.toggleable")&&H.toggle()},$.onGroupDoubleClicked=function(i){i.s("group.toggleable")&&i.toggle()},$.onDoorWindowDoubleClicked=function(L){L.s("dw.toggleable")&&L.toggle(!0)},$.onCSGBoxDoubleClicked=function(r,N){var d=this;if(d instanceof yj){var F=d.getHitFaceInfo(N);F&&F.face&&r.s(F.face+".toggleable")&&r.toggleFace(F.face,!0)}},$.onBackgroundClicked=function(){},$.onBackgroundDoubleClicked=function(){this.upSubGraph()},$.onDataClicked=function(){},$.onDataDoubleClicked=function(){},$.onAutoLayoutEnded=function(){},$.onMoveEnded=function(){},$.onPanEnded=function(){},$.onPinchEnded=function(){},$.onRectSelectEnded=function(){},$.onZoomEnded=function(){},$.serialize=function(V){return this.dm().serialize(V)},$.toJSON=function(){return this.dm().toJSON()},$.deserialize=function(N,D){return D=D instanceof Sk?{rootParent:D}:Wq(D)?{setId:D}:od(D)?{finishFunc:D}:D||{},D.view=this,this.dm().deserialize(N,D.rootParent,D)}},ms_icons:function(o){o.getRotation=function(O){return O==k?0:O},o._15O=function(){var u=this,b=u.s(wf);if(b){var g=u,m=u.data||u._data,A=u._38o={icons:b,rects:{}};for(var r in b){var D=b[r],c=Sq(D.shape3d,m,g);if(!(Sq(D.visible,m,g)===!1||Sq(D.for3d,m,g)&&!u.I3d||c&&!u.I3d)){var o=c?[c]:Sq(D.names,m,g),B=o?o.length:0,w=Sq(D.position,m,g)||3,p=Sq(D.offsetX,m,g)||0,$=Sq(D.offsetY,m,g)||0,K=Sq(D.direction,m,g)||ih,F=Sq(D.gap,m,g),N=F!=k?F:1,G=Sq(D.rotation,m,g),R=Sq(D.keepOrien,m,g),v=Sq(D.rotationFixed,m,g)?G:u.getRotation(G,R,w),Q=k,f=A.rects[r]=new Array(B);f.rotation=v;for(var Z=0;B>Z;Z++){var a,n,e,U,Y=o[Z];if(c)e=0,U=0;else{var O=Ne(Y);e=Sq(D.width,m,g),U=Sq(D.height,m,g),e==k&&(e=Or(O,m)),U==k&&(U=fb(O,m))}if(Q?K===ih?p+=e/2:K===Vj?p-=e/2:K===Ck?$-=U/2:$+=U/2:Q={width:e,height:U},u.I3d){var d=-e/2,S=-U/2;n={width:e,height:U,mat:u._16O(Sq(D.autorotate,m,g),w,Q,Sq(D.face,m,g)||Vi,Sq(D.t3,m,g),Sq(D.r3,m,g),Sq(D.rotationMode,m,g),p,$),vs:new vn([d,-S,0,d,-S-U,0,d+e,-S-U,0,d+e,-S,0])}}else a=u.getPosition(w,p,$,Q,Sq(D.positionFixed,m,g)),n={x:a.x-e/2,y:a.y-U/2,width:e,height:U},u._68o(n,v);f[Z]=n,K===ih?p+=e/2+N:K===Vj?p-=e/2+N:K===Ck?$-=U/2+N:$+=U/2+N}}}}}}});var Vd={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},dn={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Uf={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Ff={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Al={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},ij={"edge.type":1,"edge.group":1},Hg={rotation:1,rotationX:1,rotationZ:1},Kq={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Mq={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Lb={shape:1,thickness:1,position:1,anchor:1,scale:1},Uk=function(J,W){if(!J||!Qb(W)||W.isEmpty())return!1;for(J=J._parent;Qb(J);){if(J===W)return!0;J=J._parent}return!1},bf=function($,m){if(!$||!Tm(m)||m.isEmpty())return!1;for($=$._parent;Tm($);){if($===m)return!0;$=$._parent}return!1},xq=function(A){if(!A)return k;if(hk(A)){var D=A._40I,s=A._41I;if(!D||!s)return k;var N=xq(D),j=xq(s);return N===j?N:k}for(var Q=A._parent;hk(Q)&&!Q.ISubGraph;)Q=Q._parent;return Q?Q.ISubGraph?Q:xq(Q):k},ud=function(k,A,d,C){var D=A.getStyle(d)*C;D&&Oq(k,D),D=A.getStyle(d+".left")*C,D&&(k.x-=D,k.width+=D),D=A.getStyle(d+".right")*C,D&&(k.width+=D),D=A.getStyle(d+".top")*C,D&&(k.y-=D,k.height+=D),D=A.getStyle(d+".bottom")*C,D&&(k.height+=D),k.width<0&&(k.width=-k.width,k.x-=k.width),k.height<0&&(k.height=-k.height,k.y-=k.height)},Gr=function(r){for(var y,V=0,x=r.size();x>V;V++)if(y=r.getChildAt(V),tn(y)&&Gr(y))return!0;return r.hasAgentEdges()},ad=function(i){if(!i)return k;for(var W=i._parent;Qb(W);){if(!Qb(W._parent))return W.isExpanded()?i:W;W.isExpanded()||(i=W),W=W._parent}return i},Oj=function(w,M){if(!w||!M)return k;var z,n,P,v=xq(w),X=xq(M);if(v!==X){for(;X&&v!==X;)X=xq(X);if(v===X)return w;z=new pq,z.add(w,0);for(var Y=w._parent;tn(Y)&&!M.isDescendantOf(Y);)z.add(Y,0),Y=Y._parent;for(P=z.size(),n=0;P>n;n++){var R=z.get(n);if(Qb(R)&&!R.isExpanded())return R;if(R.ISubGraph)return R}return w}return w},Ar=function(D){if(D.isLooped())return D._source;var r=ad(D._source),L=ad(D._target);return r===L?D._source:Oj(r,L)},lg=function(N){if(N.isLooped())return N._target;var x=ad(N._source),T=ad(N._target);return x===T?N._target:Oj(T,x)},Dh=function(o,i,W,A,M,C,s){if(!i)return k;var Q,N=i.getRotation?i.getRotation():0;if(C!==V||s!==V)if(C=C===V?.5:C,s=s===V?.5:s,N&&!Kl(i,o)){var x=i.getPosition(),g=i.getWidth(),n=i.getHeight(),D=i.getAnchor(),q=i.getScale(),X=new pf(N,x.x,x.y,q.x,q.y);W=X.tf((C-D.x)*g,(s-D.y)*n)}else Q=Fn(o,i),W={x:Q.x+C*Q.width,y:Q.y+s*Q.height};else W=uk(W,Fn(o,i));if(N){var a=P(N),m=e(N),y=A*a-M*m;M=A*m+M*a,A=y}return W.x+=A,W.y+=M,W},$m=function(l,L){if(!l||!L)return k;var A,b,$,Z,V,x;if(l===L){if(Z=l.getLoopedEdges(),!Z)return k;Z=new pq(Z)}else{if(V=l.getAgentEdges(),x=L.getAgentEdges(),!V||!x)return k;for(b=V.size(),A=0;b>A;A++)$=V.get(A),x.contains($)&&(Z||(Z=new pq),Z.add($))}if(Z)for(A=0;A<Z.size();A++)$=Z.get(A),$.getStyle(fp)===Rh&&($._22I(k),Z.removeAt(A),A--);return Z},Yc=function(r,D){var V=$m(r,D);if(V&&!V.isEmpty()){if(1===V.size())return V.get(0)._22I(k),void 0;var H=new pq,h=new pq;V.each(function(y){var Q=y.s("edge.group");H.contains(Q)||H.add(Q)}),H.sort(),H.each(function(W){h.add(new C.EdgeGroup(V.toList(function(Q){return W===Q.s("edge.group")}),h))}),h.each(function(r){r.each(function(u){u._22I(r)})})}},ui=function(q,T){if(T){var b=T.rect,_=T.color,v=T.rotation,G=T.labelWidth,a=T.background,I=T.opacity,d=T.scale,W=d!=k&&1!==d;if(I!=k){var l=q.globalAlpha;q.globalAlpha*=I}if(v||W){q.save();var e=b.x+b.width/2,K=b.y+b.height/2;Ig(q,e,K),v&&ef(q,v),W&&q.scale(d,d),Ig(q,-e,-K)}if(a&&yq(q,b.x,b.y,b.width,b.height,a),G){var E=b.width,m=q.createLinearGradient(b.x,b.y,b.x+E,b.y);m.addColorStop(0,_),m.addColorStop(.9,_),m.addColorStop(1,ks),_=m,b.width=G}ir(q,T.ss,b,T.font,_,T.align),G&&(b.width=E),(v||W)&&q.restore(),I!=k&&(q.globalAlpha=l)}},Qq=function(w,H){if(H){var y=H.rect,D=y.x,u=y.y,Q=y.width,_=y.height,f=H.background,N=H.backgroundImage,v=H.borderWidth,S=H.borderColor,e=H.labelWidth,I=H.opacity,X=H.scale,G=X!=k&&1!==X;if(I!=k){var g=w.globalAlpha;w.globalAlpha*=I}if(G){w.save();var P=y.x+y.width/2,M=y.y+y.height/2;Ig(w,P,M),w.scale(X,X),Ig(w,-P,-M)}if(H.expanded){var U=$(8,Q/4),O=u+_-8;if(w.fillStyle=f,w.beginPath(),w.moveTo(D,u),w.lineTo(D,O),w.lineTo(D+Q/2,O),w.lineTo(D+Q/2,u+_),w.lineTo(D+Q/2+U,O),w.lineTo(D+Q,O),w.lineTo(D+Q,u),w.closePath(),w.fill(),v&&(w.lineWidth=v,w.lineJoin="round",w.lineCap="round",S?(w.strokeStyle=S,w.stroke()):(w.strokeStyle=_g(f),w.beginPath(),w.moveTo(D+Q,u),w.lineTo(D+Q,O),w.lineTo(D+Q/2+U,O),w.lineTo(D+Q/2,u+_),w.stroke(),w.strokeStyle=Bm(f),w.beginPath(),w.moveTo(D+Q,u),w.lineTo(D,u),w.lineTo(D,O),w.lineTo(D+Q/2,O),w.lineTo(D+Q/2,u+_),w.stroke())),N)fo(w,Ne(N),yr,y.x,y.y,y.width,y.height-8,H.data,H.view);else{if(y.height-=8,f=H.color,e){var h=Q,L=w.createLinearGradient(D,u,D+h,u);L.addColorStop(0,f),L.addColorStop(.9,f),L.addColorStop(1,ks),f=L,y.width=e}ir(w,H.ss,y,H.font,f,H.align),e&&(y.width=h),y.height+=8}}else if(H.icon)Gb(w,Ne(H.icon),D,u,Q,_,H.data,H.view);else{var V=Q/2;v&&(w.lineWidth=v,w.lineJoin="round",w.lineCap="round",w.strokeStyle=S?S:_g(f),w.beginPath(),w.arc(D+V,u+V,V,r,1.6*K,!0),w.moveTo(D+V,u+_),w.lineTo(D+Q-V/5,u+V),w.stroke(),w.strokeStyle=S?S:Bm(f),w.beginPath(),w.arc(D+V,u+V,V,1.6*K,r,!0),w.moveTo(D+V,u+_),w.lineTo(D+V/5,u+V),w.stroke()),w.fillStyle=f,w.beginPath(),w.arc(D+V,u+V,V,0,o,!0),w.moveTo(D+V,u+_),w.lineTo(D+Q-V/5,u+V),w.lineTo(D+V/5,u+V),w.closePath(),w.fill(),w.fillStyle=H.color,w.beginPath(),w.arc(D+V,u+V,V/3,0,o,!0),w.fill()}G&&w.restore(),I!=k&&(w.globalAlpha=g)}},Nr=function(e,F){return F>2*e?e:F/2},Wm=function($,v,S,p){if(!$||!v)return 0;var J=q(v.y-$.y,v.x-$.x);return S||(J=v.x<$.x?J+K:J),J+p},Ng=function(G,m,c,V,P,Z,I){I&&(G.x>m.x||G.x===m.x&&G.y>m.y)&&(c=Nf[c],P=-P);var g=uk(c,{x:0,y:0,width:wh(G,m),height:0},Z);return g.x+=V,g.y+=P,g=new pf(q(m.y-G.y,m.x-G.x)).tf(g),g.x+=G.x,g.y+=G.y,g},gf=function(n,Y,W,d,u){if(n._19Q=!0,!W.getEdgeGroup())return d?W.s("edge.gap"):0;var c,G=0,C=0,o=0;if(W.getEdgeGroup().getSiblings().each(function(m){m.each(function(g){if(Y.isVisible(g)&&g.s(fp)==u){var y=g.s("edge.gap");c?(C+=o/2+y/2,o=y):(c=g,o=y),g===W&&(G=C)}})}),d)return C-G+o;var m=G-C/2;return c&&W._40I!==c._40I&&(n._19Q=!1),m},Hh=function(){var F=function(J){var A=[];return J.forEach(function(S){A.push({x:S.x,y:S.y}),A.push({x:S.x+S.width,y:S.y+S.height}),A.push({x:S.x+S.width,y:S.y}),A.push({x:S.x,y:S.y+S.height})}),A};return function(h,e,f){if("oval"===h){var V=0,X=f.height/f.width,Q=X*X,Y=f.x+f.width/2,r=f.y+f.height/2,D=F(e);D.forEach(function(g){var o=g.x-Y,E=g.y-r,v=o*o+E*E/Q;v>V&&(V=v)}),V=i(V);var I=X*V;return{x:Y-V,y:r-I,width:2*V,height:2*I}}if("circle"===h){var z=0,Y=f.x+f.width/2,r=f.y+f.height/2,D=F(e);return D.forEach(function(V){var W=V.x-Y,m=V.y-r,o=W*W+m*m;o>z&&(z=o)}),z=i(z),{x:Y-z,y:r-z,width:2*z,height:2*z}}return"roundRect"===h?(Oq(f,$(f.width,f.height)/16),f):f}}(),Mp=C.graph={},Mi=function(F,X,l){Zi(v+".graph."+F,X,l)};C.layout={};var Cf={comps:[{type:Dq,points:[85,50,70,115,100,71,86,107,88,49,56,55,43,53,120,122,97,88,74,107,82,85,109,103,114,108,101,81,99,72,67,112,67,80,90,115,112,76,50,53,116,107,73,61],borderWidth:1,borderColor:k}]};if(Cf[Qg]=Cf[Ch]=160,B.Image){var _i=new B.Image;_i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",yg("default_blank",_i)}yg("node_image",qd(30,30,[{type:Xd,rect:[4,5,22,16],gradient:Nd,gradientColor:xf,background:Lo},{type:Xd,rect:[2,3,26,20],borderWidth:1,borderColor:Lo},{type:Xd,rect:[11,23,8,4],background:Lo},{type:Xd,rect:[6,27,18,2],background:Lo}])),yg("node_icon",qd(16,16,[{type:Xd,rect:[2,2,12,10],gradient:Nd,gradientColor:xf,background:Lo},{type:Yg,rect:[2,2,12,10],width:1,color:Lo},{type:Xd,rect:[6,12,4,2],background:Lo},{type:Xd,rect:[4,14,8,1],background:Lo}])),yg("block_icon",qd(16,16,[{type:Yg,rect:[1,1,14,14],width:1,color:Lo}])),yg("group_image",qd(66,39,[{type:Xd,rect:[44.3,18,18.1,12.8],gradient:Nd,gradientColor:xf,background:Lo},{type:Xd,rect:[3.3,17.8,18.1,12.8],gradient:Nd,gradientColor:xf,background:Lo},{type:Xd,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Lo,gradient:Nd,gradientColor:xf,background:Lo},{type:Xd,rect:[26.2,29.4,12.8,4.2],background:Lo},{type:Xd,rect:[21.3,33.5,22.5,2.3],background:Lo},{type:Xd,rect:[5.3,32.7,14.1,2.1],background:Lo},{type:Xd,rect:[9,30.4,6.7,2.4],background:Lo},{type:Xd,rect:[50,30.7,6.7,2.4],background:Lo},{type:Xd,rect:[46.3,33,14.1,2.1],background:Lo}])),yg("group_icon",qd(16,16,[{type:Xd,rect:[4,12,4,2],background:Lo},{type:Xd,rect:[2,13,8,1],background:Lo},{type:Xd,rect:[12,12,2,1],background:Lo},{type:Xd,rect:[11,13,4,1],background:Lo},{type:Xd,rect:[10,7,6,5],gradient:Nd,gradientColor:xf,background:Lo},{type:Xd,rect:[1,2,10,10],gradient:Nd,gradientColor:xf,background:Lo},{type:Yg,rect:[1,2,10,10],width:1,color:Lo}])),yg("refGraph_icon",qd(16,16,[{type:"shape",borderWidth:1,borderColor:Lo,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Lo,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),yg("edge_icon",qd(16,16,[{type:Xd,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Nd,gradientColor:xf,background:Lo},{type:Xd,rect:[10.8,1,4,4],background:Lo},{type:Xd,rect:[1,11,4,4],background:Lo}])),yg("subGraph_image",qd(72,45,[{type:Dq,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Nd,gradientColor:xf,background:Lo},{type:Xd,rect:[29.6,30.7,3.6,1.8],background:Lo},{type:Xd,rect:[28.4,32.3,6,1.2],background:Lo},{type:Xd,rect:[37.3,32,10.8,1.8],background:Lo},{type:Xd,rect:[39.1,29.9,7.2,2.3],background:Lo},{type:Xd,rect:[26.6,23.7,9.6,7.2],gradient:Nd,gradientColor:xf,background:Lo},{type:Xd,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Lo,gradient:Nd,gradientColor:xf,background:Lo}])),yg("subGraph_icon",qd(17,17,[{type:Dq,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Nd,gradientColor:xf,background:Lo}])),yg("shape_icon",qd(16,16,[{type:Dq,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Lo}])),yg("polyline_icon",qd(16,16,[{type:Dq,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Lo},ff(7.5,.4),ff(7.5,6.3),ff(13.6,6.3),ff(13.6,14),ff(.7,13.9),ff(.7,.3)])),yg("grid_icon",qd(16,16,[{type:Xd,rect:[1,1,4,4],background:Lo,gradient:Nd,gradientColor:xf},{type:Xd,rect:[6,1,4,4],background:Lo,gradient:Nd,gradientColor:xf},{type:Xd,rect:[11,1,4,4],background:Lo,gradient:Nd,gradientColor:xf},{type:Xd,rect:[11,6,4,4],background:Lo,gradient:Nd,gradientColor:xf},{type:Xd,rect:[6,6,4,4],background:Lo,gradient:Nd,gradientColor:xf},{type:Xd,rect:[1,6,4,4],background:Lo,gradient:Nd,gradientColor:xf},{type:Xd,rect:[11,11,4,4],background:Lo,gradient:Nd,gradientColor:xf},{type:Xd,rect:[6,11,4,4],background:Lo,gradient:Nd,gradientColor:xf},{type:Xd,rect:[1,11,4,4],background:Lo,gradient:Nd,gradientColor:xf}])),yg("light_icon",qd(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Lo},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Lo,gradient:Nd,gradientColor:xf,background:{func:function(X){var r=X?X.s(hi):k;return sn(r)?"rgb("+d(255*r[0])+","+d(255*r[1])+","+d(255*r[2])+")":r||Lo}}}])),yg("text_icon",qd(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Lo}])),yg("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),yg("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),yg("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),yg("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var tc=function(P,o){for(var B=P.vertices,z=0;z<B.length;z++){var D=B[z],r=D.y;D.y=D.z,D.z=-r,o&&(D.y+=o)}},Ai=function(N){for(var K,A,S,U,v,k,P=[],V=[],C=[],W=N.faces,D=0,O=0,b=0,I=W.length;I>D;D++,O+=6,b+=9){var Q=W[D];1===Q.i?(K||(K=[],A=[],S=[]),Rr(Q,D,O,b,N,K,S,A)):2===Q.i?(U||(U=[],v=[],k=[]),Rr(Q,D,O,b,N,U,k,v)):Rr(Q,D,O,b,N,P,C,V)}return{vs:P,uv:V,ns:C,top_vs:K,top_uv:A,top_ns:S,bottom_vs:U,bottom_uv:v,bottom_ns:k}},Rr=function(e,R,m,b,o,h,J,i){var Y=o.vertices,L=o.faceVertexUvs,q=Y[e.a],D=Y[e.b],r=Y[e.c];h[b]=q.x,h[b+1]=q.y,h[b+2]=q.z,h[b+3]=D.x,h[b+4]=D.y,h[b+5]=D.z,h[b+6]=r.x,h[b+7]=r.y,h[b+8]=r.z;var I=e.vertexNormals;if(3===I.length){var g=I[0],n=I[1],Z=I[2];J[b]=g.x,J[b+1]=g.y,J[b+2]=g.z,J[b+3]=n.x,J[b+4]=n.y,J[b+5]=n.z,J[b+6]=Z.x,J[b+7]=Z.y,J[b+8]=Z.z}else{var Q=e.normal;J[b]=Q.x,J[b+1]=Q.y,J[b+2]=Q.z,J[b+3]=Q.x,J[b+4]=Q.y,J[b+5]=Q.z,J[b+6]=Q.x,J[b+7]=Q.y,J[b+8]=Q.z}var A=L[0][R][0],d=L[0][R][1],V=L[0][R][2];i[m]=A.x,i[m+1]=A.y,i[m+2]=d.x,i[m+3]=d.y,i[m+4]=V.x,i[m+5]=V.y},_j=function(c){var J=c._lineModel;if(J)return J;var W;W=sn(c)?c:[c];var n,o,r,C,p,M,I,t,Y,T,U,X,j=["","top","bottom"];for(J=[],n=0,o=W.length;o>n;n++)for(Y=W[n],r=0,C=j.length;C>r;r++)if(I=Y[j[r]+"vs"]){t=Y[j[r]+"is"],M=t?t.length:I.length/3;for(var p=0;M>p;p+=3)t?(T=t[p],U=t[p+1],X=t[p+2]):(T=p,U=p+1,X=p+2),T*=3,U*=3,X*=3,J.push(I[T],I[T+1],I[T+2],I[U],I[U+1],I[U+2],I[U],I[U+1],I[U+2],I[X],I[X+1],I[X+2],I[X],I[X+1],I[X+2],I[T],I[T+1],I[T+2])}return c._lineModel=J,J},Lq=function(q,R,J,p,M,T,G,l,_){J==k&&(J=!0),p==k&&(p=!0),G==k&&(G=1),l==k&&(l=0);var z=new ue;return pk(z,q,R,_),z=z.toShapes(),Ai(new eq(z,{top:J,bottom:p,curveSegments:M,amount:G,repeatUVLength:T},-G/2+l))},Ro=function(A,m){this.x=A||0,this.y=m||0};Ro.prototype={constructor:Ro,add:function(p){return this.x+=p.x,this.y+=p.y,this},sub:function(H){return this.x-=H.x,this.y-=H.y,this},equals:function(p){return p.x===this.x&&p.y===this.y},multiplyScalar:function(o){return this.x*=o,this.y*=o,this},distanceTo:function(D){return i(this.distanceToSquared(D))},distanceToSquared:function(d){var r=this.x-d.x,b=this.y-d.y;return r*r+b*b},clone:function(){return new Ro(this.x,this.y)}};var Ub=function(O,W,v){this.x=O||0,this.y=W||0,this.z=v||0};Ub.prototype={constructor:Ub,set:function(x,k,N){return this.x=x,this.y=k,this.z=N,this},setY:function(U){return this.y=U,this},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(y){return this.x+=y.x,this.y+=y.y,this.z+=y.z,this},addVectors:function(T,C){return this.x=T.x+C.x,this.y=T.y+C.y,this.z=T.z+C.z,this},sub:function(h){return this.x-=h.x,this.y-=h.y,this.z-=h.z,this},subVectors:function(D,H){return this.x=D.x-H.x,this.y=D.y-H.y,this.z=D.z-H.z,this},multiplyScalar:function(R){return this.x*=R,this.y*=R,this.z*=R,this},applyMatrix4:function(P){var L=this.x,x=this.y,S=this.z,_=P.elements;return this.x=_[0]*L+_[4]*x+_[8]*S+_[12],this.y=_[1]*L+_[5]*x+_[9]*S+_[13],this.z=_[2]*L+_[6]*x+_[10]*S+_[14],this},divideScalar:function(B){if(0!==B){var L=1/B;this.x*=L,this.y*=L,this.z*=L}else this.x=0,this.y=0,this.z=0;return this},dot:function(V){return this.x*V.x+this.y*V.y+this.z*V.z},length:function(){return i(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(u){var p=this.x,q=this.y,d=this.z;return this.x=q*u.z-d*u.y,this.y=d*u.x-p*u.z,this.z=p*u.y-q*u.x,this},crossVectors:function(V,e){var C=V.x,Q=V.y,W=V.z,g=e.x,U=e.y,I=e.z;return this.x=Q*I-W*U,this.y=W*g-C*I,this.z=C*U-Q*g,this},distanceTo:function(F){return i(this.distanceToSquared(F))},distanceToSquared:function(T){var G=this.x-T.x,z=this.y-T.y,N=this.z-T.z;return G*G+z*z+N*N},clone:function(){return new Ub(this.x,this.y,this.z)}};var Bj=function(){this.elements=new Float32Array(16)};Bj.prototype={constructor:Bj,set:function(l,z,G,B,D,H,N,y,m,n,P,K,W,v,Q,s){var w=this.elements;return w[0]=l,w[4]=z,w[8]=G,w[12]=B,w[1]=D,w[5]=H,w[9]=N,w[13]=y,w[2]=m,w[6]=n,w[10]=P,w[14]=K,w[3]=W,w[7]=v,w[11]=Q,w[15]=s,this},makeRotationAxis:function(I,i){var c=P(i),S=e(i),w=1-c,z=I.x,u=I.y,q=I.z,H=w*z,s=w*u;return this.set(H*z+c,H*u-S*q,H*q+S*u,0,H*u+S*q,s*u+c,s*q-S*z,0,H*q-S*u,s*q+S*z,w*q*q+c,0,0,0,0,1),this}};var id=function(f){this.repeatUVLength=f};id.prototype={generateTopUV:function(e,X,$,C,H,O,I){var l,s,p,f,M=e.vertices,r=M[C].x,T=M[C].y,K=M[H].x,j=M[H].y,L=M[O].x,u=M[O].y,P=this.repeatUVLength;if(P)l=0,s=0,p=P,f=P;else{this._bb||(this._bb=X.getBoundingBox());var b=this._bb;l=b.minX,s=b.minY,p=b.maxX-l,f=b.maxY-s}return I?[new Ro((r-l)/p,(T-s)/f),new Ro((K-l)/p,(j-s)/f),new Ro((L-l)/p,(u-s)/f)]:[new Ro((r-l)/p,1-(T-s)/f),new Ro((K-l)/p,1-(j-s)/f),new Ro((L-l)/p,1-(u-s)/f)]},generateBottomUV:function(Q,e,S,m,u,G){return this.generateTopUV(Q,e,S,m,u,G,!0)},generateSideWallUV:function(g,u,N,h,p,I,L,J,l,j,q,D){if(!this._cl){for(var U,M,f=[],k=0,H=N.length,d=0;H>d;d++){U=N[d],M=N[(d+1)%H];var E=U.x-M.x,K=U.y-M.y,n=i(E*E+K*K);f.push(k),k+=n}for(var d=0;H>d;d++)f[d]/=k;this._cl=f}var f=this._cl,W=1-l/j,o=1-(l+1)/j,e=f[q],Y=f[D];return Y>e&&(e+=1),[new Ro(e,W),new Ro(Y,W),new Ro(Y,o),new Ro(e,o)]}};var uq=function(z,q,y,C,v,L){this.a=z,this.b=q,this.c=y,this.i=L,this.normal=C instanceof Ub?C:new Ub,this.vertexNormals=C instanceof Array?C:[]};uq.prototype={constructor:uq};var np=[-8,13,-3,12,-3,5,1,6,-1],of=function(){if(of[Zp]!=k)return of[Zp];for(var f=Nl[Zp],J=np,M=Sk.prototype.getClassName(),C='"',s=0,P="",O=!1,o=+new(B[M.substr(3,3)+rf[s]]),i=s;i<J.length;i++){var W=J.length-i;P+=i%2===s?J[i]+W+"":J[i]-W+""}for(var i=s;4>i;i++)P+=s;if(P=P*P.length/P.length,o>P){if(f){for(var H,U,T,X,$,u,Y,b,_="",z=0,i=0;i<f.length;i++)f[i]===C?b?(b=!1,0!==z%2&&(H==k?H=_:U==k?U=_:T==k?T=_:X==k?X=_:$==k?$=_:u==k?u=_:Y==k&&(Y=_)),z++,_=""):b=!0:b&&(_+=f[i]);var l=H+U+T+X+$+u;(O=qf(l,Y)&&(!u||u.indexOf(Fb)>=0)&&(!$||$>o))&&T.indexOf(wk[0])>=0&&(of[wk[0]]=1),O&&T.indexOf(1)>=0&&(of[1]=1),O&&T.indexOf(2)>=0&&(of[2]=1)}}else O=!0,of[wk[0]]=of[1]=of[2]=1;return of[Zp]=O,O},bp=function(){},sb=bp.prototype;sb.getPointAt=function(t){var c=this.getUtoTmapping(t);return this.getPoint(c)},sb.getPoints=function(r){r||(r=5);var n,D=[];for(n=0;r>=n;n++)D.push(this.getPoint(n/r));return D},sb.getSpacedPoints=function(D){D||(D=5);var P,r=[];for(P=0;D>=P;P++)r.push(this.getPointAt(P/D));return r},sb.getLength=function(){var B=this.getLengths();return B[B.length-1]},sb.getLengths=function(M){if(M||(M=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==M+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var R,I,$=[],w=this.getPoint(0),F=0;for($.push(0),I=1;M>=I;I++)R=this.getPoint(I/M),F+=R.distanceTo(w),$.push(F),w=R;return this.cacheArcLengths=$,$},sb.getUtoTmapping=function(D,p){var L,W=this.getLengths(),X=0,k=W.length;L=p?p:D*W[k-1];for(var O,H=0,P=k-1;P>=H;)if(X=E(H+(P-H)/2),O=W[X]-L,0>O)H=X+1;else{if(!(O>0)){P=X;break}P=X-1}if(X=P,W[X]==L){var M=X/(k-1);return M}var $=W[X],o=W[X+1],z=o-$,I=(L-$)/z,M=(X+I)/(k-1);return M},sb.getTangent=function(a){var n=1e-4,h=a-n,x=a+n;0>h&&(h=0),x>1&&(x=1);var S=this.getPoint(h),M=this.getPoint(x),A=M.clone().sub(S);return A.normalize()},sb.getTangentAt=function(l){var G=this.getUtoTmapping(l);return this.getTangent(G)},bp.create=function(r,T){return r.prototype=Gi(bp.prototype),r.prototype.getPoint=T,r};var Ae=function(){this.curves=[],this.autoClose=!1},an=Ae.prototype=Gi(sb);an.add=function($){this.curves.push($)},an.closePath=function(){var I=this.curves[0].getPoint(0),p=this.curves[this.curves.length-1].getPoint(1);I.equals(p)||this.curves.push(new fr(p,I))},an.getPoint=function(t){for(var f,Y,q=t*this.getLength(),b=this.getCurveLengths(),M=0;M<b.length;){if(b[M]>=q){f=b[M]-q,Y=this.curves[M];var i=1-f/Y.getLength();return Y.getPointAt(i)}M++}return null},an.getLength=function(){var D=this.getCurveLengths();return D[D.length-1]},an.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var k,R=[],j=0,_=this.curves.length;for(k=0;_>k;k++)j+=this.curves[k].getLength(),R.push(j);return this.cacheLengths=R,R
},an.getTransformedPoints=function(k){return this.getPoints(k)},an.getBoundingBox=function(){var u,B,z,X,Y,$,l=this.getPoints();u=B=Number.NEGATIVE_INFINITY,X=Y=Number.POSITIVE_INFINITY;var M,t,r,v,Z=l[0]instanceof Ub;for(v=Z?new Ub:new Ro,t=0,r=l.length;r>t;t++)M=l[t],M.x>u&&(u=M.x),M.x<X&&(X=M.x),M.y>B&&(B=M.y),M.y<Y&&(Y=M.y),Z&&(M.z>z&&(z=M.z),M.z<$&&($=M.z)),v.add(M);var F={minX:X,minY:Y,maxX:u,maxY:B};return Z&&(F.maxZ=z,F.minZ=$),F};var cc=function(k){Ae.call(this),this.actions=[],k&&this.fromPoints(k)},sc=cc.prototype=Gi(Ae.prototype),Si="moveTo",Yd="lineTo",pc="quadraticCurveTo",yb="bezierCurveTo",bn="arc",uo="ellipse";sc.fromPoints=function(_){this.moveTo(_[0].x,_[0].y);for(var Z=1,y=_.length;y>Z;Z++)this.lineTo(_[Z].x,_[Z].y)},sc.moveTo=function(){var _=Array.prototype.slice.call(arguments);this.actions.push({action:Si,args:_})},sc.lineTo=function(b,v){var q=Array.prototype.slice.call(arguments),D=this.actions[this.actions.length-1].args,S=D[D.length-2],c=D[D.length-1],N=new fr(new Ro(S,c),new Ro(b,v));this.curves.push(N),this.actions.push({action:Yd,args:q})},sc.quadraticCurveTo=function(n,k,T,E){var H=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,O=s[s.length-2],v=s[s.length-1],C=new Ic(new Ro(O,v),new Ro(n,k),new Ro(T,E));this.curves.push(C),this.actions.push({action:pc,args:H})},sc.bezierCurveTo=function(j,d,A,g,s,H){var F=Array.prototype.slice.call(arguments),b=this.actions[this.actions.length-1].args,w=b[b.length-2],E=b[b.length-1],Z=new gn(new Ro(w,E),new Ro(j,d),new Ro(A,g),new Ro(s,H));this.curves.push(Z),this.actions.push({action:yb,args:F})},sc.arc=function(j,h,t,M,a,q){var f=this.actions[this.actions.length-1].args,C=f[f.length-2],L=f[f.length-1];this.absarc(j+C,h+L,t,M,a,q)},sc.absarc=function(I,q,O,w,h,N){this.absellipse(I,q,O,O,w,h,N)},sc.ellipse=function(x,s,T,j,E,M,p){var d=this.actions[this.actions.length-1].args,A=d[d.length-2],Z=d[d.length-1];this.absellipse(x+A,s+Z,T,j,E,M,p)},sc.absellipse=function(z,i,F,N,K,q,f){var k=Array.prototype.slice.call(arguments),h=new gr(z,i,F,N,K,q,f);this.curves.push(h);var P=h.getPoint(1);k.push(P.x),k.push(P.y),this.actions.push({action:uo,args:k})},sc.getSpacedPoints=function($){$||($=40);for(var q=[],h=0;$>h;h++)q.push(this.getPoint(h/$));return q},sc.getPoints=function($,c){$=$||12;var z,H,w,l,M,n,J,r,K,v,E,X,h,I,u,G,Z,g,R=[];for(z=0,H=this.actions.length;H>z;z++)switch(w=this.actions[z],l=w.action,M=w.args,l){case Si:R.push(new Ro(M[0],M[1]));break;case Yd:R.push(new Ro(M[0],M[1]));break;case pc:for(n=M[2],J=M[3],v=M[0],E=M[1],R.length>0?(I=R[R.length-1],X=I.x,h=I.y):(I=this.actions[z-1].args,X=I[I.length-2],h=I[I.length-1]),u=1;$>=u;u++)G=u/$,Z=gs.b2(G,X,v,n),g=gs.b2(G,h,E,J),R.push(new Ro(Z,g));break;case yb:for(n=M[4],J=M[5],v=M[0],E=M[1],r=M[2],K=M[3],R.length>0?(I=R[R.length-1],X=I.x,h=I.y):(I=this.actions[z-1].args,X=I[I.length-2],h=I[I.length-1]),u=1;$>=u;u++)G=u/$,Z=gs.b3(G,X,v,r,n),g=gs.b3(G,h,E,K,J),R.push(new Ro(Z,g));break;case bn:var O,Y=M[0],A=M[1],q=M[2],t=M[3],i=M[4],Q=!!M[5],S=i-t,f=2*$;for(u=1;f>=u;u++)G=u/f,Q||(G=1-G),O=t+G*S,Z=Y+q*P(O),g=A+q*e(O),R.push(new Ro(Z,g));break;case uo:var O,Y=M[0],A=M[1],y=M[2],m=M[3],t=M[4],i=M[5],Q=!!M[6],S=i-t,f=2*$;for(u=1;f>=u;u++)G=u/f,Q||(G=1-G),O=t+G*S,Z=Y+y*P(O),g=A+m*e(O),R.push(new Ro(Z,g))}var o=R[R.length-1],V=1e-10;return F(o.x-R[0].x)<V&&F(o.y-R[0].y)<V&&R.splice(R.length-1,1),c&&R.push(R[0]),R},sc.toShapes=function(o,h){function z(k){var J,o,f,U,R,M=[],Q=new cc;for(J=0,o=k.length;o>J;J++)f=k[J],R=f.args,U=f.action,U==Si&&0!=Q.actions.length&&(M.push(Q),Q=new cc),Q[U].apply(Q,R);return 0!=Q.actions.length&&M.push(Q),M}function d(o){for(var D=[],a=0,J=o.length;J>a;a++){var M=o[a],F=new ue;F.actions=M.actions,F.curves=M.curves,D.push(F)}return D}function l(U,f){for(var K=1e-10,G=f.length,p=!1,N=G-1,$=0;G>$;N=$++){var y=f[N],i=f[$],q=i.x-y.x,u=i.y-y.y;if(F(u)>K){if(0>u&&(y=f[$],q=-q,i=f[N],u=-u),U.y<y.y||U.y>i.y)continue;if(U.y==y.y){if(U.x==y.x)return!0}else{var r=u*(U.x-y.x)-q*(U.y-y.y);if(0==r)return!0;if(0>r)continue;p=!p}}else{if(U.y!=y.y)continue;if(i.x<=U.x&&U.x<=y.x||y.x<=U.x&&U.x<=i.x)return!0}}return p}var t=z(this.actions);if(0==t.length)return[];if(h===!0)return d(t);var r,S,L,p=[];if(1==t.length)return S=t[0],L=new ue,L.actions=S.actions,L.curves=S.curves,p.push(L),p;var w=!gs.isClockWise(t[0].getPoints());w=o?!w:w;var H,q=[],Y=[],W=[],j=0;Y[j]=V,W[j]=[];var m,y;for(m=0,y=t.length;y>m;m++)S=t[m],H=S.getPoints(),r=gs.isClockWise(H),r=o?!r:r,r?(!w&&Y[j]&&j++,Y[j]={s:new ue,p:H},Y[j].s.actions=S.actions,Y[j].s.curves=S.curves,w&&j++,W[j]=[]):W[j].push({h:S,p:H[0]});if(!Y[0])return d(t);if(Y.length>1){for(var U=!1,n=[],x=0,T=Y.length;T>x;x++)q[x]=[];for(var x=0,T=Y.length;T>x;x++){Y[x];for(var b=W[x],i=0;i<b.length;i++){for(var G=b[i],f=!0,M=0;M<Y.length;M++)l(G.p,Y[M].p)&&(x!=M&&n.push({froms:x,tos:M,hole:i}),f?(f=!1,q[M].push(G)):U=!0);f&&q[x].push(G)}}n.length>0&&(U||(W=q))}var P,K,X;for(m=0,y=Y.length;y>m;m++)for(L=Y[m].s,p.push(L),P=W[m],K=0,X=P.length;X>K;K++)L.holes.push(P[K].h);return p};var ue=function(){cc.apply(this,arguments),this.holes=[]},Dl=ue.prototype=Gi(sc);Dl.getPointsHoles=function(E){var Z,x=this.holes.length,N=[];for(Z=0;x>Z;Z++)N[Z]=this.holes[Z].getTransformedPoints(E);return N},Dl.extractAllPoints=function(j){return{shape:this.getTransformedPoints(j),holes:this.getPointsHoles(j)}},Dl.extractPoints=function(e){return this.extractAllPoints(e)};var gs={triangulateShape:function(t,X){function A(f,q,K){return f.x!=q.x?f.x<q.x?f.x<=K.x&&K.x<=q.x:q.x<=K.x&&K.x<=f.x:f.y<q.y?f.y<=K.y&&K.y<=q.y:q.y<=K.y&&K.y<=f.y}function M(P,f,S,p,h){var M=1e-10,$=f.x-P.x,k=f.y-P.y,y=p.x-S.x,x=p.y-S.y,u=P.x-S.x,G=P.y-S.y,a=k*y-$*x,d=k*u-$*G;if(F(a)>M){var q;if(a>0){if(0>d||d>a)return[];if(q=x*u-y*G,0>q||q>a)return[]}else{if(d>0||a>d)return[];if(q=x*u-y*G,q>0||a>q)return[]}if(0==q)return!h||0!=d&&d!=a?[P]:[];if(q==a)return!h||0!=d&&d!=a?[f]:[];if(0==d)return[S];if(d==a)return[p];var r=q/a;return[{x:P.x+r*$,y:P.y+r*k}]}if(0!=d||x*u!=y*G)return[];var Q=0==$&&0==k,L=0==y&&0==x;if(Q&&L)return P.x!=S.x||P.y!=S.y?[]:[P];if(Q)return A(S,p,P)?[P]:[];if(L)return A(P,f,S)?[S]:[];var m,I,R,_,C,D,n,v;return 0!=$?(P.x<f.x?(m=P,R=P.x,I=f,_=f.x):(m=f,R=f.x,I=P,_=P.x),S.x<p.x?(C=S,n=S.x,D=p,v=p.x):(C=p,n=p.x,D=S,v=S.x)):(P.y<f.y?(m=P,R=P.y,I=f,_=f.y):(m=f,R=f.y,I=P,_=P.y),S.y<p.y?(C=S,n=S.y,D=p,v=p.y):(C=p,n=p.y,D=S,v=S.y)),n>=R?n>_?[]:_==n?h?[]:[C]:v>=_?[C,I]:[C,D]:R>v?[]:R==v?h?[]:[m]:v>=_?[m,I]:[m,D]}function C(d,e,D,z){var N=1e-10,C=e.x-d.x,l=e.y-d.y,O=D.x-d.x,m=D.y-d.y,E=z.x-d.x,k=z.y-d.y,B=C*m-l*O,G=C*k-l*E;if(F(B)>N){var S=E*m-k*O;return B>0?G>=0&&S>=0:G>=0||S>=0}return G>0}function N(E,T){function c(z,E){var _=d.length-1,f=z-1;0>f&&(f=_);var i=z+1;i>_&&(i=0);var A=C(d[z],d[f],d[i],B[E]);if(!A)return!1;var H=B.length-1,h=E-1;0>h&&(h=H);var m=E+1;return m>H&&(m=0),A=C(B[E],B[h],B[m],d[z]),A?!0:!1}function D(v,X){var s,m,$;for(s=0;s<d.length;s++)if(m=s+1,m%=d.length,$=M(v,X,d[s],d[m],!0),$.length>0)return!0;return!1}function r(Z,w){var P,V,u,I,L;for(P=0;P<K.length;P++)for(V=T[K[P]],u=0;u<V.length;u++)if(I=u+1,I%=V.length,L=M(Z,w,V[u],V[I],!0),L.length>0)return!0;return!1}for(var B,j,N,P,b,x,Q,O,J,W,I,d=E.concat(),K=[],_=[],k=0,n=T.length;n>k;k++)K.push(k);for(var S=0,p=2*K.length;K.length>0&&(p--,!(0>p));)for(N=S;N<d.length;N++){P=d[N],j=-1;for(var k=0;k<K.length;k++)if(x=K[k],Q=P.x+":"+P.y+":"+x,_[Q]===V){B=T[x];for(var z=0;z<B.length;z++)if(b=B[z],c(N,z)&&!D(P,b)&&!r(P,b)){j=z,K.splice(k,1),O=d.slice(0,N+1),J=d.slice(N),W=B.slice(j),I=B.slice(0,j+1),d=O.concat(W).concat(I).concat(J),S=N;break}if(j>=0)break;_[Q]=!0}if(j>=0)break}return d}for(var b,j,I,v,B,G,o={},k=t.concat(),i=0,E=X.length;E>i;i++)Array.prototype.push.apply(k,X[i]);for(b=0,j=k.length;j>b;b++)B=k[b].x+":"+k[b].y,o[B]!==V,o[B]=b;var x=N(t,X),a=tp.Triangulate(x,!1);for(b=0,j=a.length;j>b;b++)for(v=a[b],I=0;3>I;I++)B=v[I].x+":"+v[I].y,G=o[B],G!==V&&(v[I]=G);return a.concat()},isClockWise:function(O){return tp.Triangulate.area(O)<0},b2p0:function(O,k){var M=1-O;return M*M*k},b2p1:function($,O){return 2*(1-$)*$*O},b2p2:function($,N){return $*$*N},b2:function(A,B,m,K){return this.b2p0(A,B)+this.b2p1(A,m)+this.b2p2(A,K)},b3p0:function(b,F){var E=1-b;return E*E*E*F},b3p1:function(Q,m){var b=1-Q;return 3*b*b*Q*m},b3p2:function(X,b){var y=1-X;return 3*y*X*X*b},b3p3:function(S,W){return S*S*S*W},b3:function(L,h,w,g,P){return this.b3p0(L,h)+this.b3p1(L,w)+this.b3p2(L,g)+this.b3p3(L,P)}},tp={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var K=c.keys(this.faces);return K.length?K[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(i){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(X){var o=X.familyName.toLowerCase(),I=this;return I.faces[o]=I.faces[o]||{},I.faces[o][X.cssFontWeight]=I.faces[o][X.cssFontWeight]||{},I.faces[o][X.cssFontWeight][X.cssFontStyle]=X,X},drawText:function(E){var m,T=this.getFace(),d=this.size/T.resolution,p=0,R=String(E).split(""),P=R.length,n=[];for(m=0;P>m;m++){var q=new cc,M=this.extractGlyphPoints(R[m],T,d,p,q);M&&(p+=M.offset*this.spacing,n.push(M.path))}var V=p/2;return{paths:n,offset:V}},extractGlyphPoints:function(B,E,G,$,z){var D,K,L,x,k,Z,C,J,W,a,I,i,t,j,R,q,P,S,c,A=[],h=E.glyphs[B]||E.glyphs["?"];if(h){if(h.o)for(x=h._cachedOutline||(h._cachedOutline=h.o.split(" ")),Z=x.length,C=G,J=G,D=0;Z>D;)switch(k=x[D++]){case"m":W=x[D++]*C+$,a=x[D++]*J,z.moveTo(W,a);break;case"l":W=x[D++]*C+$,a=x[D++]*J,z.lineTo(W,a);break;case"q":if(I=x[D++]*C+$,i=x[D++]*J,R=x[D++]*C+$,q=x[D++]*J,z.quadraticCurveTo(R,q,I,i),c=A[A.length-1])for(t=c.x,j=c.y,K=1,L=this.divisions;L>=K;K++){var U=K/L;gs.b2(U,t,R,I),gs.b2(U,j,q,i)}break;case"b":if(I=x[D++]*C+$,i=x[D++]*J,R=x[D++]*C+$,q=x[D++]*J,P=x[D++]*C+$,S=x[D++]*J,z.bezierCurveTo(R,q,P,S,I,i),c=A[A.length-1])for(t=c.x,j=c.y,K=1,L=this.divisions;L>=K;K++){var U=K/L;gs.b3(U,t,R,P,I),gs.b3(U,j,q,S,i)}}return{offset:h.ha*G,path:z}}}};tp.generateShapes=function(x,g){g=g||{};var J=g.font;if(J===V&&(J=tp.getDefaultFont(),!J))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var S=g.size!==V?g.size:1,D=g.curveSegments!==V?g.curveSegments:4,A=g.spacing!==V?g.spacing:1,X=g.weight!==V?g.weight:"normal",I=g.style!==V?g.style:"normal";tp.size=S,tp.divisions=D,tp.face=J,tp.weight=X,tp.style=I,tp.spacing=A;for(var l=tp.drawText(x),T=l.paths,M=[],u=0,B=T.length;B>u;u++)Array.prototype.push.apply(M,T[u].toShapes());return M},function(d){var s=1e-10,U=function(e,v){var i=e.length;if(3>i)return null;var n,Y,c,C=[],D=[],I=[];if(L(e)>0)for(Y=0;i>Y;Y++)D[Y]=Y;else for(Y=0;i>Y;Y++)D[Y]=i-1-Y;var g=i,U=2*g;for(Y=g-1;g>2;){if(U--<=0)return v?I:C;if(n=Y,n>=g&&(n=0),Y=n+1,Y>=g&&(Y=0),c=Y+1,c>=g&&(c=0),x(e,n,Y,c,g,D)){var G,M,H,A,K;for(G=D[n],M=D[Y],H=D[c],C.push([e[G],e[M],e[H]]),I.push([D[n],D[Y],D[c]]),A=Y,K=Y+1;g>K;A++,K++)D[A]=D[K];g--,U=2*g}}return v?I:C},L=function(G){for(var X=G.length,r=0,L=X-1,l=0;X>l;L=l++)r+=G[L].x*G[l].y-G[l].x*G[L].y;return.5*r},x=function(c,V,K,g,R,w){var z,D,v,T,M,b,W,E,e;if(D=c[w[V]].x,v=c[w[V]].y,T=c[w[K]].x,M=c[w[K]].y,b=c[w[g]].x,W=c[w[g]].y,s>(T-D)*(W-v)-(M-v)*(b-D))return!1;var q,$,h,H,o,y,G,Q,L,u,p,r,Z,m,O;for(q=b-T,$=W-M,h=D-b,H=v-W,o=T-D,y=M-v,z=0;R>z;z++)if(E=c[w[z]].x,e=c[w[z]].y,!(E===D&&e===v||E===T&&e===M||E===b&&e===W)&&(G=E-D,Q=e-v,L=E-T,u=e-M,p=E-b,r=e-W,O=q*u-$*L,Z=o*Q-y*G,m=h*r-H*p,O>=-s&&m>=-s&&Z>=-s))return!1;return!0};return d.Triangulate=U,d.Triangulate.area=L,d}(tp),B._typeface_js={faces:tp.faces,loadFace:tp.loadFace};var ti=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},jb=ti.prototype={constructor:ti,computeFaceNormals:function(){for(var E=new Ub,B=new Ub,C=0,J=this.faces.length;J>C;C++){var P=this.faces[C],X=this.vertices[P.a],m=this.vertices[P.b],e=this.vertices[P.c];E.subVectors(e,m),B.subVectors(X,m),E.cross(B),E.normalize(),P.normal.copy(E)}},computeVertexNormals:function(Z){var U,H,V,b,j,v;for(v=new Array(this.vertices.length),U=0,H=this.vertices.length;H>U;U++)v[U]=new Ub;if(Z){var X,w,P,m=new Ub,d=new Ub;for(V=0,b=this.faces.length;b>V;V++)j=this.faces[V],X=this.vertices[j.a],w=this.vertices[j.b],P=this.vertices[j.c],m.subVectors(P,w),d.subVectors(X,w),m.cross(d),v[j.a].add(m),v[j.b].add(m),v[j.c].add(m)}else for(V=0,b=this.faces.length;b>V;V++)j=this.faces[V],v[j.a].add(j.normal),v[j.b].add(j.normal),v[j.c].add(j.normal);for(U=0,H=this.vertices.length;H>U;U++)v[U].normalize();for(V=0,b=this.faces.length;b>V;V++)j=this.faces[V],j.vertexNormals[0]=v[j.a].clone(),j.vertexNormals[1]=v[j.b].clone(),j.vertexNormals[2]=v[j.c].clone()},mergeVertices:function(){var $,y,u,c,N,m,M,v,F={},Q=[],e=[],P=4,g=l(10,P);for(u=0,c=this.vertices.length;c>u;u++)$=this.vertices[u],y=L($.x*g)+"_"+L($.y*g)+"_"+L($.z*g),F[y]===V?(F[y]=u,Q.push(this.vertices[u]),e[u]=Q.length-1):e[u]=e[F[y]];var K=[];for(u=0,c=this.faces.length;c>u;u++){N=this.faces[u],N.a=e[N.a],N.b=e[N.b],N.c=e[N.c],m=[N.a,N.b,N.c];for(var b=0;3>b;b++)if(m[b]==m[(b+1)%3]){K.push(u);break}}for(u=K.length-1;u>=0;u--){var r=K[u];for(this.faces.splice(r,1),M=0,v=this.faceVertexUvs.length;v>M;M++)this.faceVertexUvs[M].splice(r,1)}var _=this.vertices.length-Q.length;return this.vertices=Q,_}},gr=function(X,y,m,c,$,x,s){this.aX=X,this.aY=y,this.xRadius=m,this.yRadius=c,this.aStartAngle=$,this.aEndAngle=x,this.aClockwise=s};gr.prototype=Gi(sb),gr.prototype.getPoint=function(i){var S,l=this.aEndAngle-this.aStartAngle;0>l&&(l+=o),l>o&&(l-=o),S=this.aClockwise===!0?this.aEndAngle+(1-i)*(o-l):this.aStartAngle+i*l;var C=this.aX+this.xRadius*P(S),I=this.aY+this.yRadius*e(S);return new Ro(C,I)};var fr=function(M,b){this.v1=M,this.v2=b},Db=fr.prototype=Gi(sb);Db.getPoint=function(H){var b=this.v2.clone().sub(this.v1);return b.multiplyScalar(H).add(this.v1),b},Db.getPointAt=function(D){return this.getPoint(D)},Db.getTangent=function(){var N=this.v2.clone().sub(this.v1);return N.normalize()};var Ic=function($,m,g){this.v0=$,this.v1=m,this.v2=g};Ic.prototype=Gi(sb),Ic.prototype.getPoint=function(f){var M,R;return M=gs.b2(f,this.v0.x,this.v1.x,this.v2.x),R=gs.b2(f,this.v0.y,this.v1.y,this.v2.y),new Ro(M,R)};var gn=function(O,g,Q,M){this.v0=O,this.v1=g,this.v2=Q,this.v3=M};gn.prototype=Gi(sb),gn.prototype.getPoint=function(x){var s,g;return s=gs.b3(x,this.v0.x,this.v1.x,this.v2.x,this.v3.x),g=gs.b3(x,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Ro(s,g)},bp.create(function(n,V){this.v1=n,this.v2=V},function(Q){var u=new Ub;return u.subVectors(this.v2,this.v1),u.multiplyScalar(Q),u.add(this.v1),u});var Tf=bp.create(function(k,F,o){this.v0=k,this.v1=F,this.v2=o},function(L){var X,g,r;return X=gs.b2(L,this.v0.x,this.v1.x,this.v2.x),g=gs.b2(L,this.v0.y,this.v1.y,this.v2.y),r=gs.b2(L,this.v0.z,this.v1.z,this.v2.z),new Ub(X,g,r)}),Tg=bp.create(function(b,t,q,$){this.v0=b,this.v1=t,this.v2=q,this.v3=$},function(o){var O,w,l;return O=gs.b3(o,this.v0.x,this.v1.x,this.v2.x,this.v3.x),w=gs.b3(o,this.v0.y,this.v1.y,this.v2.y,this.v3.y),l=gs.b3(o,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Ub(O,w,l)}),Ye=function(S,M,j,X,l,y,a,R){ti.call(this),X=X!==V?X:.5,l=l!==V?l:.5,R=R!==V?R:1,S=S||8,y=y||0,a=a||o;var G,Q,T=1,w=R/2,F=[],r=[],z=this.vertices,W=this.faces,I=this.faceVertexUvs;for(Q=0;T>=Q;Q++){var D=[],k=[],c=Q/T,O=c*(l-X)+X;for(G=0;S>=G;G++){var C=G/S,A=new Ub,v=-(C*a+y);A.z=O*e(v),A.y=-c*R+w,A.x=O*P(v),z.push(A),D.push(z.length-1),k.push(new Ro(C,c))}F.push(D),r.push(k)}var $,J,q=(l-X)/R;for(G=0;S>G;G++)for(0!==X?($=z[F[0][G]].clone(),J=z[F[0][G+1]].clone()):($=z[F[1][G]].clone(),J=z[F[1][G+1]].clone()),$.setY(i($.x*$.x+$.z*$.z)*q).normalize(),J.setY(i(J.x*J.x+J.z*J.z)*q).normalize(),Q=0;T>Q;Q++){var d=F[Q][G],h=F[Q+1][G],B=F[Q+1][G+1],N=F[Q][G+1],u=$.clone(),U=$.clone(),g=J.clone(),K=J.clone(),m=r[Q][G].clone(),p=r[Q+1][G].clone(),Y=r[Q+1][G+1].clone(),x=r[Q][G+1].clone();W.push(new uq(d,h,N,[u,U,K])),I[0].push([m,p,x]),W.push(new uq(h,B,N,[U.clone(),g,K.clone()])),I[0].push([p.clone(),Y,x.clone()])}if(M&&X>0)for(this.vertices.push(new Ub(0,w,0)),G=0;S>G;G++){var d=F[0][G],h=F[0][G+1],B=this.vertices.length-1,u=new Ub(0,1,0),U=new Ub(0,1,0),g=new Ub(0,1,0),m=r[0][G].clone(),p=r[0][G+1].clone(),Y=new Ro(p.x,0);W.push(new uq(d,h,B,[u,U,g],null,1));var t=G/S*o,H=P(t),b=e(t),Z=(G+1)/S*o,n=P(Z),f=e(Z);I[0].push([new Ro(.5+.5*H,.5+.5*b),new Ro(.5+.5*n,.5+.5*f),new Ro(.5,.5)])}if(j&&l>0)for(this.vertices.push(new Ub(0,-w,0)),G=0;S>G;G++){var d=F[Q][G+1],h=F[Q][G],B=z.length-1,u=new Ub(0,-1,0),U=new Ub(0,-1,0),g=new Ub(0,-1,0),m=r[Q][G+1].clone(),p=r[Q][G].clone();W.push(new uq(d,h,B,[u,U,g],null,2));var t=G/S*o,H=P(t),b=e(t),Z=(G+1)/S*o,n=P(Z),f=e(Z);I[0].push([new Ro(.5+.5*n,.5-.5*f),new Ro(.5+.5*H,.5-.5*b),new Ro(.5,.5)])}};Ye.prototype=Gi(jb);var kc=function(H,f,r,M,t,W,S){ti.call(this),S=S||.5,H=H||16,f=f||16,r=(r!==V?r:0)-K,M=M!==V?M:o,t=t!==V?t:0,W=W!==V?W:K;var E,s,T=[],Q=[],B=this.vertices,j=this.faces,X=this.faceVertexUvs;for(s=0;f>=s;s++){var l=[],g=[];for(E=0;H>=E;E++){var x=E/H,c=s/f,v=new Ub;v.x=-S*P(r+x*M)*e(t+c*W),v.y=S*P(t+c*W),v.z=S*e(r+x*M)*e(t+c*W),B.push(v),l.push(B.length-1),g.push(new Ro(x,c))}T.push(l),Q.push(g)}for(s=0;f>s;s++)for(E=0;H>E;E++){var _=T[s][E+1],Y=T[s][E],U=T[s+1][E],u=T[s+1][E+1],Z=B[_].clone().normalize(),y=B[Y].clone().normalize(),D=B[U].clone().normalize(),J=B[u].clone().normalize(),n=Q[s][E+1].clone(),$=Q[s][E].clone(),k=Q[s+1][E].clone(),R=Q[s+1][E+1].clone();F(B[_].y)===S?(n.x=(n.x+$.x)/2,j.push(new uq(_,U,u,[Z,D,J])),X[0].push([n,k,R])):F(B[U].y)===S?(k.x=(k.x+R.x)/2,j.push(new uq(_,Y,U,[Z,y,D])),X[0].push([n,$,k])):(j.push(new uq(_,Y,u,[Z,y,J])),X[0].push([n,$,R]),j.push(new uq(Y,U,u,[y.clone(),D,J.clone()])),X[0].push([$.clone(),k,R.clone()]))}};kc.prototype=Gi(jb);var vc=function(D,S,m,y,H,Z){ti.call(this),D=D||.33,S=S||.17,y=y||8,m=m||6,H=H||0,Z=Z||o;for(var l=new Ub,M=[],G=[],R=0;y>=R;R++)for(var n=R/y*o+K,J=0;m>=J;J++){var I=J/m*Z+H;l.x=D*P(I),l.z=-D*e(I);var w=new Ub,i=D+S*P(n);w.x=i*P(I),w.z=-i*e(I),w.y=S*e(n),this.vertices.push(w),M.push(new Ro(J/m,1-R/y)),G.push(w.clone().sub(l).normalize())}for(var R=1;y>=R;R++)for(var J=1;m>=J;J++){var q=(m+1)*R+J-1,U=(m+1)*(R-1)+J-1,_=(m+1)*(R-1)+J,z=(m+1)*R+J,L=new uq(q,U,z,[G[q].clone(),G[U].clone(),G[z].clone()]);this.faces.push(L),this.faceVertexUvs[0].push([M[q].clone(),M[U].clone(),M[z].clone()]),L=new uq(U,_,z,[G[U].clone(),G[_].clone(),G[z].clone()]),this.faces.push(L),this.faceVertexUvs[0].push([M[U].clone(),M[_].clone(),M[z].clone()])}this.computeFaceNormals()};vc.prototype=Gi(jb);var eq=function(c,n,V){return c?(ti.call(this),c=c instanceof Array?c:[c],this.addShapeList(c,n),n.convertYZ!==!1&&tc(this,V),this.computeFaceNormals(),void 0):(c=[],void 0)},nh=eq.prototype=Gi(ti.prototype);nh.addShapeList=function(d,O){for(var Y=d.length,s=0;Y>s;s++){var M=d[s];this.addShape(M,O)}},nh.addShape=function(D,Z){function h(){if(Z.bottom)for(var W=0;K>W;W++)_=A[W],L(_[2],_[1],_[0],!0);if(Z.top)for(W=0;K>W;W++)_=A[W],L(_[0]+E*P,_[1]+E*P,_[2]+E*P,!1)}function z(){var o=0;for(m(t,o),o+=t.length,J=0,W=n.length;W>J;J++)I=n[J],m(I,o),o+=I.length}function m(v,X){for(var h,G,m=v.length;--m>=0;){h=m,G=m-1,0>G&&(G=v.length-1);var d=0,r=P;for(d=0;r>d;d++){var $=E*d,S=E*(d+1),Q=X+h+$,W=X+G+$,K=X+G+S,n=X+h+S;R(Q,W,K,n,v,d,r,h,G)}}}function s(B,K,m){i.vertices.push(new Ub(B,K,m))}function L(S,H,R,l){S+=M,H+=M,R+=M,i.faces.push(new uq(S,H,R,null,null,l?2:1));var s=l?u.generateBottomUV(i,D,Z,S,H,R):u.generateTopUV(i,D,Z,S,H,R);i.faceVertexUvs[0].push(s)}function R(G,A,s,I,U,q,o,x,W){G+=M,A+=M,s+=M,I+=M,i.faces.push(new uq(G,A,I)),i.faces.push(new uq(A,s,I));var w=u.generateSideWallUV(i,D,U,Z,G,A,s,I,q,o,x,W);i.faceVertexUvs[0].push([w[0],w[1],w[3]]),i.faceVertexUvs[0].push([w[1],w[2],w[3]])}var O,X,w,l,f,k=Z.amount,B=Z.curveSegments||ak,P=Z.steps||1,T=Z.extrudePath,p=!1,u=new id(Z.repeatUVLength);T&&(O=T.getSpacedPoints(P),p=!0,X=Z.frames!==V?Z.frames:new tb.FrenetFrames(T,P,!1),w=new Ub,l=new Ub,f=new Ub);var I,J,W,i=this,M=this.vertices.length,N=D.extractPoints(B),S=N.shape,n=N.holes,C=!gs.isClockWise(S);if(C){for(S=S.reverse(),J=0,W=n.length;W>J;J++)I=n[J],gs.isClockWise(I)&&(n[J]=I.reverse());C=!1}var A=gs.triangulateShape(S,n),t=S;for(J=0,W=n.length;W>J;J++)I=n[J],S=S.concat(I);for(var o,_,E=S.length,K=A.length,Y=0;E>Y;Y++)o=S[Y],p?(l.copy(X.normals[0]).multiplyScalar(o.x),w.copy(X.binormals[0]).multiplyScalar(o.y),f.copy(O[0]).add(l).add(w),s(f.x,f.y,f.z)):s(o.x,o.y,0);var U;for(U=1;P>=U;U++)for(Y=0;E>Y;Y++)o=S[Y],p?(l.copy(X.normals[U]).multiplyScalar(o.x),w.copy(X.binormals[U]).multiplyScalar(o.y),f.copy(O[U]).add(l).add(w),s(f.x,f.y,f.z)):s(o.x,o.y,k/P*U);h(),z()};var tb=function(I,X,w,R,q){function N(Q,Y,R){return k.vertices.push(new Ub(Q,Y,R))-1}ti.call(this),X=X||64,w=w||1,R=R||8,q=q||!1;var L,Y,z,C,t,m,Z,y,i,$,h,D,V,E,H,F,W,T,J,B,v=[],k=this,A=X+1,K=new Ub,a=new tb.FrenetFrames(I,X,q),n=a.tangents,g=a.normals,l=a.binormals;for(this.tangents=n,this.normals=g,this.binormals=l,i=0;A>i;i++)for(v[i]=[],C=i/(A-1),y=I.getPointAt(C),L=n[i],Y=g[i],z=l[i],$=0;R>$;$++)t=$/R*o,m=-w*P(t),Z=w*e(t),K.copy(y),K.x+=m*Y.x+Z*z.x,K.y+=m*Y.y+Z*z.y,K.z+=m*Y.z+Z*z.z,v[i][$]=N(K.x,K.y,K.z);for(i=0;X>i;i++)for($=0;R>$;$++)h=q?(i+1)%X:i+1,D=($+1)%R,V=v[i][$],E=v[h][$],H=v[h][D],F=v[i][D],W=new Ro(i/X,$/R),T=new Ro((i+1)/X,$/R),J=new Ro((i+1)/X,($+1)/R),B=new Ro(i/X,($+1)/R),this.faces.push(new uq(V,E,F)),this.faceVertexUvs[0].push([W,T,B]),this.faces.push(new uq(E,H,F)),this.faceVertexUvs[0].push([T.clone(),J,B.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};tb.prototype=Gi(jb),tb.FrenetFrames=function(y,a,d){function L(){A[0]=new Ub,u[0]=new Ub,j=Number.MAX_VALUE,q=F(H[0].x),r=F(H[0].y),E=F(H[0].z),j>=q&&(j=q,G.set(1,0,0)),j>=r&&(j=r,G.set(0,1,0)),j>=E&&G.set(0,0,1),W.crossVectors(H[0],G).normalize(),A[0].crossVectors(H[0],W),u[0].crossVectors(H[0],A[0])}var t,j,q,r,E,P,w,G=new Ub,H=[],A=[],u=[],W=new Ub,x=new Bj,V=a+1,h=1e-4;for(this.tangents=H,this.normals=A,this.binormals=u,P=0;V>P;P++)w=P/(V-1),H[P]=y.getTangentAt(w),H[P].normalize();for(L(),P=1;V>P;P++)A[P]=A[P-1].clone(),u[P]=u[P-1].clone(),W.crossVectors(H[P-1],H[P]),W.length()>h&&(W.normalize(),t=M(iq(H[P-1].dot(H[P]),-1,1)),A[P].applyMatrix4(x.makeRotationAxis(W,t))),u[P].crossVectors(H[P],A[P]);if(d)for(t=M(iq(A[0].dot(A[V-1]),-1,1)),t/=V-1,H[0].dot(W.crossVectors(A[0],A[V-1]))>0&&(t=-t),P=1;V>P;P++)A[P].applyMatrix4(x.makeRotationAxis(H[P],t*P)),u[P].crossVectors(H[P],A[P])};var Ij=function(w,y,d,I){ti.call(this),y=y||18,d=d||0,I=I==k?o:I;for(var $=1/(w.length-1),j=1/y,c=0,T=y;T>=c;c++)for(var D=d+c*j*I,g=P(D),Z=e(D),G=0,U=w.length;U>G;G++){var N=w[G],n=new Ub;n.x=g*N.x-Z*N.y,n.y=Z*N.x+g*N.y,n.z=N.z,this.vertices.push(n)}for(var u=w.length,c=0,T=y;T>c;c++)for(var G=0,U=w.length-1;U>G;G++){var _=G+u*c,b=_,r=_+u,g=_+1+u,B=_+1,h=c*j,R=G*$,A=h+j,t=R+$;this.faces.push(new uq(b,B,r)),this.faceVertexUvs[0].push([new Ro(h,R),new Ro(h,t),new Ro(A,R)]),this.faces.push(new uq(r,B,g)),this.faceVertexUvs[0].push([new Ro(A,R),new Ro(h,t),new Ro(A,t)])}this.mergeVertices(),tc(this),this.computeFaceNormals(),this.computeVertexNormals()};Ij.prototype=Gi(jb);var yi=function(f,U){U=U||{};var Y=tp.generateShapes(f,U);U.amount=U.amount!==V?U.amount:.5,U.convertYZ=!1,U.fill!==!1&&(U.bottom=!0,U.top=!0),eq.call(this,Y,U)};yi.prototype=Gi(nh);var gd=C.Node=function(){uj(gd,this)},Sm={X:Hr,Y:pp,Z:bq},lo={X:0,Y:1,Z:2},Aq={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Lg="xzy",wi=function(i,l,r){if(l){var s=l[0],k=l[1],b=l[2];"xzy"===r?(pp(i,k),bq(i,b),Hr(i,s)):"xyz"===r?(bq(i,b),pp(i,k),Hr(i,s)):"yxz"===r?(bq(i,b),Hr(i,s),pp(i,k)):"yzx"===r?(Hr(i,s),bq(i,b),pp(i,k)):"zxy"===r?(pp(i,k),Hr(i,s),bq(i,b)):"zyx"===r?(Hr(i,s),pp(i,k),bq(i,b)):(pp(i,k),bq(i,b),Hr(i,s))}};zo("Node",Sk,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Lg,_64O:0,_rotationX:0,_53O:0,_host:k,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return On},_22Q:function(){return Yh},getX:function(){return this.p().x},setX:function(g){this.p(g,this.p().y)},getY:function(){return this.p().y},setY:function(p){this.p(this.p().x,p)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(b){this.setAnchor(b,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(P){this.setAnchor(this.getAnchor().x,P)},getScaleX:function(){return this.getScale().x},setScaleX:function(W){this.setScale(W,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(R){this.setScale(this.getScale().x,R)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(O,Y){nc(O,fl(k,k,this.r3(),this.getRotationMode())),this.translate3d(O[0]*Y,O[1]*Y,O[2]*Y)},translateFront:function(U){this.translate3dBy([0,0,1],U)},translateBack:function(q){this.translate3dBy([0,0,-1],q)},translateLeft:function($){this.translate3dBy([-1,0,0],$)},translateRight:function(n){this.translate3dBy([1,0,0],n)},translateTop:function(k){this.translate3dBy([0,1,0],k)},translateBottom:function(S){this.translate3dBy([0,-1,0],S)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(U,i,Z){1===arguments.length&&(i=U[1],Z=U[2],U=U[0]),this.p(U,Z),this.setElevation(i)},translate3d:function(K,M,h){1===arguments.length&&(M=K[1],h=K[2],K=K[0]),this.translate(K,h),this.setElevation(this._54O+M)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(Y,T,t){1===arguments.length&&(T=Y[1],t=Y[2],Y=Y[0]),this.setSize(Y,t),this.setTall(T)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(_,Q,R){1===arguments.length&&(Q=_[1],R=_[2],_=_[0]),this.setRotationX(_),this.setRotation(-Q),this.setRotationZ(R)},setRotationY:function(m){this.setRotation(-m)},getRotationY:function(){return-this._64O},lookAtDirection:function(z,P){P=P||Vi;var d=this,R=wh(z);P===Vi?(d.r3([-D(z[1]/R),-q(z[2],z[0])+r,0]),d.setRotationMode("xzy")):P===nb?(d.r3(0,-q(z[2],z[0]),D(z[1]/R)),d.setRotationMode("zyx")):P===fq?(d.r3(0,-q(z[2],z[0])+K,-D(z[1]/R)),d.setRotationMode("zyx")):P===Bp?(d.r3([-D(z[1]/R)+r,-q(z[2],z[0])+r,0]),d.setRotationMode("xzy")):P===sm&&(d.r3([-D(z[1]/R)-r,-q(z[2],z[0])+r,0]),d.setRotationMode("xzy")),P===ze&&(d.r3([-D(z[1]/R)+K,-q(z[2],z[0])+r,K]),d.setRotationMode("zxy"))},lookAt:function(y,L){return this.lookAtDirection(rr(y,this.p3()),L)},lookAtX:function(){var p=new ge,n=new ge,Z=new ge,i=new un,P=new un,f=new C.Math.Euler;return function(b,h,D){h===fq||h===nb?i.makeRotationAxis(new C.Math.Vector3(0,1,0),Math.PI/2):h===Bp||h===sm?i.makeRotationAxis(new C.Math.Vector3(1,0,0),Math.PI/2):i.identity(),h===sm||h===nb||h===ze?(p.fromArray(this.p3()),n.fromArray(b)):(p.fromArray(b),n.fromArray(this.p3())),P.lookAt(p,n,D?Z.fromArray(D):Z.set(0,1,0)),f.setFromRotationMatrix(P.multiply(i),Gl.ReverseOrder(this.getRotationMode())),this.r3([f.x,f.y,f.z])}}(),getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(J){var _=this;if(_!==J&&_._host!==J){var c=_._host;c&&c._removeAttach(_),_._host=J,_._host&&_._host._addAttach(_),_.fp("host",c,J),_.onHostChanged(c,J)}},getAttaches:function(){return this._69O},_addAttach:function(T){var _=this;_._69O||(_._69O=new pq),_._69O.add(T),_.fp("attaches",k,T)},_removeAttach:function(C){var r=this;r._69O.remove(C),r._69O.isEmpty()&&delete r._69O,r.fp("attaches",C,k)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(w){var h=this;h._44I||(h._44I=new pq),h._42I||(h._42I=new pq),h._44I.add(w),h._42I.add(w),h._20I()},_4I:function(E){var i=this;i._44I||(i._44I=new pq),i._43I||(i._43I=new pq),i._44I.add(E),i._43I.add(E),i._20I()},_16I:function(E){var C=this;C._44I.remove(E),C._42I.remove(E),C._44I.isEmpty()&&delete C._44I,C._42I.isEmpty()&&delete C._42I,C._20I()},_18I:function(P){var q=this;q._44I.remove(P),q._43I.remove(P),q._44I.isEmpty()&&delete q._44I,q._43I.isEmpty()&&delete q._43I,q._20I()},_20I:function(){var v=this;if(delete v._45I,!v._44I||v._44I.isEmpty())return delete v._70O,void 0;var Y;v._44I.each(function(r){r.isLooped()&&(Y||(Y={}),Y[r._id]||(v._45I||(v._45I=new pq),v._45I.add(r),Y[r._id]=r))}),Y?(v._70O=new pq,v._44I.each(function(t){Y[t._id]?"A"===Y[t._id]||(Y[t._id]="A",v._70O.add(t)):v._70O.add(t)})):v._70O=v._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(x){var t=this;t._46I||(t._46I=new pq),t._48I||(t._48I=new pq),t._46I.add(x),t._48I.add(x),t._19I()},_3I:function(k){var H=this;H._47I||(H._47I=new pq),H._48I||(H._48I=new pq),H._47I.add(k),H._48I.add(k),H._19I()},_15I:function($){var n=this;n._46I.remove($),n._48I.remove($),n._46I.isEmpty()&&delete n._46I,n._48I.isEmpty()&&delete n._48I,n._19I()},_17I:function(s){var n=this;n._47I.remove(s),n._48I.remove(s),n._47I.isEmpty()&&delete n._47I,n._48I.isEmpty()&&delete n._48I,n._19I()},_19I:function(){var w=this;delete w._49I;var Y=w._48I;if(Y&&!Y.isEmpty()){var O={};Y.each(function(I){O[I._id]?w._49I||(w._49I=new pq):O[I._id]=I}),w._49I?Y.each(function(H){O[H._id]&&(w._49I.add(H),delete O[H._id])}):w._49I=Y}},getImage:function(){if(this._pendingCheckImageJSON){var i=I.getImage(this._image);i&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Zf&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(J){var A=this,R=A._image,z=A.getWidth(),e=A.getHeight();A._image=J,A.fp("image",R,J)&&(null!=J&&(wb(J)||Uc(J)&&/\.json$/i.test(J))&&(this._pendingCheckImageJSON=!0),A.fp(Qg,z,A.getWidth()),A.fp(Ch,e,A.getHeight()))},getElevation:function(){return this._54O},setElevation:function(y){var _=this;if(!_._50O){_._50O=1;var T=_._54O;_._54O=y,_.fp(xc,T,y),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(E){var J=this;if(!J._49O){J._49O=1;var B=J._64O;J._64O=E,J.fp(Qj,B,E),delete J._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(y){var C=this;if(!C._51O){C._51O=1;var W=C._rotationX;C._rotationX=y,C.fp("rotationX",W,y),delete C._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(w){var e=this;if(!e._52O){e._52O=1;var f=e._53O;e._53O=w,e.fp("rotationZ",f,w),delete e._52O}},getPosition:function(){return this._position},setPosition:function(N,Y){var G=this;if(!G._50I){G._50I=1;var E;if(E=2===arguments.length?{x:N,y:Y}:N,E.x!==G._position.x||E.y!==G._position.y){var j=G._position;G._position=E,G.fp(hs,j,E)}delete G._50I}},translate:function(I,Q){var a=this._position;this.p(a.x+I,a.y+Q)},getWidth:function(){var j=this;if(j._width>=0)return j._width;var R=j.getStyle("shape3d");if(R){var k=Rg(R);if(k&&k.rawS3)return k.rawS3[0];if("billboard"===R||"plane"===R){var h=Ne(j.getStyle("shape3d.image"));return h?Or(h,j):20}}var h=Ne(j._image);return h?Or(h,j):20},setWidth:function(O){var x=this,D=x._width;x._width=O,x.fp(Qg,D,O)},getHeight:function(){var g=this;if(g._height>=0)return g._height;var n=g.getStyle("shape3d");if(n){var z=Rg(n);if(z&&z.rawS3)return z.rawS3[2];if("plane"===n){var A=Ne(g.getStyle("shape3d.image"));return A?fb(A,g):20}if("billboard"===n)return 2}var A=Ne(g._image);return A?fb(A,g):20},setHeight:function(f){var z=this,A=z._height;z._height=f,z.fp(Ch,A,f)
},getTall:function(){var o=this;if(o._tall>=0)return o._tall;var O=o.getStyle("shape3d");if(O){var y=Rg(O);if(y&&y.rawS3)return y.rawS3[1];if("billboard"===O){var D=Ne(o.getStyle("shape3d.image"));return D?fb(D,o):20}if("plane"===O)return 2}return 20},setTall:function(B){var S=this,v=S._tall;S._tall=B,S.fp("tall",v,B)},setSize:function(u,e){var k=this;2===arguments.length?(k.setWidth(u),k.setHeight(e)):(k.setWidth(u.width),k.setHeight(u.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(U,D,E,o,F){var H=this,B=H.getAnchor(),M=H.getScale();arguments.length<=2&&(F=D,D=U.y,E=U.width,o=U.height,U=U.x);var f=F&&M.x<0?1-B.x:B.x,m=F&&M.y<0?1-B.y:B.y;H.p(U+E*f,D+o*m),F&&(E/=Math.abs(M.x),o/=Math.abs(M.y)),H.setWidth(E),H.setHeight(o)},getMatrix:function(){var A=this,R=A._64O,h=A._position,$=A.getScale();return new pf(R,h.x,h.y,$.x,$.y)},getAnchorRect:function(){var k=this,B=k.getWidth(),f=k.getHeight(),Z=k.getAnchor();return{x:-B*Z.x,y:-f*Z.y,width:B,height:f}},toLocal:function(q){return this.getMatrix().tfi(q)},toGlobal:function(w){return this.getMatrix().tf(w)},getAttachPosition:function(){var M=new pf;return function(u,g,L,f){L=L||0,f=f||0;var V=this,T=V.getAnchor(),C=V._64O,O=V._position,b=V.getScale();return M.setFromTransform(C,O.x,O.y).tf({x:L+b.x*V.getWidth()*(u-T.x),y:f+b.y*V.getHeight()*(g-T.y)})}}(),isInRect:function(i){i=this.toLocal(i);var X=this.getWidth(),j=this.getHeight();return i.x+=X*this.getAnchorX(),i.y+=j*this.getAnchorY(),!(i.x<0||i.y<0||i.x>X||i.y>j)},getRect:function(){var g=this,j=g.getWidth(),w=g.getHeight(),k=g.getAnchor(),f={x:-j*k.x,y:-w*k.y,width:j,height:w},x=g.getMatrix();return f=Fd([x.tf(f.x,f.y),x.tf(f.x+f.width,f.y),x.tf(f.x+f.width,f.y+f.height),x.tf(f.x,f.y+f.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var P=this,Q=P.getAnchor(),C=P._anchorElevation;return{x:Q.x,y:C,z:Q.y}},setAnchorElevation:function(o){var L=this,K=L._anchorElevation;return K!==o?(L._anchorElevation=o,L.fp("anchorElevation",K,o),!0):!1},setAnchor3d:function(E,z,u,Y){var C,k=this;"number"==typeof E?C={x:E,y:z,z:u}:(C=E.length?{x:E[0],y:E[1],z:E[2]}:E,Y=z);var b=k.getDataModel();b&&b.beginTransaction();var s=k.getAnchor3d(),i=k.setAnchor(C.x,C.z);if(k.setAnchorElevation(C.y)&&(i=!0),i&&Y&&!xp){k.getAnchor3d();var m=_k(k),U=nc([C.x-s.x,C.y-s.y,C.z-s.z],m);k.p3(U)}return b&&b.endTransaction(),i},getAnchor:function(){var Z=this;if(Z.hasOwnProperty("_anchor"))return Z._anchor;var w=Ne(Z._image);return w&&w.anchorX!==V?{x:w.anchorX,y:w.anchorY}:Z._anchor},setAnchor:function(z,F,s){var J,$=this;"number"==typeof z?J={x:z,y:F}:(J=z.length?{x:z[0],y:z[1]}:z,s=F);var c=$.getAnchor();if(c.x!==J.x||c.y!==J.y){var C=$.getDataModel();if(C&&C.beginTransaction(),$._anchor=J,$.fp("anchor",c,J),s&&!xp){var x=$.getPosition(),V=$.getSize(),b=$.getRotation(),G=$.getScale(),H=-V.width*(c.x-J.x)*G.x,n=-V.height*(c.y-J.y)*G.y,k=e(b),i=P(b);$.setPosition(x.x+i*H-k*n,x.y+k*H+i*n)}return C&&C.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(J,Z){var j,D=this;j=2===arguments.length?{x:J,y:Z}:J;var C=D.getScale();(C.x!==j.x||C.y!==j.y)&&(D._scale=j,D.fp("scale",C,j))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var f=this,l=f._scaleTall,E=f.getScale();return[E.x,l,E.y]},getFinalScale3d:function(){var h=this,$=h.s3(),u=h._dynamicScale3d,e=h.getScale3d();return $&&(e[0]*=$[0],e[1]*=$[1],e[2]*=$[2]),u&&(e[0]*=u[0],e[1]*=u[1],e[2]*=u[2]),e},getFinalRotation3d:function(){var V=this;return V._dynamicRotation||V.r3()},setScaleTall:function(Y){var $=this,p=$._scaleTall;p!==Y&&($._scaleTall=Y,$.fp("scaleTall",p,Y))},setScale3d:function(g,J,s){var G,r=this;G="number"==typeof g?{x:g,y:J,z:s}:g.length?{x:g[0],y:g[1],z:g[2]}:g,r.setScaleTall(G.y),r.setScale(G.x,G.z)},getCorners:function(a,h){a==k&&(a=0),h==k&&(h=a);var V=this,g=V.getAnchor(),c=V.getWidth(),K=V.getHeight(),f=-c*g.x-a,W=-K*g.y-h,o=c+2*a,E=K+2*h,D=V.getMatrix();return[D.tf(f,W),D.tf(f,W+E),D.tf(f+o,W+E),D.tf(f+o,W)]},getEditControlPoints:function(w,t,s){t==k&&(t=0),s==k&&(s=t);var Y=this,y=Y.getAnchor(),P=Y.getWidth(),r=Y.getHeight(),h=-P*y.x-t,l=-r*y.y-s,D=P+2*t,K=r+2*s;if(w)return[{x:h,y:l},{x:h,y:0},{x:h,y:l+K},{x:0,y:l+K},{x:h+D,y:l+K},{x:h+D,y:0},{x:h+D,y:l},{x:0,y:l}];var v=Y.getMatrix();return[v.tf(h,l),v.tf(h,0),v.tf(h,l+K),v.tf(0,l+K),v.tf(h+D,l+K),v.tf(h+D,0),v.tf(h+D,l),v.tf(0,l)]},rotateAt:function(Z,v,d){var H=this,C=H._position,n=H._64O,X=new pf(n,C.x,C.y).tf(Z,v),z=i(Z*Z+v*v),M=q(C.y-X.y,C.x-X.x)+d;H.setRotation(n+d),H.p(X.x+z*P(M),X.y+z*e(M))},onParentChanged:function(){gd.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(B){B._7I()})},onPropertyChanged:function(){var f={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(b){f[b]=!0}),function(i){var c=this;gd.superClass.onPropertyChanged.call(c,i),f[i.property]&&!c._layoutUpdating&&c.updateLayoutParameters(null,i.property),c._69O&&c._69O.each(function(w){w.handleHostPropertyChange(i)}),c._49I&&c._49I.each(function(t){t.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(y){this.updateAttach(y)},onStyleChanged:function(t){gd.superClass.onStyleChanged.apply(this,arguments),Mq[t]&&this.updateAttach()},updateAttach:function(t){var P=this;P._51I||xp||(P._51I=1,P._71O(t),delete P._51I)},_71O:function(c){var x,h,_,H,I,N,U=this,P=U._host,M=c?c.property:k,L=c?c.oldValue:k,e=c?c.newValue:k;if(P instanceof C.Grid){if(M===xc)U.setElevation(U._54O+e-L);else if(!c||Kq[M]){if(x=U.s("attach.row.index"),h=U.s("attach.column.index"),_=P.getCellRect(x,h),!_)return;H=U.s("attach.row.span"),I=U.s("attach.column.span"),(1!==H||1!==I)&&(_=je(_,P.getCellRect(x+H-1,h+I-1))),ud(_,U,"attach.padding",1),U.setRect(_)}}else if(P instanceof ld&&(N=U.s("attach.index"))>=0&&(!c||Lb[M])){var z=U.s("attach.thickness");z!=k&&U.setHeight(P.getThickness()*z);var u=U.s("attach.offset"),J=P.getPoints(),t=J.size();if(t>N){var B=J.get(N),y=t===N+1?J.get(0):J.get(N+1),Y=[y.x-B.x,y.y-B.y],d=wh(Y);if(d){U.s("attach.offset.relative")&&(u*=d),U.s("attach.offset.opposite")&&(u=d-u);var s={x:B.x+Y[0]/d*u,y:B.y+Y[1]/d*u},m=U.s("attach.gap");m&&(U.s("attach.gap.relative")&&(m*=P.getThickness()),s=Pi(k,s,y,m)),U.p(s),U.setRotation(q(Y[1],Y[0]))}}}else c&&(M===hs?U.translate(e.x-L.x,e.y-L.y):M===xc?U.setElevation(U._54O+e-L):Hg[M]?U._11Q(P,M,e-L):("anchor"===M||"width"===M||"height"===M||"scale"===M)&&U.layout(P))},_11Q:function(){var H=new C.Math.Euler,v=C.Math.Euler.ReverseOrder,z=new C.Math.Vector2,l=new C.Math.Vector2;return function(b,L,m){var a=this,U=b.p3(),T=b.r3(),s=a.p3(),w=a.r3();if(L===Qj&&(L="rotationY",m=-m),(L===Qj||"rotationY"===L)&&0===w[0]&&0===w[2]&&0===T[0]&&0===T[2]&&0===s[1]&&0===U[1])return a.setRotation(-w[1]-m),z.set(s[0],s[2]).rotateAround(l.set(U[0],U[2]),-m),a.p(z.x,z.y),void 0;var $=Aq[b.getRotationMode()],r=$[0],k=$[1],I=$[2],o=Sm[r],C=Sm[k],P=Sm[I],x=cn();L===Qj+r?(P(x,T[lo[I]]),C(x,T[lo[k]]),o(x,m),C(x,-T[lo[k]]),P(x,-T[lo[I]])):L===Qj+k?(P(x,T[lo[I]]),C(x,m),P(x,-T[lo[I]])):L===Qj+I&&P(x,m);var Z=rr(s,U);nc(Z,x),a.p3(U[0]+Z[0],U[1]+Z[1],U[2]+Z[2]);var E=a.getRotationMode();wi(x,a.r3(),E),H.setFromRotationMatrix(x,v(E)),a.r3([H.x,H.y,H.z])}}(),isHostOn:function(Y){var P=this;if(P._host&&Y&&Y._69O)for(var m={},G=P._host;G&&G!==P&&!m[G._id];){if(G===Y)return!0;m[G._id]=G,G=G._host}return!1},isLoopedHostOn:function(c){return this.isHostOn(c)&&c.isHostOn(this)},getScaledSize:function(){var d=this.getSize(),j=this.getScale();return d.width*=Math.abs(j.x),d.height*=Math.abs(j.y),d},layout:function(v){if(v=v||this.getHost()){var u=this,K=u.s("layout.h")||"center",y=u.s("layout.v")||"center";if("center"!==K||"center"!==y){var S=new C.Math.Vector2,j=v.getPosition(),l=v.getAnchor(),c=v.getScaledSize();u.getPosition();var L,a,$,m,h,w=1,P=1;switch(u._layoutUpdating=!0,K){case"left":S.setX(u._layoutHValue-l.x*c.width);break;case"right":S.setX((1-l.x)*c.width-u._layoutHValue);break;case"leftright":L=c.width-u._layoutHValue[2],$=u.getRotation()-v.getRotation(),m=Math.abs(Math.sin($)),h=Math.abs(Math.cos($)),w+=h*L/u._layoutHValue[3],P+=m*L/u._layoutHValue[4],S.setX(u._layoutHValue[1]+(u._layoutHValue[5]-l.x)*c.width);break;case"center":S.setX((.5-l.x)*c.width-u._layoutHValue);break;case"scale":$=u.getRotation()-v.getRotation(),m=Math.abs(Math.sin($)),h=Math.abs(Math.cos($)),S.setX((.5-l.x)*c.width-u._layoutHValue[1]*c.width/u._layoutHValue[0]),a=c.width/u._layoutHValue[2]-1,w+=h*a,P+=m*a}switch(y){case"top":S.setY(u._layoutVValue-l.y*c.height);break;case"bottom":S.setY((1-l.y)*c.height-u._layoutVValue);break;case"topbottom":$||($=u.getRotation()-v.getRotation(),m=Math.abs(Math.sin($)),h=Math.abs(Math.cos($))),L=c.height-u._layoutVValue[2],w+=m*L/u._layoutVValue[3],P+=h*L/u._layoutVValue[4],S.setY(u._layoutVValue[1]+(u._layoutVValue[5]-l.y)*c.height);break;case"center":S.setY((.5-l.y)*c.height-u._layoutVValue);break;case"scale":$||($=u.getRotation()-v.getRotation(),m=Math.abs(Math.sin($)),h=Math.abs(Math.cos($))),S.setY((.5-l.y)*c.height-u._layoutVValue[1]*c.height/u._layoutVValue[0]),a=c.height/u._layoutVValue[2]-1,w+=m*a,P+=h*a}(1!==w||1!==P)&&("leftright"===K||"scale"===K?u.setSize(u._layoutHValue[3]*w,u._layoutHValue[4]*P):u.setSize(u._layoutVValue[3]*w,u._layoutVValue[4]*P)),S.rotateAround(null,v.getRotation()),this.setPosition(S.x+j.x,S.y+j.y),u._layoutUpdating=V}}},updateLayoutParameters:function(x,p){if(x=x||this.getHost()){var N=this,F=N.s("layout.h"),T=N.s("layout.v");if(F||T){var K,G,w,r,s,c,H=new C.Math.Vector2,U=x.getPosition(),k=x.getAnchor(),$=x.getScaledSize(),e=N.getPosition(),Y=N.getSize();switch(H.set(e.x-U.x,e.y-U.y),H.rotateAround(null,-x.getRotation()),F){case"left":N._layoutHValue=H.x+k.x*$.width;break;case"right":N._layoutHValue=-H.x+(1-k.x)*$.width;break;case"center":N._layoutHValue=-H.x+(.5-k.x)*$.width;break;case"leftright":case"scale":"scale"===F?K=-H.x+(.5-k.x)*$.width:(G=N.getAnchor(),w=N.getRotation()-x.getRotation(),r=Math.cos(w),s=Math.sin(w),c=-Math.min(-G.x*r+G.y*s,-G.x*r-(1-G.y)*s,(1-G.x)*r+G.y*s,(1-G.x)*r-(1-G.y)*s),K=H.x-(c-k.x)*$.width),"position"===p&&"object"==typeof N._layoutHValue?(N._layoutHValue[0]=$.width,N._layoutHValue[1]=K):N._layoutHValue=[$.width,K,$.width,Y.width,Y.height,c]}switch(T){case"top":N._layoutVValue=H.y+k.y*$.height;break;case"bottom":N._layoutVValue=-H.y+(1-k.y)*$.height;break;case"center":N._layoutVValue=-H.y+(.5-k.y)*$.height;break;case"topbottom":case"scale":"scale"===T?K=-H.y+(.5-k.y)*$.height:(w||(G=N.getAnchor(),w=N.getRotation()-x.getRotation(),r=Math.cos(w),s=Math.sin(w)),c=-Math.min(-G.x*s-G.y*r,-G.x*s+(1-G.y)*r,(1-G.x)*s-G.y*r,(1-G.x)*s+(1-G.y)*r),K=H.y-(c-k.y)*$.height),"position"===p&&"object"==typeof N._layoutVValue?(N._layoutVValue[0]=$.height,N._layoutVValue[1]=K):N._layoutVValue=[$.height,K,$.height,Y.width,Y.height,c]}}}},getSerializableProperties:function(){var E=gd.superClass.getSerializableProperties.call(this);return fs(E,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),E}});var al=C.Edge=function(E,J){var e=this;uj(al,e),e.setSource(E),e.setTarget(J)};zo("Edge",Sk,{_icon:"edge_icon",getUIClass:function(){return Vq},_22Q:function(){return mc},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(Z){var T=this;if(T._source!==Z){var K=T._source;T._source=Z,K&&K._16I(T),Z&&Z._2I(T),T._7I(),T.fp("source",K,Z)}},setTarget:function(x){var m=this;if(m._target!==x){var T=m._target;m._target=x,T&&T._18I(m),x&&x._4I(m),m._7I(),m.fp("target",T,x)}},isLooped:function(){var h=this;return h._source===h._target&&!!h._source&&!!h._target},_7I:function(){var C,l=this,y=Ar(l);l._40I!==y&&(C=this._40I,C&&C._15I(l),l._40I=y,y&&y._1I(l),l.fp("sourceAgent",C,y),Yc(C,l._41I),Yc(y,l._41I));var f=lg(l);l._41I!==f&&(C=l._41I,C&&C._17I(l),l._41I=f,f&&f._3I(l),l.fp("targetAgent",C,f),Yc(C,l._40I),Yc(f,l._40I))},_22I:function(G){this._52I=G,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var G=this;return G._52I&&G._52I.get(0)!==G&&!G.getStyle(Og)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var p=this,r=p._52I;return r&&!p.getStyle(Og)&&r.size()>1&&p===r.get(0)},toggle:function(){var R=this._52I,s=!this.s(Og);R&&R.size()>1&&(R.each(function(E){E.s(Og,s)}),R.getSiblings().each(function(m){m!==R&&m.each(function(l){l.fp("edgeGroup",k,m)})}))},setStyle:function(j,w){(j===ee||"edge.segments"===j)&&(w=Uj(w)),al.superClass.setStyle.call(this,j,w)},onStyleChanged:function(F){al.superClass.onStyleChanged.apply(this,arguments),ij[F]&&Yc(this._41I,this._40I)},getSerializableProperties:function(){var z=al.superClass.getSerializableProperties.call(this);return fs(z,{source:1,target:1}),z}});var te=C.Group=function(){uj(te,this)};zo("Group",gd,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return lc},onChildAdded:function(){te.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){te.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var s=this;if(!s._54I&&!xp){var G=s.getChildrenRect();G&&(s._53I=1,s.p(uk(s.s("group.position"),G,s.getSize())),delete s._53I)}},getChildrenRect:function(){var t,o=this;return o.eachChild(function(K){t=je(t,o.getChildRect(K))}),t},getChildRect:function(p){var x;return tn(p)&&p.s(Jj)&&(Qb(p)&&p.isExpanded()&&p.eachChild(function(N){x=je(x,p.getChildRect(N))}),!x&&p.getRect&&(x=p.getRect())),x},setPosition:function(l,X){var L=this;if(!L._54I){var M;M=2===arguments.length?{x:l,y:X}:l,xp||L._53I||(L._54I=1,_e(L._children,M.x-L._position.x,M.y-L._position.y),delete L._54I),te.superClass.setPosition.call(this,M)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(o){var G=this;if(G._57O!==o){var O=G._57O;G._57O=o,G.fp("expanded",O,G._57O),G._fireInvalidateDeep(),G._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(A){Qb(A)?A._fireInvalidateDeep():A.iv()})},_8I:function(){te.superClass._8I.call(this),this.eachChild(function(o){tn(o)&&o._8I()})},onStyleChanged:function(e){te.superClass.onStyleChanged.apply(this,arguments),"group.position"===e&&this._81I()},getSerializableProperties:function(){var e=te.superClass.getSerializableProperties.call(this);return e.expanded=1,e}});var as=C.Block=function(){uj(as,this)};zo("Block",gd,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Kf},onChildAdded:function(){as.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){as.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var y=this;if(!xp&&!y._updatingToChildren&&y._syncSize&&!y._freezeSyncFromChildren){var Q,q,R,J,f,v=[],l=y.getRotation();if(y.eachChild(function(W){tn(W)&&v.push.apply(v,W.getCorners())}),v.length){y._updatingFromChildren=1;var g=P(-l),n=e(-l),W=1/0,w=-1/0,x=1/0,u=-1/0;for(J=0,f=v.length;f>J;J++)R=v[J],Q=R.x,q=R.y,R.x=g*Q-n*q,R.y=n*Q+g*q,W=$(W,R.x),w=j(w,R.x),x=$(x,R.y),u=j(u,R.y);var S=y.getScale();y.setSize(F((w-W)/S.x),F((u-x)/S.y));var L;S.x<0&&(L=W,W=w,w=L),S.y<0&&(L=x,x=u,u=L),g=P(l),n=e(l);var G=y.getAnchor();Q=W+(w-W)*G.x,q=x+(u-x)*G.y,y.setPosition(g*Q-n*q,n*Q+g*q),delete y._updatingFromChildren}}},setPosition:function(N,g){var z=this;if(!z._updatingToChildren){var n;n=2===arguments.length?{x:N,y:g}:N,xp||z._updatingFromChildren||(z._updatingToChildren=1,_e(z._children,n.x-z._position.x,n.y-z._position.y),delete z._updatingToChildren),as.superClass.setPosition.call(this,n)}},setWidth:function(N){return this.setSize(N,this.getHeight())},setHeight:function(P){return this.setSize(this.getWidth(),P)},setSize:function(I,R){1>I&&(I=1),1>R&&(R=1);var s=this;if(!s._updatingToChildren){2!==arguments.length&&(R=I.height,I=I.width);var d=s.getWidth(),T=s.getHeight();if(I!==d&&as.superClass.setWidth.call(s,I),R!==T&&as.superClass.setHeight.call(s,R),!xp&&!s._updatingFromChildren){s._updatingToChildren=1;var B=I/d,x=R/T;s._adjustChildScaleOrSize(B,x,"size"),delete s._updatingToChildren,s.updateFromChildren()}}},_adjustChildScaleOrSize:function(c,w,H){var V=this;if(V._syncSize){var W=V.getPosition(),o=V.getRotation();V.getScale(),V.eachChild(function(Y){if(tn(Y)){var S=Y.getPosition(),E=Y.getRotation(),i=Y.getWidth(),v=Y.getHeight(),p=Y.getScale(),D=p.x*i,M=p.y*v,X=new pf(E,S.x,S.y,D,M);X.translate(-W.x,-W.y),X.rotate(-o),E=q(X.b*Math.sign(D),X.a*Math.sign(D)),X.scale(c,w);var r,z,t,b=P(E);if(Math.abs(b)<.001?(r=e(E),z=X.b/r,t=-X.c/r):(z=X.a/b,t=X.d/b),"scale"===H)Y.setScale(z/i,t/v);else if("size"===H){var T=z/p.x,K=t/p.y;Y.setScale(Pf(z)*Math.abs(p.x),Pf(t)*Math.abs(p.y)),Y.setSize(Math.max(.1,Math.abs(T)),Math.max(.1,Math.abs(K)))}X.rotate(o),X.translate(W.x,W.y),Y.setPosition(X.tx,X.ty)}})}},_calcChangeFactor:function(d,L,s,E){var A,Z,o,U;return A=F(d),Z=F(s),o=A>Z?A/Z:Z/A,A=F(L),Z=F(E),U=A>Z?A/Z:Z/A,j(o,U)},setAnchor:function(){var X=this;if(!X._updatingToChildren){var _=X.getAnchor();if(as.superClass.setAnchor.apply(X,arguments),!xp&&!X._updatingFromChildren&&X._syncSize){X._updatingToChildren=1;var V=X.getAnchor();X.getPosition();var l=X.getSize(),C=X.getScale(),N=X.getRotation(),F=-l.width*C.x*(_.x-V.x),I=-l.height*C.y*(_.y-V.y),Y=e(N),d=P(N),n=d*F-Y*I,x=Y*F+d*I;X.eachChild(function(d){if(tn(d)){var m=d.getPosition();d.setPosition(m.x-n,m.y-x)}}),delete X._updatingToChildren}}},setRotation:function(w){var K=this;if(!K._updatingToChildren){var B=K.getRotation();if(as.superClass.setRotation.apply(K,arguments),!xp&&!K._updatingFromChildren){K._updatingToChildren=1;var G=K.getPosition(),p=w-B;K.eachChild(function(S){if(tn(S)){var A=S.getMatrix();A.translate(-G.x,-G.y),A.rotate(p),A.translate(G.x,G.y);var H=Math.sign(S.getScale().x);S.setRotation(q(A.b*H,A.a*H)),S.setPosition(A.tx,A.ty)}}),delete K._updatingToChildren}}},setScale:function(A,L){var Y=this;if(!Y._updatingToChildren){null==L&&(L=A.y,A=A.x);var b=Y.getScale();if(F(A)<.01&&(A=.01*(Pf(A)||Pf(b.x))),F(L)<.01&&(L=.01*(Pf(L)||Pf(b.y))),as.superClass.setScale.call(Y,A,L),!xp&&!Y._updatingFromChildren){Y._updatingToChildren=1;var n=A/b.x,Q=L/b.y;Y._adjustChildScaleOrSize(n,Q,"size"),delete Y._updatingToChildren,Y.updateFromChildren()}}},getSerializableProperties:function(){var x=as.superClass.getSerializableProperties.call(this);return x.clickThroughEnabled=1,x.syncSize=1,x}});var dh=C.Grid=function(){uj(C.Grid,this)};zo("Grid",gd,{IRotatable:!1,_icon:"grid_icon",_image:k,getUIClass:function(){return Mm},setRotation:function(){},getCellRect:function(w,$){var o=this,i=o.s("grid.row.count"),p=o.s("grid.column.count");if(0>=i||0>=p||0>w||w>=i||0>$||$>=p)return k;var P,I,b,V=o.getRect(),g=o.s("grid.row.percents"),M=o.s("grid.column.percents");if(ud(V,o,"grid.border",-1),g&&g._as&&(g=g._as),M&&M._as&&(M=M._as),g&&g.length===i){for(b=0,P=0;w>P;P++)b+=V.height*g[P];V.y+=b,V.height=V.height*g[w]}else V.height=V.height/i,V.y+=V.height*w;if(M&&M.length===p){for(I=0,P=0;$>P;P++)I+=V.width*M[P];V.x+=I,V.width=V.width*M[$]}else V.width=V.width/p,V.x+=V.width*$;return Oq(V,-o.s("grid.gap")),V}});var xe=C.Text=function(){uj(xe,this),this.setSize(100,50),this.s("text","TEXT")};zo("Text",gd,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return ao},setWidth:function(y){y||(y=.001),xe.superClass.setWidth.call(this,y)},setHeight:function(d){d||(d=.001),xe.superClass.setHeight.call(this,d)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),yg("__text__",{width:{value:100,isSafeFunc:!0,func:function(C){return C._width}},height:{value:50,isSafeFunc:!0,func:function(W){return W._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var ld=C.Shape=function(){uj(ld,this),this._59O=new pq};ld.__de__=Cf,zo("Shape",gd,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Ek},_22Q:function(){return dj},getLength:function(L){return Ao(vb(this._59O,this._58O,L,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var i=this._58O;return i?new pq(i._as.slice(0)):i},setSegments:function(f){var _=this._58O;f=f?sn(f)?new pq(f.slice(0)):new pq(f._as.slice(0)):null,(_&&f&&_._as.join(",")!==f._as.join(",")||_!==f)&&(this._58O=f,this.fp("segments",_,f))},getPoints:function(){return this._59O},toPoints:function(){var p=this._59O;return new pq(p._as.slice(0))},setPoints:function(y,T){var G=this,n=G._59O;y=y?sn(y)?new pq(y.slice(0)):new pq(y._as.slice(0)):new pq;var B,h,v,E,K,w;T&&(B=G.getPosition(),w=new pf(G.getRotation(),0,0,G.getScale().x,G.getScale().y)),(n&&y&&n._as.join(",")!==y._as.join(",")||n!==y)&&(G._59O=y,G.fs(),G.fp("points",n,y)),T&&(h=G.getPosition(),v=h.x-B.x,E=h.y-B.y,K=w.tf(v,E),G.setPosition(h.x-v+K.x,h.y-E+K.y))},addPoint:function(p,H,T){var M=this.toPoints();M.add(p,H),this.setPoints(M,T)},setPoint:function(M,J,l){var i=this.toPoints();i.set(M,J),this.setPoints(i,l)},removePointAt:function(E){var v=this.toPoints();v.removeAt(E),this.setPoints(v)},setWidth:function(O){var S=this;if(1>O&&(O=1),!S._55I&&!xp&&S.getWidth()){S._55I=1;var v=S._position.x,w=O/S.getWidth(),h=S.toPoints(),D=new pq;h.each(function(O){D.add({x:(O.x-v)*w+v,y:O.y,e:O.e})}),S.setPoints(D),vm(S,[w,0,0,1,v*(1-w),0]),S.fs(),delete S._55I}ld.superClass.setWidth.call(S,O)},setHeight:function(K){var j=this;if(1>K&&(K=1),!j._55I&&!xp&&j.getHeight()){j._55I=1;var d=j._position.y,e=K/j.getHeight(),f=j.toPoints(),O=new pq;f.each(function(p){O.add({x:p.x,y:(p.y-d)*e+d,e:p.e})}),j.setPoints(O),vm(j,[1,0,0,e,0,d*(1-e)]),j.fs(),delete j._55I}ld.superClass.setHeight.call(j,K)},setAnchorElevation:function(Y){var h=this;h._55I=!0;var a=h._updatingAnchor3d,m=!xp&&!a;if(m){var E,l=Y,o=h.getAnchorElevation(),g=h.getTall();E=g*(o-l),h.shiftPointsElevation(E)}var N=ld.superClass.setAnchorElevation.apply(h,arguments);return a||delete h._55I,N},getShapeElevation:function(){var G=this,n=G._54O;return n-(G.getTall()||0)*(G._anchorElevation-.5)},setAnchor3d:function(x,F,X,n){var R,Z=this;"number"==typeof x?R={x:x,y:F,z:X}:(R=x.length?{x:x[0],y:x[1],z:x[2]}:x,n=F),Z._55I=!0,Z._updatingAnchor3d=!0;var j=Z.getDataModel();if(j&&j.beginTransaction(),!xp){var J=Z.getAnchor3d(),h=Z.getSize(),k=Z.getTall(),y=h.width*(J.x-R.x),Q=h.height*(J.z-R.z),w=k*(J.y-R.y);n||Z.shiftPoints(y,Q,w);var L=Z.p3()}var b=ld.superClass.setAnchor3d.apply(Z,arguments);if(!xp&&n){var e=Z.p3();Z.shiftPoints(e[0]-L[0]+y,e[2]-L[2]+Q,e[1]-L[1]+w)}return j&&j.endTransaction(),delete Z._updatingAnchor3d,delete Z._55I,b},setAnchor:function(Q,G,y){var C=this;C._55I=!0;var E=C._updatingAnchor3d,W=!xp&&!E;if(W){var h,e,U;"number"==typeof Q?U={x:Q,y:G}:(U=Q.length?{x:Q[0],y:Q[1]}:Q,y=G);var B=C.getAnchor(),A=C.getSize();h=A.width*(B.x-U.x),e=A.height*(B.y-U.y),y||C.shiftPoints(h,e);var p=C.getPosition()}var i=ld.superClass.setAnchor.apply(C,arguments);if(W){var x=C.getPosition();y&&C.shiftPoints(x.x-p.x+h,x.y-p.y+e)}return E||delete C._55I,i},shiftPoints:function(j,g,i){var v=this,M=v.getElevation()||0,b=v.toPoints(),a=new pq;b.each(function(q){var Q=q.e;i&&(Q=(Q==k?M:Q)+i),a.add({x:q.x+j,y:q.y+g,e:Q})}),v.setPoints(a),v.fs()},shiftPointsElevation:function(e){return this.shiftPoints(0,0,e)},setPosition:function(s,z){var c,N=this;if(!N._28Q){if(N._28Q=1,!N._55I&&!xp){c=2===arguments.length?{x:s,y:z}:s;var J=c.x-N._position.x,C=c.y-N._position.y;if(0===J&&0===C)return delete N._28Q,void 0;N._55I=1,N.shiftPoints(J,C),vm(N,[1,0,0,1,J,C]),delete N._55I}ld.superClass.setPosition.apply(N,arguments),delete N._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var V=this;if(2!==V._59O.size())return!1;var $=V._58O;return $?2===$.size()&&1===$.get(0)&&2===$.get(1)?!0:!1:!0},fireShapeChange:function(){var v=this;if(!v._55I&&!xp){var z=Fd(v._59O);z&&(v._55I=1,v.setRect(z),delete v._55I)}v.fp(Dq,!1,!0)},getSerializableProperties:function(){var L=ld.superClass.getSerializableProperties.call(this);return L.segments=1,L.points=1,L.thickness=1,L.closePath=1,L}});var zf=C.Polyline=function(){uj(zf,this),this.s({"shape.background":null,"shape.border.width":2})};zo("Polyline",ld,{_icon:"polyline_icon",_22Q:function(){return gb},getUIClass:function(){return Sd},setClosePath:function(){},setTall:function(q){var g=this;if(!g._55I&&!g._24Q&&!xp&&g.getTall()){g._24Q=1;var L=g._54O,e=q/g.getTall();g._59O.each(function(P){P.e=P.e==k?L:(P.e-L)*e+L}),g.fs(),delete g._24Q}zf.superClass.setTall.call(g,q)},setElevation:function(z){var B=this;if(!B._55I&&!B._24Q&&!xp){B._24Q=1;var b=z-B._54O;B._59O.each(function(g){g.e==k?g.e=z:g.e+=b}),B.fs(),delete B._24Q}zf.superClass.setElevation.apply(B,arguments)},fireShapeChange:function(){var I=this,x=I._59O;if(!I._55I&&!I._24Q&&!xp){var m=x.size();if(m){var H=1,T=x.get(0),t=I._54O;T.e==k&&(T.e=t);for(var s=T.e,l=0;m>H;H++){T=x.get(H),T.e==k&&(T.e=t);var b=$(s,T.e),P=j(s+l,T.e);s=b,l=P-b}I._24Q=1,I.setTall(l),I.setElevation(s+l*I._anchorElevation),delete I._24Q}}zf.superClass.fireShapeChange.apply(I,arguments)}});var Fg=C.SubGraph=function(){uj(Fg,this)};zo("SubGraph",gd,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Fg.superClass._8I.call(this),this.eachChild(function(o){tn(o)&&o._8I()})}}),I.loadingRefGraph=0;var Zf=C.RefGraph=function(){uj(Zf,this)};zo("RefGraph",as,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(D){var B=this._ref;this._ref=D,this.fp("ref",B,D),this.updateRef()},_21I:function(){Zf.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var $=this;if(I.loadingRefGraph++,$.clearChildrenFromDataModel(),I.loadingRefGraph--,$._ref&&$._dataModel){$._xhrLoadHandler&&($._xhrLoadHandler.cancel=!0);var n=xp,F=$._xhrLoadHandler=function(W){if(W&&$._dataModel){I.loadingRefGraph++;var C=$._pendingUpdateInfo={needToRestore:n};n&&(C.position=$.p(),C.width=$.getWidth(),C.height=$.getHeight(),C.rotation=$.getRotation(),C.anchor=$.getAnchor(),C.scale=$.getScale()),$.p(0,0),$.setAnchor(.5,.5),$.setRotation(0),$.setScale(1,1);var j=I.parse(W),T=$._dataModel.deserialize(j,$,{justDatas:!0});T.each(function(q){q._refGraph=$}),$.checkPendingUpdateInfo(),I.loadingRefGraph--,I.handleRefGraphLoaded($,T,j)}};F.xhrLoadCalled=!1,I.load($._ref,function(n){F.cancel||(F.xhrLoadCalled?F(n):Cm(function(){F(n)}))}),F.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var T=this,f=T._pendingUpdateInfo;if(!f)return T.onPendingUpdated&&(I.loadingRefGraph++,T.onPendingUpdated(),I.loadingRefGraph--),void 0;var d=!0;this.eachChild(function(r){(r._pendingCheckImageJSON||r._pendingUpdateInfo)&&(d=!1)}),d&&(I.loadingRefGraph++,T._pendingUpdateInfo=null,T.updateFromChildren(),f.needToRestore&&(T.setSize(f.width,f.height),T.setAnchor(f.anchor),T.setRotation(f.rotation),T.setScale(f.scale),T.p(f.position)),this.getParent()instanceof Zf&&this.getParent().checkPendingUpdateInfo(),T.onPendingUpdated&&T.onPendingUpdated(),I.loadingRefGraph--)},getSerializableProperties:function(){var Q=Zf.superClass.getSerializableProperties.call(this);return Q.ref=1,Q}}),C.EdgeGroup=function(w,g){this._70O=w,this._siblings=g;for(var z,r,F=0,t=w.size(),M=_[Og];t>F;F++)if(z=w.get(F).getStyle(Og,!1),z!=k){M=z;break}M==k&&(M=!0);var B=I.edgeGroupAgentFunc;for(B&&(r=B(w),r&&r!==w.get(0)&&(w.remove(r),w.add(r,0))),F=0;t>F;F++)w.get(F).s(Og,M)},zo("EdgeGroup",c,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(A){return this._70O.get(A)},indexOf:function(Y){return this._70O.indexOf(Y)},each:function(u,q){this._70O.each(u,q)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(S,p){this._siblings.each(function(r){r._70O.each(S,p)})}});var Ei=function(u,U,P){var Y=xh[u]={type:u,action:U};if(P)for(var F in P)Y[F]=P[F]};fs(I,{setConnectAction:Ei,getConnectAction:function(u,D){if(!D){if(!u)return null;D=u.getCurrentConnectActionType()}return xh[D]},doConnectAction:function(T,K,V,n){n=n||T.getCurrentConnectActionType();var h=xh[n];if(!h)return!1;var Q=h.action;return Q?(K instanceof bs.Group?T.sm().getSelection().each(function(e){Q.call(null,T,e,V)}):Q.call(null,T,K,V),!0):!1},doDeleteConnectionAction:function(z,U,Z){Z=Z||z.getCurrentConnectActionType();var p=xh[Z];if(!p||!p.delete)return!1;var A=p.delete.action;return A?(U instanceof bs.Group?z.sm().getSelection().each(function(O){A.call(null,z,O)}):A.call(null,z,U),!0):!1}});var oh=C.JSONSerializer=function(J,N){this.dm=this._dataModel=J,this._hierarchical=I.forceHierarchicalSerialization?!0:N==k?J.isHierarchicalRendering():N};zo("JSONSerializer",c,{ms_ac:["hierarchical"],serialize:function(O){return I.stringify(this.toJSON(),O)},toJSON:function(){var r=this,z=r.dm,B=z.getRoots(),Y=r.json={v:I.getVersion(),p:{},a:{},d:[]},f=z.getSerializableAttrs();z.getInit()&&(Y.init=z.getInit()),z.getName()&&(Y.p.name=z.getName()),z.getBackground()&&(Y.p.background=z.getBackground()),z.getLayers()&&(Y.p.layers=z.getLayers()),z.getEnvmap()&&(Y.p.envmap=z.getEnvmap()),Y.p.autoAdjustIndex=z.isAutoAdjustIndex(),Y.p.hierarchicalRendering=z.isHierarchicalRendering();for(var O in f){var p=z.a(O);p!==V&&r[ii](O,p,Y.a)}return cq(Y.a)&&delete Y.a,r._hierarchical?B.each(r.serializeData,this):z.each(function(S){r.serializeData(S)}),z.fireSerializeEvent({type:"serialize",json:Y}),z.getPostProcessingData()&&(Y.p.postProcessingData=z.getPostProcessingData()),Y},isSerializable:function(){return!0},getProperties:function(T){return T.getSerializableProperties()},getStyles:function(Y){return Y.getSerializableStyles()},getAttrs:function(b){return b.getSerializableAttrs()},serializeData:function(s){var n=this;if(n.isSerializable(s)&&!s._refGraph){var c,K,H,e,x=sg(s.getClassName())||s.getClass(),A=new x,i={c:s.getClassName(),i:s.getId(),p:{},s:{},a:{}};n.json.d.push(i),c=n.getProperties(s);for(K in c)/^_/.test(K)?(H=s[K],"_width"!==K&&"_height"!==K||H!==V||((s.s("layout.h")||s.s("layout.v"))&&s.getHost()||s.s("fullscreen"))&&(H=s[K]="_width"===K?s.getWidth():s.getHeight()),H!==A[K]&&n[ii](K.substr(1),H,i.p)):(e=sl(K),s[e]&&(H=s[e](),H!==A[e]()&&n[ii](K,H,i.p)));c=n.getStyles(s);for(K in c)H=s.s(K),H!==A.s(K)&&n[ii](K,H,i.s);c=n.getAttrs(s);for(K in c)H=s.a(K),H!==A.a(K)&&n[ii](K,H,i.a);cq(i.p)&&delete i.p,cq(i.s)&&delete i.s,cq(i.a)&&delete i.a}n._hierarchical&&s.getChildren().each(n.serializeData,n)},serializeValue:function(R,t,K){Zq(t)?t={__a:t._as}:t instanceof Sk&&(t={__i:t.getId()}),K[R]=t},deserialize:function(l,K,B){var f=this;return Uc(l)&&/.json$/.test(l)?(I.xhrLoad(l,function(u){f.deserializeImpl(u,K,B)}),void 0):f.deserializeImpl(l,K,B)},deserializeImpl:function(g,_,t){var P=this,C=P.dm;t=Wq(t)?{setId:t}:od(t)?{finishFunc:t}:t||{},g=P.json=Uc(g)?I.parse(g):g,g.a&&g.a.onPreDeserialize&&!t.disableOnPreDeserialize&&g.a.onPreDeserialize(g,C,t.view),C.beginTransaction(),xp++,P._82I={};var K=new pq,z=new pq,q=0,H=g.d.length;if(t.justDatas||(od(g.init)&&g.init(C),C.setInit(g.init)),!t.justDatas){for(var v in g.a)C.a(v,P[yl](g.a[v]));for(var J in g.p)C[di(J)](g.p[J])}for(;H>q;q++){var w=g.d[q],A=sg(w.c),e=new A,F=w.i;t.setId&&F!=k&&(e._id=F),P._82I[F]=e,K.add(e),z.add(w)}for(q=0;H>q;q++)P.deserializeData(K.get(q),z.get(q));
return K.each(function(e){_&&!e.getParent()&&e.setParent(_),C.add(e)}),C.fireSerializeEvent({type:"deserialize",json:g}),xp--,C.endTransaction(),g.a&&g.a.onPostDeserialize&&!t.disableOnPostDeserialize&&g.a.onPostDeserialize(g,C,t.view,K),t.finishFunc&&t.finishFunc(g,C,t.view,K),K},deserializeData:function(Q,c){for(var A in c.p)Q[di(A)](this[yl](c.p[A]));for(A in c.s)Q.s(A,this[yl](c.s[A]));for(A in c.a)Q.a(A,this[yl](c.a[A]))},deserializeValue:function(n){if(wb(n)){var Z=n.__i;if(Z!=k)return this._82I[Z];if(Z=n.__a,sn(Z))return new pq(Z)}return n}}),fs($b,{serialize:function(l,E){return new oh(this,E).serialize(l)},toJSON:function(I){return new oh(this,I).toJSON()},deserialize:function(J,w,r){return new oh(this).deserialize(J,w,r)}});var Dc=C.OverlappingBox=function(a){this.gv=a,this.boxes={}};zo("OverlappingBox",c,{clear:function(){var f,I,i=this.boxes;for(f in i)I=i[f],I.length=0},isOverlapping:function(G,p){var i,X,U=this,A=U.boxes,$=A[G];$?(i=$.rects,X=$.length):$=A[G]={rects:i=[],length:X=0};var d,T,p;for(d=0;X>d;d++)if(T=i[d],T.x<p.x+p.w&&T.x+T.w>p.x&&T.y<p.y+p.h&&T.h+T.y>p.y)return!0;return i.length<=X?(i.push(p),$.length++):i[$.length++]=p,!1}}),fs(I,{fetch:function(K,h){var J="GET",W=!1,_=null,O="";h&&(J=h.method||"GET",W=h.sync,O=h.url,_=h.data||null),K.open(J,O,!W),h.responseType?K.responseType=h.responseType:h.overrideMimeType&&K.overrideMimeType(h.overrideMimeType),K.send(_)},convertImageSrc:function(I,U){U&&"function"==typeof U||(U=function(){}),U(I)}});var ib=C.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};zo("Request",c,{_responseType:null,_overrideMimeType:"text/plain",send:function(O){var d=this._xhr,c=this.onload,w=this.onerror;this.getResponseType()?O.responseType=this.getResponseType():this.getOverrideMimeType()&&(O.overrideMimeType=this.getOverrideMimeType()),d.onload=c,d.onerror=w,I.fetch(d,O)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(p){this._responseType=p},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(G){this._overrideMimeType=G},getResponseText:function(){var H=this._xhr;return H.response||H.responseText}}),Mp.GraphView=function(S){var t=this;t._24I={},t._34I=new pq,t._25I={},t._56I={},t._view=Hb(1,t),t._canvas=os(t._view),t.dm(S?S:new $b),this._coreInteractor=new Ib(this),t.setEditable(!1),t.setScrollBarVisible(I.graphViewScrollBarVisible)},Mi("GraphView",c,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Td,df,ci,Yp,"resettable","editInteractor",Lp,"pannable","rectSelectable","autoScrollZone",wd,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:I.graphViewResettable,_pannable:I.graphViewPannable,_rectSelectable:I.graphViewRectSelectable,_autoScrollZone:I.graphViewAutoScrollZone,_rectSelectBackground:I.graphViewRectSelectBackground,_rectSelectBorderColor:I.graphViewRectSelectBorderColor,_editPointSize:I.graphViewEditPointSize,_editPointBorderColor:I.graphViewEditPointBorderColor,_editPointBackground:I.graphViewEditPointBackground,_scrollBarColor:gg,_scrollBarSize:lb,_autoHideScrollBar:mm,_autoMakeVisible:km,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(Q){this._dataModel.setLayers(Q)},setEditable:function($){var z=this,b=z.__interactorMap__;if(!b){var q=Mp.XEditInteractor;b=z.__interactorMap__={scrollBar:new aq(z),select:new Hp(z),edit:q?new q(z):new bl(z),move:new Bd(z),"default":new Ee(z),touch:new Fp(z,{editable:!1})}}$?(z._uieditable=!0,z.setInteractors([b.scrollBar,b.select,b.edit,b.move,b.default,b.touch])):(z._uieditable=!1,z.setInteractors([b.scrollBar,b.select,b.move,b.default,b.touch]))},getCanvas:function(){return this._canvas},_33I:function(O){var d=O.getUIClass();return d?new d(this,O):k},getDataUI:function(e){var t=this,s=t._25I[e._id];return s===V&&(s=t._33I(e),t._25I[e._id]=s),s},getNodeRect:function(L){return I.getNodeRect(this,L)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(j){var D=this.getDataUI(j);return D?(D._79o(),D._78o):null},getEdgeSourcePosition:function(f){var S=this,p=S.getDataUI(f),F=p.s,E=p._data._40I;return Dh(S,E,F("edge.source.position"),F("edge.source.offset.x"),F("edge.source.offset.y"),F("edge.source.anchor.x"),F("edge.source.anchor.y"))},getEdgeTargetPosition:function(U){var I=this,O=I.getDataUI(U),J=O.s,c=O._data._41I;return Dh(I,c,J("edge.target.position"),J("edge.target.offset.x"),J("edge.target.offset.y"),J("edge.target.anchor.x"),J("edge.target.anchor.y"))},invalidateAll:function(t){var W=this;if(t){for(var U in W._25I){var L=W._25I[U];L&&L.dispose()}W._25I={},W._56I={},W._24I={},W._34I.clear(),W.redraw()}else W.dm().each(function(q){W.invalidateData(q)})},invalidateSelection:function(){var z=this;z.sm().each(function(f){z.invalidateData(f)})},invalidateData:function(b){var q=this;q._24I[b._id]=b,q._21Q(b),q.iv()},_21Q:function(w){var n=this,_=n._24I;if(hk(w)&&uf[w.s(fp)]){var u=w.getSourceAgent();u&&u.getAgentEdges().each(function(Q){_[Q._id]=Q}),u=w.getTargetAgent(),u&&u.getAgentEdges().each(function(j){_[j._id]=j}),n.iv()}},redraw:function(w){var u=this;u._32I||(w?u._34I.add(w):(u._32I=1,u._34I.clear()),u.iv())},each:function(b,Q){var m,a,Z,v=0,K=this.getLayers(),p=this._dataModel,A=p._datas._as,R=A.length;if(K){for(var $=K.length;$>v;v++)if(Z=K[v],wb(Z)&&(Z=Z.name),p.isHierarchicalRendering()){var q=function(J){return J._layer===Z?Q?b.call(Q,J):b(J):void 0};if(this._dataModel.eachByHierarchical(q)===!1)return}else for(var P=0;R>P;P++)if(m=A[P],m._layer===Z&&(a=Q?b.call(Q,m):b(m),a===!1))return}else if(p.isHierarchicalRendering())this._dataModel.eachByHierarchical(b,null,Q);else for(;R>v;v++)if(m=A[v],a=Q?b.call(Q,m):b(m),a===!1)return},reverseEach:function(T,m){var u,l,J,N,I=this._dataModel,k=I._layers,z=I._datas._as,t=z.length;if(k){for(u=k.length-1;u>=0;u--)if(N=k[u],wb(N)&&(N=N.name),I.isHierarchicalRendering()){var Y=function(n){return n._layer===N?m?T.call(m,n):T(n):void 0};if(I.reverseEachByHierarchical(Y)===!1)return}else for(var R=t-1;R>=0;R--)if(l=z[R],l._layer===N&&(J=m?T.call(m,l):T(l),J===!1))return}else if(I.isHierarchicalRendering())I.reverseEachByHierarchical(T,null,m);else for(u=t-1;u>=0;u--)if(l=z[u],J=m?T.call(m,l):T(l),J===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var r=this,V=r._84I;if(!V){var N=this.dm().a("width"),m=this.dm().a("height");N>0&&m>0?r._84I={x:0,y:0,width:N,height:m}:(r.each(function(W){r.isVisible(W)&&(V=je(V,r.getDataUIBounds(W)))}),r._84I=V?V:Bf)}return r._84I},getScrollRect:function(){return je(this.getContentRect(),this._29I)},makeCenter:function(f,k,Y){var O=this;if(!O.getWidth()||!O.getHeight())return Y||Cm(O.centerData,O,[f,k,!0],500),void 0;O.makeVisible(f),O.validate();var C=O.getDataUIBounds(f);if(C){var g=O.getWidth(),x=O.getHeight(),n=C.x+C.width/2,K=C.y+C.height/2,W=-n*O._zoom+g/2,l=-K*O._zoom+x/2;O.setTranslate(W,l,k)}},fitData:function(N,M,S,P,g){var V=this;if(!V.getWidth()||!V.getHeight())return g||Cm(V.fitData,V,[N,M,S,P,!0],500),void 0;var l=function(){V.makeVisible(N),V.validate();var H=V.getDataUIBounds(N);H&&(H=pb(H),Oq(H,S==k?20:S),V.fitRect(H,M,P))};M?I.callWhenLoaded(l):l()},fitContent:function(b,q,B,W){var l=this;if(!l.getWidth()||!l.getHeight())return W||Cm(l.fitContent,l,[b,q,B,!0],500),void 0;var D=function(){l.validate();var C=pb(l.getContentRect());Oq(C,q==k?20:q),l.fitRect(C,b,B)};b?I.callWhenLoaded(D):D()},fitRect:function(V,x,Z){var h=this,X=h.getWidth(),a=h.getHeight(),t=V.x+V.width/2,A=V.y+V.height/2,v=$(X/V.width,a/V.height),y=h._zoom,F=-t*y+X/2,o=-A*y+a/2;0===v||isNaN(v)||(Z&&(v=$(1,v)),x?(h._65I&&(delete h._65I.finishFunc,h._65I.stop(!0)),h._14o&&h._14o.stop(!0),h.setTranslate(F,o,{finishFunc:function(){h.setZoom(v,x)}})):(h.setTranslate(F,o),h.setZoom(v)))},toCanvas:function(M,O){O=O||this._zoom,this.validateImpl();var G=this,K=G.getContentRect();K.width||(K.width=10),K.height||(K.height=10);var j=os(),Q=K.x*O,C=K.y*O,N=K.width*O,p=K.height*O;Oi(j,N,p,1);var X=Rq(j);return M=M||this._dataModel.getBackground(),M&&yq(X,0,0,N,p,M),Ig(X,-Q,-C),X.scale(O,O),G._42(X),X.restore(),j},toDataURL:function(L,n,k){return this.toCanvas(L,k).toDataURL(n||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(Y,v){var N=this,y=this.__htmlOrderList,l=[];if(N._93db(Y,v),N.each(function(e){var G=N.getDataUI(e);if(G){var z=N._56I[e._id],m=G._htmlView;if(z){var U=G._79o();if(m=G._htmlView,C.HtmlNode&&e instanceof C.HtmlNode)G._42(Y);else{var H=N.getViewRect(),W=m&&m.layoutHTML;!v||Fi(v,U)?(W&&(m.layoutHTML(),G.__outerLayout&&delete G.__outerLayout),G._42(Y)):Fi(H,U)||!W||G.__outerLayout||(m.layoutHTML(),G.__outerLayout=!0)}}m&&(l.push(m),m.getView&&(m=m.getView()),m.style.display=z?"block":yp)}}),y&&l.length>0){var c=!1;if(y.length!==l.length)c=!0;else for(var I=0;I<l.length;I++)if(l[I]!==y[I]){c=!0;break}c&&(l.forEach(function(H){N.appendHTML(H,!0)}),this.__htmlOrderList=l)}else this.__htmlOrderList=l;N._92db(Y,v)},validateImpl:function(){this.tryUpdateRootData();var J,M,e,f,a,l=this,T=l.tx(),n=l.ty(),h=l._zoom,C=l._canvas,r=this.getWidth(),L=this.getHeight(),o=l._29I,d={x:-T/h,y:-n/h,width:r/h,height:L/h},D={},P=l._34I,W=l._24I,$=l._32I,p=l._23I;l._24I={},(r!==C.clientWidth||L!==C.clientHeight)&&(Oi(C,r,L),$=1),$||yk(d,o)||($=1),l._29I=d,l.each(function(K){M=K._id;var F=D[M]=l.isVisible(K);F!==l._56I[M]&&(W[M]=K,e=l.getDataUI(W[M]),e&&e._84o(F),l._84o(K,F))},l);for(M in W)e=l.getDataUI(W[M]),e&&(!$&&l._56I[M]&&(a=e._79o(),a&&P.add(a)),e.invalidate()),l._83I=1;if(l._56I=D,!$)for(M in W)D[M]&&(e=l.getDataUI(W[M]),e&&(a=e._79o(),a&&P.add(a)));if($?f=d:(P.each(function(F){Fi(d,F)&&(f=je(f,F))}),f&&(Oq(f,j(1,1/h)),f.x=E(f.x*h)/h,f.y=E(f.y*h)/h,f.width=g(f.width*h)/h,f.height=g(f.height*h)/h,f=_h(d,f))),l._74O=f,f){J=Rq(C);var B=f.x,z=f.y,H=f.width,v=f.height;B=Math.floor((B*h+T)*Wg),z=Math.floor((z*h+n)*Wg),H=Math.ceil(H*h*Wg)+1,v=Math.ceil(v*h*Wg)+1,J.beginPath(),J.rect(B,z,H,v),J.clip(),J.clearRect(B,z,H,v),Ko(J,T,n,h),l._42(J,f),J.restore(),delete l._74O}if(P.clear(),delete l._32I,p&&r>0&&L>0){var e=l.getDataUI(p);if(e){var a=e._79o(),X=l._29I,k=X.x,O=X.y,V=X.width,t=X.height,h=l._zoom;a&&!Fi(a,X)&&(a.x+a.width<k&&l.tx(-a.x*h),a.x>k+V&&l.tx(-(a.x+a.width-V)*h),a.y+a.height<O&&l.ty(-a.y*h),a.y>O+t&&l.ty(-(a.y+a.height-t)*h))}delete l._23I}l._83I&&(delete l._83I,delete l._84I),l._98O(),cq(l._24I)||Cm(l.iv,l)},tryUpdateRootData:function(){var v,j=this.getFullscreenDatas();for(var I in j)v=j[I],this.scaleRootData(v)},scaleRootData:function(T){var I=T.s("fullscreen");if("uniform"===I||"fill"===I){T.setRotation(0);var x,t=T.s("fullscreen.gap")||0,Q=this.getWidth()-2*t,z=this.getHeight()-2*t,J=T.getAnchor(),W=T.getScaledSize(),p=W.width,F=W.height,N=T.s("fullscreen.lock");if(N)return"uniform"===I?Q/z>p/F?(x=z/F,p=F*Q/z):(x=Q/p,F=p*z/Q):"v"===N?(x=z/F,p=Q/x,T.setWidth(p)):(x=Q/p,F=z/x,T.setHeight(F)),this.setZoom(x),this.tx(t-(T.getX()-J.x*p)*x),this.ty(t-(T.getY()-J.y*F)*x),void 0;var r=this.tx(),C=this.ty();x=this._zoom;var b={x:(-r+t)/x,y:(-C+t)/x,width:Q/x,height:z/x};if("uniform"===I){var m=p/F,X=Math.min(b.width,b.height*m),h=X/m;b.x+=.5*(b.width-X),b.y+=.5*(b.height-h),b.width=X,b.height=h}T.setSize(b.width/T.getScaleX(),b.height/T.getScaleY()),T.setPosition(b.x+J.x*b.width,b.y+J.y*b.height)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(U){var V=this;U!==V.isScrollBarVisible()&&(U?(Ll(V._view,V._79O=Xf()),Ll(V._79O,V._27I=Xf()),Ll(V._79O,V._28I=Xf())):(Zj(V._79O),delete V._79O,delete V._27I,delete V._28I),V.fp("scrollBarVisible",!U,U))},showScrollBar:function(){var K=this;K._79O&&(K._85I||(N(function(){K._86I()},Gk),K.iv()),K._85I=new Date)},_86I:function(){var X=this;if(X._85I){var C=new Date,n=C.getTime();n-X._85I.getTime()>=Gk?(delete X._85I,X.iv()):N(function(){X._86I()},Gk)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var X=this,z=this._27I,t=this._28I;if(X._79O){if(X._autoHideScrollBar&&!X._85I)return z.style.visibility=Pq,t.style.visibility=Pq,void 0;var l=X.getScrollBarColor(),M=X._zoom,b=X.getScrollBarSize(),a=X.getViewRect(),S=X.getScrollRect(),F=a.height*M,r=S.height*M,y=a.width*M-b-2,e=F*((a.y-S.y)*M/r),q=F*(F/r),T=z.style;r-.5>F?(Pb>q&&(e=e+q/2-Pb/2,0>e&&(e=0),e+Pb>F&&(e=F-Pb),q=Pb),qi(z,y,e,b,q),T.visibility=Mb,T.background=l,T.borderRadius=b/2+cp):T.visibility=Pq;var L=a.width*M,f=S.width*M,e=a.height*M-b-2,y=L*((a.x-S.x)*M/f),R=L*(L/f),T=t.style;f-.5>L?(Pb>R&&(y=y+R/2-Pb/2,0>y&&(y=0),y+Pb>L&&(y=L-Pb),R=Pb),qi(t,y,e,R,b),T.visibility=Mb,T.background=l,T.borderRadius=b/2+cp):T.visibility=Pq}},setDataModel:function(F){var h=this,p=h._dataModel,y=h._selectionModel;p!==F&&(p&&(p.ump(h.handleDataModelPropertyChange,h),p.umm(h.handleDataModelChange,h),p.umd(h.handleDataPropertyChange,h),p.removeIndexChangeListener(h._75O,h),p.removeHierarchyChangeListener(h.handleHierarchyChange,h),y||p.sm().ums(h.handleSelectionChange,h)),h._dataModel=F,F.mp(h.handleDataModelPropertyChange,h),F.mm(h.handleDataModelChange,h),F.md(h.handleDataPropertyChange,h),F.addIndexChangeListener(h._75O,h),F.addHierarchyChangeListener(h.handleHierarchyChange,h),y?y._21I(F):F.sm().ms(h.handleSelectionChange,h),h.invalidateAll(!0),h.fp(Jc,p,F),h._canvas.style.background=F.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===V){var b=this.getLayers();b?(this._layersInfo={},b.forEach(function(u){var H=wb(u)?u.name:u;this._layersInfo[H]=u},this)):this._layersInfo=null}return this._layersInfo},calculateAttachPoint:function(){var e=new lf,W=new lf,a=new lf;return function(f,c){var I=this.getAttachPoints(f);if(!I||!I.length)return null;a.set(c.x,c.y);for(var F,y,w,q,p=1/0,h=0,A=I.length;A>h;h++)w=I[h],W.x=w.x,W.y=w.y,e.x=w.offsetX||0,e.y=w.offsetY||0,q=Dh(this,f,0,e.x,e.y,W.x,W.y),y=a.distanceToSquared(q),p>y&&(F=h,p=y);p=Math.sqrt(p);var O=this.getAttachStyle(f);if("close"===O){var o=f.s("attach.close.threshold")/this._zoom;if(p>o)return null}return{index:F,distance:p,info:I[F]}}}(),getAttachPoints:function(Z){var _=Z.s("attach.points");if(_)return _;var c=Ne(Z._image);return c?Sq(c.attachPoints,Z,this)||null:void 0},getAttachStyle:function(w){var W=w.s("attach.style");if(W)return W;var x=Ne(w._image);return x?Sq(x.attachStyle,w,this)||"close":void 0},updateLayers:function(){this._layersInfo=V,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(m){if("background"===m.property){var s=this._canvas.style.background,u=m.newValue||"";this._canvas.style.background=u,this.fp("canvasBackground",s,u)}else"a:width"===m.property||"a:height"===m.property?(this._83I=1,this.redraw()):"layers"===m.property?this.updateLayers():"hierarchicalRendering"===m.property&&this.redraw()},handleDataPropertyChange:function(p){this.dm().isHierarchicalRendering()&&"parent"===p.property&&p.data.hasChildren()&&this.redraw(),this.invalidateData(p.data)},onPropertyChanged:function(H){var D=this,U=H.property;if(D.redraw(),"zoom"===U){var e=D.sm().getSelection();e.size()&&e.each(function(M){M.invalidate()})}Uf[U]?D.showScrollBar():U===Lp&&D.onCurrentSubGraphChanged(H)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(A){var r=this,U=A.kind,$=A.data;if(r._83I=1,"add"===U)r.invalidateData($),hk($)&&$.getEdgeGroup()&&$.getEdgeGroup().eachSiblingEdge(r.invalidateData,r);else if(U===ro){r._21Q($);var p=$._id,M=r._25I[p];if(M){if(r._56I[p]){var Y=M._79o();Y&&r.redraw(Y)}M.dispose(),delete r._25I[p],delete r._24I[p],delete r._56I[p]}$===r._currentSubGraph&&r.setCurrentSubGraph(k)}else U===Ef&&(r.invalidateAll(!0),r.setCurrentSubGraph(k))},_75O:function(c){this.invalidateData(c.data)},handleHierarchyChange:function(g){this.dm().isHierarchicalRendering()&&g.data.hasChildren()&&this.redraw(),this.invalidateData(g.data)},adjustIndex:function(J){var q=this;if(q.isVisible(J)){q.dm().beginTransaction();for(var B=J;B._parent&&q.isVisible(B._parent);)B=B._parent;B&&B!==J&&q._dataModel.adjustIndex(B),q._dataModel.adjustIndex(J),q.dm().endTransaction()}},getImage:function(S){return S.getImage?S.getImage():V},getSelectWidth:function(P){var q=Ne(this.getImage(P));return q&&Sq(q.disableSelectedBorder,P,this)?0:P.s("select.width")},getSelectColor:function($){return $.s("select.color")},isSelectable:function(Y,E){if(this.isSelected(Y))return!0;if(!E&&Y.getParent()instanceof as&&this.isSelectable(Y.getParent(),!0)&&Y.getParent().isSyncSize())return!1;var u=this.getLayersInfo();if(u){var p=u[Y._layer];if(p&&p.selectable===!1)return!1}return Y.s("2d.selectable")&&this.sm().isSelectable(Y)},isMovable:function(b){var p=this;if(hk(b)&&b.getStyle(fp)!==Rh)return!1;var L=this.getLayersInfo();if(L){var s=L[b._layer];if(s&&s.movable===!1)return!1}return b.s("2d.movable")?p._movableFunc?p._movableFunc(b):!0:!1},isEditable:function(w){var h=this;if(C._uiSerializing)return h._uieditable;if(!h._editInteractor||!h.isSelected(w))return!1;if(Qb(w)){var P=h.getDataUI(w);if(!P||P._88I)return!1}if(hk(w)&&w.getStyle(fp)!==Rh)return!1;var S=this.getLayersInfo();if(S){var f=S[w._layer];if(f&&f.editable===!1)return!1}return w.s("2d.editable")?h._editableFunc?h._editableFunc(w):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(n){return tn(n)&&0!==n.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(n):!0},isRectEditable:function(q){return this._rectEditableFunc?this._rectEditableFunc(q):!0},isAnchorEditable:function(h){return this._anchorEditableFunc?this._anchorEditableFunc(h):!0},isRotationEditable:function(e){return e.setRotation&&e.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(e):!0:!1},getRotationPoint:function(d){var O=d.getAnchor(),q=d.getScale(),B=this._zoom,i=nd(d.getRotation(),0,-d.getHeight()*q.y*O.y-(q.y<0?-1:1)*(uh?32:16)/B),A=d.p();return i.x+=A.x,i.y+=A.y,i},getLogicalPoint:function(p){var j=this;return Iq(p,j._canvas,j.tx(),j.ty(),j._zoom,j._zoom)},getScreenPoint:function(r,X){var B,w=this;return"object"==typeof r?r.x!==V?(B=r.x,X=r.y):(B=r[0],X=r[1]):B=r,Xq(B,X,w._canvas,w.tx(),w.ty(),w._zoom,w._zoom)},getSelectedDataAt:function(K){var c=this;return this.getDataAt(K,function(T){return c.isSelected(T)})},getDataInfoAt:function(Q,$,B){var T,u=this.lp(Q),s=this.getDataAt(u,$,B);if(s){var f=this.getDataUI(s);T={data:s,ui:f,point:u};var d=f._38o;if(d){var z=d.icons;for(var P in z){var a=z[P],n=d.rects[P];if(n)for(var E=Sq(a.names,s,this),Y=E?E.length:0,M=n.rotation,Z=Y-1;Z>=0;Z--){var D=E[Z],U=n[Z];if(Wi(U,u,M))return T.part="icons",T.name=P,T.icon=D,T.rect=U,T.index=Z,T.rotation=M,T}}}if(this.isNoteVisible(s)){if(f.note2Info&&Wi(f.note2Info.clickRect,u,k,f.note2Info.scale))return T.part="note2",T;if(f.noteInfo&&Wi(f.noteInfo.clickRect,u,k,f.noteInfo.scale))return T.part="note",T}if(this.isLabelVisible(s)){if(f.label2Info&&Wi(f.label2Info.rect,u,f.label2Info.rotation,f.label2Info.scale))return T.part="label2",T;if(f.labelInfo&&Wi(f.labelInfo.rect,u,f.labelInfo.rotation,f.labelInfo.scale))return T.part="label",T}if(s.isInRect&&s.isInRect(u))return T.part="body",T}return T},getDataAt:function(x,p,_){x.target&&(x=this.lp(x));var n,C=this._zoom;return this.reverseEach(function(c){return(p?p(c):this.isSelectable(c))&&this.rectIntersects(c,pe(x.x,x.y,_,C))?(n=c,!1):void 0},this),n},getIconInfoAt:function(T,u){var F=this;if(T.target&&(T=F.lp(T)),u||(u=F.getDataAt(T)),u){var l=F.getDataUI(u);if(l&&l._38o){var r,c=l._38o,H=new pq;for(r in c.icons)H.add(r);for(var x=H.size()-1;x>=0;x--){r=H.get(x);for(var C=c.rects[r],b=C.rotation,p=C.length-1;p>=0;p--){var f=C[p],G=f.width,P=f.height,d={x:T.x-f.x-G/2,y:T.y-f.y-P/2};b!=k&&(d=nd(-b,d.x,d.y));var f={x:-G/2,y:-P/2,width:G,height:P};if(Wi(f,d))return{key:r,index:p,name:c.icons[r].names[p],rect:C[p],point:T,rotation:b,relativeRect:f,relativePoint:d,data:u}}}}}return k},getDatasInRect:function(k,U,b){b===V&&(b=1);var r=this,O=new pq;return r.reverseEach(function(P){b&&!r.isSelectable(P)||(U?r.rectIntersects(P,k):r.rectContains(P,k))&&O.add(P)}),O},moveSelection:function(Z,w){var y=this;y.dm().beginTransaction(),_e(y.sm().toSelection(y.isMovable,y),Z,w),y.dm().endTransaction()},moveDatas:function(p,E,x){var S=this;S.dm().beginTransaction(),p instanceof pq||(p=new pq(p)),_e(p,E,x),S.dm().endTransaction()},getDataUIBounds:function(Z){var A=this.getDataUI(Z);return A?A._79o():k},drawData:function(S,A,$){var y=this.getDataUI(A);if(y){var H=y._79o();(!$||Fi($,H))&&(y._42(S),A instanceof C.Block&&A.eachChild(function(H){this.drawData(S,H,$)},this))}},getBoundsForGroup:function(p){return p.s(Jj)?this.getDataUIBounds(p):k},isPixelPerfect:function(W){return W.s("pixelPerfect")},rectIntersects:function(P,R){this.validate();var b=k;if(this._56I[P._id]){var T=this._25I[P._id];if(T){var G=T._79o();if(Ii(R,G))b=!0;else if((R=_h(R,G))&&(T.rectIntersects&&(b=T.rectIntersects(R)),b==k)){if(!this.isPixelPerfect(P))return!0;var X=R.x,g=R.y,z=R.width,c=R.height,M=this._zoom,w=I.hitMaxArea,S=z*c*M*M;if(S>w){var W=Math.sqrt(w/S);M*=W}z*=M,c*=M,2>z&&(z=2),2>c&&(c=2),X*=M,g*=M;var t=Mn(z,c);Ig(t,-X,-g),t.scale(M,M),this._drawForChecking=!0,this.drawData(t,P,R),this._drawForChecking=!1;try{for(var h=0,p=t.getImageData(0,0,z,c).data;h<p.length;h+=4)if(0!==p[h+3]){b=!0;break}t.restore()}catch(s){rb=k,b=!1}}}}return b?!0:!1},rectContains:function(p,P){if(this._56I[p._id]){var H=this._25I[p._id];if(H)return Ii(P,H._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(z){if(!I.isInput(z.target)){var K=this,Y=K._focusData,F=Y&&K._25I[Y._id],u=0,s=K._dataModel._datas;if(!(Y&&Y._enabled&&Y._editable&&F&&F.onKeyDown&&F.onKeyDown(z)===!0))if(9===z.keyCode&&(Y&&(u=s.indexOf(Y),ub(z)?-1===--u&&(u=0):++u===s.size()&&(u=0)),K._focusData=Y=s.get(u),K.sm().setSelection(Y)),Ah(z)?K.selectAll():Eg(z)&&K.isResettable()&&K.reset(),K.sm().isEmpty()){if(K._editing)return;var S=K.tx(),n=K.ty(),w=!1,B=ub()?100:10;_o(z)&&(S-=B,w=!0),yc(z)&&(n-=B,w=!0),_b(z)&&(S+=B,w=!0),Vc(z)&&(n+=B,w=!0),w&&K.setTranslate(S,n)}else{Fm(z)&&K.handleDelete(z);var N=ub()?10:1;_o(z)&&(K.moveSelection(-N,0),K.fi({kind:"moveLeft"})),yc(z)&&(K.moveSelection(0,-N),K.fi({kind:"moveUp"})),_b(z)&&(K.moveSelection(N,0),K.fi({kind:"moveRight"})),Vc(z)&&(K.moveSelection(0,N),K.fi({kind:"moveDown"}))}}},handleScroll:function(S,x){if(_d(S),!this.getEditInteractor()){var u=this.getDataAt(S);if(u){var D=Ne(this.getImage(u));if(D&&Sq(D.scrollable,u,this))return}}var H=this.lp(S);x>0?this.scrollZoomIn(H):0>x&&this.scrollZoomOut(H)},handlePinch:function(g,U,S){this._68I||(U>S?this.pinchZoomIn(g):this.pinchZoomOut(g))},checkDoubleClickOnNote:function(y,v){var N=this,R=N.lp(y),F=N.getDataUI(v),d=F.note2Info;return d&&v.s("note2.toggleable")&&Wi(d.clickRect,R)?(v.s(Qp,!v.s(Qp)),N.fi({kind:"toggleNote2",event:y,data:v}),!0):(d=F.noteInfo,d&&v.s("note.toggleable")&&Wi(d.clickRect,R)?(v.s(Xc,!v.s(Xc)),N.fi({kind:"toggleNote",event:y,data:v}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(J,T){var V=this,a=V.getAutoScrollZone(),L=a/V.getZoom(),i=a/4,k=V._29I,z=V.lp(J),b={x:V.tx(),y:V.ty()};return z&&a>0&&k&&(z.x-k.x<L?V.translate(i,0):k.x+k.width-z.x<L&&V.translate(-i,0),z.y-k.y<L?V.translate(0,i):k.y+k.height-z.y<L&&V.translate(0,-i)),b.x=V.tx()-b.x,b.y=V.ty()-b.y,T&&(T.x+=b.x,T.y+=b.y),b},getMoveMode:function(b,R){var x=R.s("2d.move.mode");return x?x:Gh["88"]?"x":Gh["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(q,c,w){var H=this;return"currentSubGraph"===c?{__i:q.getId()}:w.serializeProperty(q,c,H)},deserializeProperty:function(K,D,F){var A=this;if("currentSubGraph"===D){var y=A.dm(),Q=y.__idMap;return Q[K.__i]}return F.deserializeProperty(K,D,A)},setDefaultCursor:function(h,c){this._defaultCursor=h,c!==!1&&this.setCursor(h)},setCursor:function(q){"default"===q&&(q=this._defaultCursor||q);var u=this.getView().style;u.cursor=q,u.cursor="-webkit-"+q,u.cursor="-moz-"+q},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(Q){return Q===k||I.getConnectAction(null,Q)?(this._currentActionType=Q,this.redraw(),!0):!1},isConnectActionVisible:function(r){var V=I.getConnectAction(this);if(!V)return!1;var d=V.visible;return od(d)&&(d=d(this,r)),d},isInteractive:function(e){var j=Ne(this.getImage(e));return j&&Sq(j.interactive,e,this)?!0:e.s("interactive")},appendHTML:function(l,w){var x=this.getView();if(!(w||l&&l.parentNode!==x))return!1;var G=l.getView&&l.getView();return!w&&G&&G.parentNode===x?!1:l.isSelfViewEvent?(l.addToDOM(x),!0):(l.getView&&(l=l.getView()),this.isScrollBarVisible()?x.insertBefore(l,this.getView().lastChild):Ll(x,l),!0)},layoutHTML:function(v,Z,w){var c,p=this,G=p._zoom;if(Z.getView&&(c=Z,Z=Z.getView()),Z.style.position="absolute",w){var V=v.getRect();qi(c||Z,p.tx()+V.x*G,p.ty()+V.y*G,V.width*G,V.height*G)}else{var X=new sq,V=v.getAnchorRect(),t=v.getPosition(),h=v.getScale(),W=Z.style;qi(c||Z,V),X.appendTranslate(p.tx(),p.ty()),X.appendScale(G,G),X.append(new sq(v.getRotation(),t.x,t.y,h.x,h.y)),ll(W,"transform","matrix("+X.a.toFixed(5)+", "+X.b.toFixed(5)+", "+X.c.toFixed(5)+",\n    "+X.d.toFixed(5)+", "+X.tx.toFixed(5)+", "+X.ty.toFixed(5)+")"),ll(W,"transformOrigin",(-V.x).toFixed(5)+"px "+(-V.y).toFixed(5)+"px"),Z.maxtrixAppend=X.invert().translate(-V.x,-V.y)}}});var Ir=function(q,Y){var g=this;g.gv=q,g.s=function(J){return Y.getStyle(J)},g._data=Y,g._87I=new pq};Zi(Ir,c,{_6I:k,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var P=this,g=P.gv.isSelected(P._data);return!g||P.isShadowed()?0:P.gv.getSelectWidth(P._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(J){var a=this._data,h=this.gv.getBodyColor(a);return h?h:J?a.getStyle(J):k},_2Q:function(j){return this.s(j)},_1Q:function(n,b,K,g){var c=this.s,k=c("2d.gray"),i=c(b+".dash.color");if(k&&(i=I.toGrayColor(i)),n.strokeStyle=i,n.lineWidth=K,n.stroke(),c(b+".dash.3d")){var j=c(b+".dash.3d.color");Cq(n,i,k?I.toGrayColor(j):j,K,this.gv._zoom,c(b+".dash.3d.accuracy"))}Bb(n,g)},invalidate:function(){this._6I=k},_79o:function(){var z=this;if(!z._6I){var K=z._data,e=z.gv;z.labelInfo=z.label2Info=z.noteInfo=z.note2Info=z._38o=k,z._87I.clear(),z.interactiveInfo=e.isInteractive(K)?{}:k,z._3O(),z._55O=e.isEditable(K)?{_42O:e.isRectEditable(K),_43O:e.isPointEditable(K),_56O:e.isRotationEditable(K)}:k,z._6I=z._81o()}return z._6I},_3O:function(){},getPosition:function(){return Bf},_68o:function(z,I){z&&this._87I.add(rc(z,I))},_81o:function(){var B=this,Z=B.s;B._24O(Sr,"getLabel"),B._24O($h,"getLabel2"),B._26O(Fk,"getNote"),B._26O(zq,"getNote2"),B._15O(),B._55O&&B._48O();var d;if(B._87I.each(function(o){d=je(d,o)}),d&&B.isShadowed()){var H=pb(d);H.x+=Z("shadow.offset.x"),H.y+=Z("shadow.offset.y"),Oq(H,Z("shadow.blur")),d=je(d,H)}return B._87I.clear(),d},_42:function(U){var m=this,l=m._data,L=m.gv,W=m.s,u=W("opacity"),p=this.isShadowed();if(p){var b=U.shadowOffsetX,M=U.shadowOffsetY,R=U.shadowBlur,y=U.shadowColor,D=L.getZoom();U.shadowOffsetX=W("shadow.offset.x")*D,U.shadowOffsetY=W("shadow.offset.y")*D,U.shadowBlur=W("shadow.blur")*D,U.shadowColor=m.getSelectColor()}if(u!=k){var S=U.globalAlpha;U.globalAlpha=u}m._80o(U),L.isLabelVisible(l)&&((!L._drawForChecking||W("label.selectable"))&&ui(U,m.labelInfo),(!L._drawForChecking||W("label2.selectable"))&&ui(U,m.label2Info)),L.isNoteVisible(l)&&(Qq(U,m.noteInfo),Qq(U,m.note2Info)),m._99O(U),u!=k&&(U.globalAlpha=S),p&&(U.shadowOffsetX=b,U.shadowOffsetY=M,U.shadowBlur=R,U.shadowColor=y)},_80o:function(){},_47O:function(){},_24O:function(u,n){var l=this,B=l._data,_=l.gv,x=l.s,P=_[n](B);if(P!=k){var I=x(u+".scale"),D=x(u+".max"),Q=x(u+".position"),q=l[u+"Info"]={label:P,scale:I,color:_[n+"Color"](B),font:x(u+".font"),opacity:x(u+".opacity"),align:x(u+".align"),rotation:l.getRotation(x(u+".rotation"),!1,Q),background:_[n+"Background"](B)},w=So(q,P);D>0&&D<w.width&&(q.labelWidth=w.width,w.width=D),1!==I&&(w.width*=I,w.height*=I);var R=l.getPosition(Q,x(u+".offset.x"),x(u+".offset.y"),w,x(u+".position.fixed"));if(w.x=R.x-w.width/2,w.y=R.y-w.height/2,l._68o(q.rect=w,q.rotation),1!==I){var Z=w.width/I,o=w.height/I;q.rect={x:R.x-Z/2,y:R.y-o/2,width:Z,height:o}}}},_26O:function(d,J){var n=this,p=n.gv,$=n._data,S=n.s,Q=p[J]($);if(Q!=k){var L,G,w=S(d+".scale"),c=n[d+"Info"]={note:Q,scale:w,data:$,view:p,expanded:S(d+".expanded"),font:S(d+".font"),color:S(d+".color"),opacity:S(d+".opacity"),align:S(d+".align"),icon:S(d+".icon"),backgroundImage:S(d+".backgroundImage"),borderWidth:S(d+".border.width"),borderColor:S(d+".border.color"),background:p[J+"Background"]($)},B=n.getPosition(S(d+".position"),S(d+".offset.x"),S(d+".offset.y")),Z=B.x,e=B.y;if(c.expanded){var O,Y=S(d+".max"),m=S(d+".backgroundImage");m?(m=Ne(m),O={width:Or(m,$),height:fb(m,$)}):O=So(c,Q),O.width+=6,O.height+=2,Y>0&&Y<O.width&&(c.labelWidth=O.width,O.width=Y),L=O.width,G=O.height+8,c.clickRect={x:Z-L*w/2,y:e-G*w,width:L*w,height:G*w*O.height/G}}else{var s=S(d+".icon");s?(s=Ne(s),L=Or(s,$),G=fb(s,$)):(L=12,G=18),c.clickRect={x:Z-L*w/2,y:e-G*w,width:L*w,height:G*w}}c.rect={x:Z-L/2,y:e-G*w/2-G/2,width:L,height:G};var M=g(c.borderWidth/2)*w;n._68o({x:Z-L*w/2-M,y:e-G*w-M,width:L*w+2*M,height:G*w+2*M})}},_48O:function(){},_99O:function(E){var i=this,A=i._38o;if(A){var D=i.gv,Z=i._data,u=A.icons,a=i.interactiveInfo;a&&(a._38o={});for(var j in u){var I=u[j],$=A.rects[j];if($){a&&(a._38o[j]=[]);var w=Sq(I.opacity,Z,D),G=Sq(I.names,Z,D),K=G?G.length:0,L=$.rotation;if(w!=k){var V=E.globalAlpha;E.globalAlpha*=w}for(var B=0;K>B;B++){var X=G[B],m=Ne(X),x=$[B];if(L){var v=x.x+x.width/2,c=x.y+x.height/2;E.save(),Ig(E,v,c),ef(E,L),Ig(E,-v,-c)}a&&a._38o[j].push(E.interactiveInfo={compInfos:[],matrix:L?new sq(L,v,c).appendTranslate(-v,-c):new sq}),fo(E,m,Sq(I.stretch,Z,D),x.x,x.y,x.width,x.height,i._data,i.gv),E.interactiveInfo=k,L&&E.restore()}w!=k&&(E.globalAlpha=V)}}}}});var On=function(E,z){uj(On,this,[E,z])};Zi(On,Ir,{_checkEmptyRect:!0,_40O:function(f,x){var _=this,m=_.s,u=f.rect;(f.borderColor=_.gv.getBorderColor(_._data))&&(f.borderType=m("border.type"),f.borderWidth=m("border.width"),f.borderPadding=m("border.padding"),x=j(x,f.borderPadding+f.borderWidth/2));var D=_._data.getScale(),w=j(1,j(F(D.x),F(D.y)));if(f.selectWidth=_.getSelectWidth()){var Y=_.gv._zoom;f.selectType=m("select.type"),f._97o=_.getSelectColor(),f.selectPadding=m("select.padding"),x=j(x,(f.selectPadding+f.selectWidth/2/Y)/w)}x>0&&(x*=w,u=pb(u),Oq(u,x)),_._68o(u)},_39O:function(i,G){var z,S=this,Q=G.rect;if(G.borderWidth>0&&(z=G.borderPadding,i.strokeStyle=G.borderColor,i.lineWidth=G.borderWidth,em(i,G.borderType,{x:Q.x-z,y:Q.y-z,width:Q.width+2*z,height:Q.height+2*z}),i.stroke()),G.selectWidth>0){var X=S.gv._zoom;if(z=G.selectPadding,i.strokeStyle=G._97o,i.lineWidth=G.selectWidth/X,G.rotation!=k){i.save(),i.translate(G.position.x,G.position.y),i.rotate(G.rotation);
var x=S._data,W=x.getWidth(),Y=x.getHeight(),d=G.scale,c=G.anchor;Q={x:d.x*-W*c.x,y:d.y*-Y*c.y,width:d.x*W,height:d.y*Y}}em(i,G.selectType,{x:Q.x-z,y:Q.y-z,width:Q.width+2*z,height:Q.height+2*z}),G.rotation!=k&&i.restore(),i.stroke()}},dispose:function(){var F=this,h=F._htmlView;On.superClass._3O.call(F),h&&(h.onHTMLRemoved&&h.onHTMLRemoved(),Zj(h))},_3O:function(){var t=this,y=t.s,x=t._data,G=t.gv,g=x.getStyle(Dq),n=t.getBodyColor(),P=t._83o=g?{shape:g,_53o:t.getBodyColor("shape.background"),_27Q:Ne(y("shape.repeat.image"),n),shapeGradientPack:y("shape.gradient.pack"),_54o:y("shape.border.width"),_55o:y("shape.border.color"),_56o:y("shape.border.3d"),_57o:y("shape.border.3d.color"),_58o:y("shape.border.3d.accuracy"),shapeGradient:y("shape.gradient"),_59o:y("shape.gradient.color"),_60o:y("shape.border.pattern"),_61o:y("shape.border.cap"),_62o:y("shape.border.join"),shapeForeground:y("shape.foreground"),bodyColor:n,gray:y("2d.gray")}:{img:Ne(G.getImage(x),n),bodyColor:n,gray:y("2d.gray"),stretch:y("image.stretch")};if(a&&!U);else{var i,E=P.img;E&&E.renderHTML?(t._htmlInfo&&t._htmlInfo.img!==E&&(t._htmlInfo=k),t._htmlInfo||(t._htmlInfo={img:E,cache:{}}),i=E.renderHTML(x,G,t._htmlInfo.cache)):t._htmlInfo=k,t._htmlView&&t._htmlView!==i&&(t._htmlView.onHTMLRemoved&&t._htmlView.onHTMLRemoved(),Zj(t._htmlView.getView?t._htmlView.getView():t._htmlView)),(t._htmlView=i)&&G.appendHTML(i)&&i.onHTMLAdded&&i.onHTMLAdded(),P.rect=x.getRect(),P.position=x.p(),P.scale=x.getScale(),P.anchor=x.getAnchor(),P.rotation=x.getRotation(),g===Xd&&(P._63o=y("shape.depth"));var e=0;if(g)e=Nl(k,P._54o/2,P._62o),t.s("shape.dash")&&(e=j(e,(t.s("shape.dash.width")||P._54o)/2));else if(E&&E.boundExtend)if(e=Sq(E.boundExtend,x,G),E.boundExtendAbsolute){var W=x.getScale();e/=G._zoom*j(1,j(F(W.x),F(W.y)))}else if(!Sq(E.fitSize,x,G)){var s=Sq(E.width,x,G),$=Sq(E.height,x,G);e*=j(x.getWidth()/s,x.getHeight()/$)}t._40O(P,e);var b=y("clip.percentage");if(1>b&&(0>b&&(b=0),P.clipRect=Qf(x.getAnchorRect(),y("clip.direction"),b)),g){var I=y("shape.fill.clip.percentage");1>I&&(0>I&&(I=0),P.shapeClipRect=Qf(x.getAnchorRect(),y("shape.fill.clip.direction"),I));var M=y("shape.foreground.clip.percentage");1>M&&(0>M&&(M=0),P.shapeForegroundClipRect=Qf(x.getAnchorRect(),y("shape.foreground.clip.direction"),M))}}},getPosition:function(q,N,e,X){var t=uk(q,this._83o.rect,X);return t.x+=N,t.y+=e,t},_80o:function(q){var f=this,b=f.s,Q=f.gv,$=f._data,n=f._83o,N=n.rect,p=n.position,c=n.rotation,Z=n.anchor,V=n.scale,T=n.shape,C=n.clipRect;if(!f._checkEmptyRect||N.width>0&&N.height>0){var M=$.getSize();if(M.x=-M.width*Z.x,M.y=-M.height*Z.y,q.save(),Ig(q,p.x,p.y),ef(q,c),go(q,V.x,V.y),C&&(q.beginPath(),q.rect(C.x,C.y,C.width,C.height),q.clip()),Q._drawForChecking&&n.img&&Sq(n.img.pixelPerfect,$,Q)===!1)yq(q,M.x,M.y,M.width,M.height,"#888888");else if(f.freeDraw)f.freeDraw(q,M,n);else if(T){var e,S,y,G,z=n._60o,w=ve(q,z),P=n._27Q,D=n._54o,t=n.shapeGradientPack,U=n.gray,h=q.lineJoin,L=q.lineCap,v=function(o){return U?I.toGrayColor(o):o};"roundRect"===T?e=b("shape.corner.radius"):"polygon"===T?e=b("shape.polygon.side"):"arc"===T&&(e=b("shape.arc.from"),S=b("shape.arc.to"),y=b("shape.arc.close"),G=b("shape.arc.oval")),q.lineJoin=n._62o,q.lineCap=n._61o;var j=v(n._53o);if(j||P||t){var H=n.shapeClipRect;H&&(q.save(),q.beginPath(),q.rect(H.x,H.y,H.width,H.height),q.clip()),em(q,T,M,e,S,y,G),t?sr(q,t):P?Ve(q,P,v(n.bodyColor),null,$,Q):nm(q,j,n.shapeGradient,v(n._59o),M),q.fill(),H&&q.restore(),t&&q.restore(),q!==w&&em(w,T,M,e,S,y,G)}else em(w,T,M,e,S,y,G);var d=n.shapeForeground;if(d){q.save();var g=n.shapeForegroundClipRect;g&&(q.beginPath(),q.rect(g.x,g.y,g.width,g.height),q.clip()),em(q,T,M,e,S,y,G),nm(q,d,b("shape.foreground.gradient"),v(b("shape.foreground.gradient.color")),M),q.fill(),q.restore()}if(D>0){var F=b("shape.border.width.absolute");F&&(q.save(),q.setTransform(1,0,0,1,0,0)),q.lineWidth=D;var s=v(n._55o);q.strokeStyle=s,q.stroke(),F&&q.restore(),n._56o&&Cq(q,s,v(n._57o),D,Q._zoom,n._58o)}if(Bb(q,z),b("shape.dash")){var o=b("shape.dash.width")||D;if(o>0){z=b("shape.dash.pattern");var w=ve(q,z,f._2Q("shape.dash.offset"));w!==q&&em(w,T,M,e,S,y,G),f._1Q(q,"shape",o,z)}}Fc(q,j,n._63o,M),q.lineJoin=h,q.lineCap=L}else{var i=f.interactiveInfo;i&&(q.interactiveInfo=i.bodyInfo={compInfos:[],matrix:new sq(c,p.x,p.y,V.x,V.y)}),n.gray&&(q.compGray=!0),fo(q,n.img,n.stretch,M.x,M.y,M.width,M.height,$,Q,n.bodyColor),q.compGray=!1,q.interactiveInfo=k}q.restore()}f._39O(q,n)},_48O:function(){},_47O:function(){}});var Vq=function(e,V){uj(Vq,this,[e,V])},we=function(p,z,q,m){var H=wh(p,z);return q=m?$(q,H):Nr(q,H),H?q/=H:q=0,{x:p.x+(z.x-p.x)*q,y:p.y+(z.y-p.y)*q}};Zi(Vq,Ir,{_3O:function(){var D,Y=this,N=Y._data,p=Y.gv,F=Y.s,h=F(fp),J=N.isLooped(),m=F("edge.width"),s=F("edge.center"),M=F("edge.offset"),u=p.getBorderColor(N),o=u?F("border.width"):0,Z=Y.getSelectWidth(),$=N._40I,y=N._41I,z=Y._78o=$&&y?{looped:J,type:h,width:m,center:s,color:Y.getBodyColor("edge.color"),borderColor:u,borderWidth:o,_97o:Z?Y.getSelectColor():k,selectWidth:Z,pattern:F("edge.pattern"),cap:F("edge.cap"),join:F("edge.join"),is3d:F("edge.3d"),_67o:F("edge.3d.color"),_66o:F("edge.3d.accuracy"),gray:F("2d.gray")}:k;if(z){var E=I.getEdgeType(h);if(E){var e=E(N,gf(Y,p,N,J,h),p,Y._19Q);e.points&&e.points.size()>1?(z.edgeTypeInfo=e,D=Fd(z.edgeTypeInfo.points)):e[ik]&&e.rect&&(z.edgeTypeInfo=e,D=e.rect)}else{var T=F("edge.source.anchor.x"),n=F("edge.source.anchor.y"),S=F("edge.target.anchor.x"),c=F("edge.target.anchor.y"),R=Dh(p,$,F("edge.source.position"),F("edge.source.offset.x"),F("edge.source.offset.y"),T,n),X=Dh(p,y,F("edge.target.position"),F("edge.target.offset.x"),F("edge.target.offset.y"),S,c);if(h===Rh){var W=z.points=F(ee)||kb,f=W.size();z.segments=F("edge.segments");var H=T!==V||n!==V,t=S!==V||c!==V;if(!s)if(M)H||(R=we(R,f?W.get(0):X,M,f)),t||(X=we(X,f?W.get(f-1):R,M,f));else{var C;H||(C=Cj(R,f?W.get(0):X,Fn(p,$)),C&&(R={x:C[0],y:C[1]})),t||(C=Cj(f?W.get(f-1):R,X,Fn(p,y)),C&&(X={x:C[0],y:C[1]}))}D=je(Fd(z.points),Fd(R,X))}else{var v=gf(Y,p,N,J,h);if(Y._19Q||(v=-v),J)R=pb(R),R.x=p.getNodeRect($).x,z.radius=v,D={x:R.x-v,y:R.y-v,width:2*v,height:2*v};else{var x=wh(R,X),B=Nr(M,x),b={x:B,y:v},i={x:x-B,y:v},r=q(X.y-R.y,X.x-R.x),d=z.mat=new pf(r);if(z.orienAngle=r,z.angle=X.x<R.x?r+K:r,z.rect={x:b.x,y:b.y,width:i.x-b.x,height:0},z.origin=R,b=d.tf(b),b.x+=R.x,b.y+=R.y,i=d.tf(i),i.x+=R.x,i.y+=R.y,s){var w={x:x,y:0};w=d.tf(w),w.x+=R.x,w.y+=R.y,D=Fd([R,b,i,w]),z.c1=R,z.c2=w}else D=Fd(b,i);R=b,X=i}}z.sourcePoint=R,z.targetPoint=X,N._lastSourcePoint=R,N._lastTargetPoint=X}var Q=0;F("edge.dash")&&(Q=F("edge.dash.width")||m);var O="square"===z.cap?.71:.5;Nl(D,j(Q*O,m*O+o+Z),z.join),Y._68o(D)}},getRotation:function(y,r,p){y=y||0;var D=this._78o;if(D){var h,Z=D.angle,d=D.points,X=D.edgeTypeInfo;if(Z!=k)return r?D.orienAngle+y:Z+y;if(X&&X[ik])return X.getRotation?X.getRotation(this,y,r,p):0;if(X&&X.points){var l=X.points;return h=l.size(),dn[p]?h&&0===h%2?Wm(l.get(h/2-1),l.get(h/2),r,y):y:Vd[p]?Wm(l.get(0),l.get(1),r,y):Wm(l.get(h-2),l.get(h-1),r,y)}if(d)return h=d.size(),dn[p]?h&&0===h%2?Wm(d.get(h/2-1),d.get(h/2),r,y):y:Vd[p]?Wm(D.sourcePoint,h?d.get(0):D.targetPoint,r,y):Wm(h?d.get(h-1):D.sourcePoint,D.targetPoint,r,y)}return y},getPosition:function(D,l,j,Z,O){var r=this._78o;if(r){var T,A=r.type,w=r.points,s=r.edgeTypeInfo,n=r.sourcePoint,p=r.targetPoint;if(!A)return r.looped?{x:n.x-r.radius+l,y:n.y+j}:(O&&n&&p&&(n.x>p.x||n.x===p.x&&n.y>p.y)&&(D=Nf[D],j=-j),T=uk(D,r.rect,Z),T.x+=l,T.y+=j,T=r.mat.tf(T),T.x+=r.origin.x,T.y+=r.origin.y,T);if(s&&s[ik])return s.getPosition?s.getPosition(this,D,l,j,Z,O):{x:(n.x+p.x)/2,y:(n.y+p.y)/2};if(w){var T,m=w.size();if(dn[D]){if(m){var G=m%2;if(0===G)return Ng(w.get(m/2-1),w.get(m/2),D,l,j,Z,O);T=w.get((m-G)/2)}else T={x:(n.x+p.x)/2,y:(n.y+p.y)/2};return T=uk(D,{x:T.x,y:T.y,width:0,height:0},Z),T.x+=l,T.y+=j,T}return Vd[D]?Ng(n,m?w.get(0):p,D,l,j,Z,O):Ng(m?w.get(m-1):n,p,D,l,j,Z,O)}if(s){var u=s.points,m=u.size();if(dn[D]){var G=m%2;return 0===G?Ng(u.get(m/2-1),u.get(m/2),D,l,j,Z,O):(T=u.get((m-G)/2),T=uk(D,{x:T.x,y:T.y,width:0,height:0},Z),T.x+=l,T.y+=j,T)}return Vd[D]?Ng(u.get(0),u.get(1),D,l,j,Z,O):Ng(u.get(m-2),u.get(m-1),D,l,j,Z,O)}}return Bf},_42:function(Y){this._78o&&Vq.superClass._42.call(this,Y)},drawPath:function(B,h){B.beginPath();var I=h.type,s=h.points,L=h.segments,Z=h.edgeTypeInfo;if(!I||s){var z=h.sourcePoint,R=z.x,t=z.y,P=h.targetPoint,G=P.x,x=P.y;if(I)if(L){var U=new pq({x:R,y:t});U.addAll(s),U.add({x:G,y:x}),pk(B,U,L)}else B.moveTo(R,t),s.each(function($){B.lineTo($.x,$.y)}),B.lineTo(G,x);else h.looped?B.arc(R,t,h.radius,0,o,!0):h.center?(B.moveTo(h.c1.x,h.c1.y),B.lineTo(R,t),B.lineTo(G,x),B.lineTo(h.c2.x,h.c2.y)):(B.moveTo(R,t),B.lineTo(G,x))}else Z&&(Z.points?pk(B,Z.points,Z.segments):Z[ik]&&Z[ik](B,Z))},_80o:function(B){var K=this,L=K.s,W=K._78o,j=W.width,p=W.selectWidth,C=W.borderWidth,Q=B.lineJoin,r=B.lineCap,S=W.gray,G=W.pattern;B.lineJoin=W.join,B.lineCap=W.cap,K.drawPath(ve(B,G),W);var h=L("edge.width.absolute");h&&(B.save(),B.setTransform(1,0,0,1,0,0)),p&&(B.strokeStyle=W._97o,B.lineWidth=j+2*(C+p),B.stroke()),C&&(B.strokeStyle=S?I.toGrayColor(W.borderColor):W.borderColor,B.lineWidth=j+2*C,B.stroke());var A=S?I.toGrayColor(W.color):W.color,U=S?I.toGrayColor(W._67o):W._67o;if(B.strokeStyle=A,B.lineWidth=j,B.stroke(),W.is3d&&Cq(B,A,U,j,K.gv._zoom,W._66o),h&&B.restore(),Bb(B,G),L("edge.dash")){G=L("edge.dash.pattern");var f=ve(B,G,K._2Q("edge.dash.offset"));f!==B&&K.drawPath(f,W),K._1Q(B,"edge",L("edge.dash.width")||j,G)}B.lineJoin=Q,B.lineCap=r},_48O:function(){},_47O:function(){},_71o:function(G,f){var d=this,F=d._data;if(d._19Q=!0,!F.getEdgeGroup())return G?F.s("edge.gap"):0;var y,t=0,N=0,q=0;if(F.getEdgeGroup().getSiblings().each(function(w){w.each(function(H){if(d.gv.isVisible(H)&&H.s(fp)==f){var h=H.s("edge.gap");y?(N+=q/2+h/2,q=h):(y=H,q=h),H===F&&(t=N)}})}),G)return N-t+q;var E=t-N/2;return y&&F._40I!==y._40I&&(d._19Q=!1),E}});var lc=function(P,d){uj(lc,this,[P,d])};Zi(lc,On,{_3O:function(){var O,M,R=this,b=R.s,X=R._data,h=R.gv;if(R._88I=k,X.isExpanded()&&X.eachChild(function(I){var B=h.getBoundsForGroup(I);B&&(M||(M=[]),M.push(B),O=je(O,B))}),O){var c=h.getLabel(X),C=b("group.type");O=Hh(C,M,O),ud(O,X,"group.padding",1);var g=R._88I={type:C,rect:O,_64o:O};if(!C&&c!=k){var P,A=R.labelInfo={label:c,color:b("group.title.color"),font:b("group.title.font"),align:b("group.title.align")},o=So(A,c),x=o.width,p=o.height,F=b("group.title.align"),v=b("group.title.orientation");if((v===Bp||v===sm)&&x>O.width?O.width=x:(v===fq||v===nb)&&x>O.height&&(O.height=x),A.rect={y:O.y-p,width:o.width,height:p},P=F===fq?O.x:F===nb?O.x+O.width-x:O.x+O.width/2-x/2,A.rect.x=P,v===sm)g.titleRect={x:O.x,y:O.y+O.height,width:O.width,height:p},g.rect={x:O.x,y:O.y,width:O.width,height:O.height+p},A.rect={x:P,y:O.y+O.height,width:x,height:p};else if(v===fq){var z=g.titleRect={x:O.x-p,y:O.y,width:p,height:O.height};g.rect={x:O.x-p,y:O.y,width:O.width+p,height:O.height},A.rect={x:z.x+p/2-O.height/2,y:z.y+O.height/2-p/2,width:O.height,height:p},A.rotation=-Math.PI/2}else if(v===nb){var z=g.titleRect={x:O.x+O.width,y:O.y,width:p,height:O.height};g.rect={x:O.x,y:O.y,width:O.width+p,height:O.height},A.rect={x:z.x+p/2-O.height/2,y:z.y+O.height/2-p/2,width:O.height,height:p},A.rotation=Math.PI/2}else g.titleRect={x:O.x,y:O.y-p,width:O.width,height:p+1},g.rect={x:O.x,y:O.y-p,width:O.width,height:O.height+p}}R._40O(g,b("group.border.width")/2)}else lc.superClass._3O.call(R)},getPosition:function($,M,S,u){var n=this._88I;if(n){var V=uk($,n.rect,u);return V.x+=M,V.y+=S,V}return lc.superClass.getPosition.apply(this,arguments)},_24O:function(T,n){var b=this._88I;(!b||b.type||"label2"===T)&&lc.superClass._24O.call(this,T,n)},_80o:function(X){var q=this,u=q._88I;if(u){var v=q._data,$=q.s,_=q.gv,i=u.type,d=u.rect,H=u._64o,y=u.titleRect,M=q.getBodyColor(),x=Ne($("group.image"),M),r=$("group.image.stretch"),A=q.getBodyColor("group.background"),k=Ne($("group.repeat.image"),M),l=$("group.gradient.pack"),B=$("group.gradient"),O=$("group.gradient.color"),j=$("group.border.width"),J=$("group.border.color"),I=$("group.border.pattern"),Y=$("group.title.orientation"),Q=$("group.depth");if(i){var t=X.lineJoin,o=X.lineCap;if(X.lineJoin=$("group.border.join"),X.lineCap=$("group.border.cap"),x){if(X.save(),em(X,i,d),X.clip(),fo(X,x,r,d.x,d.y,d.width,d.height,v,_,M),X.restore(),j>0){var F=ve(X,I);em(F,i,d),X.lineWidth=j,X.strokeStyle=J,X.stroke(),Bb(X,I)}}else{var F=ve(X,I);A||k||l?(em(X,i,d),l?sr(X,l):k?Ve(X,k,M,null,v,_):nm(X,A,B,O,d),X.fill(),l&&X.restore(),X!==F&&em(F,i,d)):em(F,i,d),j>0&&(X.lineWidth=j,X.strokeStyle=$("group.border.color"),X.stroke()),Bb(X,I),i===Xd&&Fc(X,A,Q,d)}X.lineJoin=t,X.lineCap=o}else{var a=$("group.title.background"),c=$("group.border.radius");if(x)fo(X,x,r,H.x,H.y,H.width,H.height,v,_,q.getBodyColor());else if(A||k)if(k?Ve(X,k,M,null,v,_):nm(X,A,B,O,H),0===j)em(X,Xd,H),X.fill(),Fc(X,A,Q,H);else{switch(X.beginPath(),Y){case sm:_f(X,H.x,H.y,H.width,H.height,c,c,0,0);break;case fq:_f(X,H.x,H.y,H.width,H.height,0,c,0,c);break;case nb:_f(X,H.x,H.y,H.width,H.height,c,0,c,0);break;case Bp:_f(X,H.x,H.y,H.width,H.height,0,0,c,c)}X.fill()}if(y&&a)if(0===j)yq(X,y.x,y.y,y.width,y.height,a),Fc(X,a,Q,y);else{switch(X.beginPath(),X.fillStyle=a,Y){case sm:_f(X,y.x,y.y,y.width,y.height,0,0,c,c);break;case fq:_f(X,y.x,y.y,y.width,y.height,c,0,c,0);break;case nb:_f(X,y.x,y.y,y.width,y.height,0,c,0,c);break;case Bp:_f(X,y.x,y.y,y.width,y.height,c,c,0,0)}X.fill()}if(j>0){var F=ve(X,I);if(em(F,"roundRect",d,c),X.lineWidth=j,X.strokeStyle=J,y&&$("group.splitLine")){var f=y.x,D=y.y,C=y.width,L=y.height;Y===sm?(X.moveTo(f,D),X.lineTo(f+C,D)):Y===fq?(X.moveTo(f+C,D),X.lineTo(f+C,D+L)):Y===nb?(X.moveTo(f,D),X.lineTo(f,D+L)):(X.moveTo(f,D+L),X.lineTo(f+C,D+L))}X.stroke(),Bb(X,I)}}q._39O(X,u)}else lc.superClass._80o.call(q,X)}});var Kf=function(G,S){uj(Kf,this,[G,S])};Zi(Kf,On,{_80o:function(t){this._39O(t,this._83o)}});var Ek=function(v,S){uj(Ek,this,[v,S])};Zi(Ek,On,{_3O:function(){var S=this,$=S._data,B=S.s,y=S.gv,K=$.getPoints(),w=y.getBorderColor($),T=w?B("border.width"):0,P=S.getSelectWidth(),N=B("shape.border.width"),q=$.getRect(),r=y.getBodyColor($),R=S._99o=K.isEmpty()?k:{rect:q,rotation:$.getRotation(),fillRule:B("shape.fill.rule"),scale:$.getScale(),position:$.p(),points:K,segments:$.getSegments(),bodyColor:r,borderColor:w,borderWidth:T,_94o:B("shape.border.3d"),_95o:B("shape.border.3d.color"),_96o:B("shape.border.3d.accuracy"),_97o:P?S.getSelectColor():k,selectWidth:P,_53o:B("shape.background"),_27Q:Ne(B("shape.repeat.image"),r),shapeGradientPack:B("shape.gradient.pack"),_54o:N,_55o:B("shape.border.color"),shapeGradient:B("shape.gradient"),_59o:B("shape.gradient.color"),_60o:B("shape.border.pattern"),_61o:B("shape.border.cap"),_62o:B("shape.border.join"),shapeForeground:B("shape.foreground"),gray:B("2d.gray")};if(R){var c=$.getScale(),l=j(1,j(F(c.x),F(c.y)));B("shape.dash")&&B("shape.dash.width")>N&&(N=B("shape.dash.width"));var G=N*("square"===R._61o?.71:.5)+T+P/S.gv._zoom/l;G&&(G*=l,q=pb(q),Nl(q,G,R._62o)),S._68o(q);var z=B("clip.percentage");1>z&&(0>z&&(z=0),R.clipRect=Qf($.getAnchorRect(),B("clip.direction"),z));var n=B("shape.fill.clip.percentage");1>n&&(0>n&&(n=0),R.shapeClipRect=Qf($.getAnchorRect(),B("shape.fill.clip.direction"),n));var I=B("shape.foreground.clip.percentage");1>I&&(0>I&&(I=0),R.shapeForegroundClipRect=Qf($.getAnchorRect(),B("shape.foreground.clip.direction"),I))}},getPosition:function(H,y,D,o){var g=this._99o;if(g){var M=uk(H,g.rect,o);return M.x+=y,M.y+=D,M}return Bf},_42:function(n){this._99o&&Ek.superClass._42.call(this,n)},_80o:function(Z){var t,n=this,R=n.s,U=n._99o,H=U.position,Q=U.scale,y=U.rotation,W=U.borderWidth,x=U.selectWidth/n.gv._zoom,A=U._27Q,M=U.shapeGradientPack,O=U._54o,B=U.clipRect,o=U.shapeClipRect,q=U.points,l=U.segments,h=n._data.isClosePath(),G=U.fillRule,d=U.gray,P=function(e){return d?I.toGrayColor(e):e},c=P(U._53o),v=c||A||M;Z.save(),Ig(Z,H.x,H.y),ef(Z,y),go(Z,Q.x,Q.y),B&&(Z.beginPath(),Z.rect(B.x,B.y,B.width,B.height),Z.clip()),v&&o&&(Z.save(),Z.beginPath(),Z.rect(o.x,o.y,o.width,o.height),Z.clip()),Ig(Z,-H.x,-H.y);var T=U._60o,m=ve(Z,T),z=Z.lineJoin,_=Z.lineCap;Z.lineJoin=U._62o,Z.lineCap=U._61o;var k=P(U.bodyColor);v?(pk(Z,q,l,h),M?sr(Z,M):A?Ve(Z,A,k,null,n._data,n.gv):(t=k?k:c,nm(Z,t,U.shapeGradient,P(U._59o),U.rect)),Z.fill(G),o&&(Z.restore(),Ig(Z,-H.x,-H.y)),M&&Z.restore(),m!==Z&&pk(m,q,l,h)):pk(m,q,l,h);var V=U.shapeForeground;if(V){Z.save();var u=U.shapeForegroundClipRect;u&&(Ig(Z,H.x,H.y),Z.beginPath(),Z.rect(u.x,u.y,u.width,u.height),Z.clip(),Ig(Z,-H.x,-H.y)),pk(Z,q,l,h),nm(Z,V,R("shape.foreground.gradient"),P(R("shape.foreground.gradient.color")),U.rect),Z.fill(G),Z.restore()}var s=R("shape.border.width.absolute");if(s&&(Z.save(),Z.setTransform(1,0,0,1,0,0)),x&&(Z.strokeStyle=U._97o,Z.lineWidth=O+2*(W+x),Z.stroke()),W&&(Z.strokeStyle=P(U.borderColor),Z.lineWidth=O+2*W,Z.stroke()),O&&(t=P(U._55o),!c&&k&&(t=k),Z.strokeStyle=t,Z.lineWidth=O,Z.stroke(),U._94o&&Cq(Z,t,P(U._95o),O,n.gv._zoom,U._96o)),s&&Z.restore(),Bb(Z,T),R("shape.dash")){var D=R("shape.dash.width")||O;if(D>0){T=R("shape.dash.pattern");var m=ve(Z,T,n._2Q("shape.dash.offset"));m!==Z&&pk(m,q,l,h),n._1Q(Z,"shape",D,T)}}Z.lineJoin=z,Z.lineCap=_,Z.restore()},_48O:function(){},_47O:function(){}});var Sd=function(D,K){uj(Sd,this,[D,K])};Zi(Sd,Ek,{getRotation:function(f,V,j){f=f||0;var M=this._data.getPoints(),m=M.size();return m>1?dn[j]?m&&0===m%2?Wm(M.get(m/2-1),M.get(m/2),V,f):f:Vd[j]?Wm(M.get(0),M.get(1),V,f):Wm(M.get(m-2),M.get(m-1),V,f):f},getPosition:function($,s,J,K,W){var p=this._data.getPoints(),I=p.size();if(I>1){if(dn[$]){var T=I%2;if(0===T)return Ng(p.get(I/2-1),p.get(I/2),$,s,J,K,W);var D=p.get((I-T)/2),w={x:D.x,y:D.y,width:0,height:0};return D=uk($,w,K),D.x+=s,D.y+=J,D}return Vd[$]?Ng(p.get(0),p.get(1),$,s,J,K,W):Ng(p.get(I-2),p.get(I-1),$,s,J,K,W)}return Bf}});var Mm=function(W,m){uj(Mm,this,[W,m])};Zi(Mm,On,{_3O:function(){var S=this;Mm.superClass._3O.call(S);var m=S.s,M=S._83o;S._82o=M.img||M.shape?k:{background:S.getBodyColor("grid.background"),depth:m("grid.depth"),rect:M.rect,_88o:m("grid.cell.depth"),cellBorderColor:m("grid.cell.border.color"),_89o:m("grid.row.count"),_90o:m("grid.column.count"),block:m("grid.block"),_91o:m("grid.block.color"),_92o:m("grid.block.padding"),_93o:m("grid.block.width")}},_80o:function(U){var T=this,$=T._82o;if(!$)return Mm.superClass._80o.call(T,U),void 0;var A,p,J=T._data,m=$.background,q=$.rect,s=$.block,F=$._91o,n=$._92o,i=$._93o,j=$._88o,b=$.cellBorderColor,S=$._89o,H=$._90o;if(m)if(yq(U,q.x,q.y,q.width,q.height,m),Fc(U,m,$.depth,q),j)for(A=0;S>A;A++)for(p=0;H>p;p++)q=J.getCellRect(A,p),q&&Fc(U,m,j,q);else if(b){for(U.beginPath(),A=0;S>A;A++)for(p=0;H>p;p++)q=J.getCellRect(A,p),q&&U.rect(q.x,q.y,q.width,q.height);U.strokeStyle=b,U.lineWidth=1,U.stroke()}if("h"===s)for(A=0;S>A;A++)q=je(J.getCellRect(A,0),J.getCellRect(A,H-1)),Oq(q,n),so(U,F,q.x,q.y,q.width,q.height,i);else if("v"===s)for(p=0;H>p;p++)q=je(J.getCellRect(0,p),J.getCellRect(S-1,p)),Oq(q,n),so(U,F,q.x,q.y,q.width,q.height,i);T._39O(U,T._83o)}});var ao=function(R,q){uj(ao,this,[R,q])};Zi(ao,On,{_checkEmptyRect:!1,_81o:function(){var j=this._data,d=ao.superClass._81o.call(this),_=j.s("text");if(_!=k){var r,a,H=j.s("text.font"),I=j.s("text.align"),h=j.s("text.vAlign"),O=Qk(H,_),N=O.width,W=O.height,n=j.getAnchor(),M=j.getWidth(),J=j.getHeight();"left"===I?r=-M*n.x:"center"===I?r=-M*n.x+(M-N)/2:"right"===I&&(r=M*(1-n.x)-O.width),"top"===h?a=-J*n.y:"middle"===h?a=-J*n.y+(J-W)/2:"bottom"===h&&(a=J*(1-n.y)-O.height);var L,X=j.getMatrix();if(L=Fd([X.tf(r,a),X.tf(r+N,a),X.tf(r+N,a+W),X.tf(r,a+W)]),d=je(d,L),d&&j.s("text.shadow")){var C=pb(d);C.x+=j.s("text.shadow.offset.x"),C.y+=j.s("text.shadow.offset.y"),Oq(C,j.s("text.shadow.blur")),d=je(d,C)}}return d}});var io=Mp.Interactor=function(f){this.gv=this._graphView=f};Mi("Interactor",c,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(D){this.gv.fi(D)},setCursor:function(y){uh||this.gv.setCursor(y)},startDragging:function(x){var m=this;m._lastClientPoint=ms(x),m._lastLogicalPoint=m.gv.lp(x),rk(m,x)},clearDragging:function(){var v=this;v._lastClientPoint=v._lastLogicalPoint=v._logicalPoint=k},autoScroll:function(m){return this.gv.autoScroll(m,this._lastClientPoint)}});var Xb=k,xd=function(N){Xb.handleWindowTouchMove(N)},ip=function(d){Xb.handleWindowTouchEnd(d),B.removeEventListener(wq,xd,m),B.removeEventListener($k,ip,m),Xb=k},Hn=function(w){Xb.handleWindowMouseMove(w)},kl=function(o){Xb.handleWindowMouseUp(o),B.removeEventListener(wr,Hn,m),B.removeEventListener(cs,kl,m),Xb=k},De=function(Z,f){Z!==Xb&&(Xb?uh?Xb.handleWindowTouchEnd(f):Xb.handleWindowMouseUp(f):uh?(B.addEventListener(wq,xd,m),B.addEventListener($k,ip,m)):(B.addEventListener(wr,Hn,m),B.addEventListener(cs,kl,m)),Xb=Z)},Ib=function(F){var v=this;v.gv=F,v._is2d=F instanceof Mp.GraphView,v._is2d&&(v.filter=function(g){return F.isSelectable(g)&&F.isInteractive(g)}),F.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",Sb].forEach(function(f){v.addListener(f)}),v.initImageResource()};Zi(Ib,io,{enableVR:function($){var G=this;if(!!G._vrEnable!==$)if(G._vrEnable=$,$)G.gv.vr.mp(G.onVRControllerChange,G);else if(G.gv.vr.ump(G.onVRControllerChange,G),G._vrRayPolyline){var P=G.gv.dm();P.remove(G._vrRayPolyline),P.remove(G._vrRayHitPoint),G._vrRayPolyline=V,G._vrRayHitPoint=V}},onVRControllerChange:function(U){var m=this,W=U.property,T=U.newValue,u=m.gv.vr.getController(T.id),e=u.getRay();e&&("gamepad.button.trigger"===W?"down"===T._62O?m.handle_mousedown(e):m.handleWindowMouseUp(e):"gamepad.pose"===W&&(m.handle_mousemove(e),m.handleWindowMouseMove(e)))},drawVRRay:function(w,g,b){var L,i=this,J=i.gv,k=i._vrRayPolyline,N=!1;if(k)L=i._vrRayHitPoint;else{var Y=J.dm();i._vrRayPolyline=k=new C.Polyline,i._vrRayHitPoint=L=new C.Node,L.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),L.setAnchor3d(.5,.5,.499);var t=.2/J.vr.measureOflength;L.s3(t,t,t),k.s("intersect",!1),L.s("intersect",!1),Y.add(k),Y.add(L),N=!0}if(g){var V=b.world,j=b.worldNormal,S=V.x,z=V.y,W=V.z;k.s("shape.border.color","red"),k.setPoints([{x:w.origin.x,y:w.origin.z,e:w.origin.y},{x:S,y:W,e:z}]),L.s("3d.visible",!0),L.p3(S,z,W),L.lookAtDirection([j.x,j.y,j.z],"front")}else{k.s("shape.border.color","blue");var F=new C.Math.Vector3;F.copy(w.direction).setLength(1e3/i.gv.vr.measureOflength).add(w.origin),k.setPoints([{x:w.origin.x,y:w.origin.z,e:w.origin.y},{x:F.x,y:F.z,e:F.y}]),L.s("3d.visible",!1)}J.fi({kind:"vrRayIntersect",ray:w,data:g,intersect:b,polyline:k,hitNode:L,begin:N})},addListener:function(O){var n=this;n.gv.getView().addEventListener(O,function(Z){I.preventDefault(Z),n.disabled||n["handle_"+O](Z)},m)},handleWindowTouchMove:function(e){this.handleWindowMouseMove(e)},handleWindowMouseMove:function(Z){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",Z):(this.handleDownInfo("onBeginDrag",Z),this.isDragging=!0))},handleWindowTouchEnd:function(o){this.handleWindowMouseUp(o)},handleWindowMouseUp:function(B){if(this.isDragging&&(this.handleDownInfo("onEndDrag",B),this.isDragging=!1),this.downInfo){var j=this.handle("onUp",B);j&&j.data===this.downInfo.data?this.handleMissingUp(B):this.handleDownInfo("onUp",B),this.downInfo=k}},handle_mouseleave:function(_){var B=this,y=B.gv,r=B.currentInfo?B.currentInfo.data:k;if(r){r.s("onLeave")&&r.s("onLeave")(_,r,y),B.fire("data","onLeave",_,r);var f=B.currentInfo?B.currentInfo.hits:k;if(f)for(var N in f)B.handleLeave(_,N);B.currentInfo=k}},handle_mousewheel:function(I){I.scrollDelta=I.wheelDelta/40,this.handle("onScroll",I)},handle_DOMMouseScroll:function(X){X.scrollDelta=2===X.axis?-X.detail:0,this.handle("onScroll",X)},handle_touchstart:function(S){this.handle_mousedown(S)},handle_touchmove:function(c){this.handle("onMove",c)},handle_mousedown:function(H){this.isDragging&&(this.handleDownInfo("onEndDrag",H),this.isDragging=!1),this.downInfo=this.handle("onDown",H),this.downInfo&&De(this,H)},handle_mousemove:function(G){var D=this,J=D.gv;D._hoverTimer&&(T(D._hoverTimer),delete D._hoverTimer);var $,j,Q,C=D.handle("onMove",G),c=this.currentInfo?this.currentInfo.data:k,i=this.currentInfo?this.currentInfo.hits:k;if(C&&(j=C.data,Q=C.hits,D._hoverTimer=N(function(){T(D._hoverTimer),delete D._hoverTimer,D.handle("onHover",G,C)},J.getHoverDelay()||I.hoverDelay)),j!==c){if(c&&(c.s("onLeave")&&c.s("onLeave")(G,c,J),this.fire("data","onLeave",G,c)),j&&(j.s("onEnter")&&j.s("onEnter")(G,j,J),this.fire("data","onEnter",G,j)),i)for($ in i)this.handleLeave(G,$);if(Q)for($ in Q){var x=Q[$];x.target.onEnter&&x.target.onEnter(G,j,J,x.point,x.width,x.height),this.fire(x.type,"onEnter",x.event,x.data,x.image,x.comp,x.point,x)}}else{if(i)for($ in i)Q&&Q[$]||this.handleLeave(G,$);if(Q)for($ in Q)if(!i||!i[$]){var x=Q[$];x.target.onEnter&&x.target.onEnter(G,j,J,x.point,x.width,x.height),this.fire(x.type,"onEnter",x.event,x.data,x.image,x.comp,x.point,x)}}this.currentInfo=C},handle:function(p,h,y){var $,r=this,B=r.gv;if(r._is2d){if(y=y||B.getDataInfoAt(h,this.filter),!y)return;if($=y.ui.interactiveInfo){var t,U=y.data;if(U.s(p)&&U.s(p)(h,U,B),this.fire("data",p,h,U),"body"===y.part&&$.bodyInfo)t="body",y.hits=this.handleImage(t,B.getImage(U),p,h,U,y.point,$.bodyInfo);else if("icons"===y.part&&$._38o){var R=$._38o[y.name];R&&R[y.index]&&(t="icons|"+y.name+"|"+y.index,y.hits=this.handleImage(t,y.icon,p,h,U,y.point,R[y.index]))}}return y}var U,W;if(!y)if(h&&h instanceof C.Math.Ray){var s=B.vr.intersectWorld(h);if(U=s.data,W=s.intersect,r.drawVRRay(h,U,W),!U)return;var H=B.getData3dUI(U);if($=H.interactiveInfo,!$)return;y={data:U,part:W.part,ui:H}}else{if(y=B.getDataInfoAt(h),!y)return;y&&(y={data:y.data,part:y.part})}if(!W){U=y.data;var H=B.getData3dUI(U);if(y.ui=H,$=H.interactiveInfo,!$)return y;if(W=B.intersectObject(h,U),!W)return}U.s(p)&&U.s(p)(h,U,B),this.fire("data",p,h,U);var Y,I=W.part;return"body"!==I&&(Y=U.s(I+".image")||U.s("shape3d."+I+".image")),Y||(Y=U.s("all.image")||U.s("shape3d.image")),$="object"==typeof Y?$[Y.uuid]:$[Y],$&&$.bodyInfo?(y.part="body",y.interactiveInfo=$,y.point=W.uv.multiply({x:$.bodyInfo.rect.width,y:$.bodyInfo.rect.height}),y.image=Y,y.hits=this.handleImage("body",Y,p,h,U,y.point,$.bodyInfo),y):y},_handleLeaveOrMissing:function(j,N,$){var o="leave"===j?this.currentInfo:this.downInfo;if(o){var _=o.interactiveInfo||o.ui.interactiveInfo;if(_){var c,y,Y=o.data;if(this._is2d){if(y=this.gv.lp(N),"body"===o.part&&_.bodyInfo)c="body","leave"===j?this.handleLeaveImage($,c,this.gv.getImage(Y),N,Y,y,_.bodyInfo):this.handleMissingUpImage(c,this.gv.getImage(Y),N,Y,y,_.bodyInfo);else if("icons"===o.part&&_._38o){var O=_._38o[o.name];O&&O[o.index]&&(c="icons|"+o.name+"|"+o.index,"leave"===j?this.handleLeaveImage($,c,o.icon,N,Y,y,O[o.index]):this.handleMissingUpImage(c,o.icon,N,Y,y,O[o.index]))}}else{if(!_.bodyInfo)return;var z=this.gv.intersectObject(N,Y);y=z?z.uv.multiply({x:_.bodyInfo.rect.width,y:_.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===j?this.handleLeaveImage($,"body",o.image,N,Y,y,_.bodyInfo):this.handleMissingUpImage("body",o.image,N,Y,y,_.bodyInfo)}}}},handleDownInfo:function(O,t){if(this.downInfo){var e=this.downInfo,i=this.gv,M=e.interactiveInfo||e.ui.interactiveInfo;if(M){var X,N=e.data;if(N.s(O)&&N.s(O)(t,N,i),this.fire("data",O,t,N),this._is2d){var u=i.lp(t);if("body"===e.part&&M.bodyInfo)X="body",this.handleDownInfoImage(X,i.getImage(N),O,t,N,u,M.bodyInfo);else if("icons"===e.part&&M._38o){var K=M._38o[e.name];K&&K[e.index]&&(X="icons|"+e.name+"|"+e.index,this.handleDownInfoImage(X,e.icon,O,t,N,u,K[e.index]))}}else{if(!M.bodyInfo)return;var H=i.intersectObject(t,N);if(!H)return;u=H.uv.multiply({x:M.bodyInfo.rect.width,y:M.bodyInfo.rect.height}),this.handleDownInfoImage("body",e.image,O,t,N,u,M.bodyInfo)}}}},fire:function(F,D,Q,c,l,H,m,y){this.gv.fi({kind:D,type:F,event:Q,data:c,image:l,comp:H,view:this.gv,point:m,width:y?y.width:V,height:y?y.height:V})},handleImage:function(z,y,X,A,E,u,B){var L={};if(y&&(y=Ne(y))){var j=this.gv,S=B.rect,K=this.convertPoint(u,B);K.inRect&&(y[X]&&y[X](A,E,j,K,S.width,S.height),this.fire("image",X,A,E,y,V,K,S),L[z+"|image"]={target:y,type:"image",image:y,data:E,event:A,point:K,width:S.width,height:S.height});for(var g=B.compInfos,i=y,D=g.length-1;D>=0;D--){var U=g[D],n=U.comp;K=this.convertPoint(u,U,i,n,j,E),K.inRect&&(S=U.rect,n[X]&&n[X](A,E,j,K,S.width,S.height),this.fire("comp",X,A,E,y,n,K,S),(y=S.image)&&(y[X]&&y[X](A,E,j,K,S.width,S.height),this.fire("image",X,A,E,y,V,K,S)),L[z+"|"+D]={target:n,type:"comp",comp:n,image:y,data:E,event:A,point:K,width:S.width,height:S.height},y&&(L[z+"|"+D+"|image"]={target:y,type:"image",image:y,data:E,event:A,point:K,width:S.width,height:S.height}))}}return L},handleLeave:function(z,F){return this._handleLeaveOrMissing("leave",z,F)},handleMissingUp:function(Y){return this._handleLeaveOrMissing("missing",Y)},handleLeaveImage:function(Z,e,g,b,c,p,R){if(g&&(g=Ne(g))){var E=this.gv,J=R.rect,w=this.convertPoint(p,R);Z===e+"|image"&&(g.onLeave&&g.onLeave(b,c,E,w,J.width,J.height),this.fire("image","onLeave",b,c,g,V,w,J));for(var s=R.compInfos,y=g,i=s.length-1;i>=0;i--){var S=s[i],u=S.comp;w=this.convertPoint(p,S,y,u,E,c),J=S.rect,Z===e+"|"+i&&(u.onLeave&&u.onLeave(b,c,E,w,J.width,J.height),this.fire("comp","onLeave",b,c,g,u,w,J)),(g=J.image)&&Z===e+"|"+i+"|image"&&(g.onLeave&&g.onLeave(b,c,E,w,J.width,J.height),this.fire("image","onLeave",b,c,g,V,w,J))}}},handleMissingUpImage:function(n,T,_,j,i,H){var q="onUp",Q=this.downInfo.hits;if(Q&&T&&(T=Ne(T))){var h=this.gv,I=H.rect,X=this.convertPoint(i,H);!X.inRect&&Q[n+"|image"]&&(T[q]&&T[q](_,j,h,X,I.width,I.height),this.fire("image",q,_,j,T,V,X,I));for(var L=H.compInfos,O=T,K=L.length-1;K>=0;K--){var d=L[K],x=d.comp;X=this.convertPoint(i,d,O,x,h,j),X.inRect||(I=d.rect,Q[n+"|"+K]&&(x[q]&&x[q](_,j,h,X,I.width,I.height),this.fire("comp",q,_,j,T,x,X,I)),(T=I.image)&&Q[n+"|"+K+"|image"]&&(T[q]&&T[q](_,j,h,X,I.width,I.height),this.fire("image",q,_,j,T,V,X,I)))}}},handleDownInfoImage:function(l,e,h,o,Z,R,L){var m=this.downInfo.hits;if(m&&e&&(e=Ne(e))){var C=this.gv,T=L.rect,W=this.convertPoint(R,L);m[l+"|image"]&&(e[h]&&e[h](o,Z,C,W,T.width,T.height),this.fire("image",h,o,Z,e,V,W,T));for(var z=L.compInfos,S=e,Q=z.length-1;Q>=0;Q--){var d=z[Q],c=d.comp;W=this.convertPoint(R,d,S,c,C,Z),T=d.rect,m[l+"|"+Q]&&(c[h]&&c[h](o,Z,C,W,T.width,T.height),this.fire("comp",h,o,Z,e,c,W,T)),(e=T.image)&&m[l+"|"+Q+"|image"]&&(e[h]&&e[h](o,Z,C,W,T.width,T.height),this.fire("image",h,o,Z,e,V,W,T))}}},initImageResource:function(){I.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(T,B,U,g,y,P){var J=B.rect,Z=B.matrix.applyInverse(T).sub(J),a=Z.x>=0&&Z.y>=0&&Z.x<=J.width&&Z.y<=J.height;if(!a)return Z;if(g&&Sq(g.pixelPerfect,P,y)){var J,Y=1;this._is2d?(Y=y.getZoom(),J=pe(T.x,T.y,V,Y)):J=pe(T.x,T.y);var u=!1,A=J.x,p=J.y,x=J.width,l=J.height,C=I.hitMaxArea,w=x*l*Y*Y;if(w>C){var K=Math.sqrt(C/w);Y*=K}x*=Y,l*=Y,2>x&&(x=2),2>l&&(l=2),A*=Y,p*=Y;var Q=Mn(x,l),O=new sq(0,-A,-p,Y,Y);O.append(B.matrix),y._drawForChecking=!0,g.transform=O;var r=U.comps;U.comps=[g],Gb(Q,U,0,0,x,l,P,self),U.comps=r,delete g.transform,y._drawForChecking=!1;try{for(var X=0,q=Q.getImageData(0,0,x,l).data;X<q.length;X+=4)if(0!==q[X+3]){u=!0;break}Q.restore()}catch(R){rb=k,u=!1}Z.inRect=u}else Z.inRect=!0;return Z}});var Ee=Mp.DefaultInteractor=function(K){uj(Ee,this,[K])};Mi("DefaultInteractor",io,{handle_mousedown:function(H){_d(H);
var M=this,f=M.gv,c=f.getDataAt(H);!f.setFocus(H)||f._editing||f._scrolling||(sj(H)?f.handleDoubleClick(H,c):f.handleClick(H,c),!Eg()&&c&&(f.isMovable(c)||f.isInteractive(c))||!f.isPannable()||!Bn(H)||pr(H)||(M._tx=f.tx(),M._ty=f.ty(),M.startDragging(H)))},handleWindowMouseUp:function(o){var F=this,k=F.gv;k._panning&&(delete k._panning,k.onPanEnded(),F.fi({kind:"endPan",event:o})),delete F._tx,delete F._ty,F.clearDragging()},handle_mousemove:function(J){var W=this,d=W.gv;W._hoverTimer&&(T(W._hoverTimer),delete W._hoverTimer),W._hoverTimer=N(function(){W.fi({kind:"hover",event:J}),T(W._hoverTimer),delete W._hoverTimer},d.getHoverDelay()||I.hoverDelay)},handle_touchmove:function(D){this.handle_mousemove(D)},handleWindowMouseMove:function(Y){var u=this,y=u.gv,x=u._lastClientPoint;u.fi({kind:y._panning?"betweenPan":"beginPan",event:Y}),y._panning=1,y.setTranslate(u._tx+Y.clientX-x.x,u._ty+Y.clientY-x.y)},handle_mousewheel:function(C){this.gv.handleScroll(C,C.wheelDelta)},handle_DOMMouseScroll:function(J){2===J.axis&&this.gv.handleScroll(J,-J.detail)},handle_keydown:function(f){this.gv.handleKeyDown(f)}});var Hp=Mp.SelectInteractor=function(f){uj(Hp,this,[f])};Mi("SelectInteractor",io,{_42:function(){var T=this,p=T.gv,q=p.getZoom(),c=T.mark,B=T.div;B||(B=T.div=Xf(),Ll(T.getView(),B));var O={};O.x=c.x*q+p.tx(),O.y=c.y*q+p.ty(),O.width=c.width*q,O.height=c.height*q,qi(B,O),this.intersects()?(B.style.border="",B.style.background=p.getRectSelectBackground()):(B.style.background="",B.style.border="1px solid "+p.getRectSelectBorderColor())},handle_mousedown:function(A){var G=this,Y=G.gv;if(G._57I=k,G.pendingClickThrough=k,!(Y._editing||Y._scrolling||Eg())){var U=Y.getDataAt(A),R=Y.sm();U?pr(A)?R.co(U)?R.rs(U):R.as(U):R.co(U)?U instanceof as&&U.isClickThroughEnabled()&&Bn(A)&&(G.pendingClickThrough=ms(A)):R.ss(U):pr(A)||!Y.isPannable()?Bn(A)&&(pr(A)||R.cs(),Y.isRectSelectable()&&(G.startDragging(A),Y._77O=1)):Bn(A)&&(G._57I=ms(A))}},handle_mouseup:function(P){var T=this,N=T.gv,$=T._57I;if($&&(wh($,ms(P))<=1&&N.sm().cs(),T._57I=k),T.pendingClickThrough){if(wh(T.pendingClickThrough,ms(P))<=1){var r=N.getDataAt(P);if(r instanceof as&&r.isClickThroughEnabled()){var J=N.getDataAt(P,function(q){var k=q.getParent()===r&&N.isSelectable(q,!0);return k});J&&(P.clickThrough=!0,N.sm().ss(J))}}T.pendingClickThrough=k}},handleWindowMouseUp:function(Y){this.clear(Y)},handleWindowMouseMove:function(G){var B=this,K=B.gv;B._logicalPoint=K.lp(G),B.mark?(B.fi({kind:"betweenRectSelect",event:G}),K.isPannable()&&B.autoScroll(G),B.redraw()):B.fi({kind:"beginRectSelect",event:G}),B.mark=Fd(B._lastLogicalPoint,B._logicalPoint),B.redraw()},intersects:function(){var x=this,H=x._lastLogicalPoint,y=x._logicalPoint;return H.x>y.x||H.y>y.y},clear:function(K){var j=this,E=j.gv,c=j.mark;if(j._57I=k,j.pendingClickThrough=k,j._lastLogicalPoint){if(c){if(0!==c.width&&0!==c.height){var t=E.getDatasInRect(c,j.intersects());if(!t.isEmpty()){var M=E.sm(),f=M.toSelection();t.each(function(W){M.co(W)?f.remove(W):f.add(W)}),M.ss(f)}}Zj(j.div),delete j.div,delete j.mark,j.redraw(),j.fi({kind:"endRectSelect",event:K}),E.onRectSelectEnded()}j.clearDragging(),delete E._77O}},redraw:function(){var G=this;G._draw||(G._draw=1,N(function(){G.mark&&G._42(),delete G._draw},16))}});var Bd=Mp.MoveInteractor=function(k){uj(Bd,this,[k])};Mi("MoveInteractor",io,{handle_mousedown:function(l){var p=this,a=p.gv;if(Bn(l)&&!a._editing&&!a._scrolling&&!Eg()){var V=a.getSelectedDataAt(l);!V||a.isInteractive(V)&&!a.isMovable(V)?a._focusData=k:(p._data=V,a.handleMouseDown&&a.handleMouseDown(l,V),p.startDragging(l),a.isMovable(V)&&(a._moving=1))}},handleWindowMouseUp:function(D){var F=this,U=F.gv;U.handleMouseUp&&U.handleMouseUp(D,F._data),F.clear(D)},handleWindowMouseMove:function(l){var K=this,E=K._data,O=K.gv;if((!O._93O||!O._93O(l,E))&&O._moving){K._logicalPoint||K.fi({kind:"prepareMove",event:l});var i=K._logicalPoint?"betweenMove":"beginMove",N={kind:i,event:l},o=K._logicalPoint=O.lp(l);"beginMove"!==i||K._alreadyBeginTransaction||(K._alreadyBeginTransaction=!0,O.getDataModel().beginTransaction());var W=K._calcShift(i,l),y=W.x,k=W.y,z=K.gv.getMoveMode(l,E);z&&("x"===z?k=0:"y"===z?y=0:"xy"!==z&&(y=k=0)),O.moveSelection(y,k),K._lastLogicalPoint=o,K.autoScroll(l),K.fi(N)}},_calcShift:function(){var j=this,s=j._logicalPoint,C=j._lastLogicalPoint,k=s.x-C.x,M=s.y-C.y;return{x:k,y:M}},clear:function(c){var A=this,D=A.gv;A._lastLogicalPoint&&(A._lastLogicalPoint=A._data=D._moving=k,A._logicalPoint&&(A.fi({kind:"endMove",event:c}),D.onMoveEnded()),A.clearDragging()),A._alreadyBeginTransaction&&(A._alreadyBeginTransaction=!1,D.getDataModel().endTransaction())}});var aq=Mp.ScrollBarInteractor=function(b){uj(aq,this,[b])};Mi("ScrollBarInteractor",io,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(w){var q=this.gv.getViewRect();return this._41o()&&(q.x+q.width-this.gv.lp(w).x)*this.gv.getZoom()<oo},isH:function(N){var J=this.gv.getViewRect();return this._40o()&&(J.y+J.height-this.gv.lp(N).y)*this.gv.getZoom()<oo},handle_mousemove:function(t){this.handle_touchmove(t)},handle_touchmove:function(z){if(!Pg&&Bn(z)&&this.gv.isScrollBarVisible()){var V=this,P=V.isV(z),_=V.isH(z);(P||_)&&V.gv.showScrollBar(),V.gv._scrolling=P||_}},handleWindowMouseUp:function($){this.handleWindowTouchEnd($)},handleWindowTouchEnd:function(D){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=k,this.fi({kind:"endScroll",event:D})},handle_mousedown:function(k){this.handle_touchstart(k)},handle_touchstart:function(F){var V=this;if(V.gv.setFocus(F),_d(F),V.handle_touchmove(F),!(Nc(F)>1)&&V.gv._scrolling&&V.gv.isScrollBarVisible()){V._cp=ms(F),V._tx=V.gv.tx(),V._ty=V.gv.ty();var r=V.isV(F);V._state=r?"vScroll":"hScroll",rk(V,F),V.fi({kind:"beginScroll",event:F})}},handleWindowMouseMove:function(m){this.handleWindowTouchMove(m)},handleWindowTouchMove:function(B){var Q=ms(B),L=this.gv.getViewRect(),E=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-Q.y)*E.height/L.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-Q.x)*E.width/L.width),this.fi({kind:"betweenScroll",event:B})}});var Fp=Mp.TouchInteractor=function(Y,O){O=O||{},O.selectable===V&&(O.selectable=!0),O.movable===V&&(O.movable=!0),O.pannable===V&&(O.pannable=!0),O.pinchable===V&&(O.pinchable=!0),O.editable===V&&(O.editable=!0),this.params=O,uj(Fp,this,[Y])};Mi("TouchInteractor",io,{ms_edit:1,setUp:function(){var T=this;Fp.superClass.setUp.call(T),uh&&T.params.editable&&T.gv.setEditInteractor(T)},tearDown:function(){var c=this;Fp.superClass.tearDown.call(c),uh&&c.params.editable&&c.gv.setEditInteractor(k)},clear:function(v){var F=this,z=F.gv;z._moving&&(F.fi({kind:"endMove",event:v}),delete z._moving,z.onMoveEnded(),z.dm().endTransaction()),z._panning&&(F.fi({kind:"endPan",event:v}),delete z._panning,z.onPanEnded()),z._pinching&&(F.fi({kind:"endPinch",event:v}),delete z._pinching,z.onPinchEnded()),z._editing&&(F._46O(v),F._77I=F._node=F._edge=F._shape=F._rect=F._89I=F._index=z._editing=k),F._moving=F._panning=F._pinching=F._editing=F._57I=F._data=F._beginHistory=k,F.clearDragging()},handle_touchstart:function(L){var z=this;if(!z.gv._editing){_d(L),z._57I=k;var m=z.params,$=z.gv,X=$.sm(),e=$.getDataAt(L),c=Nc(L);if(1===c){if(sj(L))return $.handleDoubleClick(L,e),void 0;$.handleClick(L,e),e&&($.handleMouseDown&&$.handleMouseDown(L,e),z._data=e),m.selectable||(e=k),e?(X.co(e)||X.ss(e),m.editable&&$.isEditable(e)&&z._79I(L,e,!0)?(z._editing=1,z.startDragging(L)):m.movable&&$.isMovable(e)&&(z._moving=1,z.startDragging(L))):(z._57I=ms(L),m.pannable&&$.isPannable()&&(z._panning=1,z.startDragging(L),z._translate={x:$.tx(),y:$.ty()}))}else if(m.pinchable&&2===c){z._pinching=1,z.startDragging(L);var B=$.getView(),w=$.getZoom(),F=B.getBoundingClientRect(),O=L.touches[0],l=L.touches[1],Z={x:(O.clientX+l.clientX)/2-F.left,y:(O.clientY+l.clientY)/2-F.top};Z.x-=$.tx(),Z.y-=$.ty(),Z.x/=w,Z.y/=w,z._p=Z,z._d=Kc(L)}}},handle_touchend:function(F){var l=this,M=l.gv,s=l._57I,r=l._data;s&&(wh(s,ms(F))<=1&&M.sm().cs(),l._57I=k),r&&M.handleMouseUp&&M.handleMouseUp(F,r)},handleWindowTouchEnd:function(q){this.clear(q)},handleWindowTouchMove:function(F){var P=this,d=P.gv,e=Nc(F);if(1===e){if(P._editing&&(P._beginHistory||(P._beginHistory=1,d.dm().beginTransaction()),d._editing=1,P._78I(F)),P._moving)P._beginHistory||(P._beginHistory=1,d.dm().beginTransaction()),P.handleMove(F);else if(P._panning){var s=ms(F);d.setTranslate(P._translate.x+s.x-P._lastClientPoint.x,P._translate.y+s.y-P._lastClientPoint.y),P.fi({kind:d._panning?"betweenPan":"beginPan",event:F}),d._panning=1}}else if(2===e&&P._pinching){var a=Kc(F);d.handlePinch(P._p,a,P._d),P._d=a,P.fi({kind:d._pinching?"betweenPinch":"beginPinch",event:F}),d._pinching=1}},handleMove:function(p){var g=this,W=g.gv,s=W.lp(p);W._93O&&W._93O(p,g._data)||(W.moveSelection(s.x-g._lastLogicalPoint.x,s.y-g._lastLogicalPoint.y),g._lastLogicalPoint=s,g.autoScroll(p),g.fi({kind:W._moving?"betweenMove":"beginMove",event:p}),W._moving=1)}});var C=B.ht,bs=C.graph._editor={Math:C.Math,Guide:{}};bs.getStyle=function(J){var v,h=bs.StyleMap;return h&&(v=h[J],v!==V)?v:bs.DefaultStyleMap[J]},bs.setStyle=function(Z,l){var X=bs.StyleMap;X||(X=bs.StyleMap={}),X[Z]=l},bs.inEdit=function(V){return V._inXEdit===!0},bs.startEdit=function(M){M._inXEdit=!0,bs.Inject.doInject(M)},bs._46O=function(x){x._inXEdit=!1,bs.Inject.undoInject(x)},bs.toScreenPosition=function(z,f){var w=z.tx(),a=z.ty(),i=z._zoom;return new bs.Math.Vector2(f.x*i+w,f.y*i+a)},bs.checkHit=function(H,x,R){return H.distanceTo(x)<R?!0:!1},bs.toWorldPosition=function(E,G){var F=E.tx(),i=E.ty(),f=E._zoom;return{x:(G.x-F)/f,y:(G.y-i)/f}},bs.setAntialias=function(e,A){for(var G,C=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],$=0,T=C.length;T>$&&(G=C[$],!(G in e));$++);e[G],e[G]=A},bs.getTargetCornersOnScreen=function(Y,g){if(!g)return null;var O,c=[];if(Kl(g,Y)){var o=Fn(Y,g);O=[{x:o.x,y:o.y},{x:o.x+o.width,y:o.y},{x:o.x+o.width,y:o.y+o.height},{x:o.x,y:o.y+o.height}]}else{if(!g.getCorners)return null;O=g.getCorners()}return O.forEach(function(i){var z=bs.toScreenPosition(Y,i);c.push(z.x,z.y)}),c},bs.log=function(){};var ai=bs.Inject={_modules:[]};ai.registAsModule=function(J,n){var Z={},K={};for(var H in J){var r=n.prototype[H];Z[H]=r}J.getBackup=function(h){return Z[h]},J.getBackups=function(){return Z},K.doInject=function(){for(var Y in J)"getBackup"!==Y&&(n.prototype[Y]=J[Y])},K.undoInject=function(){for(var x in J)"getBackup"!==x&&(n.prototype[x]=Z[x])},ai._modules.push(K)},ai.doInject=function(B){for(var q,x=ai._modules,R=0,U=x.length;U>R;R++)q=x[R],q.doInject(B)},ai.undoInject=function(H){for(var A,k=ai._modules,x=0,p=k.length;p>x;x++)A=k[x],A.undoInject(H)};var io=C.graph.EditInteractor=function(A){var _=this,i=b.createElement("canvas");i.className="editCanvas",i.style.position="absolute",_._styleMap={},_._canvas=i,_._context=i.getContext("2d"),io.superClass.constructor.call(_,A),bs.setAntialias(_._context,!1),_._subModules=[new bs.Anchor(_),new bs.RotateX(_),new bs.Rect(_),new bs.Curve(_),new bs.MoveHelper(_)],_._gridGuide=new bs.Guide.Grid(_),_._rectGuide=new bs.Guide.Rect(_)},bl=io;C.Default.def(io,C.graph.Interactor,{ms_edit:1,ms_fire:1}),c.defineProperties(io.prototype,{editDetail:{get:function(){var B=!!this._editDetail;return B},set:function(J){var o=this,r=o._editDetail;r!==J&&(o._editDetail=J,o.gv._editing=J,o.fp("editDetail",r,J),o.fp("pointsEditingMode",r,J),o.fi({kind:J?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function($){(!this._editDetail||$)&&(this.gv._editing=$,$||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(S){this._editing=S,this.gvEditing=S}},pointsEditingMode:{get:function(){return this.editDetail},set:function(Q){var O=this;O.editDetail!==Q&&(Q?O._tryEnterEditDetailMode():O._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var Q=this._gridEnabled;if(!Q)return!1;var D=this.gv;return D?!0:!0},set:function(C){C!==this._gridEnabled&&(this._gridEnabled=C,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(q){q!==this._agEnabled&&(this._agEnabled=q,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),io.prototype.getSubModule=function(N){var x,p,j,g=this._subModules;for(p=0,j=g.length;j>p;p++)if(x=g[p],x.catalog===N)return x},io.prototype.invokeSubModule=function(t,E){var D=this,G=D._subModules;if(G)for(var L,y,x,r=Array.prototype.slice.call(arguments,2),X=0,j=G.length;j>X;X++)if(L=G[X],y=L[t],y&&(x=y.apply(L,r),x!=V&&E))return L},io.prototype.invokeSubModuleInverse=function(q,E){var A=this,u=A._subModules;if(u)for(var n,r,y,x=Array.prototype.slice.call(arguments,2),m=u.length-1;m>=0;m--)if(n=u[m],r=n[q],r&&(y=r.apply(n,x),y!=V&&E))return n},io.prototype.setUp=function(){bs.log("setUp");var G=this,S=G.gv,V=S.getView(),e=G._canvas;io.superClass.setUp.call(G),S.setEditInteractor(G),S._79O?V.insertBefore(e,S._79O):V.appendChild(e),bs.startEdit(S),G.invokeSubModule("setUp"),S.dm().mm(G._onDataModelChanged,G),S.dm().md(G._onDataPropertyChanged,G)},io.prototype.tearDown=function(){bs.log("tearDown");var s=this,m=s.gv,z=m.getView();s._resetCustomCursorStyle(),io.superClass.tearDown.call(s),m.dm().umm(s._onDataModelChanged,s),m.dm().umd(s._onDataPropertyChanged,s),m.setEditInteractor(null),z.removeChild(s._canvas),s._drawTimer&&(T(s._drawTimer),s._drawTimer=null),bs._46O(m),s.invokeSubModule("tearDown")},io.prototype._onDataModelChanged=function(h){var f=this;("clear"===h.kind||"remove"===h.kind&&f.editDetail&&h.data===f.getSubModule("Curve").target)&&(f.editDetail=!1,f._42())},io.prototype._onDataPropertyChanged=function(V){var f=this;if(f.editDetail){var o=f.getSubModule("Curve"),y=V.data;y===o.target&&(y._writing||o._handleDataChanged())}},io.prototype.clear=function(){bs.log("clear")},io.prototype.redraw=function(){this._42()},io.prototype._42=function(){var w=this;w._drawTimer||(w._drawTimer=N(function(){w._drawTimer=null,w.drawImpl()},0))},io.prototype.drawImpl=function(){var q;for(q in{_42:!0})break;return function(){var K=this,d=K._canvas,s=K.gv,l=s.getWidth(),L=s.getHeight(),o=K._context,r=C.Default.getInternal();(d.width!==l||d.height!==L)&&r.setCanvas(d,l,L),o.clearRect(0,0,d.width,d.height);var Y=K._getValidSelection();o.save();var I=C.Default.devicePixelRatio;o.scale(I,I),K._gridGuide._42(),K.invokeSubModuleInverse(q,!1,o,s,Y),K._rectGuide._42(),o.restore()}}(),io.prototype._getValidSelection=function(){var R=this,p=R.gv,i=p.sm().getSelection(),l=[];return i.each(function(e){p.isVisible(e)&&p.isEditable(e)&&l.push(e)}),l},io.prototype.handle_touchmove=function(K){return this.handle_mousemove(K)},io.prototype.handle_mousemove=function(c){if(!C.Default.isDragging()){var Z=this;(Z.editDetail||!Eg())&&(Z.gvEditing=!1,Z._checkEdit(c)&&(Z.gvEditing=!0))}},io.prototype.handle_touchstart=function(f){return this.handle_mousedown(f)},io.prototype.handle_mousedown=function(o){_d(o);var x=this;if(x.editDetail||!Eg()){if(sj(o)&&!o.clickThrough){if(x.editDetail){if(x._tryQuitEditDetailMode(o))return}else if(x._tryEnterEditDetailMode())return;x.gv.dm().beginTransaction();var T=x.invokeSubModule("handleDoubleClick",!0,o);if(x.gv.dm().endTransaction(),T)return}var j=x._checkEdit(o);j&&(x._downPosition=x._getLogicalPoint(o),x.gv.dm().beginTransaction(),j.startEdit(x,o),x.editing=!0)}},io.prototype._checkEdit=function(O){var m=this,y=m.gv,W=m._getLogicalPoint(O),F=m.invokeSubModule("check",!0,y,O,W)||null;return m._editMod=F,F},io.prototype.handleWindowTouchMove=function(s){return this.handleWindowMouseMove(s)},io.prototype.handleWindowMouseMove=function(O){var A=this,s=A._downPosition;if(s){var B=A._getLogicalPoint(O);if(B.distanceTo(s)<A.getStyle("moveSensitivity"))return;delete A._downPosition}var C=A._editMod;C&&C.handleEdit(A.gv,O)},io.prototype._getLogicalPoint=function(T){var N=this,l=C.Default.getLogicalPoint(T,N._canvas);return new bs.Math.Vector2(l)},io.prototype.handleWindowTouchEnd=function(n){return this.handleWindowMouseUp(n)},io.prototype.handleWindowMouseUp=function(){var E;for(E in{_46O:!0})break;return function(a){var b=this;b.editing=!1,b.setCursor("default"),b.invokeSubModule(E,!1,a),b._42(),b.gv.dm().endTransaction()}}(),io.prototype.handle_mousewheel=function(g){var f=this;_d(g),f.invokeSubModule("preHandleScroll",!0)||f.gv.handleScroll(g,g.wheelDelta)},io.prototype.handleDelete=function(){var s=this;if(!s.editDetail){s.gv.dm().beginTransaction();var K=s.invokeSubModule("handleNormalStateDelete",!0);return s.gv.dm().endTransaction(),K||s.gv.removeSelection(),void 0}s.gv.dm().beginTransaction(),s.invokeSubModule("handleDelete",!0),s.gv.dm().endTransaction(),s._42()},io.prototype.handle_keydown=function(w){var u=this;if((w.metaKey||w.ctrlKey)&&u._42(),Eg(w)&&!u.editing)return u.gvEditing=!1,u.setCursor("default"),u._42(),void 0;var D=Wh(w);return u.editDetail?((D||_m(w))&&(u.editDetail=!1,u._42()),u.gv.dm().beginTransaction(),u.invokeSubModule("handle_keydown",!0,w),u.gv.dm().endTransaction(),void 0):(u.gv.dm().beginTransaction(),u.invokeSubModule("handleNormalStateKeyDown",!0,w),u.gv.dm().endTransaction(),D&&u._tryEnterEditDetailMode(),void 0)},io.prototype.handle_keyup=function(x){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,x),this.gv.dm().endTransaction()},io.prototype._tryEnterEditDetailMode=function(){var A=this;return!A.editDetail&&A.invokeSubModule("canEnterEditDetailMode",!0)&&1===A._getValidSelection().length?(A.editDetail=!0,A._42(),!0):void 0},io.prototype._tryQuitEditDetailMode=function(b){var q=this;if(q.editDetail){var z=q.gv,l=q.getSubModule("Curve").target;return b&&z.getDataAt(b)===l?void 0:(q.editDetail=!1,q._42(),!0)}},io.prototype.setStyle=function(k,s,p){var w=this;p?bs.setStyle(k,s):w._styleMap[k]=s,w.fp("styleChanged",null,{key:k,value:s,base:p}),w._42()},io.prototype.getStyle=function(C){var K=this,h=K._styleMap[C];return h!==V?h:bs.getStyle(C)},io.prototype.setCursor=function(L){this._resetCustomCursorStyle(),C.graph.EditInteractor.superClass.setCursor.call(this,L)},io.prototype._resetCustomCursorStyle=function(){var z=this;if(z._customStyle){var H=this.gv.getView();H.classList&&H.classList.remove&&H.classList.remove(z._customStyle),z._customStyle=null}},io.prototype._setRotateCursor=function(Y){var v=this,E=v._cursorFactory;E||(E=v._cursorFactory=new bs.CursorFactory(v));var L=E.getRotateCursor(Y),P=v.gv.getView();v._resetCustomCursorStyle(),v._customStyle=L,P.classList&&P.classList.add&&P.classList.add(L)};var lj=bs.Group=function(l){var w=this;w._entities=l,w._64O=0,w._position={x:0,y:0},w._scale={x:1,y:1},w._anchor={x:.5,y:.5},w._anchor2={x:.5,y:.5}};lj.prototype={},lj.prototype.constructor=lj;var Rd=null;lj.findOrCreateGroup=function(u){if(Rd&&Rd.checkIsMe(u))return Rd;var p=new bs.Group(u);return p.getKeyOb()?(Rd=p,p):void 0},lj.prototype.checkIsMe=function(L){var m=this._entities;if(m.length!==L.length)return!1;var f,U={},k=L.length;for(f=0;k>f;f++)U[L[f]._id]=!0;for(f=0;k>f;f++)if(!U[m[f]._id])return!1;return!0},lj.prototype.getRotation=function(){return this._64O},lj.prototype.getPosition=function(){return this._position},lj.prototype.getAnchor=function(){return this._anchor},lj.prototype.getWidth=function(){return this._width},lj.prototype.getScale=function(){return this._scale},lj.prototype.getSize=function(){return{width:this._width,height:this._height}},lj.prototype.getHeight=function(){return this._height},lj.prototype.getKeyOb=function(){for(var m=this._entities,W=m.length-1;W>=0;W--){var j=m[W];if(this.isNode(j))return j}},lj.prototype.getAnchor2=function(){var v=this,G=v.rotateCenter;if(G)return G;var p=v.getKeyOb();if(!p)return v._anchor;var C=v._anchor2,I=p.getMatrix();return I.tf({x:p.getWidth()*(C.x-p.getAnchor().x),y:p.getHeight()*(C.y-p.getAnchor().y)})},lj.prototype.setAnchor2=function(G,f){var z=this,Q=z.getKeyOb();if(Q){var e,F=Q.getMatrix();e="number"==typeof G?{x:G,y:f}:G;var r=F.tfi(e);z._anchor2={x:Q.getAnchor().x+r.x/Q.getWidth(),y:Q.getAnchor().y+r.y/Q.getHeight()}}},lj.prototype.setRotation=function(){},lj.prototype.beginRotate=function(C){this.rotateCenter=C.pos,this.rotateMode=C.groupRotateMode},lj.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},lj.prototype.addRotation=function(i,U){return"batch"===U?this._addRotationInBatchMode(i):"block"===U?this._addRotationInBlockMode(i):void 0},lj.prototype._addRotationInBlockMode=function(B){var i=this,r=i.rotateCenter||i.getPosition();i._entities.forEach(function(K){if(i.isNode(K)){var n=K.getMatrix();n.translate(-r.x,-r.y),n.rotate(B),n.translate(r.x,r.y);var j=Math.sign(K.getScale().x);K.setRotation(q(n.b*j,n.a*j)),K.setPosition(n.tx,n.ty)}})},lj.prototype._addRotationInBatchMode=function(p){var g=this,w=g._anchor2;g._entities.forEach(function(F){if(g.isNode(F)){var v=F.getAnchor(),m=F.getMatrix(),O=m.tf({x:F.getWidth()*(w.x-v.x),y:F.getHeight()*(w.y-v.y)}),c=new bs.Math.Matrix2d;c.set(m.a,m.b,m.c,m.d,m.tx,m.ty),c.translate(-O.x,-O.y),c.rotate(p),c.translate(O.x,O.y);var r=Math.sign(F.getScale().x);F.setRotation(q(c.b*r,c.a*r)),F.setPosition(c.tx,c.ty)}})},lj.prototype.setPosition=function(Q){var K,V,h,t,S=this,e=S._position,s=Q.x-e.x,p=Q.y-e.y,O=S._entities;for(V=0,h=O.length;h>V;V++)K=O[V],tn(K)&&(t=K.getPosition(),K.setPosition(t.x+s,t.y+p));S._position=Q},lj.prototype.setScale=function(M,Y){var F=this,b=M/F._scale.x,A=Y/F._scale.y;F._adjustChildScaleOrSize(b,A,"size"),F._scale={x:M,y:Y}},lj.prototype.getRect=function(){var O=this,J=O._position,S=O._width,s=O._height;return{x:J.x-S/2,y:J.y-s/2,width:S,height:s}},lj.prototype.setSize=function(q,w){var r=this,q=Math.max(1,q),w=Math.max(1,w),h=q/r._width,$=w/r._height;r._adjustChildScaleOrSize(h,$,"size"),r._width=q,r._height=w},lj.prototype._adjustChildScaleOrSize=function(P,X,x){var V,I,E,k,Z,w,C,F,L,v,t,n,W,h,y=this,l=y._position,K=y._entities,d=new bs.Math.Matrix2d;for(I=0,E=K.length;E>I;I++)if(V=K[I],y.isNode(V)){if(k=V.getPosition(),Z=V.getRotation(),w=V.getWidth(),C=V.getHeight(),F=V.getScale(),t=F.x*w,n=F.y*C,d.identity().scale(t,n).rotate(Z).translate(k.x,k.y).translate(-l.x,-l.y).rotate(-y._64O),Z=q(d.b*Math.sign(t),d.a*Math.sign(t)),d.scale(P,X),L=Math.cos(Z),v=Math.sin(Z),Math.abs(L)<.001?(W=d.b/v,h=-d.c/v):(W=d.a/L,h=d.d/L),"scale"===x)V.setScale(W/w,h/C);else if("size"===x){var H=W/F.x,$=h/F.y;V.setScale(Pf(W)*Math.abs(F.x),Pf(h)*Math.abs(F.y)),V.setSize(Math.max(.1,Math.abs(H)),Math.max(.1,Math.abs($)))}d.rotate(y._64O).translate(l.x,l.y),V.setPosition(d.tx,d.ty)}},lj.prototype.getMatrix=function(){var g=this,K=g._position,x=C.Default.getInternal(),$=g._scale;return new x.Mat(g._64O,K.x,K.y,$.x,$.y)},lj.prototype.toGlobal=function(q){return this.getMatrix().tf(q)},lj.prototype.getCorners=function(){var C=this,U=C._width,$=C._height,E=C._anchor,B=-U*E.x,W=-$*E.y,Q=C.getMatrix();return[Q.tf(B,W),Q.tf(B,W+$),Q.tf(B+U,W+$),Q.tf(B+U,W)]},lj.prototype.calcInfo=function(){var N,x,M,l,Y,g,V=this,R=[],X=V._entities,J=V._64O;for(l=0,Y=X.length;Y>l;l++)g=X[l],V.isNode(g)&&g.getCorners&&R.push.apply(R,g.getCorners());if(R.length){var f=Math.cos(-J),E=Math.sin(-J),S=1/0,w=-1/0,T=1/0,A=-1/0;for(l=0,Y=R.length;Y>l;l++)M=R[l],N=M.x,x=M.y,M.x=f*N-E*x,M.y=E*N+f*x,S=Math.min(S,M.x),w=Math.max(w,M.x),T=Math.min(T,M.y),A=Math.max(A,M.y);V._width=(w-S)/V._scale.x,V._height=(A-T)/V._scale.y,f=Math.cos(J),E=Math.sin(J);var H=V._anchor;N=S+(w-S)*H.x,x=T+(A-T)*H.y,V._position={x:f*N-E*x,y:E*N+f*x}}},lj.prototype.isNode=function(G){return tn(G)?Kl(G)?!1:!0:!1},lj.prototype._42=function(W,c,q){var T,d,l,e,C,S,L,j,w=this,J=w._entities,E=w.rotateMode;for("batch"===E&&(j=w.getKeyOb()),T=0,d=J.length;d>T;T++)l=J[T],w.isNode(l)&&(S=l.getRect(),e=bs.toScreenPosition(q,{x:S.x,y:S.y}),C=bs.toScreenPosition(q,{x:S.x+S.width,y:S.y+S.height}),L={min:e,max:C},l===j&&(L.isKeyOb=!0),bs.Icons.DrawIcon(W,c,bs.Icons.GroupSubEntityRect,L))};var Sj=bs.CurveActiving=function(i,H){this._curve=i,this._interactor=i._interactor;for(var c in H)this[c]=H[c]};Sj.prototype={},Sj.prototype.constructor=Sj,c.defineProperties(Sj.prototype,{point:{get:function(){return this._point},set:function(N){var s=this;s._point=N,s.editingCtrl||s._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(G){var X=this;X._pairs=G,X.editingCtrl&&X._firePointChange()}}}),Sj.prototype._firePointChange=function(){var Q=this,l=Q.getCurrentEditingPoint();if(!l)return S.fi({kind:"selectPoint"}),void 0;var S=Q._interactor,f=this._curve.target;if(f){var U=bs.getDataMatrix(f).invert(),o=l.e;l=U.apply(bs.toWorldPosition(S.gv,l)),l.e=o;var b=Q._lastFirePoint;b&&Math.abs(l.x-b.x)<1e-5&&Math.abs(l.y-b.y)<1e-5&&(l.e==V&&b.e==V||Math.abs(l.e-b.e)<1e-5)||(Q._lastFirePoint=l,S.fi({kind:"selectPoint",x:l.x,y:l.y,e:l.e}))}},Sj.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Sj.prototype.getCurrentEditingPoint=function(){var U=this,q=U.editingCtrl;if(q){var N=U.pairs;if(N){var C=N[q.pairId],a=C[q.type];if(a)return a}}return U._point};var mr=bs.CursorFactory=function(M){var a=this;a._interactor=M,a._rotateCursorStyles={}};mr.prototype={},mr.prototype.constructor=mr,mr.prototype.getRotateCursor=function(p){var E=this;0>p&&(p+=2*Math.PI);var f=E._interactor,A=f.getStyle("rotateCursorSize"),T=f.getStyle("rotateCursorRound"),a=Math.round(180*(p/Math.PI)/T);a*T>=360&&(a=0);var Z=E._rotateCursorStyles,g="htCustomRotateStyle_"+A+"_"+T+"_"+a;return Z[g]||(E._produceRotateCursor(g,A,T,a),Z[g]=!0),g},mr.prototype._produceRotateCursor=function(X,p,F,E){var I=this;I._interactor;var w=I._canvas;w||(w=I._canvas=b.createElement("canvas")),w.width=w.height=p*devicePixelRatio,w.style.width=w.style.height=p+" px";var k=w.getContext("2d");bs.setAntialias(k,!1),k.scale(devicePixelRatio,devicePixelRatio);var o,y,R,v,M,O=Math.round(p/2),H=""+O+" "+O+",auto !important;";o=Math.PI/180*E*F,k.clearRect(0,0,p,p),k.save(),k.scale(p/32,p/32),k.translate(16,16),k.rotate(o+Math.PI/2),k.beginPath(),k.moveTo(-8,0),k.lineTo(-8,3),k.lineTo(-5,3),k.moveTo(8,0),k.lineTo(8,3),k.lineTo(5,3),k.moveTo(-8,3),k.quadraticCurveTo(0,-6,8,3),k.restore(),k.strokeStyle="white",k.lineWidth=4,k.stroke(),k.strokeStyle="black",k.lineWidth=2,k.stroke(),y=JSON.stringify(w.toDataURL()),v="cursor:url("+y+")"+H,1!==devicePixelRatio&&(R='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+p+'px" height="'+p+'px"><image xlink:href='+y+' width="'+p+'" height="'+p+'"/></svg>',v+="cursor:url(data:image/svg+xml;base64,"+btoa(R)+")"+H,v+="cursor:-webkit-image-set(url("+y+")"+devicePixelRatio+"x,url("+y+")1x)"+H),M=b.createElement("style"),M.textContent="body."+X+" *, ."+X+"{"+v+"}",b.head.appendChild(M)};var dh=bs.Guide.Grid=function(Y){var P=this;P._interactor=Y,P._alignmentGuideId=0,P._xAlignmentGuide=[],P._yAlignmentGuide=[]};dh.prototype={},dh.prototype.constructor=dh,c.defineProperties(dh.prototype,{gridBlockSize:{get:function(){var N=this;return N._gridBlockSize||N._interactor.getStyle("gridBlockSize")},set:function(Y){this._gridBlockSize=Y,this._interactor._42()}},gridThickLinesEvery:{get:function(){var D=this;return D._gridThickLinesEvery||D._interactor.getStyle("gridThickLinesEvery")},set:function(F){this._gridThickLinesEvery=F,this._interactor._42()}},gridEnabled:{get:function(){var l=this,x=l._interactor;return x.gridEnabled&&l.isValidGrid()}}}),dh.prototype._42=function(){var G=this,F=G._interactor;G.gridEnabled&&G.drawGrid(),F.alignmentGuideEnabled&&G.drawAlignmentGuide()},dh.prototype.makeMatrix=function(){var D=this,b=D._interactor.getStyle("gridAngle"),c=D._interactor.getStyle("gridRotation"),B=new bs.Math.Matrix2d,s=Math.sin(b),K=Math.cos(b);return B.set(1,0,K,s,0,0),B.rotate(c),B},dh.prototype.isValidGrid=function(){var V=this,i=Math.PI,o=V._interactor,K=o.gv;if(K._zoom<o.getStyle("gridZoomThreshold"))return!1;var B=o.getStyle("gridAngle"),P=Math.abs(180*(B%i/i)),n=1-1e-8;return n>P||P>180-n?!1:!0},dh.prototype.drawAlignmentGuide=function(){var y=this,v=y._interactor,Y=v.gv,c=v._canvas,C=v._context,z=c.width,T=c.height,k=Y.tx(),F=Y.ty(),d=Y._zoom;C.beginPath(),C.strokeStyle=v.getStyle("gridAlignmentGuideColor"),C.lineWidth=1,y._xAlignmentGuide.forEach(function($){var y=$.p*d+k;C.moveTo(y,0),C.lineTo(y,T)}),y._yAlignmentGuide.forEach(function(m){var f=m.p*d+F;C.moveTo(0,f),C.lineTo(z,f)}),C.stroke()},dh.prototype.drawGrid=function(){function V(U,Q,G,V){var y=bs.toScreenPosition(O,A.apply({x:U,y:Q})),I=bs.toScreenPosition(O,A.apply({x:G,y:V}));K.moveTo(y.x,y.y),K.lineTo(I.x,I.y)}var Z=this,s=Z._interactor,w=Z.gridBlockSize,j=Z.gridThickLinesEvery,c=s.getStyle("gridThickColor"),f=s.getStyle("gridLightColor"),O=s.gv,X=s._canvas,K=s._context,k=X.width,H=X.height,A=Z.makeMatrix(),o=A.applyInverse(bs.toWorldPosition(O,{x:0,y:0})),e=A.applyInverse(bs.toWorldPosition(O,{x:k,y:0})),v=A.applyInverse(bs.toWorldPosition(O,{x:0,y:H})),t=A.applyInverse(bs.toWorldPosition(O,{x:k,y:H})),J=Math.min(o.x,e.x,v.x,t.x),W=Math.max(o.x,e.x,v.x,t.x),M=Math.min(o.y,e.y,v.y,t.y),y=Math.max(o.y,e.y,v.y,t.y);k=W-J,H=y-M;var r=Math.ceil(J/w),z=Math.floor(W/w),I=Math.ceil(M/w),T=Math.floor(y/w);O.tx(),O.ty(),O._zoom;var U,$,P;for(K.save(),K.lineWidth=1,K.beginPath(),K.strokeStyle=c,P=Math.ceil(r/j)*j;z>=P;P+=j)U=P*w,V(U,M,U,y);for(P=Math.ceil(I/j)*j;T>=P;P+=j)$=P*w,V(J,$,W,$);for(K.stroke(),K.beginPath(),K.strokeStyle=f,P=r;z>=P;P++)0!==P%j&&(U=P*w,V(U,M,U,y));for(P=I;T>=P;P++)0!==P%j&&($=P*w,V(J,$,W,$));K.stroke(),K.restore()},dh.prototype.getAlignmentGuides=function(){var D=this;return{x:D._xAlignmentGuide,y:D._yAlignmentGuide}},dh.prototype.addAlignmentGuide=function(A,x,r){var D=this,Z="x"===A?D._xAlignmentGuide:D._yAlignmentGuide,r=r?r:++D._alignmentGuideId,Y={p:x,id:r};if(Z.length){var k=D._findClosestAlignmentGuide(Y.p,Z);k.dis<0?Z.splice(k.index+1,0,Y):Z.splice(k.index,0,Y)}else Z.push(Y);return D._interactor._42(),r},dh.prototype.findClosest=function($,Z,s){var d=this,R=d._interactor,b=R.gv;s&&($=bs.toWorldPosition(b,$));var f,z,W,l=1/0,S=1/0,n=$.x,J=$.y;if(d.gridEnabled){var N=d.gridBlockSize,M=d.makeMatrix(),o=M.applyInverse($);o=M.apply({x:Math.round(o.x/N)*N,y:Math.round(o.y/N)*N}),l=o.x-n,S=o.y-J,W=!0}if(R.alignmentGuideEnabled&&(f=d._findClosestAlignmentGuide(n,d._xAlignmentGuide).dis,z=d._findClosestAlignmentGuide(J,d._yAlignmentGuide).dis,Math.abs(f)<Math.abs(l)&&(l=f,W=!0),Math.abs(z)<Math.abs(S)&&(S=z,W=!0)),W){W=!1;var L=b._zoom,x=R.getStyle("smartGuideSensitivity")/L,k={};if(Math.abs(l)<x&&"y"!==Z&&(k.x=s?l*L:l,W=!0),Math.abs(S)<x&&"x"!==Z&&(k.y=s?S*L:S,W=!0),W)return k}},dh.prototype._findClosestAlignmentGuide=function(H,O){if(!O.length)return{dis:1/0};for(var A,R=0,u=O.length-1;u-R>1;)A=Math.floor((R+u)/2),O[A].p<H?R=A:u=A;var d=O[R].p-H,X=O[u].p-H;return Math.abs(d)<=Math.abs(X)?{line:O[R],dis:d,index:R}:{line:O[u],dis:X,index:u}},dh.prototype.removeAllAlignmentGuide=function(s){var l=this;"y"!==s&&(l._xAlignmentGuide=[]),"x"!==s&&(l._yAlignmentGuide=[]),l._interactor._42()},dh.prototype.removeAlignmentGuide=function(U){for(var L,B,l,x=this,Y=x._xAlignmentGuide,O=0;2>O;O++)for(Y=0===O?x._xAlignmentGuide:x._yAlignmentGuide,L=0,B=Y.length;B>L;L++)if(l=Y[L],l.id===U)return Y.splice(L,1),x._interactor._42(),{axis:0===O?"x":"y",position:l.p};return!1},dh.prototype.adjustAlignmentGuide=function(R,x){var e=this,o=e.removeAlignmentGuide(R);return o?(e.addAlignmentGuide(o.axis,x,R),!0):!1};var Hd=bs.Guide.Rect=function(o){var x=this;x._interactor=o};Hd.prototype={},Hd.prototype.constructor=Hd,Hd.prototype.gatherRects=function(){var C,x,w,l,o=this,q=o._interactor.gv,Q=[],h=[],y={x:Q,y:h},n={},r=q.getDataModel(),u=r.a("width"),_=r.a("height");u&&_&&(C=0,x=0,w=u,l=_,Q.push({node:r,type:0,p:C},{node:r,type:1,p:C+w/2},{node:r,type:2,p:C+w}),h.push({node:r,type:0,p:x},{node:r,type:1,p:x+l/2},{node:r,type:2,p:x+l}),n[r._id||0]={x:C,y:x,width:w,height:l}),r.each(function(e){if(tn(e)&&!q.isSelected(e)&&q.isVisible(e)){var d=!1;
if(q.sm().getSelection().each(function(g){d||(e.isHostOn(g)?d=!0:e.isDescendantOf(g)&&(d=!0))}),!d){var R=e.getRect();C=R.x,x=R.y,w=R.width,l=R.height,Q.push({node:e,type:0,p:C},{node:e,type:1,p:C+w/2},{node:e,type:2,p:C+w}),h.push({node:e,type:0,p:x},{node:e,type:1,p:x+l/2},{node:e,type:2,p:x+l}),n[e._id]=R}}}),Q.sort(function(w,Y){return w.p-Y.p}),h.sort(function(w,Y){return w.p-Y.p}),o._grid=y,o._87I=n},Hd.prototype.gatherLines=function(C,O,K){var t,z,D,W,A,Y,Q,s,b,l,w,P,e=this,N=[e.findClosest({x:C.x,y:C.y},O),e.findClosest({x:C.x+C.w/2,y:C.y+C.h/2},O),e.findClosest({x:C.x+C.w,y:C.y+C.h},O)],M={},S=e._87I;K=K||255;var J,r;for(e._guideLine=[],t=0;2>t;t++)for(M={},0===t?(W="y",s=C.x,b=s+C.w):(W="x",s=C.y,b=s+C.h),z=0;3>z;z++)A=N[z],A&&isFinite(A[W])&&(J=1<<3*t+z,K&J&&(Y=A[W+"Line"],Q=Y.node,r=Q._id||0,M[r]||(M[r]=!0,P=S[r],"y"===W?(l=P.x,w=P.x+P.width):(l=P.y,w=P.y+P.height),D=Y.p,e._guideLine.push({type:W,a:s,b:b,c:l,d:w,p:D,center:1===Y.type}))))},Hd.prototype._binarySearchClosest=function(z,F){if(!F.length)return{dis:1/0};for(var H,h=0,b=F.length-1;b-h>1;)H=Math.floor((h+b)/2),F[H].p<z?h=H:b=H;var q=F[h].p-z,O=F[b].p-z;return Math.abs(q)<=Math.abs(O)?{line:F[h],dis:q}:{line:F[b],dis:O}},Hd.prototype.findClosest=function(d,C,S){var h=this,g=h._interactor,x=g.gv,o=h._grid;S&&(d=bs.toWorldPosition(x,d));var f,X=h._binarySearchClosest(d.x,o.x),J=h._binarySearchClosest(d.y,o.y),U=X.dis,w=J.dis,L=x._zoom,z=g.getStyle("smartGuideSensitivity")/L,Z={};return Math.abs(U)<z&&"y"!==C&&(Z.x=S?U*L:U,Z.xLine=X.line,f=!0),Math.abs(w)<z&&"x"!==C&&(Z.y=S?w*L:w,Z.yLine=J.line,f=!0),f?Z:void 0},Hd.prototype._42=function(){var d=this,U=d._guideLine;if(U&&!C.Default.isCtrlDown()){var M,z,m,B,W,h,i,A,y,c,P,r,q,u,K,D,E,x=d._interactor,f=x.gv,g=x._context,n=f.tx(),J=f.ty(),O=f._zoom,R=x.getStyle("guideLineTextSpacing");for(M=0,z=U.length;z>M;M++)m=U[M],A=m.type,y=m.p,c=m.a,P=m.b,r=m.c,q=m.d,u=Math.min(c,r),K=Math.max(P,q),"x"===A?(B=y*O+n,W=u*O+J,h=B,i=K*O+J):(B=u*O+n,W=y*O+J,h=K*O+n,i=W),bs.Icons.DrawIcon(x,g,bs.Icons.MoveLineGuide,{rect:[B,W,h,i],center:m.center}),q>=c&&P>=r||(u=c>q?q:P,K=c>q?c:r,E=K-u,"x"===A?(m.center2center||(B-=R,h=B),W=u*O+J,i=K*O+J,D=bs.Icons.MoveLineGuideDistanceV):"y"===A&&(m.center2center||(W-=R,i=W),B=u*O+n,h=K*O+n,D=bs.Icons.MoveLineGuideDistanceH),bs.Icons.DrawIcon(x,g,D,{x0:B,y0:W,x1:h,y1:i,dis:E}))}},Hd.prototype.clear=function(){this._guideLine=null},bs.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var rh=bs.Icons={},Pl=1e4,Yf=null,Xr="rgb(51,153,255)",zd="rgb(183,232,135)",lq="rgb(255,204,153)",rq=6;C.Default.setImage("Icons.RectPoint",{width:rq,height:rq,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:Xr,rect:[0,0,rq,rq]}]});var cg="#e000e0";rh.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var z=rh.GroupSubEntityRect.data;if(!z)return[];var M=z.min,f=z.max;return[M.x,M.y,M.x,f.y,f.x,f.y,f.x,M.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return rh.GroupSubEntityRect.data.isKeyOb?cg:"#666666"}}}]},rh.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[rh.Line.data.P1.x,rh.Line.data.P1.y],rq,rq]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[rh.Line.data.P2.x,rh.Line.data.P2.y],rq,rq]}}}]},rh.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return rh.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},rh.Rect={comps:[{type:"shape",points:{func:function(){var N=rh.Rect.data;if(!N)return[];var D=N.LT,E=N.LB,K=N.RB,W=N.RT;return[D.x,D.y,E.x,E.y,K.x,K.y,W.x,W.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:Xr},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rh.Rect.data.rotation}},rect:{func:function(){return[[rh.Rect.data.LT.x,rh.Rect.data.LT.y],rq,rq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rh.Rect.data.rotation}},rect:{func:function(){return[[rh.Rect.data.LB.x,rh.Rect.data.LB.y],rq,rq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rh.Rect.data.rotation}},rect:{func:function(){return[[rh.Rect.data.RB.x,rh.Rect.data.RB.y],rq,rq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rh.Rect.data.rotation}},rect:{func:function(){return[[rh.Rect.data.RT.x,rh.Rect.data.RT.y],rq,rq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rh.Rect.data.rotation}},visible:{func:function(){return rh.Rect.data.L?!0:!1}},rect:{func:function(){return[[rh.Rect.data.L.x,rh.Rect.data.L.y],rq,rq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rh.Rect.data.rotation}},visible:{func:function(){return rh.Rect.data.R?!0:!1}},rect:{func:function(){return[[rh.Rect.data.R.x,rh.Rect.data.R.y],rq,rq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rh.Rect.data.rotation}},visible:{func:function(){return rh.Rect.data.T?!0:!1}},rect:{func:function(){return[[rh.Rect.data.T.x,rh.Rect.data.T.y],rq,rq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rh.Rect.data.rotation}},visible:{func:function(){return rh.Rect.data.B?!0:!1}},rect:{func:function(){return[[rh.Rect.data.B.x,rh.Rect.data.B.y],rq,rq]}}}]};var Ip=16;C.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:Xr,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:Xr,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),rh.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[rh.Anchor.data.POS.x,rh.Anchor.data.POS.y],Ip,Ip]}}}]},rh.TipShiftX=12,rh.TipShiftY=12;var Lr=[8,28];rh.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[rh.TipHelper.data.helperPos.x,rh.TipHelper.data.helperPos.y,Lr[0]*rh.TipHelper.data.size,Lr[1]]}},background:{func:function(){return Yf.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return rh.TipHelper.data.text}},rect:{func:function(){return[rh.TipHelper.data.helperPos.x,rh.TipHelper.data.helperPos.y,Lr[0]*rh.TipHelper.data.size,Lr[1]]}},color:{func:function(){return Yf.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var ts=7;rh.ShapePoint={comps:[{type:"circle",rect:{func:function(){var k=rh.ShapePoint.data.point;return[k,ts,ts]}},background:{func:function(){var j=rh.ShapePoint.data.isEnd;return j?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:Xr}]},rh.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return rh.ShapeBgCurve.data.P}},segments:{func:function(){return rh.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:Xr}]};var sh=8;rh.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var x=rh.ShapeHighlighPoint.data;return[[x.x,x.y],sh,sh]}},background:{func:function(){return Yf.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Yj=10;rh.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var y=rh.ShapeHighlighRealPoint.data;return[[y.x,y.y],Yj,Yj]}},background:"#ffffff",borderWidth:2,borderColor:Xr}]};var qm=8;rh.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var n=rh.ShapeHighlighCtrlPoint.data,T=n.x,G=n.y,E=qm/2;return[T-E,G-E,T-E,G+E,T+E,G+E,T+E,G-E]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Yf.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Yf.getStyle("shapeCtrlPointBorderColor")||Xr}}}]};var Ej=3;rh.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return rh.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Ej,borderColor:{func:function(){return Yf.getStyle("curveHighlightColor")}}}]},rh.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return rh.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},rh.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return rh.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return rh.MoveLineGuide.data.center?zd:lq}}}]};var jr=5;rh.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var y=rh.MoveLineGuideDistanceH.data,m=y.x0,p=y.y0;return[m,p-jr,m,p+jr]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lq},{type:"shape",points:{func:function(){var g=rh.MoveLineGuideDistanceH.data,t=g.x1,T=g.y1;return[t,T-jr,t,T+jr]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lq},{type:"text",text:{func:function(){return Math.round(rh.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var S=rh.MoveLineGuideDistanceH.data;return[[(S.x0+S.x1)/2,S.y0-10],20,20]}},color:lq,font:"12px Arial",align:"center"}]},rh.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var D=rh.MoveLineGuideDistanceV.data,M=D.x0,d=D.y0;return[M-jr,d,M+jr,d]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lq},{type:"shape",points:{func:function(){var X=rh.MoveLineGuideDistanceV.data,j=X.x1,L=X.y1;return[j-jr,L,j+jr,L]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lq},{type:"text",text:{func:function(){return Math.round(rh.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var t=rh.MoveLineGuideDistanceV.data;return[[t.x0-10,(t.y0+t.y1)/2],20,20]}},color:lq,font:"12px Arial",align:"center"}]},C.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),rh.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var a=rh.EdgeElevationGuide.data,K=a.x,n=a.y,F=Yf.getStyle("curveElevationIntersectSize"),z=Yf.getStyle("curveElevationGuideShift");return K+=z[0],n+=z[1],[K-F,n-F,2*F,2*F]}}}]},C.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),C.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),rh.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return rh.ConnectGuide.data.rotation}},rect:{func:function(){var g=rh.ConnectGuide.data.connect;g.x,g.y;var G=Yf.getStyle("connectGuideIntersectSize");return[[g.x,g.y],2*G,2*G]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var N=rh.ConnectGuide.data.cursorPos||rh.ConnectGuide.data.connect,O=Yf.getStyle("connectGuideIntersectSize");return[[N.x,N.y],2*O-2,2*O-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var J=rh.ConnectGuide.data.connect,d=rh.ConnectGuide.data.cursorPos||J;return[J.x,J.y,J.x+.5*(d.x-J.x),J.y,d.x+.5*(J.x-d.x),d.y,d.x,d.y]}}}]},C.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),C.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),rh.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var I=rh.ConnectGuideGarbage.data.hover;return I?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var K=rh.ConnectGuideGarbage.data,r=Yf.getStyle("connectGuideGarbageIntersectsize");return K.hover&&(r+=5),[[K.x,K.y],2*r,2*r]}}}]};var ob=6;rh.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return rh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var B=rh.ShapeActivingCtrl.data;return[B.point.x,B.point.y,B.c1.x,B.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Xr},{type:"shape",visible:{func:function(){return rh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var x=rh.ShapeActivingCtrl.data;return[x.point.x,x.point.y,x.c2.x,x.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Xr},{type:"shape",visible:{func:function(){return rh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var Y=rh.ShapeActivingCtrl.data.c1,t=Y.x,p=Y.y,$=ob/2;return"c1"===rh.ShapeActivingCtrl.data.hl&&($+=.5),[t-$,p-$,t-$,p+$,t+$,p+$,t+$,p-$]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Yf.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===rh.ShapeActivingCtrl.data.hl?Yf.getStyle("shapeCtrlPointHighlightBorder")||Xr:Yf.getStyle("shapeCtrlPointBorderColor")||Xr}}},{type:"shape",visible:{func:function(){return rh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var c=rh.ShapeActivingCtrl.data.c2,_=c.x,j=c.y,p=ob/2;return"c2"===rh.ShapeActivingCtrl.data.hl&&(p+=.5),[_-p,j-p,_-p,j+p,_+p,j+p,_+p,j-p]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Yf.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===rh.ShapeActivingCtrl.data.hl?Yf.getStyle("shapeCtrlPointHighlightBorder")||Xr:Yf.getStyle("shapeCtrlPointBorderColor")||Xr}}}]},rh.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:Xr,rect:{func:function(){return[[rh.RoundPoint.data.x,rh.RoundPoint.data.y],rq,rq]}}}]},rh.AttachPoint={comps:[{type:"rect",background:{func:function(){return rh.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:Xr,rect:{func:function(){var F=rh.AttachPoint.data.isAttach?rq+4:rq;return[[rh.AttachPoint.data.x,rh.AttachPoint.data.y],F,F]}}}]},bs.Icons.DrawIcon=function(x,_,g,n){g.width=g.height=Pl,g.data=n,Yf=x,C.Default.drawImage(_,g,0,0,Pl,Pl)},bs.Icons.MapPoints=function(o,G){for(var z=0,e=o.length;e>z;z++)o[z]/=G},bs.roundTo=function(t,Z,o){var p=Math.abs(t%Z);return o>p||o>Z-p?Z*Math.round(t/Z):t},bs.toFixed=function(l){return Math.round(100*l)/100},bs.getDataMatrix=function(B){if(B instanceof C.Shape){var m=new C.Math.Matrix2d,$=B.getPosition();return m.translate(-$.x,-$.y).scale(B.getScale().x,B.getScale().y).rotate(B.getRotation()).translate($.x,$.y),m}return B.getMatrix?B.getMatrix():new C.Math.Matrix2d};var cd=bs.Math.Curve=function(){this._curves=[]};cd.prototype={},cd.prototype.constructor=cd,cd.prototype.createFromHtShape=function(o,q,s){q instanceof C.List&&(q=q.toArray());var h,t,r,M,u,y,f,w=this,Y=null,L=null,j=0,F=bs.Math.Vector2,_=bs.Math.CubicBezier,k=function(H){return new F(o[H],o[H+1],s?s[H/2]:V)};for(t=0,r=q.length;r>t;t++){switch(M=q[t],u=null,M){case 1:L=k(j),Y=L,j+=2;break;case 2:h=k(j),j+=2,u=new _(L,L.clone(),h.clone(),h),L=h;break;case 3:y=k(j),h=k(j+2),j+=4,u=new _(L,y.clone().sub(L).multiplyScalar(2/3).add(L),y.clone().sub(h).multiplyScalar(2/3).add(h),h),L=h;break;case 4:y=k(j),f=k(j+2),h=k(j+4),j+=6,u=new _(L,y,f,h),L=h;break;case 5:if(!Y)break;u=new _(L,L.clone(),Y.clone(),Y),L=null,Y=null}u&&(u._index=w._curves.length,w._curves.push(u))}},cd.prototype.checkPoint=function(G,F){var I,Q,E,B,M,y=this,f=y._curves;for(I=0,Q=f.length;Q>I;I++)if(B=f[I],M=B.intersectRect(G,F,F),M.length)return E=0,M.forEach(function(C){E+=C.t}),E/=M.length,G=B.getPointAt(E),G.t=E,{bezier:B,intersection:G}},cd.prototype.insertKnot=function(R,y){var b=R.insertKnot(y),Q=this,n=Q._curves;n.splice(R._index,1,b[0],b[1])},cd.prototype._isCloseEnough=function(b,B){return Math.abs(b.x-B.x)<1e-6&&Math.abs(b.y-B.y)<1e-6},cd.prototype._isSamePoint=function(X,f){return X===f},cd.prototype.moveRealPoint=function(n,T){var U=this,i=U._curves,l=T.clone().sub(n);i.forEach(function(N){var G=N._p1;N._p2,N._p3;var E=N._p4;U._isSamePoint(G,n)&&(N._p2.add(l),N._p1=T),U._isSamePoint(E,n)&&(N._p3.add(l),N._p4=T)})},cd.prototype.moveCtrlDueToRealPointMovement=function(s,c){var n=this,r=n._curves,D=function(P){P.add(c),P.e&&c.e&&(P.e+=c.e)};r.forEach(function(I){var V=I._p1;I._p2,I._p3;var f=I._p4;n._isSamePoint(V,s)&&D(I._p2),n._isSamePoint(f,s)&&D(I._p3)})},cd.prototype.moveCtrlPoint=function(Z,e,$){var g=Z[$];if(g){g.e!==V&&(e.e=g.e);var D=this,F=D._curves;e.clone().sub(g),F.forEach(function(x){var N;"c2"===$?N="_p2":"c1"===$&&(N="_p3"),D._isSamePoint(x[N],g)&&(x[N]=e)}),Z[$]=e}},cd.prototype.deleteRealPoint=function(A,e){var E,x,d,R,q,$,u,F=this,t=F._curves,W={},z=[],i=bs.Math.CubicBezier;for(x=0,d=t.length;d>x;x++)E=t[x],R=E._p1,q=E._p2,$=E._p3,u=E._p4,(W[x]||!F._isSamePoint(R,A))&&(F._isSamePoint(u,A)?d>x+1&&F._isSamePoint(t[x+1]._p1,A)&&(e||z.push(new i(R,q,t[x+1]._p3,t[x+1]._p4))):z.push(E));F._curves=z},cd.prototype.findPairs=function(v,f){var s,C,h,J,q,$,b,K,S=this,d=S._curves,t={},F=[];for(C=0,h=d.length;h>C;C++)s=d[C],J=s._p1,q=s._p2,$=s._p3,b=s._p4,!t[C]&&S._isSamePoint(J,v)&&(f?F.push({point:J,r2:b}):F.push({point:J,c2:q})),S._isSamePoint(b,v)&&(K=f?{point:b,r1:J}:{point:b,c1:$},h>C+1&&S._isSamePoint(d[C+1]._p1,v)&&(f?K.r2=d[C+1]._p4:K.c2=d[C+1]._p2,t[C+1]=!0),F.push(K));return F},cd.prototype.toHtShape=function(){var s=this,l=s._curves,q=[],w=[],T={x:1/0,y:1/0};return l.forEach(function(e){var d=e._p1,O=e._p2,b=e._p3,x=e._p4;return s._isCloseEnough(d,T)||(q.push(1),w.push(d.clone())),T=x,s._isCloseEnough(d,O)&&s._isCloseEnough(b,x)?(q.push(2),w.push(x.clone()),void 0):(q.push(4),w.push(O.clone(),b.clone(),x.clone()),void 0)}),{segments:q,points:w}};var Bi=bs.Math.CubicBezier=function(V,J,H,G){var y=this;y._id=bs.Math.CubicBezier._globalId++,y._p1=V,y._p2=J,y._p3=H,y._p4=G};Bi._globalId=1,Bi.prototype={},Bi.prototype.constructor=Bi,Bi.prototype.toString=function(){return this._id},Bi.prototype.intersectRect=function(l,D,S){var f=D/2,J=S/2,P=l.x,Q=l.y,_=bs.Math.Vector2,b=new _(-f+P,-J+Q),G=new _(f+P,J+Q),T=new _(G.x,b.y),R=new _(b.x,G.y),W=this,N=W.intersectLine(b,T),E=W.intersectLine(T,G),Z=W.intersectLine(G,R),A=W.intersectLine(R,b),M=N.concat(E).concat(Z).concat(A);return M},Bi.prototype.intersectLine=function(T,M){var e,P,l,H,c,q,s,R,b,Y,N,d,W,y=this,K=T.clone().min(M),u=T.clone().max(M);H=y._p1,c=y._p2,q=y._p3,s=y._p4,e=H.clone().multiplyScalar(-1),P=c.clone().multiplyScalar(3),l=q.clone().multiplyScalar(-3),N=e.add(P).add(l).add(s),e=H.clone().multiplyScalar(3),P=c.clone().multiplyScalar(-6),l=q.clone().multiplyScalar(3),Y=e.add(P).add(l),e=H.clone().multiplyScalar(-3),P=c.clone().multiplyScalar(3),b=e.add(P),R=H.clone(),W=new bs.Math.Vector2(T.y-M.y,M.x-T.x),d=T.x*M.y-M.x*T.y;for(var m=y.getRoots(W.dot(N),W.dot(Y),W.dot(b),W.dot(R)+d),k=new Array,Z=0,g=m.length;g>Z;Z++){var X=m[Z];if(!(0>X||X>1)){var $=H.clone().lerp(c,X),z=c.clone().lerp(q,X),Q=q.clone().lerp(s,X),A=$.lerp(z,X),V=z.lerp(Q,X),F=A.lerp(V,X);F.t=X,T.x==M.x?K.y<=F.y&&F.y<=u.y&&k.push(F):T.y==M.y?K.x<=F.x&&F.x<=u.x&&k.push(F):F.x>=K.x&&F.y>=K.y&&F.x<=u.x&&F.y<=u.y&&k.push(F)}}return k},Bi.prototype.solveTForPoint=function(g){var r,_,$,Y,b=this;r=b._p1.x-g.x,_=b._p2.x-g.x,$=b._p3.x-g.x,Y=b._p4.x-g.x;for(var f=b.getRoots(Y-3*$+3*_-r,3*$-6*_+3*r,3*_-3*r,r),t=V,o=1/0,U=0,R=f.length;R>U;U++){var H=f[U];if(!(0>H||H>1)){var M=b._p1.clone().lerp(b._p2,H),z=b._p2.clone().lerp(b._p3,H),S=b._p3.clone().lerp(b._p4,H),q=M.lerp(z,H),w=z.lerp(S,H),d=q.lerp(w,H);d.t=H;var P=Math.abs(d.y-g.y);o>P&&(o=P,t=d)}}return t},Bi.prototype.getPointAt=function(D){var U=this,c=U._p1,h=U._p2,p=U._p3,P=U._p4,e=c.clone().lerp(h,D),Q=h.clone().lerp(p,D),Z=p.clone().lerp(P,D),_=e.lerp(Q,D),G=Q.lerp(Z,D);return _.lerp(G,D)},Bi.prototype.getRoots=function(y,T,x,_){var m,E,O,o,F,Q=new Array;if(Math.abs(y)<1e-6){var m=T,E=x/m,O=_/m,o=E*E-4*O;if(o>0){var F=Math.sqrt(o);Q.push(.5*(-E+F)),Q.push(.5*(-E-F))}else 0==o&&Q.push(.5*-E)}T/=y,x/=y,_/=y,m=(3*x-T*T)/3,E=(2*T*T*T-9*x*T+27*_)/27;var M=T/3,t=E*E/4+m*m*m/27,r=E/2;if(Math.abs(t)<=1e-6&&(t=0),t>0){var J,U,F=Math.sqrt(t);J=-r+F,U=J>=0?Math.pow(J,1/3):-Math.pow(-J,1/3),J=-r-F,J>=0?U+=Math.pow(J,1/3):U-=Math.pow(-J,1/3),Q.push(U-M)}else if(0>t){var e=Math.sqrt(-m/3),S=Math.atan2(Math.sqrt(-t),-r)/3,Z=Math.cos(S),L=Math.sin(S),u=Math.sqrt(3);Q.push(2*e*Z-M),Q.push(-e*(Z+u*L)-M),Q.push(-e*(Z-u*L)-M)}else{var J;J=r>=0?-Math.pow(r,1/3):Math.pow(-r,1/3),Q.push(2*J-M),Q.push(-J-M)}return Q},Bi.prototype._70I=function(){var w=this;return w._p1.distanceToSquared(w._p2)<1e-10&&w._p3.distanceToSquared(w._p4)<1e-10},Bi.prototype.insertKnot=function(o){var b=this,X=b._p1,x=b._p2,l=b._p3,H=b._p4,j=X.clone().lerp(x,o),k=x.clone().lerp(l,o),d=l.clone().lerp(H,o),i=j.clone().lerp(k,o),W=k.clone().lerp(d,o),_=i.clone().lerp(W,o);return b._70I()?(X.clone().lerp(H,o),[new bs.Math.CubicBezier(X,X.clone(),_.clone(),_),new bs.Math.CubicBezier(_,_.clone(),H.clone(),H)]):[new bs.Math.CubicBezier(X,j,i,_),new bs.Math.CubicBezier(_,W,d,H)]};var Vq=C.Default.getInternal().ui().EdgeUI,Kn={_47O:function(Q){var w=this,B=Kn.getBackups()._47O;bs.inEdit(w.gv)||B.call(w,Q)}};bs.Inject.registAsModule(Kn,Vq);var On=C.Default.getInternal().ui().NodeUI,eb={_47O:function(X){var H=this,Q=eb.getBackups()._47O;bs.inEdit(H.gv)||Q.call(H,X)},getSelectWidth:function(){var u=this,j=u.gv,E=u._data;if(j.isEditable(E)&&bs.inEdit(j))return 0;var N=eb.getBackup("getSelectWidth");return N.call(u)}};bs.Inject.registAsModule(eb,On);var Xi=C.graph.GraphView,Vn={_editPointSize:function(){var V=C.Default.isTouchable,l=bs.getStyle("pointSize");return l[V?0:1]}(),isPointEditable:function(I){var i=this;if(bs.inEdit(i))return i._pointEditableFunc?i._pointEditableFunc(I):!0;var m=Vn.getBackup("isPointEditable");m.call(i,I)},isEditable:function(c){var s,t=this,F=Vn.getBackup("isEditable");if(s=c instanceof bs.Group?!0:F.call(t,c),!bs.inEdit(t))return s;if(!(c instanceof C.Edge))return s;if(!c.s("2d.editable"))return!1;var T=t.getEditableFunc();return T?T(c):!0},_42:function(U,u){var F=this,G=Vn.getBackups()._42;if(G.call(F,U,u),bs.inEdit(F)){var t=F.getEditInteractor();t.drawImpl()}}};bs.Inject.registAsModule(Vn,Xi);var Ek=C.Default.getInternal().ui().ShapeUI,Li={_47O:function(n){var p=this,D=Li.getBackups()._47O;bs.inEdit(p.gv)||D.call(p,n)}};bs.Inject.registAsModule(Li,Ek);var Ee=C.graph.DefaultInteractor,wg={handle_mousewheel:function(U){var n=this,V=wg.getBackup("handle_mousewheel");bs.inEdit(n.gv)||V.call(n,U)}};bs.Inject.registAsModule(wg,Ee);var Bd=C.graph.MoveInteractor,ye={_calcShift:function(q,J){var A=this,v=ye.getBackup("_calcShift"),R=A.gv;if(!bs.inEdit(R))return v.call(A,q,J);var n=R.getEditInteractor(),T=n.getSubModule("Move").calcShift(q,J,A);return T||v.call(A,q,J)},clear:function(F){var r=this,Y=ye.getBackup("clear");Y.call(r,F);var k=r.gv;if(bs.inEdit(k)){var o=k.getEditInteractor();o.getSubModule("Move").clear(F)}}};bs.Inject.registAsModule(ye,Bd);var Hd=bs.Rect=function(q){this.catalog="Rect",this._interactor=q};Hd.prototype={},Hd.prototype.constructor=Hd,Hd.prototype.gatherInfo=function(L,c){var D=this;if(1===c.length){var e=c[0];return e instanceof C.Shape&&e._70I()?D.gatherLine(L,e):Kl(e,L)?!1:D.gatherSingleTarget(L,e)}return c.length>1?D.gatherMultiTargets(L,c):!1},Hd.prototype.gatherSingleTarget=function(L,B){if(B.getCorners){var c,g=this,Q=g.info;g.target=B,c=g.screenInfo={};var P=B.getCorners();Q.LT=new bs.Math.Vector2(P[0]),Q.LB=new bs.Math.Vector2(P[1]),Q.RB=new bs.Math.Vector2(P[2]),Q.RT=new bs.Math.Vector2(P[3]),Q.T=Q.LT.clone().add(Q.RT).divideScalar(2),Q.B=Q.LB.clone().add(Q.RB).divideScalar(2),Q.L=Q.LT.clone().add(Q.LB).divideScalar(2),Q.R=Q.RT.clone().add(Q.RB).divideScalar(2);for(var s in Q)c[s]=bs.toScreenPosition(L,Q[s]);var F=g._interactor,w=F.getStyle("checkSize"),d=function(B,E,H){var y=E.clone().sub(B).setLength(-w),L=H.clone().sub(B).setLength(-w),V=y.add(L).add(B);return V};return c.rotLT=d(c.LT,c.RT,c.LB),c.rotLB=d(c.LB,c.LT,c.RB),c.rotRB=d(c.RB,c.LB,c.RT),c.rotRT=d(c.RT,c.LT,c.RB),c.rotT=c.rotLT.clone().add(c.rotRT).divideScalar(2),c.rotB=c.rotLB.clone().add(c.rotRB).divideScalar(2),c.rotL=c.rotLT.clone().add(c.rotLB).divideScalar(2),c.rotR=c.rotRT.clone().add(c.rotRB).divideScalar(2),c.rotation=B.getRotation(),g.gatherConnectInfo(),!0}},Hd.prototype.gatherConnectInfo=function(){var o=this,Z=o.target,d=o._interactor,z=o.screenInfo,Q=d.gv;if(Q.isConnectActionVisible(Z)&&d.getStyle("connectGuideVisible")){var c;Z.s&&(c=Z.s("connectGuideShift")),c||(c=d.getStyle("connectGuideShift"));var e=Z.getAnchor(),C=Z.getSize(),R=Z.toGlobal({x:C.width*(c[0]-e.x),y:C.height*(c[1]-e.y)});R=bs.toScreenPosition(Q,R),z.P1?R.add(z.P2.clone().sub(z.P1).setLength(c[2])):(R.add(z.RT.clone().sub(z.LT).setLength(c[2])),R.add(z.LB.clone().sub(z.LT).setLength(c[3]))),z.connect=R}},Hd.prototype.gatherMultiTargets=function(C,M){var i=bs.Group.findOrCreateGroup(M);if(!i)return!1;var B=this;return B.editing&&"rotate"!==B.editing.mode||i.calcInfo(),B.gatherSingleTarget(C,i)},Hd.prototype.gatherLine=function(N,w){this.target=w;var W=this.screenInfo={},r=w.getPoints(),F=bs.getDataMatrix(w);return W.P1=bs.toScreenPosition(N,F.apply(r.get(0))),W.P2=bs.toScreenPosition(N,F.apply(r.get(1))),this.gatherConnectInfo(),!0},Hd.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Hd.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Hd.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Hd.prototype.check=function(A,F,V){if(C.Default.isLeftButton(F)){var c=this;if(c.editing=null,c.tipInfo=null,c.screenInfo){var X=c.target,H=A.isEditable(X),K=c.screenInfo;if(H&&K.connect){var P=c._checkConnect(V);if(P)return P}if(K.P1)return c._checkLine(V);var I,t,R,o=null,s=c._interactor,p=s.getStyle("checkSize");if(H&&A.isRectEditable(X))for(t=0;t<bs.Rect.ResizeKeys.length;t++)if(R=bs.Rect.ResizeKeys[t],bs.checkHit(V,K[R],p)){o=R,I="resize";break}if(!o&&H&&A.isRotationEditable(X)&&!s.getStyle("rotateAsClock")){var Y=s.getStyle("rotateCheckSize");for(t=0;t<bs.Rect.RotateKeys.length;t++)if(R=bs.Rect.RotateKeys[t],bs.checkHit(V,K[R],Y)){o=R,I="rotate";break}}if(!o)return s.setCursor("default"),void 0;if("rotate"===I){var d,b=A.lp(F);if(X instanceof bs.Group){var U=s.getStyle("groupRotateModeKey");"string"==typeof U&&(U=[U]);for(var S=!1,w=0,m=U.length;m>w;w++)if(F[U[w]]){S=!0;break}var z=s.getStyle("groupRotateModeDefault");d=S?"batch"===z?"block":"batch":z}var E="batch"===d?X.getAnchor2():X.getPosition(),g=Math.atan2(b.y-E.y,b.x-E.x);s._setRotateCursor(g),c.editing={mode:I,key:o,pos:E,flipY:X.getScale().y<0,rotation:X.getRotation(),hitRot:g},d&&(c.editing.groupRotateMode=d)}else{var N=bs.Rect.ResizeKeys.indexOf(o),v=bs.Rect.ResizeDirection[N],l=Math.cos(X.getRotation()),M=Math.sin(X.getRotation()),L=v.x*Math.sign(X.getScale().x),n=v.y*Math.sign(X.getScale().y),e=Math.atan2(-M*L-l*n,l*L-M*n),u=(Math.round(e/(Math.PI/4))+8)%8,i=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][u];this._interactor.setCursor(i);var r=X.getWidth(),D=X.getHeight(),J=X.getAnchor();c.editing={mode:I,key:o,rect:{x:-r*J.x,y:-D*J.y,width:r,height:D},anchor:J,matrix:X.getMatrix()}}return o}}},Hd.prototype._checkLine=function(T){var x=this;x.screenInfo;var s,F=x._interactor.getStyle("checkSize");if(bs.checkHit(T,x.screenInfo.P1,F))s="P1";else{if(!bs.checkHit(T,x.screenInfo.P2,F))return this._interactor.setCursor("default"),void 0;s="P2"}return x.editing={mode:"line",key:s},s},Hd.prototype._checkConnect=function(e){var n=this,N=n.screenInfo,g=n._interactor,w=g.getStyle("connectGuideIntersectSize"),C=N.connect,Y=e.x,T=C.x;if(T>Y&&w>T-Y&&Math.abs(C.y-e.y)<w||Y>=T&&bs.checkHit(e,C,w)){var m="connect",J=I.getConnectAction(g.gv);if(n.editing={mode:m},J&&J.delete)if(n.target instanceof bs.Group){var R=!0;g.gv.sm().getSelection().each(function(W){J.delete.visible.call(null,g.gv,W)||(R=!1)}),n.editing.hasDeleteAction=R}else J.delete.visible.call(null,g.gv,n.target)&&(n.editing.hasDeleteAction=!0);return g.setCursor("default"),m}},Hd.prototype._fireEditEvent=function(C,K){var b=this._interactor,Y=this.editing;if(Y){var S=Y.mode;S="rotate"===S?"Rotation":"connect"===S?"Connection":S[0].toUpperCase()+S.slice(1),b.fi({kind:C+"Edit"+S,event:K})}},Hd.prototype.startEdit=function(G,N){G.startDragging(N);var p=this;p._interactor.fi({kind:"prepareEdit",event:N});var D=p.editing,e=p.target;if(D){if(p._fireEditEvent("begin",N),"rotate"===D.mode)return D.groupRotateMode&&e.beginRotate(D),void 0;if("connect"!==D.mode)("line"===D.mode||e&&0===e.getRotation())&&(p._inSmartGuide=!0,p._interactor.rectGuide.gatherRects());else if(D.hasDeleteAction){var c=G.gv,h=p._interactor.getStyle("connectGuideGarbageShift");D.garbageInfo={x:c.getWidth()*h[0]+h[2],y:c.getHeight()*h[1]+h[3],size:p._interactor.getStyle("connectGuideGarbageIntersectsize")},G._42()
}}},Hd.prototype._46O=function($){var k,u,c=this,r=c.editing,L=c.target;if(r){if("connect"===r.mode&&!r.canceled&&!r.deleted)try{r.garbageInfo&&r.garbageInfo.hover?I.doDeleteConnectionAction(c._interactor.gv,L):I.doConnectAction(c._interactor.gv,L,r.target)}catch(z){console.error(z)}u=r.freezeFlag,k=c.editing.groupRotateMode,c._fireEditEvent("end",$),c.editing=null}c.tipInfo=null,c._inSmartGuide&&(c._interactor.rectGuide.clear(),c._inSmartGuide=!1),k&&L&&L.endRotate(),L instanceof C.Block&&(u===V?delete L._freezeSyncFromChildren:L._freezeSyncFromChildren=u,L.updateFromChildren())},Hd.prototype.handleNormalStateDelete=function(){var E=this,c=E.editing;if(c&&"connect"===c.mode&&!c.canceled&&!c.deleted){if(c.garbageInfo){try{I.doDeleteConnectionAction(E._interactor.gv,E.target)}catch(F){console.error(F)}c.garbageInfo=null}return c.cursorPos=null,c.targetCorners=null,c.deleted=!0,E._interactor._42(),!0}},Hd.prototype.handleNormalStateKeyDown=function(W){var J=this,l=J.editing;return!l||"connect"!==l.mode||l.canceled||l.deleted?void 0:C.Default.isEsc(W)?(l.cursorPos=null,l.targetCorners=null,l.canceled=!0,J._interactor._42(),!0):void 0},Hd.prototype.handleEdit=function(m,k){var F=this,h=F.editing;if(h){var q,t,R,g,T,Z=F.target,d=h.key,c=h.mode,Y=m.lp(k),L=F._interactor;if("connect"===c){if(h.canceled)return;if(h.deleted)return;h.cursorPos=L._getLogicalPoint(k);var Q=h.garbageInfo;return Q&&bs.checkHit(h.cursorPos,Q,Q.size)?(Q.hover=!0,h.target=null,h.targetCorners=null):(Q&&(Q.hover=!1),h.target=m.getDataAt(Y,function(O){return m.isSelectable(O)?tn(O)?!0:!1:!1})||null,h.targetCorners=bs.getTargetCornersOnScreen(m,h.target)),L._42(),void 0}if("rotate"===c){var J,x,A=h.pos,f=Math.atan2(Y.y-A.y,Y.x-A.x);if(h.groupRotateMode?x=f-h.hitRot:(J=f-h.hitRot,x=h.rotation+J),x%=2*Math.PI,0>x&&(x+=2*Math.PI),!C.Default.isCtrlDown(k)){var i,W;ub(k)?(i=L.getStyle("shiftRotateRound"),W=i/2):(i=L.getStyle("rotateRound"),W=L.getStyle("rotateSensitivity")),x=bs.roundTo(x,i,W)}h.groupRotateMode?(J=x-(h.lastRotation||0),0!==J&&(Z.addRotation(J,h.groupRotateMode),h.lastRotation=x)):Z.setRotation(x),L._setRotateCursor(f),x>Math.PI&&(x-=2*Math.PI);var O=180*(x/Math.PI);O=O.toFixed(2),q=""+O+"°"}else if("resize"===c){var H=h.rect;R=H.x,g=H.y;var a,w=H.width,j=H.height,V=h.anchor,K=h.matrix,M=Z.s&&Z.s("keepAspectRatio")||L.getStyle("keepAspectRatio");ub(k)&&(M=!M);var v=F._unionPointMode1,u=F._unionPointMode2;if(F._inSmartGuide&&!C.Default.isCtrlDown(k)&&!M){var n;"L"===d||"R"===d?n="x":("T"===d||"B"===d)&&(n="y"),F._adsorbedToClosest(Y,n),T=!0}a=K.tfi(Y);var $;"LT"===d?(H=v(a,{x:R+w,y:g+j},w,j,M),$=9):"T"===d?(H=u({x:R,y:a.y},{x:R+w,y:g+j},w,j,M,"v"),$=1):"RT"===d?(H=v(a,{x:R,y:g+j},w,j,M),$=33):"L"===d?(H=u({x:a.x,y:g},{x:R+w,y:g+j},w,j,M,"h"),$=8):"R"===d?(H=u({x:R,y:g},{x:a.x,y:g+j},w,j,M,"h"),$=32):"LB"===d?(H=v(a,{x:R+w,y:g},w,j,M),$=12):"B"===d?(H=u({x:R,y:g},{x:R+w,y:a.y},w,j,M,"v"),$=4):"RB"===d&&(H=v(a,{x:R,y:g},w,j,M),$=36);var S=K.tf(H.x+H.width*V.x,H.y+H.height*V.y);Z instanceof C.Block&&(h.hasOwnProperty("freezeFlag")||(h.freezeFlag=Z._freezeSyncFromChildren,Z._freezeSyncFromChildren=!0)),Z.setPosition(S),Z.setSize(H.width,H.height),T&&(t=Z.getRect(),L.rectGuide.gatherLines({node:Z,x:t.x,y:t.y,w:t.width,h:t.height},n,$)),q=""+Math.round(H.width)+" * "+Math.round(H.height)}else if("line"===c){if(ub(k)){var X=Z.getPoints(),I="P1"===d?X.get(1):X.get(0),_={x:Y.x-I.x,y:Y.y-I.y},y=L.getStyle("shiftLineRotateRound"),N=F._shiftDirList;if(!N||F._shiftRotateRound!==y){F._shiftRotateRound=y,F._shiftDirList=N=[];for(var p=0;p<Math.PI;p+=y)N.push({x:e(p),y:P(p)})}for(var z,G=0,o=0,r=N.length;r>o;o++){var E=N[o],U=E.x*_.x+E.y*_.y;Math.abs(U)>Math.abs(G)&&(G=U,z=E)}Y={x:I.x+z.x*G,y:I.y+z.y*G},L.rectGuide.clear()}else F._inSmartGuide&&!C.Default.isCtrlDown(k)&&(F._adsorbedToClosest(Y),T=!0);var l=bs.getDataMatrix(Z).applyInverse(Y);Z.setPoint("P1"===d?0:1,l,!0);var s=Z.getPoints(),D=s.get(0),b=s.get(1);R=D.x-b.x,g=D.y-b.y,q=" "+Math.round(Math.sqrt(R*R+g*g))+" ",T&&(t=Z.getRect(),L.rectGuide.gatherLines({node:Z,x:t.x,y:t.y,w:t.width,h:t.height}))}if(q){var B=C.Default.getLogicalPoint(k,L._canvas);B.x+=bs.Icons.TipShiftX,B.y+=bs.Icons.TipShiftY,F.tipInfo={helperPos:B,text:q,size:q.length}}F._fireEditEvent("between",k)}},Hd.prototype._unionPointMode1=function(n,x,H,i,k){if(k&&H&&i){var h=n.x-x.x,X=n.y-x.y;Math.abs(h*i)<Math.abs(X*H)?(X=Math.sign(X)*Math.abs(h*i/H),n.y=x.y+X):(h=Math.sign(h)*Math.abs(X*H/i),n.x=x.x+h)}return C.Default.unionPoint(n,x)},Hd.prototype._unionPointMode2=function(y,K,g,$,F,f){var u=C.Default.unionPoint(y,K);if(F&&g&&$){var M;"v"===f?(M=u.x+u.width/2,u.width=g*u.height/$,u.x=M-u.width/2):(M=u.y+u.height/2,u.height=$*u.width/g,u.y=M-u.height/2)}return u},Hd.prototype._adsorbedToClosest=function(r,D){var U=this,z=U._interactor,q=z.rectGuide.findClosest(r,D),L=z.gridGuide.findClosest(r,D),$=1/0,m=1/0;q&&(isFinite(q.x)&&($=q.x),isFinite(q.y)&&(m=q.y)),L&&(isFinite(L.x)&&Math.abs(L.x)<Math.abs($)&&($=L.x),isFinite(L.y)&&Math.abs(L.y)<Math.abs(m)&&(m=L.y)),isFinite($)&&(r.x+=$),isFinite(m)&&(r.y+=m)},Hd.prototype._42=function(R,B,Z){var L=this;L.info={},L.screenInfo=null;var f=L._interactor;if(!f.editDetail&&L.gatherInfo(B,Z)){var z=L.editing,x=z?z.groupRotateMode:null,E=L.screenInfo;"block"!==x&&(E.P1?bs.Icons.DrawIcon(f,R,bs.Icons.Line,E):bs.Icons.DrawIcon(f,R,bs.Icons.Rect,E),E.connect&&(bs.Icons.DrawIcon(f,R,bs.Icons.ConnectGuide,{rotation:E.rotation,connect:E.connect,cursorPos:z?z.cursorPos:null}),z&&(z.targetCorners&&bs.Icons.DrawIcon(f,R,bs.Icons.NodeHoverGuide,z.targetCorners),z.garbageInfo&&bs.Icons.DrawIcon(f,R,bs.Icons.ConnectGuideGarbage,z.garbageInfo))),L.tipInfo&&bs.Icons.DrawIcon(f,R,bs.Icons.TipHelper,L.tipInfo)),L.target instanceof bs.Group&&L.target._42(f,R,B)}};var xk=bs.Anchor=function(n){this.catalog="Anchor",this._interactor=n};xk.prototype={},xk.prototype.constructor=xk,xk.prototype.gatherInfo=function(V,E){var L=this;if(1===E.length){var s=E[0];if(!s.getAnchor)return;if(s instanceof C.Shape&&s._70I())return;if(Kl(s,V))return;return L.gatherSingleTarget(V,E[0])}return E.length>1?L.gatherMultiTargets(V,E):!1},xk.prototype.gatherSingleTarget=function(P,d){var V=this;return V.info.POS=d.getPosition(),V.screenInfo.POS=bs.toScreenPosition(P,V.info.POS),V.target=d,!0},xk.prototype.gatherMultiTargets=function(H,_){var V=this,x=bs.Group.findOrCreateGroup(_);return x?(V.screenInfo.POS=bs.toScreenPosition(H,x.getAnchor2()),V.target=x,!0):!1},xk.prototype.isVisible=function(){var Z=this,Y=Z._interactor;if(Y.getStyle("anchorVisible")===!1)return!1;var s=Z.target;if(s){if(this.editing)return!0;var c=s.getAnchor(),I=Y.getStyle("anchorOutsideVisibleThreshold");if(c.x<-I||c.x>1+I||c.y<-I||c.y>1+I)return!0;var w=s.getSize(),M=s.getScale(),l=Math.min(Math.abs(w.width*M.x),Math.abs(w.height*M.y));if(l*Y.gv._zoom<Y.getStyle("anchorHideThreshold"))return!1}return!0},xk.prototype.check=function(e,r,E){if(C.Default.isLeftButton(r)){var D=this,Y=D._interactor;if(D.isVisible()&&Y.getStyle("anchorMovable")!==!1){D.editing=null,D.tipInfo=null;var l=D.target;if(l&&e.isAnchorEditable(l)&&e.isEditable(l)){var v;if(D.screenInfo&&(v=D.screenInfo.POS)&&bs.checkHit(E,new bs.Math.Vector2(v),Y.getStyle("checkSize"))){if(l instanceof bs.Group)return D.editing={},!0;var b=l.getWidth(),M=l.getHeight(),Z=l.getAnchor();return D.editing={rect:{x:-b*Z.x,y:-M*Z.y,width:b,height:M},anchor:Z,matrix:l.getMatrix()},!0}}}}},xk.prototype.startEdit=function(r,a){r.startDragging(a),r.fi({kind:"beginEditAnchor",event:a})},xk.prototype._46O=function(o){var s=this;s.editing&&(s.editing=null,s._interactor.fi({kind:"endEditAnchor",event:o})),s.tipInfo=null},xk.prototype.handleEdit=function(x,h){var X=this,s=X.target;if(s){var g=X.editing;if(g){var T=x.lp(h),d=X._interactor;if(s instanceof bs.Group)return s.setAnchor2(T),d._42(),void 0;var U=g.matrix,V=U.tfi(T),D=g.rect,i=(V.x-D.x)/D.width,P=(V.y-D.y)/D.height;if(!C.Default.isCtrlDown(h)){var F=d.getStyle("anchorRound"),n=d.getStyle("anchorSensitivity");i=bs.roundTo(i,F,n),P=bs.roundTo(P,F,n)}s.setAnchor(i,P,!0);var k=C.Default.getLogicalPoint(h,d._canvas);k.x+=bs.Icons.TipShiftX,k.y+=bs.Icons.TipShiftY;var c=""+i.toFixed(2)+", "+P.toFixed(2);X.tipInfo={helperPos:k,text:c,size:c.length},d.fi({kind:"betweenEditAnchor",event:h})}}},xk.prototype._42=function(W,o,n){var Y=this;Y.info={},Y.screenInfo={};var O=Y._interactor;O.editDetail||Y.gatherInfo(o,n)&&Y.isVisible()&&(bs.Icons.DrawIcon(O,W,bs.Icons.Anchor,Y.screenInfo),Y.tipInfo&&bs.Icons.DrawIcon(O,W,bs.Icons.TipHelper,Y.tipInfo))};var oc=bs.RotateX=function(z){this.catalog="RotateX",this._interactor=z};oc.prototype={},oc.prototype.constructor=oc,oc.prototype.gatherInfo=function(D,B){var a=this;if(1===B.length){var q=B[0];return q instanceof C.Shape&&q._70I()||Kl(q,D)?!1:a.gatherSingleTarget(D,q)}return B.length>1?a.gatherMultiTargets(D,B):!1},oc.prototype.gatherSingleTarget=function(){var A=new C.Math.Vector2,n=new C.Math.Vector2,D=new C.Math.Vector2,Z=new C.Math.Vector2,V=function(s,C){var W=s.x-C.x,j=s.y-C.y;return W*W+j*j};return function(r,Y){if(Y.getCorners){var B=this,W=Y.getCorners(),g=15,e=Y.getPosition();A.copy(W[0]),D.copy(W[1]),Z.copy(W[3]),n.copy(A).add(Z).divideScalar(2).add(A.sub(D).setLength(g/r.getZoom()));var T=Math.max(V(e,W[0]),V(e,W[1]),V(e,W[2]),V(e,W[3]));return B.info.POS=n.clone(),B.screenInfo.POS=bs.toScreenPosition(r,B.info.POS),B.screenInfo.LEN=Math.sqrt(T)*r.getZoom()+g,B.screenInfo.CENTER=bs.toScreenPosition(r,e),B.target=Y,!0}}}(),oc.prototype.gatherMultiTargets=function(b,k){var i=this,F=bs.Group.findOrCreateGroup(k);if(!F)return!1;var i=this;return i.gatherSingleTarget(b,F)},oc.prototype.isVisible=function(){var j=this._interactor;if(!j.getStyle("rotateAsClock"))return!1;var $=this.target;if(!$)return!0;var Y=j.gv;return Y.isEditable($)&&Y.isRotationEditable($)?!0:!1},oc.prototype.check=function(c,i,V){var g=this,O=g._checkImpl(c,i,V);return(O||g._clockPainted)&&g._interactor._42(),O},oc.prototype._checkImpl=function(V,E,d){if(C.Default.isLeftButton(E)){var H=this;H.editing=null,H.tipInfo=null;var A;if(H.screenInfo&&(A=H.screenInfo.POS)&&H.isVisible()){var y=H._interactor;if(bs.checkHit(d,A,y.getStyle("checkSize"))){var h=H.target,r=V.lp(E),W=h.getPosition(),L=Math.atan2(r.y-W.y,r.x-W.x);return y._setRotateCursor(L),H.editing={pos:W,rotation:h.getRotation(),hitRot:L,groupRotateMode:"block",screenInfo:{CENTER:H.screenInfo.CENTER,LEN:H.screenInfo.LEN}},!0}}}},oc.prototype.startEdit=function(m,_){m.startDragging(_),m.fi({kind:"beginEditRotation",event:_}),this.target instanceof bs.Group&&this.target.beginRotate(this.editing)},oc.prototype._46O=function(X){var U=this;U.editing&&(U.editing=null,U._interactor.fi({kind:"endEditRotation",event:X})),U.target instanceof bs.Group&&U.target.endRotate(),U.tipInfo=null},oc.prototype.handleEdit=function(n,R){var v=this,o=v.editing;if(o){var r,m,a=v.target,H=n.lp(R),h=v._interactor,W=o.pos,N=Math.atan2(H.y-W.y,H.x-W.x),E=a instanceof bs.Group;if(E?m=N-o.hitRot:(r=N-o.hitRot,m=o.rotation+r),m%=2*Math.PI,0>m&&(m+=2*Math.PI),!C.Default.isCtrlDown(R)){var V,u;ub(R)?(V=h.getStyle("shiftRotateRound"),u=V/2):(V=h.getStyle("rotateRound"),u=h.getStyle("rotateSensitivity")),m=bs.roundTo(m,V,u)}E?(r=m-(o.lastRotation||0),0!==r&&(a.addRotation(r,o.groupRotateMode),o.lastRotation=m)):a.setRotation(m),h._setRotateCursor(N),m>Math.PI&&(m-=2*Math.PI);var Q=180*(m/Math.PI),J=""+Q.toFixed(2)+"°",x=C.Default.getLogicalPoint(R,h._canvas);x.x+=bs.Icons.TipShiftX,x.y+=bs.Icons.TipShiftY,v.tipInfo={helperPos:x,text:J,size:J.length},h.fi({kind:"betweenEditRotation",event:R})}},oc.prototype._42=function(F,N,j){var t=this;t._clockPainted=!1,t.info={},t.screenInfo={};var q=t._interactor;q.editDetail||t.gatherInfo(N,j)&&t.isVisible()&&(bs.Icons.DrawIcon(q,F,bs.Icons.RoundPoint,t.screenInfo.POS),t.tipInfo&&bs.Icons.DrawIcon(q,F,bs.Icons.TipHelper,t.tipInfo),t.editing&&t.drawClock(F))},oc.prototype.drawClock=function(L){L.save();var Y=this;Y._clockPainted=!0;var s=Y.editing||{},E=s.screenInfo||Y.screenInfo,R=E.LEN,M=R+8,v=R+18;L.save(),L.translate(E.CENTER.x,E.CENTER.y),L.beginPath(),L.strokeStyle="rgb(150, 150, 150)";for(var j,b,_,C,l,y=0;360>y;y++)j=y*Math.PI/180,0===y%5&&(b=P(j)*R,_=e(j)*R,C=P(j)*M,l=e(j)*M,L.moveTo(b,_),L.lineTo(C,l)),0===y%45&&(b=P(j)*R,_=e(j)*R,C=P(j)*v,l=e(j)*v,L.moveTo(b,_),L.lineTo(C,l));L.stroke(),L.rotate(-r);var F=s.lastRotation||Y.target.getRotation();L.beginPath(),L.fillStyle="rgba(255, 0, 0, 0.1)",L.strokeStyle="rgb(157, 157, 157)",L.moveTo(0,0),L.arc(0,0,v,0,F,!1),L.fill(),L.beginPath(),L.moveTo(0+v,0),L.arc(0,0,v,0,F,!1),L.stroke(),L.restore()};var cd=bs.Curve=function(X){this.catalog="Curve",this._interactor=X};cd.prototype={},cd.prototype.constructor=cd,c.defineProperties(cd.prototype,{activing:{get:function(){return this._activing},set:function(P){var c=this;if(P)c._activing=new bs.CurveActiving(this,P);else{var z=c._activing;z&&z.dispose(),c._activing=null}}}}),cd.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},cd.prototype.setUp=function(){var R=this,p=R._interactor;p&&p.gv.mp(R._onGraphviewPropertyChanged,R)},cd.prototype._onGraphviewPropertyChanged=function(w){("zoom"===w.property||"translateX"===w.property||"translateY"===w.property)&&this._handleDataChanged()},cd.prototype.tearDown=function(){var F=this,K=F._interactor;K&&K.gv.ump(F._onGraphviewPropertyChanged,F)},cd.prototype.canEnterEditDetailMode=function(){var J=this,i=J._interactor,R=i._getValidSelection();if(1===R.length){var z=R[0],l=z instanceof C.Edge;if(z instanceof C.Shape||l){if(l){var x=z.s("edge.type");if(x&&"points"!==x)return}var Z=i.gv;if(Z.isPointEditable(z)&&Z.isEditable(z))return J.target=z,!0}}},cd.prototype.preHandleScroll=function(){var S=this.editing;return S&&S.inEdit?!0:void 0},cd.prototype.getCurrentSelectintStatus=function(){var u=this;if(u.activing&&!u.activing.selections){if(u.activing.status!=V)return u.activing.status;var b=function(j){var A=u.activing.status;u.activing.status=j,u._interactor.fp("shapePointStatus",A,j)},I=bs.Curve.PointType,e=u.activing.point,o=u.activing.pairs;if(!o||1!==o.length)return b(I.Mirrored);var T=o[0],X=T.c1&&T.c1.isNearEnough(e),Y=T.c2&&T.c2.isNearEnough(e);if(!T.c1||!T.c2)return X||Y?b(I.Straight):b(I.Disconnected);if(X&&Y)return b(I.Straight);if(X||Y)return b(I.Asymmetric);var s=T.c1.clone().sub(e),A=T.c2.clone().sub(e);return Math.abs(s.x*A.y-s.y*A.x)>1e-5||s.x*A.x>0?b(I.Disconnected):Math.abs(s.length()-A.length())>1e-5?b(I.Asymmetric):b(I.Mirrored)}},cd.prototype.handle_keydown=function(b){var U=this;if(U._interactor.editDetail){var s=bs.Curve.PointType;"1"===b.key?U._setCurrentSelectionStatus(s.Straight):"2"===b.key?U._setCurrentSelectionStatus(s.Mirrored):"3"===b.key?U._setCurrentSelectionStatus(s.Disconnected):"4"===b.key&&U._setCurrentSelectionStatus(s.Asymmetric)}},cd.prototype.setCurrentSelectionStatus=function(v){var N=this,P=N._interactor;if(P){var F=P.gv;F.dm().beginTransaction(),this._setCurrentSelectionStatus(v),F.dm().endTransaction()}},cd.prototype._setCurrentSelectionStatus=function(f){var p=this,t=p.activing;if(t){var e=p.getCurrentSelectintStatus();if(null!==e&&e!==f){t.status=f;var $=p.activing.point,H=p.activing.pairs;if(H&&1===H.length){var L=H[0],v=p.screenInfo.curve,y=bs.Curve.PointType,m=function(){p._writeToHt(),p._interactor.fp("shapePointStatus",e,f)};if(f===y.Straight)return v.moveCtrlPoint(L,$,"c1"),v.moveCtrlPoint(L,$,"c2"),m(),void 0;if(e===y.Straight){var W=v.findPairs($,!0),V=W[0],o=V.r1||$,c=V.r2||$,r=c.clone().sub(o).multiplyScalar(.25);return v.moveCtrlPoint(L,$.clone().sub(r),"c1"),v.moveCtrlPoint(L,$.clone().add(r),"c2"),m(),void 0}var P=L.c1,j=L.c2;if(P&&j){if(f===y.Mirrored)return v.moveCtrlPoint(L,$.clone().multiplyScalar(2).sub(j),"c1"),m(),void 0;if(f===y.Asymmetric&&e===y.Disconnected){var z=P.clone().sub($).length(),r=$.clone().sub(j).setLength(z).add($);return v.moveCtrlPoint(L,r,"c1"),m(),void 0}}t._firePointChange(),p._interactor.fp("shapePointStatus",e,f)}}}},cd.prototype._handleDataChanged=function(k){var I=this;if(I.screenInfo&&I.target){var X=I._interactor;I.gatherSingleTarget(X.gv,I.target,!0),I.check(X.gv,null,k?X._getLogicalPoint(k):new bs.Math.Vector2(X._lastClientPoint)),X._42()}},cd.prototype.gatherSingleTarget=function(o,R,B){var K,g,l=this;l.screenInfo&&l.screenInfo.curve&&(g=l.screenInfo.curve._curves);var w=l.editing;K=w?l.screenInfo:l.screenInfo={};var u,Z,N=R instanceof C.Edge;N?(u=R.s("edge.segments"),Z=R.s("edge.points")||new C.List):(u=R._58O,Z=R._59O),K.S=u;var k,O=K.P=[],y=bs.getDataMatrix(R);if(R instanceof C.Polyline&&(k=R.getElevation()||0,K.E=[]),Z.each(function(H){K.E&&K.E.push(H.e||k),H=y.apply(H);var V=bs.toScreenPosition(o,H);O.push(V.x,V.y)}),N){var E=bs.toScreenPosition(o,R._lastSourcePoint),X=bs.toScreenPosition(o,R._lastTargetPoint);O.splice(0,0,E.x,E.y),O.push(X.x,X.y)}if(!K.S||!K.S.size()){K.S=new C.List,K.S.add(1);for(var D=0;D<O.length/2-1;D++)K.S.add(2)}if((!w||B)&&l.convertToCubicBezier(g),l.activing&&(B||!l.editing||"realPoint"===l.editing.type)){var b=K.curve.findPairs(l.activing.point);l.activing.pairs=b}N&&"points"!==R.s("edge.type")&&l._writeToHt()},cd.prototype._convertToNewPoint=function(T,o,Z){var A,u,B;for(A=0,u=o.length;u>A;A++){if(B=o[A],B._p1.isNearEnough(T))return B._p1;if(B._p4.isNearEnough(T))return B._p4}if(Z)for(A=0,u=Math.min(Z.length,u);u>A;A++){if(B=Z[A],B._p1===T)return o[A]._p1;if(B._p4===T)return o[A]._p4}},cd.prototype.convertToCubicBezier=function(m){var c,I,g=this,M=new bs.Math.Curve,X=g.screenInfo;if(M.createFromHtShape(X.P,X.S,X.E),X.curve=M,g.activing){var L=M._curves;if(c=g.activing.point,I=g._convertToNewPoint(c,L,m),I&&(g.activing.point=I),g.activing.selections){var b=-1,r=g.activing.selections;r.forEach(function(z){b++,I=g._convertToNewPoint(z,L,m),I&&(r[b]=I)})}}},cd.prototype.check=function(Y,w,K){if(!w||C.Default.isLeftButton(w)){var s=this;if(s._interactor.setCursor("default"),s.editing=null,s.highlight=null,s.tipInfo=null,s.screenInfo){if(Eg())return s._interactor._42(),!0;if(s._checkEditCtrlPoint(K))return s._interactor._42(),!0;if(s._checkEditRealPoint(K))return s._interactor._42(),!0;if(s._checkEditElevation(K))return s._interactor._42(),!0;var $=s.screenInfo.curve,l=$.checkPoint(K,s._interactor.getStyle("curveIntersectSize"));if(l){var t=s.highlight={};t.type="insertKnot",t.bezier=l.bezier,t.point=l.intersection}return s._interactor._42(),!0}}},cd.prototype._checkEditRealPoint=function(k){var c,f,e,X,q,l,G=this,I=G.screenInfo.curve._curves,p=G._interactor.getStyle("curvePointIntersectSize"),d=1/0;for(p*=p,e=0,X=I.length;X>e;e++)c=I[e],q=c._p1,l=k.distanceToSquared(q),d>l&&(d=l,f=q),q=c._p4,l=k.distanceToSquared(q),d>l&&(d=l,f=q);if(d>p)return!1;var v=G.highlight={};return v.type="changeRealPoint",v.point=f,G.editing={type:"realPoint",point:f,shiftGuide:{point:f.clone(),dir:"x",limit:0}},G._interactor.setCursor("crosshair"),!0},cd.prototype._checkEditElevation=function(j){var n=this;if(!n._interactor.getStyle("curveElevationVisible"))return!1;var o=n.activing;if(!o)return!1;var e=o.getCurrentEditingPoint();if(!e)return!1;var y=n._interactor,l=y.getStyle("curveElevationGuideShift"),R=y.getStyle("curveElevationIntersectSize"),i=j.distanceToSquared({x:e.x+l[0],y:e.y+l[1]});if(!(i>R*R)){var g=n.highlight={};g.type="elevation";var T=new bs.Math.Vector2(j.x,j.y,e.e);return n.editing={type:"elevation",startPoint:T},n._interactor.setCursor("crosshair"),!0}},cd.prototype._checkEditCtrlPoint=function(u){var N=this;if(N.activing&&!N.activing.selections){var E=N.getCurrentSelectintStatus();if(E!==bs.Curve.PointType.Straight){var o=N.activing.pairs;if(o){var G=N._interactor.getStyle("curvePointIntersectSize");G*=G;var m,I,Z,h,t,s,g,k,L,F=1/0;for(g=0,L=o.length;L>g;g++)for(h=o[g],k=0;2>k;k++)t=0===k?"c1":"c2",h[t]&&(s=u.distanceToSquared(h[t]),F>s&&(F=s,m=h,I=g,Z=t));if(F>G)return!1;N.activing.hlpair=m,N.activing.hltype=Z;var W=N.highlight={};return W.type="changeCtrlPoint",W.point=m[Z],N.editing={type:"ctrlPoint",pair:m,pairId:I,ctrlType:Z,direction:m[Z].clone().sub(N.activing.point).normalize()},N._interactor.setCursor("crosshair"),!0}}}},cd.prototype.startEdit=function(G,f){G.startDragging(f);var x=this;x.highlight&&"insertKnot"===x.highlight.type&&(x.insertKnot(),x.gatherSingleTarget(x._interactor.gv,x.target),x.activing=null,x._checkEditRealPoint(x._interactor._getLogicalPoint(f)));var h=x._activing;if(h){var T=x.editing?x.editing.type:null;"ctrlPoint"===T?h.editingCtrl={pairId:x.editing.pairId,type:h.hltype}:"realPoint"===T&&(h.editingCtrl=!1)}var g=x.highlight,J=C.Default.isCtrlDown(f);if(!g||Eg()){var E=x._interactor.gv;if(!E.setFocus(f)||E._scrolling)return;return E.isPannable()&&Bn(f)&&!J&&(x._pan={tx:E.tx(),ty:E.ty()},G.fi({kind:"beginPan",event:f})),void 0}if("changeRealPoint"===g.type){var N,l=x.activing?x.activing.point:null,P=x.activing?x.activing.selections:null;if(J&&x.activing)l===g.point?(P?(x.activing={point:P[0]},P.length>1&&(P.splice(0,1),x.activing.selections=P)):x.activing=null,x.editing=null):P&&(N=P.indexOf(g.point))>=0?(P.length>1?P.splice(N,1):delete x.activing.selections,x.editing=null):P?(P.push(l),x.activing={point:g.point,selections:P}):x.activing={point:g.point,selections:[l]};else if(P)l===g.point||((N=P.indexOf(g.point))>=0?(P.splice(N,1,l),x.activing={point:g.point,selections:P}):x.activing={point:g.point});else{var L;l===g.point&&(L=x.activing.status),x.activing={point:g.point},L&&(x.activing.status=L)}G.fi({kind:"beginEditPoint",event:f})}},cd.prototype.insertKnot=function(){var P=this,A=P.highlight,m=P.screenInfo.curve;m.insertKnot(A.bezier,A.point.t),P._writeToHt()},cd.prototype._writeToHt=function(){var A,I,s,L,d=this,$=d.screenInfo.curve,u=$.toHtShape(),r=u.points,j=[],q=u.segments,K=d._interactor.gv,X=d.target,m=X instanceof C.Edge,n=bs.getDataMatrix(X).invert();L=X instanceof C.Polyline,L&&(s=X.getElevation());for(var _=0,B=r.length;B>_;_++)A=r[_],I=bs.toWorldPosition(K,A),I=n.apply(I),A.e!=V&&A.e!==s&&(I.e=A.e),j.push(I);if(X._writing=!0,m){X.s("edge.type","points"),X.setStyle("edge.segments",q),X.setStyle("edge.points",j.slice(1,j.length-1)),X.setStyle("edge.source.offset.x",0),X.setStyle("edge.source.offset.y",0),X.setStyle("edge.target.offset.x",0),X.setStyle("edge.target.offset.y",0);var z=d._nextChangeEdgeHost;delete d._nextChangeEdgeHost,z&&("source"===z.type?X.setSource(z.host):X.setTarget(z.host)),d._writeEdgeHostAnchor("source",j[0]),d._writeEdgeHostAnchor("target",j[j.length-1])}else j.length?(X.setSegments(q),X.setPoints(j,!0)):X.removeFromDataModel();delete X._writing},cd.prototype._writeEdgeHostAnchor=function(B,f){var R=this,O=R.target,N=R._calcHostAnchor(O,B,f);O.s("edge."+B+".anchor.x",N.x),O.s("edge."+B+".anchor.y",N.y),N.offsetX||N.offsetY?(O.s("edge."+B+".offset.x",N.offsetX),O.s("edge."+B+".offset.y",N.offsetY)):(O.s("edge."+B+".offset.x",0),O.s("edge."+B+".offset.y",0))},cd.prototype._calcHostAnchor=function(R,i,b,O){O||(O="source"===i?R.getSource():R.getTarget());var L=this._interactor.gv,d=L.calculateAttachPoint(O,b);if(d)return d.info;var z=O.getRotation(),N=O.getAnchor();if(Kl(O,L)&&(z=0),z){var q=O.getMatrix(),Y=q.tfi(b),m=O.getSize();return{x:Y.x/m.width+N.x,y:Y.y/m.height+N.y}}var C=Fn(L,O),I={x:(b.x-C.x)/C.width,y:(b.y-C.y)/C.height};return I},cd.prototype._handlePanning=function(X){var R=this,B=R._pan;if(B){B.started=!0;var f=R._interactor,g=f.gv,m=f._lastClientPoint,n=ms(X);g.setTranslate(B.tx+n.x-m.x,B.ty+n.y-m.y),R.gatherSingleTarget(f.gv,R.target),f._42(),f.fi({kind:"betweenPan",event:X})}},cd.prototype.handleEdit=function(r,R){var e=this,I=e.editing;if(e._pan)return e._handlePanning(R),void 0;if(I){I.inEdit=!0;var B,w,b,y=e._interactor._getLogicalPoint(R),_=C.Default.isCtrlDown(R),Q=C.Default.isShiftDown(R),k=I.type,L=e.activing;if(e._guideInfo=null,"ctrlPoint"===k&&Q){var T=e.editing.direction.clone();B=L.point;var p=T.dot(y.clone().sub(B));y=T.setLength(p).add(B)}else if("ctrlPoint"===k||"realPoint"===k){var T;if("realPoint"===k&&Q){var Y=e.editing.shiftGuide;w=Y.point;var Z=Math.abs(y.x-w.x),i=Math.abs(y.y-w.y);Z>i&&Z>Y.limit&&"y"===Y.dir&&(Y.dir="x"),i>Z&&i>Y.limit&&"x"===Y.dir&&(Y.dir="y"),T=Y.dir,"x"===T?(y.y=w.y,Y.limit=Math.max(Y.limit,Z)):"y"===T&&(y.x=w.x,Y.limit=Math.max(Y.limit,i))}var M=e._isEditEdgeSourceTarget();if(M){var c=e._editEdgeSourceTarget(M,y,_);c&&(b=c.tipText)}else if(!_){var W=e._guidingToEdit(y,T),j="realPoint"===k?e._interactor.gridGuide.findClosest(y,T,!0):null,x=1/0,s=1/0;j&&(j.x&&(x=j.x),j.y&&(s=j.y));var g=!1;W&&(W.xList&&(Math.abs(W.x)<=Math.abs(x)?(g=!0,x=W.x):delete W.xList),W.yList&&(Math.abs(W.y)<=Math.abs(s)?(g=!0,s=W.y):delete W.yList),g&&(e._guideInfo=W)),isFinite(x)&&(y.x+=x),isFinite(s)&&(y.y+=s),g&&(W.v=y)}}var J=e.screenInfo.curve;if("realPoint"===I.type){B=I.point,B.e!==V&&(y.e=B.e),J.moveRealPoint(B,y),I.point=y,e.highlight.point=y;var G=L.status,A=L.selections;if(e.activing={point:y,status:G},A){var E=y.clone().sub(B),q=0;A.forEach(function(S){var r=S.clone().add(E);J.moveRealPoint(S,r),A[q++]=r}),e.activing.selections=A}}else if("ctrlPoint"===I.type){var F=L.pairs,O=F[I.pairId];J.moveCtrlPoint(O,y,I.ctrlType);var a=L.status,X=bs.Curve.PointType;if((a===X.Mirrored||a===X.Asymmetric)&&O.c1&&O.c2){var B=new bs.Math.Vector2(L.point),u="c1"===I.ctrlType?"c2":"c1";if(a===bs.Curve.PointType.Mirrored)J.moveCtrlPoint(O,B.clone().multiplyScalar(2).sub(y),u);else if(a===X.Asymmetric){var p=O[u].clone().sub(B).length(),o=B.clone().sub(O[I.ctrlType]).setLength(p).add(B);isNaN(o.x)||J.moveCtrlPoint(O,o,u)}}L._firePointChange()}else if("elevation"===I.type){w=I.startPoint;var S=w.e+(w.y-y.y)/r._zoom;e._setCurrentPointImpl("e",S),L._firePointChange(),b="E: "+bs.toFixed(S)}var n=C.Default.getLogicalPoint(R,e._interactor._canvas);if(n.x+=bs.Icons.TipShiftX,n.y+=bs.Icons.TipShiftY,!b){var K=bs.toWorldPosition(r,y);b=""+bs.toFixed(K.x)+", "+bs.toFixed(K.y)}e.tipInfo={helperPos:n,text:b,size:b.length},e._writeToHt(),e._interactor.fi({kind:"betweenEditPoint",event:R})}},cd.prototype._setCurrentPointImpl=function(W,P){var f=this,$=f._activing;if(!$)return!1;var K=f.target;if(!K)return!1;var g=$.getCurrentEditingPoint();if(!g)return!1;var c=$.editingCtrl;if(!c)var l=g.clone();if("e"===W)g.e=P;else{var n;if("x"===W||"y"===W){var e=$._lastFirePoint;n="x"===W?{x:P,y:e?e.y:0}:{x:e?e.x:0,y:P}}else"object"==typeof W?(n=W,W.e!==V&&(g.e=W.e)):(n={x:arguments[0],y:arguments[1]},arguments[2]!==V&&(g.e=arguments[2]));var X=bs.getDataMatrix(K);n=bs.toScreenPosition(f._interactor.gv,X.apply(n)),g.x=n.x,g.y=n.y}if(!c){var r=l.multiplyScalar(-1).add(g);g.e&&l.e&&(r.e=g.e-l.e),f.screenInfo.curve.moveCtrlDueToRealPointMovement(g,r)}return!0},cd.prototype.setCurrentPoint=function(s,x){return this._setCurrentPointImpl(s,x)?(this._writeToHt(),!0):!1},cd.prototype._isEditEdgeSourceTarget=function(){var F=this,o=F.target;if(!(o instanceof C.Edge))return!1;var S=F.editing.point,f=F.screenInfo.curve._curves;return S===f[0]._p1?"source":S===f[f.length-1]._p4?"target":!1},cd.prototype._editEdgeSourceTarget=function(j,P,Y){var q,z=this,o=z.target;if(q="source"===j?o.getSource():o.getTarget()){var g=z._interactor.gv,l=bs.toWorldPosition(g,P),i=z._calcHostAnchor(o,j,l,q);if(z._interactor.getStyle("edgeHostDetectPerFrame")||i.x<0||i.x>1||i.y<0||i.y>1){var m=g.getDataAt(l,function(E){return g.isSelectable(E)?tn(E)?!0:!1:!1});if(m){var I=z._calcHostAnchor(o,j,l,m);q=m,z._nextChangeEdgeHost={type:j,host:m},i=I}}var y;if(!Y){var d=z._interactor.getStyle("anchorRound"),r=z._interactor.getStyle("anchorSensitivity");y=g.calculateAttachPoint(q,l),y?i=y.info:(i.x=bs.roundTo(i.x,d,r),i.y=bs.roundTo(i.y,d,r))}if(!Y){var v=q.getAttachPosition(i.x,i.y,i.offsetX,i.offsetY),C=bs.toScreenPosition(g,v);P.x=C.x,P.y=C.y}z._edgeHostGuideInfo={corners:bs.getTargetCornersOnScreen(g,q),attach:y?y.index:-1,host:q};var O=""+i.x.toFixed(2)+", "+i.y.toFixed(2);return(i.offsetX||i.offsetY)&&(O+=" offset: "+i.offsetX.toFixed(2)+", "+i.offsetY.toFixed(2)),{host:q,anchor:i,tipText:O}}},cd.prototype._guidingToEdit=function(A,R){var g,v,D=this;if(g=D.screenInfo.curve){v=g._curves;var G,X,m,Z,t,j,U,T,o=1/0,y=1/0,C=[];for(D.editing&&"realPoint"===D.editing.type&&(T=D.editing.point),t=0,j=2*v.length;j>t;t++)U=v[Math.floor(t/2)][t%2?"_p4":"_p1"],C.indexOf(U)>=0||(C.push(U),T&&T===U||(m=U.x-A.x,Z=U.y-A.y,Math.abs(m)<Math.abs(o)?(o=m,G=[U]):m===o&&G.push(U),Math.abs(Z)<Math.abs(y)?(y=Z,X=[U]):Z===y&&X.push(U)));var w=D._interactor.getStyle("smartGuideSensitivity");if((Math.abs(o)>w||"y"===R)&&(G=null),(Math.abs(y)>w||"x"===R)&&(X=null),G||X){var d=!1,q={};if(G&&(d=!0,q.xList=G,q.x=o),X&&(d=!0,q.yList=X,q.y=y),d)return q}}},cd.prototype._46O=function(u){var f=this;f.editing&&(f.editing=null,f._interactor.fi({kind:"endEditPoint",event:u})),f._guideInfo=null,f._edgeHostGuideInfo=null,f._pan&&(f._pan=null,f._interactor.fi({kind:"endPan",event:u})),f.tipInfo=null},cd.prototype._canDeletePoint=function(x,l){var s=this.target;if(!(s instanceof C.Edge))return!0;var D=x._curves[0],g=x._curves[x._curves.length-1];return D._p1===l||g._p4===l?!1:!0},cd.prototype.handleDelete=function(){var f=this;if(f.activing&&f.screenInfo){var $=C.Default.isShiftDown(),r=f.screenInfo.curve;f._canDeletePoint(r,f.activing.point)&&r.deleteRealPoint(f.activing.point,$),f.activing.selections&&f.activing.selections.forEach(function(N){f._canDeletePoint(r,N)&&r.deleteRealPoint(N,$)}),f.activing=null,delete f.editing,delete f.tipInfo,delete f._pan,f._writeToHt(),f._interactor.fp("deleteShapePoint",!1,!0)}},cd.prototype.handleDoubleClick=function(h){var C=this,p=C._interactor._getLogicalPoint(h);if(C.screenInfo&&C._checkEditRealPoint(p)){var R=C.getCurrentSelectintStatus(),D=bs.Curve.PointType;return R=R===D.Mirrored?D.Straight:D.Mirrored,C._setCurrentSelectionStatus(R),C._interactor._42(),!0}},cd.prototype._drawHighlight=function(l){var D=this,p=D.highlight;if(p){var K=p.bezier,L=D._interactor;K&&bs.Icons.DrawIcon(L,l,bs.Icons.ShapeHighlightCurve,[K._p1.x,K._p1.y,K._p2.x,K._p2.y,K._p3.x,K._p3.y,K._p4.x,K._p4.y]);var F=p.point;F&&"insertKnot"===p.type&&bs.Icons.DrawIcon(L,l,bs.Icons.ShapeHighlighPoint,F)}},cd.prototype._drawGuide=function(Q){var U=this,t=U._guideInfo;if(t){var D,V,$,c,y=t.v;for(D=0;2>D;D++)if(c=0===D?t.xList:t.yList)for(V=0,$=c.length;$>V;V++)bs.Icons.DrawIcon(U._interactor,Q,bs.Icons.ShapeGuideLine,[y.x,y.y,c[V].x,c[V].y])}},cd.prototype._drawCurrentPoint=function(T){var l=this;if(l.activing){var K=l.activing,_=l.getCurrentSelectintStatus(),w=l._interactor;if(_!==bs.Curve.PointType.Straight){var R=K.pairs;K.hlpair,K.hltype;var h=K.selections,m=K.editingCtrl;if(R&&!h){var j,d,O;for(d=0,O=R.length;O>d;d++)j=R[d],m&&d===m.pairId&&j[m.type]?bs.Icons.DrawIcon(w,T,bs.Icons.ShapeActivingCtrl,{point:j.point,c1:j.c1,c2:j.c2,hl:m.type}):bs.Icons.DrawIcon(w,T,bs.Icons.ShapeActivingCtrl,j)}}bs.Icons.DrawIcon(w,T,bs.Icons.ShapeHighlighRealPoint,l.activing.point),h&&h.forEach(function(J){bs.Icons.DrawIcon(w,T,bs.Icons.ShapeHighlighRealPoint,J)})}},cd.prototype.clear=function(){var D=this;D.editing=null,D._guideInfo=null,D.activing=null,D.highlight=null},cd.prototype._42=function(m){var I=this;I.info={},I.editing||(I.screenInfo=null);var L=I._interactor;if(!L.editDetail)return I.clear(),void 0;var r=L.gv;if(!I.target||!r.isSelected(I.target)||!r.isVisible(I.target))return L.editDetail=!1,I.clear(),void 0;if(I.gatherSingleTarget(r,I.target),bs.Icons.DrawIcon(L,m,bs.Icons.ShapeBgCurve,I.screenInfo),I._drawHighlight(m),I._drawCurrentPoint(m),I._getRealPoint().forEach(function(o){bs.Icons.DrawIcon(L,m,bs.Icons.ShapePoint,o)}),I._drawGuide(m),I.tipInfo&&bs.Icons.DrawIcon(L,m,bs.Icons.TipHelper,I.tipInfo),I._edgeHostGuideInfo){bs.Icons.DrawIcon(L,m,bs.Icons.NodeHoverGuide,I._edgeHostGuideInfo.corners);var H=I._edgeHostGuideInfo.host;if(H){var j=r.getAttachPoints(H);if(j&&j.length)for(var o=0,G=j.length;G>o;o++){var k=j[o],v=H.getAttachPosition(k.x,k.y,k.offsetX,k.offsetY);v=bs.toScreenPosition(r,v),v.isAttach=I._edgeHostGuideInfo.attach===o,bs.Icons.DrawIcon(L,m,bs.Icons.AttachPoint,v)}}}if(I._interactor.getStyle("curveElevationVisible")&&I.target instanceof C.Polyline&&I.activing){var f=I.activing.getCurrentEditingPoint();
f&&bs.Icons.DrawIcon(L,m,bs.Icons.EdgeElevationGuide,f)}},cd.prototype._getRealPoint=function(){var I,p=this.screenInfo,R=p.P,D=p.S,b=-1,w=[],F=-1,g=D.length;return D.each(function(d){F++;var i=1;if(3===d)i=2;else if(4===d)i=3;else if(5===d)return;b+=i,I=F+1>=g?!0:1===D.get(F+1)?!0:!1,w.push({point:{x:R[2*b],y:R[2*b+1]},segmentIndex:F,pointIndex:b,isEnd:I})}),w},cd.prototype.getEditingPointsInfo=function(x){var R=this,v=R.activing;if(!v)return!1;var J=v.point;if(!J)return!1;var S=this._getRealPoint(),T=[{screen:J}];v.selections&&v.selections.forEach(function(I){T.push({screen:I})});var Q,g,h=S.length;return T.forEach(function(X){for(Q=0;h>Q;Q++)if(g=S[Q],X.screen.isNearEnough(g.point)){X.segmentIndex=g.segmentIndex,X.pointIndex=g.pointIndex,X.point=R.target.getPoints().get(g.pointIndex);break}}),x&&T.sort(function(G,x){return G.segmentIndex-x.segmentIndex}),T};var jm=bs.MoveHelper=function(E){var Z=this;Z.catalog="Move",Z._interactor=E};jm.prototype={},jm.prototype.constructor=jm,jm.prototype.calcShift=function(c,M,g){var Y,s,$=this,H=$._interactor.gv,o=H.lp(M);if("beginMove"===c&&$._gatherGridInfo(g._lastLogicalPoint||o),Y=$._target){var J=Y.downPosition;if(J){var d=$._interactor.getStyle("moveSensitivity")/H._zoom;if(J.distanceTo(o)<d)return{x:0,y:0};delete Y.downPosition}var z;s=C.Default.isShiftDown(M),s&&(o=$._dealShiftDown(o),z=Y.shiftGuide.dir);var h,b=Y.rawPos={x:Y.pos.x+o.x-Y.lp.x,y:Y.pos.y+o.y-Y.lp.y};if(C.Default.isCtrlDown(M)){if(h=$._calcShiftByAddon(),$._target.node instanceof bs.Group){var G=$._target.node;G._position.x+=h.x,G._position.y+=h.y}return h}for(var I,U=Y.x+b.x,p=Y.y+b.y,r={x:U,y:p},v={x:U+Y.w/2,y:p+Y.h/2},i={x:U+Y.w,y:p+Y.h},a=$._interactor.rectGuide,K=$._interactor.gridGuide,F=[a.findClosest(r,z),a.findClosest(v,z),a.findClosest(i,z),K.findClosest(r,z),K.findClosest(v,z),K.findClosest(i,z)],Q=1/0,N=1/0,T=0,u=F.length;u>T;T++)I=F[T],I&&(U=I.x,p=I.y,isFinite(U)&&Math.abs(U)<Math.abs(Q)&&(Q=U),isFinite(p)&&Math.abs(p)<Math.abs(N)&&(N=p));if(isFinite(Q)||(Q=0),isFinite(N)||(N=0),h=$._calcShiftByAddon(Q,N),$._target.node instanceof bs.Group){var G=$._target.node;G._position.x+=h.x,G._position.y+=h.y}var X=Y.node;if(!Kl(X,H)){var w=b.x+Q,O=b.y+N;$._interactor.rectGuide.gatherLines({node:X,x:Y.x+w,y:Y.y+O,w:Y.w,h:Y.h},z)}return h}},jm.prototype._calcShiftByAddon=function(z,j){var P=this._target,E=P.rawPos,I=P.node.getPosition();return z=z||0,j=j||0,{x:E.x-I.x+z,y:E.y-I.y+j}},jm.prototype._dealShiftDown=function(M){var c=this,V=c._target.shiftGuide,B=c._target.lp,i=Math.abs(M.x-B.x),l=Math.abs(M.y-B.y);i>l&&i>V.limit&&"y"===V.dir&&(V.dir="x"),l>i&&l>V.limit&&"x"===V.dir&&(V.dir="y");var s=V.dir;return"x"===s?(M.y=B.y,V.limit=Math.max(V.limit,i)):"y"===s&&(M.x=B.x,V.limit=Math.max(V.limit,l)),M},jm.prototype._gatherGridInfo=function(X){var r,x=this,T=x._interactor,M=T._getValidSelection();if(M.length){if(1===M.length){if(r=M[0],!r.getRect)return x._target=null,void 0}else if(r=bs.Group.findOrCreateGroup(M),!r)return x._target=null,void 0}else{var M=T.gv.sm().getSelection();if(M.length&&(r=M.get(0),!r.getRect))return x._target=null,void 0}var q=r.getPosition(),S=r.getRect();x._target={node:r,x:S.x-q.x,y:S.y-q.y,w:S.width,h:S.height,lp:{x:X.x,y:X.y},pos:{x:q.x,y:q.y},shiftGuide:{dir:"x",limit:0},downPosition:new bs.Math.Vector2(X)},T.rectGuide.gatherRects()},jm.prototype.clear=function(){var K=this;K._interactor.rectGuide.clear(),K._interactor._42()};var Hm="directional",Qi="point",Bq="spot",hi="light.color",Zr=function(Z,H){Uc(H)&&Ln.test(H)?sf(Z,H):wb(H)&&H.modelType?zr(Z,H):ec[Z]=H},Rg=function(U){if(wb(U))return U.modelType?U.uuid?ec[U.uuid]:(U.uuid=C.Math.generateUUID(),zr(U.uuid,U),V):U;var G=ec[U];return U&&G===V&&Ln.test(U)&&(Wb&&Wb[U]||sf(U,U)),G};fs(I,{graph3dViewAttributes:k,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:K/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:qp,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:K/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:Zr,getShape3dModel:Rg,createMatrix:function(y,k){sn(y)||(y=[y]);for(var Y=y.length-1;Y>=0;Y--){var c=y[Y];k=fl(c.mat,c.s3,c.r3,c.rotationMode,c.t3,k)}return k},transformVec:function(f,_){return nc(f,_)},createBoxModel:function(){return{vs:ej,ns:hg,uv:Rm,is:$e}},createRoundRectModel:function($,H){return rn.roundRect($,H)},createStarModel:function(t,L){return rn.star(t,L)},createRectModel:function(q,p){return rn.rect(q,p)},createTriangleModel:function(g,$){return rn.triangle(g,$)},createRightTriangleModel:function(C,m){return rn.rightTriangle(C,m)},createParallelogramModel:function(M,h){return rn.parallelogram(M,h)},createTrapezoidModel:function(X,P){return rn.trapezoid(X,P)},createSmoothSphereModel:function(J,X,N,o,E,P,I){return Ai(new kc(J,X,N,o,E,P,I))},createSphereModel:function(W,N,Q,x,$,o){return W?yd(W,N,Q,x,$,o):I.createSmoothSphereModel()},createSmoothConeModel:function(t,x,K,O,l){return xj(t,x,K,O,l)},createConeModel:function(K,$,e,s,W,X){return K?Tk(K,$,e,s,W,X):xj(X)},createSmoothCylinderModel:function(s,y,o,w,n,P,p,v){return Ai(new Ye(s,y,o,w,n,P,p,v))},createCylinderModel:function(c,_,d,K,u,v,Z){return c?$o(c,_,d,K,u,v,Z):Sc(v,Z)},createSmoothTorusModel:function(b,O,W,z,K,n){return Ai(new vc(b,O,W,z,K,n))},createTorusModel:function(X,O,c,o,u,j,G){return X?qh(X,O,c,o,u,j,G):gl(j,G)},createExtrusionModel:function(g,k,V,f,A,s,W,T){return Ec(g,k,V,f,A,s,W,T)},createSmoothRingModel:function(l,i,Y,$,b,k){for(var s=[],r=0;r<l.length-1;r+=2)s.push({x:l[r],y:l[r+1]});for(l=vb(s,i,Y)[0],s=[],r=0;r<l.length;r++){var y=l[r];s.push(new Ub(y.x,0,y.y))}return Ai(new Ij(s,k,$,b))},createTextGeometry:function(A,p){return Ai(new yi(A,p))},loadFontFace:function(P,j){I.xhrLoad(P,function(i){if(!i)return j();var C;try{C=JSON.parse(i)}catch(Y){C=JSON.parse(i.substring(65,i.length-2))}tp.loadFace(C),j&&j(C.familyName.toLowerCase())},j?null:{sync:!0})},createRingModel:function(S,y,Y,B,c,o,Q,O,m,h){for(var i=[],Z=0;Z<S.length-1;Z+=2)i.push({x:S[Z],y:S[Z+1]});o=o||I.shapeSide,Q=Q||0,O=O||o;var C,H,N,l,M,p,q,r,K,D,Z,V,v,A,b,$,F,f,T=[],R=[],t=m?[]:k,U=m?[]:k,s=h?[]:k,g=h?[]:k,G=B?[]:k,d=B?[]:k,z=c?[]:k,a=c?[]:k,S=vb(i,y,Y),E=Ao(S),L=0,x=2*Math.PI/o;return S.forEach(function(u){if(N=u.length,N>1){if(l=u[0],B)for(p=l.x,r=l.y,Z=Q;O>Z;Z++)V=Z+1,v=Z*x,A=V*x,b=P(v),$=e(v),F=P(A),f=e(A),G.push(b*p,r,-$*p,F*p,r,-f*p,0,r,0),d.push(.5-.5*b,.5-.5*$,.5-.5*F,.5-.5*f,.5,.5);for(D=0;N>D;D++){for(M=u[D],p=l.x,q=M.x,r=l.y,K=M.y,C=L/E,L+=wh(l,M),H=L/E,Z=Q;O>Z;Z++)V=Z+1,v=Z*x,A=V*x,b=P(v),$=e(v),F=P(A),f=e(A),T.push(b*q,K,-$*q,F*q,K,-f*q,b*p,r,-$*p,F*q,K,-f*q,F*p,r,-f*p,b*p,r,-$*p),R.push(Z/o,H,V/o,H,Z/o,C,V/o,H,V/o,C,Z/o,C),m&&Z===Q&&(t.push(0,r,0,0,K,0,b*q,K,-$*q,b*q,K,-$*q,b*p,r,-$*p,0,r,0),U.push(0,.5-r,0,.5-K,2*q,.5-K,2*q,.5-K,2*p,.5-r,0,.5-r)),h&&V===O&&(s.push(0,r,0,F*q,K,-f*q,0,K,0,F*q,K,-f*q,0,r,0,F*p,r,-f*p),g.push(1,.5-r,1-2*q,.5-K,1,.5-K,1-2*q,.5-K,1,.5-r,1-2*p,.5-r));l=M}if(c)for(p=l.x,r=l.y,Z=Q;O>Z;Z++)V=Z+1,v=Z*x,A=V*x,b=P(v),$=e(v),F=P(A),f=e(A),z.push(F*p,r,-f*p,b*p,r,-$*p,0,r,0),a.push(.5-.5*F,.5+.5*f,.5-.5*b,.5+.5*$,.5,.5)}}),{vs:T,uv:R,bottom_vs:z,bottom_uv:a,top_vs:G,top_uv:d,from_vs:t,from_uv:U,to_vs:s,to_uv:g}}},!0),fs(_,{"3d.move.mode":V,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":V,"edge.gradient.color":V,"edge.source.t3":V,"edge.target.t3":V,"light.type":Qi,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":K/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":jd,"wf.short":!1,"wf.mat":V,"wf.geometry":!1,batch:V,"transparent.mask":!1,brightness:V,"select.brightness":.7,"repeat.uv.length":V,alphaTest:.4,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","shape3d.vector.dynamic.maxsize":2048,"label.face":Vi,"label.t3":V,"label.r3":V,"label.texture.scale":2,"label.rotationMode":Lg,"label.light":!1,"label.blend":V,"label.reverse.flip":!1,"label.reverse.color":fd,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Vi,"label2.t3":V,"label2.r3":V,"label2.texture.scale":2,"label2.rotationMode":Lg,"label2.light":!1,"label2.blend":V,"label2.reverse.flip":!1,"label2.reverse.color":fd,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Vi,"note.t3":V,"note.r3":V,"note.texture.scale":2,"note.rotationMode":Lg,"note.light":!1,"note.blend":V,"note.reverse.flip":!1,"note.reverse.color":fd,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Vi,"note2.t3":V,"note2.r3":V,"note2.texture.scale":2,"note2.rotationMode":Lg,"note2.light":!1,"note2.blend":V,"note2.reverse.flip":!1,"note2.reverse.color":fd,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:V,"shape3d.color":Lo,"shape3d.top.color":V,"shape3d.bottom.color":V,"shape3d.from.color":V,"shape3d.to.color":V,"shape3d.image":V,"shape3d.top.image":V,"shape3d.bottom.image":V,"shape3d.from.image":V,"shape3d.to.image":V,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":V,"shape3d.side.to":V,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":V,"shape3d.opacity":V,"shape3d.reverse.flip":!1,"shape3d.reverse.color":fd,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":V,"shape3d.uv.scale":V,"shape3d.top.uv.offset":V,"shape3d.top.uv.scale":V,"shape3d.bottom.uv.offset":V,"shape3d.bottom.uv.scale":V,"shape3d.from.uv.offset":V,"shape3d.from.uv.scale":V,"shape3d.to.uv.offset":V,"shape3d.to.uv.scale":V,"shape3d.top.cap":V,"shape3d.bottom.cap":V,"shape3d.start.angle":0,"shape3d.sweep.angle":o,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":V,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":Lo,"all.image":V,"all.blend":V,"all.opacity":V,"all.reverse.flip":!1,"all.reverse.color":fd,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":V,"all.uv.offset":V,"all.uv.scale":V,"all.discard.selectable":!0,mat:V,"left.mat":V,"right.mat":V,"top.mat":V,"bottom.mat":V,"front.mat":V,"back.mat":V},!0);var yh,Hk=!1,Bs=[0,0,0,0],bm={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:fq,2:nb,3:Bp,4:sm,5:Vi,6:ze}},jc=function(s,t,f,w){if(t.getFaceVisible(s,f)){vi(t,_k(s,t.getFaceMat(s,f)||t.getMat(s)));var Z=t._26I;t.getFaceReverseCull(s,f)?Z.enable(Z.CULL_FACE):Z.disable(Z.CULL_FACE),xo(Z,t._prg.uFixPickReverseColor,bm[f]),Vf(Z),lp(Z,w,6),Em(Z),_r(t)}},Jd=function(z){return z instanceof Vl},Kp=function(d){return[d.x,d.e||0,d.y]},Yr=function(H,w,x){for(var w=rd(w),J=w[0],e=w[1],O=w[2];x--;)H.push(J,e,O)},Rb=function(f,d,o){for(var d=rd(d),g=d[0],I=d[1],c=d[2],a=d[3];o--;)f.push(g,I,c,a)},$p=function(R,q,Y){if(q)for(var D,T,g,F=q[0],o=q[1],B=q[2],w=q[4],L=q[5],_=q[6],l=q[8],f=q[9],P=q[10],N=q[12],a=q[13],Z=q[14],h=Y.length,M=0,M=0;h>M;M+=3)D=Y[M],T=Y[M+1],g=Y[M+2],R.push(F*D+w*T+l*g+N,o*D+L*T+f*g+a,B*D+_*T+P*g+Z);else ke(R,Y)},lr=function(j,J){var S=J.s("light.intensity"),l=rd(J.s(hi)),y=l[0],G=l[1],X=l[2];1!==S&&(y*=S,G*=S,X*=S),j.push(y,G,X,J.s("light.disabled")?1:0)},qj=function(c,k,B){xo(k,B.uHeadlightRange,c._headlightRange);var e=c._headlightIntensity,j=rd(c._headlightColor);1!==e&&(j=[j[0]*e,j[1]*e,j[2]*e]),xo(k,B.uHeadlightColor,[j[0],j[1],j[2],c._headlightDisabled?1:0]);var X=c._59O,f=c._spots,y=c._dirs;if(X.length){var Q=[],M=[],V=[];X.forEach(function(u){lr(Q,u),ke(M,c._transformPointToViewSpace(u.p3())),V.push(u.s("light.range"))}),k.uniform4fv(B.uPointColor,Q),k.uniform1fv(B.uPointRange,V),k.uniform3fv(B.uPointPosition,M)}if(f.length){var z=[],F=[],N=[],A=[],v=[],d=[];f.forEach(function(p){lr(z,p),ke(F,c._transformPointToViewSpace(p.p3())),ke(v,c._transformDirectionToViewSpace(p.p3(),p.s("light.center"))),N.push(p.s("light.range")),A.push(P(p.s("light.angle")/2)),d.push(p.s("light.exponent"))}),k.uniform4fv(B.uSpotColor,z),k.uniform1fv(B.uSpotRange,N),k.uniform1fv(B.uSpotAngle,A),k.uniform1fv(B.uSpotExponent,d),k.uniform3fv(B.uSpotPosition,F),k.uniform3fv(B.uSpotDirection,v)}if(y.length){var K=[],r=[];y.forEach(function(C){lr(K,C),ke(r,c._transformDirectionToViewSpace(C.p3()))}),k.uniform4fv(B.uDirColor,K),k.uniform3fv(B.uDirDirection,r)}},Bl=function($){return $>0&&0===($-1&$)},gm=function(I){return I=j(0,$(K,I)),I=j(Ri,$(K-Ri,I))},Ti=function(){return.05+y()/2},Yo=function(Q,e,P,C){var O,$=Q.getEye();return Q.isOrtho()?(O=rr(Q.getCenter(),$),O[0]+=C[0],O[1]+=C[1],O[2]+=C[2]):O=$,Tl(e,P,C,O)},Tl=function(Q,b,E,Y){var x=Lj(Q,b),N=rr(Y,E,!0),B=Lj(N,b);if(F(B)<Ri)return k;var z=(x-Lj(E,b))/B;return[E[0]+N[0]*z,E[1]+N[1]*z,E[2]+N[2]*z]},ml=function(V,f){return{x:2*V.x-f.x,y:2*V.y-f.y}},Pi=function(f,W,U,X){var Y,c;if(!f)return Y=q(W.y-U.y,U.x-W.x),{x:W.x+X*e(Y),y:W.y+X*P(Y)};if(!U)return Y=q(f.y-W.y,W.x-f.x),{x:W.x+X*e(Y),y:W.y+X*P(Y)};var p=rr([f.x,f.y,0],[W.x,W.y,0],!0),G=rr([U.x,U.y,0],[W.x,W.y,0],!0),n=-(p[0]+G[0])/2,k=-(p[1]+G[1])/2,m=i(n*n+k*k);if(Ri>m)return Y=q(f.y-W.y,W.x-f.x),{x:W.x+X*e(Y),y:W.y+X*P(Y)};var l=f.x-W.x,O=f.y-W.y,$=U.x-W.x,B=U.y-W.y,t=i(l*l+O*O),F=i($*$+B*B);Y=M(Lj(p,G))/2,c=p[1]*G[0]-p[0]*G[1]>0?-1:1,n/=m,k/=m;var N=X/e(Y),S=j(t,F)/P(Y);m=Math.min(N,S);var a={x:W.x+c*m*n,y:W.y+c*m*k};return U.b&&N>F/P(Y)&&(a.adjust=!0),a},gj=function(F){var J=F[1],M=F[2],C=F[3],d=F[6],u=F[7],g=F[11];F[1]=F[4],F[2]=F[8],F[3]=F[12],F[4]=J,F[6]=F[9],F[7]=F[13],F[8]=M,F[9]=d,F[11]=F[14],F[12]=C,F[13]=u,F[14]=g},ng=function(p){var $=p[0],O=p[1],X=p[2],R=p[3],H=p[4],m=p[5],q=p[6],U=p[7],G=p[8],t=p[9],E=p[10],j=p[11],C=p[12],l=p[13],r=p[14],A=p[15],J=$*m-O*H,K=$*q-X*H,i=$*U-R*H,B=O*q-X*m,b=O*U-R*m,o=X*U-R*q,v=G*l-t*C,Z=G*r-E*C,u=G*A-j*C,W=t*r-E*l,N=t*A-j*l,F=E*A-j*r,Y=J*F-K*N+i*W+B*u-b*Z+o*v;return Y?(Y=1/Y,p[0]=(m*F-q*N+U*W)*Y,p[1]=(X*N-O*F-R*W)*Y,p[2]=(l*o-r*b+A*B)*Y,p[3]=(E*b-t*o-j*B)*Y,p[4]=(q*u-H*F-U*Z)*Y,p[5]=($*F-X*u+R*Z)*Y,p[6]=(r*i-C*o-A*K)*Y,p[7]=(G*o-E*i+j*K)*Y,p[8]=(H*N-m*u+U*v)*Y,p[9]=(O*u-$*N-R*v)*Y,p[10]=(C*b-l*i+A*J)*Y,p[11]=(t*i-G*b-j*J)*Y,p[12]=(m*Z-H*W-q*v)*Y,p[13]=($*W-O*Z+X*v)*Y,p[14]=(l*K-C*B-r*J)*Y,p[15]=(G*B-t*K+E*J)*Y,void 0):k},xl=function(q,n){if(n){var Q=n[0],E=n[1],O=n[2];q[12]=q[0]*Q+q[4]*E+q[8]*O+q[12],q[13]=q[1]*Q+q[5]*E+q[9]*O+q[13],q[14]=q[2]*Q+q[6]*E+q[10]*O+q[14],q[15]=q[3]*Q+q[7]*E+q[11]*O+q[15]}},ch=function(h,v){if(v){var s=v[0],o=v[1],I=v[2];h[0]=h[0]*s,h[1]=h[1]*s,h[2]=h[2]*s,h[3]=h[3]*s,h[4]=h[4]*o,h[5]=h[5]*o,h[6]=h[6]*o,h[7]=h[7]*o,h[8]=h[8]*I,h[9]=h[9]*I,h[10]=h[10]*I,h[11]=h[11]*I}},bg=function(E,u,k){var i=u[0],A=u[1],$=u[2],V=u[3],r=u[4],J=u[5],m=u[6],O=u[7],h=u[8],L=u[9],B=u[10],D=u[11],_=u[12],H=u[13],I=u[14],j=u[15],b=k[0],e=k[1],f=k[2],S=k[3];return E[0]=b*i+e*r+f*h+S*_,E[1]=b*A+e*J+f*L+S*H,E[2]=b*$+e*m+f*B+S*I,E[3]=b*V+e*O+f*D+S*j,b=k[4],e=k[5],f=k[6],S=k[7],E[4]=b*i+e*r+f*h+S*_,E[5]=b*A+e*J+f*L+S*H,E[6]=b*$+e*m+f*B+S*I,E[7]=b*V+e*O+f*D+S*j,b=k[8],e=k[9],f=k[10],S=k[11],E[8]=b*i+e*r+f*h+S*_,E[9]=b*A+e*J+f*L+S*H,E[10]=b*$+e*m+f*B+S*I,E[11]=b*V+e*O+f*D+S*j,b=k[12],e=k[13],f=k[14],S=k[15],E[12]=b*i+e*r+f*h+S*_,E[13]=b*A+e*J+f*L+S*H,E[14]=b*$+e*m+f*B+S*I,E[15]=b*V+e*O+f*D+S*j,E},Xh=function(x,Z,f,z){var Y,M,o,$,q,W,j,u,d,J,y=Z[0],c=Z[1],E=Z[2],a=z[0],Q=z[1],k=z[2],h=f[0],A=f[1],m=f[2];return F(y-h)<Ri&&F(c-A)<Ri&&F(E-m)<Ri?Km(x):(j=y-h,u=c-A,d=E-m,J=1/i(j*j+u*u+d*d),j*=J,u*=J,d*=J,Y=Q*d-k*u,M=k*j-a*d,o=a*u-Q*j,J=i(Y*Y+M*M+o*o),J?(J=1/J,Y*=J,M*=J,o*=J):(Y=0,M=0,o=0),$=u*o-d*M,q=d*Y-j*o,W=j*M-u*Y,J=i($*$+q*q+W*W),J?(J=1/J,$*=J,q*=J,W*=J):($=0,q=0,W=0),x[0]=Y,x[1]=$,x[2]=j,x[3]=0,x[4]=M,x[5]=q,x[6]=u,x[7]=0,x[8]=o,x[9]=W,x[10]=d,x[11]=0,x[12]=-(Y*y+M*c+o*E),x[13]=-($*y+q*c+W*E),x[14]=-(j*y+u*c+d*E),x[15]=1,x)},Wp=function(j,_,m,d,g){var b=1/A(_/2),G=1/(d-g);return j[0]=b/m,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=b,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=(g+d)*G,j[11]=-1,j[12]=0,j[13]=0,j[14]=2*g*d*G,j[15]=0,j},Fe=function(J,u,o,$,E,h,Y){var G=1/(u-o),K=1/($-E),p=1/(h-Y);return J[0]=-2*G,J[1]=0,J[2]=0,J[3]=0,J[4]=0,J[5]=-2*K,J[6]=0,J[7]=0,J[8]=0,J[9]=0,J[10]=2*p,J[11]=0,J[12]=(u+o)*G,J[13]=(E+$)*K,J[14]=(Y+h)*p,J[15]=1,J},Mf=function(w,V){var Y=V[0],m=V[1],Z=V[2],Q=V[3],p=Y*Y+m*m+Z*Z+Q*Q,x=p?1/p:0;return w[0]=-Y*x,w[1]=-m*x,w[2]=-Z*x,w[3]=Q*x,w},xi=function(x,j){var G=j[0]+j[5]+j[10],V=0;return G>0?(V=2*Math.sqrt(G+1),x[3]=.25*V,x[0]=(j[6]-j[9])/V,x[1]=(j[8]-j[2])/V,x[2]=(j[1]-j[4])/V):j[0]>j[5]&j[0]>j[10]?(V=2*Math.sqrt(1+j[0]-j[5]-j[10]),x[3]=(j[6]-j[9])/V,x[0]=.25*V,x[1]=(j[1]+j[4])/V,x[2]=(j[8]+j[2])/V):j[5]>j[10]?(V=2*Math.sqrt(1+j[5]-j[0]-j[10]),x[3]=(j[8]-j[2])/V,x[0]=(j[1]+j[4])/V,x[1]=.25*V,x[2]=(j[6]+j[9])/V):(V=2*Math.sqrt(1+j[10]-j[0]-j[5]),x[3]=(j[1]-j[4])/V,x[0]=(j[8]+j[2])/V,x[1]=(j[6]+j[9])/V,x[2]=.25*V),x},Im=function(U,d,o){var T=d[0],F=d[1],N=d[2],a=d[3],I=T+T,W=F+F,Q=N+N,z=T*I,q=T*W,f=T*Q,S=F*W,M=F*Q,y=N*Q,A=a*I,n=a*W,J=a*Q;return U[0]=1-(S+y),U[1]=q+J,U[2]=f-n,U[3]=0,U[4]=q-J,U[5]=1-(z+y),U[6]=M+A,U[7]=0,U[8]=f+n,U[9]=M-A,U[10]=1-(z+S),U[11]=0,U[12]=o[0],U[13]=o[1],U[14]=o[2],U[15]=1,U},ym=function(){var X=[0,0,0],A=[0,0,0],f=[0,0,0],Q=function(F,N,z){F[0]=N[1]*z[2]-N[2]*z[1],F[1]=N[2]*z[0]-N[0]*z[2],F[2]=N[0]*z[1]-N[1]*z[0]},t=function(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]},e=function(F){var c=Math.sqrt(t(F));F[0]/=c,F[1]/=c,F[2]/=c},k=function(Z,_,m){Z[0]=_[0]-m[0],Z[1]=_[1]-m[1],Z[2]=_[2]-m[2]};return function(P,u,b){var C=cn();return k(f,P,u),0===t(f)&&(f[2]=1),e(f),Q(X,b,f),0===t(X)&&(1===Math.abs(b[2])?f[0]+=1e-4:f[2]+=1e-4,e(f),Q(X,b,f)),e(X),Q(A,f,X),C[0]=X[0],C[4]=A[0],C[8]=f[0],C[1]=X[1],C[5]=A[1],C[9]=f[1],C[2]=X[2],C[6]=A[2],C[10]=f[2],C}}(),fg=function(s,R){if(s.vr.enable){var A=s.vr.getViewMatrix(R);if(A)return A}return Xh(R?R:cn(),s._eye,s._center,s._up)},br=function(p){if(p.vr.enable){var n=p.vr.getProjectMatrix();if(n)return n}var q=p.getAspect(),r=p._near,A=p._far,x=cn();if(p._ortho){var m=p._orthoWidth/2,Q=m/q;Fe(x,-m,m,-Q,Q,r,A)}else Wp(x,p._fovy,q,r,A);return x},ri=function(C,n){if(!C)return k;var E=0,M=1,o=2,r=[],t=0,u=C.length,s=u/3;if(n){for(;u>t;t++)r[t]=0;for(t=0;t<n.length;t+=3){var y=[],S=[],J=[];y[E]=C[3*n[t+1]+E]-C[3*n[t]+E],y[M]=C[3*n[t+1]+M]-C[3*n[t]+M],y[o]=C[3*n[t+1]+o]-C[3*n[t]+o],S[E]=C[3*n[t+2]+E]-C[3*n[t+1]+E],S[M]=C[3*n[t+2]+M]-C[3*n[t+1]+M],S[o]=C[3*n[t+2]+o]-C[3*n[t+1]+o],J[E]=y[M]*S[o]-y[o]*S[M],J[M]=y[o]*S[E]-y[E]*S[o],J[o]=y[E]*S[M]-y[M]*S[E];for(var X=0;3>X;X++)r[3*n[t+X]+E]+=J[E],r[3*n[t+X]+M]+=J[M],r[3*n[t+X]+o]+=J[o]}}else for(t=0;s>t;t+=3){var y=[],S=[],J=[];y[E]=C[3*(t+1)+E]-C[3*t+E],y[M]=C[3*(t+1)+M]-C[3*t+M],y[o]=C[3*(t+1)+o]-C[3*t+o],S[E]=C[3*(t+2)+E]-C[3*(t+1)+E],S[M]=C[3*(t+2)+M]-C[3*(t+1)+M],S[o]=C[3*(t+2)+o]-C[3*(t+1)+o],J[E]=y[M]*S[o]-y[o]*S[M],J[M]=y[o]*S[E]-y[E]*S[o],J[o]=y[E]*S[M]-y[M]*S[E];for(var X=0;3>X;X++)r[3*(t+X)+E]=J[E],r[3*(t+X)+M]=J[M],r[3*(t+X)+o]=J[o]}for(t=0;u>t;t+=3){var x=[];x[E]=r[t+E],x[M]=r[t+M],x[o]=r[t+o];var a=i(x[E]*x[E]+x[M]*x[M]+x[o]*x[o]);0===a&&(a=Ri),x[E]=x[E]/a,x[M]=x[M]/a,x[o]=x[o]/a,r[t+E]=x[E],r[t+M]=x[M],r[t+o]=x[o]}return new vn(r)},Vg=function(o,e,a,B){if(a||(a=o.createTexture()),e){var i=o.TEXTURE_2D,$=o.REPEAT,O=o.CLAMP_TO_EDGE,U=o.TEXTURE_MIN_FILTER;B!==o.NEAREST&&(B=o.LINEAR),Pd(o,a),o.texImage2D(i,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,e),_q(o,o.TEXTURE_MAG_FILTER,B);var H=e.naturalWidth||e.width,D=e.naturalHeight||e.height;Bl(H)&&Bl(D)&&!e.clampToEdge?(_q(o,o.TEXTURE_WRAP_S,$),_q(o,o.TEXTURE_WRAP_T,$),_q(o,U,o.LINEAR_MIPMAP_LINEAR),o.generateMipmap(i)):(_q(o,o.TEXTURE_WRAP_S,O),_q(o,o.TEXTURE_WRAP_T,O),_q(o,U,B)),Pd(o,k)}return a},og=function(s,L){var I=new Uint8Array(3);return L=L||s.createTexture(),Pd(s,L),_q(s,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.RGB,1,1,0,s.RGB,s.UNSIGNED_BYTE,I),L},op=function(d){d._26I&&d._prg&&(d._26I.deleteProgram(d._prg),d._prg=k)},rl=function(n,H,p,K){var v=n.createShader(p);return n.shaderSource(v,K),n.compileShader(v),n.attachShader(H,v),v},Un=function(P){return P.createBuffer()},Pd=function(V,O){V.bindTexture(V.TEXTURE_2D,O)},pm=function(V,L){V.frameStack?V.frameStack.push(L):V.frameStack=[L],V.bindFramebuffer(V.FRAMEBUFFER,L)},Ie=function(r){var m=r.frameStack;if(m){if(m.pop(),m.length)return r.bindFramebuffer(r.FRAMEBUFFER,m[m.length-1]),void 0;r.frameStack=null}r.bindFramebuffer(r.FRAMEBUFFER,null)},_q=function(h,G,i){h.texParameteri(h.TEXTURE_2D,G,i)},Gp=function(t,u){t.enable(t.POLYGON_OFFSET_FILL),t.polygonOffset(u[0],u[1])},gq=function(x){x.disable(x.POLYGON_OFFSET_FILL)},lm=function(o,t){if(t){var t=rd(t);o.clearColor(t[0],t[1],t[2],t[3])}},Pm=function(T,Y){xo(T,Y.uFix,!0),jf(T,Y.aNormal)},ji=function(a,n){xo(a,n.uFix,!1),nj(a,n.aNormal)},ug=function(m,e,d,P,z,L,i,w){m._picking||(d?(xo(m,e.uBlend,!0),xo(m,e.uBlendColor,d)):xo(m,e.uBlend,!1),xo(m,e.uLight,P==k?!0:P),tg(z)&&1!==z&&xo(m,e.uPartOpacity,z),xo(m,e.uReverseFlip,L==k?!1:L),xo(m,e.uFixPickReverseColor,i||fd)),w?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE)},Fo=function(k,D){k._picking||xo(k,D.uPartOpacity,1)},Vf=function(s,k,G,t,c,T,r,Z,w){if(!G)return s.activeTexture(s.TEXTURE0),Pd(s,s._emptyTexture),s.activeTexture(s.TEXTURE1),Pd(s,s._emptyBlendTexture),void 0;xo(s,k.uTexture,!0),xo(s,k.uDiscardSelectable,Wq(t)?t:!0),nj(s,k.aUv),zj(s,c,T,k.aUv,2),w?(xo(s,k.uBlendTexture,!0),s.activeTexture(s.TEXTURE1),Pd(s,w),s.uniform1i(k.uBlendSampler,1)):(xo(s,k.uBlendTexture,!1),s.activeTexture(s.TEXTURE1),Pd(s,s._emptyBlendTexture)),s.activeTexture(s.TEXTURE0),Pd(s,G),s.uniform1i(k.uSampler,0);var o=[0,0,1,1];r&&(o[0]=r[0],o[1]=r[1]),Z&&(o[2]=Z[0],o[3]=Z[1]),xo(s,k.uOffsetScale,o)},Em=function(P,d,T){P.activeTexture(P.TEXTURE0),Pd(P,k),P.activeTexture(P.TEXTURE1),Pd(P,k),T&&(jf(P,d.aUv),xo(P,d.uTexture,!1),xo(P,d.uBlendTexture,!1))},ep=function(m,i,d,L,y,T){!d||Y||oe||m.lineWidth(d),L&&!m._picking&&xo(m,i.uFixPickReverseColor,L),y&&zj(m,y,T,i.aPosition)},eh=function(r,l,Z,p){yh&&(p=r[yh]),r.drawArrays(p==k?r.TRIANGLES:p,l,Z);var n=r._renderInfo;n&&(n.calls++,n.vertices+=Z,(p==k||p===r.TRIANGLES)&&(n.faces+=Z/3),p===r.LINES&&(n.lines+=Z/2))},lp=function(z,J,l,d){yh&&(d=z[yh]),z.drawElements(d==k?z.TRIANGLES:d,l,z.UNSIGNED_SHORT,J==k?0:2*J);var D=z._renderInfo;D&&(D.calls++,D.vertices+=l,(d==k||d===z.TRIANGLES)&&(D.faces+=l/3),d===z.LINES&&(D.lines+=l/2))},rs=function(T,R,q,U,i){var w=T.ARRAY_BUFFER;T.bindBuffer(w,R),q&&T.bufferData(w,q,T.STATIC_DRAW),U!=k&&T.vertexAttribPointer(U,i?i:3,T.FLOAT,!1,0,0)},zj=function(w,_,K,s,M){return K?(bh(w,w.ARRAY_BUFFER,_,K),s!=k&&w.vertexAttribPointer(s,M?M:3,w.FLOAT,!1,0,0),void 0):rs(w,_,K,s,M)},qq=function(r,w,F){var J=r.ELEMENT_ARRAY_BUFFER;r.bindBuffer(J,w),F&&r.bufferData(J,F,r.STATIC_DRAW)},Wd=function(L,A,t){bh(L,L.ELEMENT_ARRAY_BUFFER,A,t)},bh=function(a,n,t,k){var c=k._bufId;c||(c=k._bufId=C.Math.generateIncreasingID());var t,z=a._bufPool;(t=z[c])&&t._buf?a.bindBuffer(n,t._buf):(t=z[c]={_buf:Un(a)},a.bindBuffer(n,t._buf),a.bufferData(n,k,a.STATIC_DRAW)),t._fid=a._renderInfo.frame},xo=function(B,t,I){if(I!=k&&t!=k){I=rd(I);var Y=I.length;3===Y?B.uniform3fv(t,I):4===Y?B.uniform4fv(t,I):16===Y?B.uniformMatrix4fv(t,!1,I):Wq(I)?B.uniform1i(t,I?1:0):2===Y?B.uniform2fv(t,I):B.uniform1f(t,I)}},nj=function(h,n){n!=k&&n>=0&&h.enableVertexAttribArray(n)},jf=function(M,e){e!=k&&e>=0&&M.disableVertexAttribArray(e)},_r=function(J,v){var k=J.getGL(),b=J._prg;J._7O=J._8O.pop(),v&&(xo(k,b.uMVMatrix,J._7O),J._6O=v,xo(k,b.uNMatrix,v))},If=function(W,r){return r||(r=cn()),Ld(r,W),ng(r),gj(r),r},vi=function(V,t){var G=V.getGL(),p=V._prg,s=V._7O;t&&(V._8O.push(Te(s)),xo(G,p.uMMatrix,t),bg(s,s,t),V._7O=s),xo(G,p.uMVMatrix,s),xo(G,p.uNMatrix,If(s,V._6O))},el=function(d,v,N,p,b,w){if(N){if(p){var y=N.value++,W=2147483648|y,G=[(255&W>>16)/255,(255&W>>8)/255,(255&W)/255,(255&W>>24)/255];N[y]={data:b,part:w}}else G=Bs;return xo(d,v.uFixPickReverseColor,G),G}},Cl=function(){var M={center:function(h,v,r,_,U){var c=-v[1]/2,G={x:-v[0]/2,y:c,width:v[0],height:v[1]},k=uk(h,G,r);return[k.x+_,-k.y-U,Ti()]},front:function(u,O,I,w,J){var n=-O[1]/2,l={x:-O[0]/2,y:n,width:O[0],height:O[1]},T=uk(u,l,I);return[T.x+w,-T.y-J,O[2]/2+Ti()]},back:function(y,Z,h,N,T){var n=-Z[0]/2,R=-Z[1]/2,E={x:n,y:R,width:Z[0],height:Z[1]},f=uk(y,E,h);return[-f.x-N,-f.y-T,-Z[2]/2-Ti()]},left:function(w,A,T,q,J){var U=-A[1]/2,N={x:-A[2]/2,y:U,width:A[2],height:A[1]},F=uk(w,N,T);return[-A[0]/2-Ti(),-F.y-J,F.x+q]},right:function(W,x,n,f,Z){var S=-x[2]/2,b=-x[1]/2,z={x:S,y:b,width:x[2],height:x[1]},u=uk(W,z,n);return[x[0]/2+Ti(),-u.y-Z,-u.x-f]},top:function(s,X,v,G,T){var b={x:-X[0]/2,y:-X[2]/2,width:X[0],height:X[2]},n=uk(s,b,v);return[n.x+G,X[1]/2+Ti(),n.y+T]},bottom:function(t,U,p,J,R){var S=-U[2]/2,A={x:-U[0]/2,y:S,width:U[0],height:U[2]},e=uk(t,A,p);return[e.x+J,-U[1]/2-Ti(),-e.y-R]}};return function(F,Y,A,r,p,x){return M[r](F,Y,A,p||0,x||0)}}(),Kh=function(B,X,d,y,V,i,x,c,$,e){if(V&&(X[0]+=V[0],X[1]+=V[1],X[2]+=V[2]),xl(B,d),c){var Q=cn();if(wi(Q,$,e),nc(X,Q),xl(B,X),B.auto=c,B.pos=nc([0,0,0],B),i){var j=B.mat2=cn();wi(j,i,x)}}else wi(B,$,e),xl(B,X),y===fq?pp(B,-r):y===nb?pp(B,r):y===Bp?Hr(B,-r):y===sm?Hr(B,r):y===ze&&pp(B,K),wi(B,i,x);return B},Ud=function(q,$){var S=$.auto,C=$.mat2,Z=q.gv;if(S){var d,G=cn(),a=[0,0,0,0];d="string"==typeof S?[S.indexOf("x")<0?Z._eye[0]:Z._center[0],S.indexOf("y")<0?Z._eye[1]:Z._center[1],S.indexOf("z")<0?Z._eye[2]:Z._center[2]]:Z._eye,xi(a,Xh(cn(),d,Z._center,Z._up)),Im(G,Mf(a,a),$.pos),C&&bg(G,G,C),vi(Z,G)}else vi(Z,$)},An=function(X,x,_,w,K){var G=X.s,R=X.gv,E=R.getGL(),i=R._prg,Y=R._buffer,g=R._1O;Vg(E,rb,g),Ud(X,_),ug(E,i,G(x+".blend"),G(x+".light"),G(x+".opacity"),G(x+".reverse.flip"),G(x+".reverse.color"),G(x+".reverse.cull")),Vf(E,i,g,K,Y.uv,In),zj(E,Y.vs,w,i.aPosition),zj(E,Y.ns,Id,i.aNormal),Wd(E,Y.is,Ym),lp(E,0,Ym.length),Em(E,i,g),Fo(E,i),_r(R)},Uh=function(g,Y,G){var P=g.gv,w=g.data,c=g[Y]={blend:P.getBodyColor(w)||P.getFaceBlend(w,Y),light:P.getFaceLight(w,Y),color:P.getFaceColor(w,Y),opacity:P.getFaceOpacity(w,Y),transparent:P.getFaceTransparent(w,Y),reverseFlip:P.getFaceReverseFlip(w,Y),reverseColor:P.getFaceReverseColor(w,Y),reverseCull:P.getFaceReverseCull(w,Y),texture:P.getFaceImage(w,Y),blendTexture:P.getFaceBlendImage(w,Y),discardSelectable:P.getFaceDiscardSelectable(w,Y)};if("csg"!==Y){c.uv=P.getFaceUv(w,Y)||G&&G[Y+"Uv"],c.uvScale=P.getFaceUvScale(w,Y)||G&&G[Y+"UvScale"],c.uvOffset=P.getFaceUvOffset(w,Y)||G&&G[Y+"UvOffset"];var R=P.getFaceMat(w,Y);R&&(c.mat=_k(w,R))}return c},hr=function(H,l,r,M,S){if(M){if(!S(M.transparent))return;var X=H.data,y=H.gv,m=y._buffer,_=y.getTexture(M.texture,X),A=y.getTexture(M.blendTexture,X);Vf(l,r,_,M.discardSelectable,m.uv,M.tuv,M.uvOffset,M.uvScale,A),ug(l,r,M.blend,M.light,M.opacity,M.reverseFlip,M.reverseColor,M.reverseCull),xo(l,r.uDiffuse,M.color),zj(l,m.vs,M.vs,r.aPosition),zj(l,m.ns,M.ns,r.aNormal),eh(l,0,M.vs.length/3),Fo(l,r),Em(l,r,_)}},Om=function(U,e,y,V,O,K){var w,I,Y,H,r,f,P,h,G,t,l,c=[V-e,O-y],F=U?U.length:0;for(Y=0;F>Y;Y++){for(H=2,w=U[Y],r=w[0],f=w[1];H+1<w.length;){if(P=w[H],h=w[H+1],I=no(e,y,V,O,r,f,P,h,!0)){G=[P-r,h-f],t=wh(G),G[0]/=t,G[1]/=t,t=Lj(c,G),t=t>0?K:-K,l=[G[0]*t,G[1]*t];break}r=P,f=h,H+=2}if(l)break}if(l)for(V=e+l[0],O=y+l[1],Y=0;F>Y;Y++)for(H=2,w=U[Y],r=w[0],f=w[1];H+1<w.length;){if(P=w[H],h=w[H+1],I=no(e,y,V,O,r,f,P,h,!0))return[0,0];r=P,f=h,H+=2}return l?l:[V-e,O-y]},tq=C.graph3d={},Qn=function(H,e,w){Zi(v+".graph3d."+H,e,w)},vr="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Tj="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
fs(I,{setBatchInfo:function($,L){se[$]=L},getBatchInfo:function(N){return se[N]}},!0);var Eq=[1,1,1],Ql=[1,0,0,0,0,1,0,1,1,1,1,0],Hc=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],ab=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Gn=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],mj=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],ok=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Wl=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Qh=function(L,K){$q(L,K,"_batchModelMap","_batchIndexMap"),Kj(L,K,"_wireframeModelMap","_wireframeIndexMap"),Kj(L,K,"_polylineModelMap","_polylineIndexMap"),Kj(L,K,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Kj(L,K,"_polylineModelMapSwap","_polylineIndexMapSwap")},$q=function(D,n,s,M){if(!n)return D[s]={},D[M]={},void 0;var V=n._id,P=D[M],w=P[V];if(w){var b=D[s],m=w.batch,v=b[m],t=v.ds,R=w.index;if(v.invalidate=!0,delete P[V],t.splice(R,1),Jp(t))return delete b[m],void 0;for(var J=w.begin,u=w.size,h=3*J,H=3*u,S=4*J,z=4*u,a=v.vs,X=v.ps,Y=v.uv,T=v.cs,o=v.bs,i=v.rs,k=v.ns,Z=v.ls;R<t.length;R++)w=P[t[R]._id],w.index--,w.begin-=u;a.splice(h,H),X.splice(S,z),Y&&Y.splice(2*J,2*u),T&&T.splice(S,z),o&&o.splice(h,H),i&&i.splice(J,u),k&&k.splice(h,H),Z&&Z.splice(J,u)}},Kj=$q,Qd=function(u,G,f,p){if(!p)return k;var b=G[p];if(!b){var J=se[p]||dk,F=J.image?[]:k;b=G[p]={vs:[],ns:[],uv:F,cs:F?k:J.color?k:[],bs:J.blend?[]:k,ps:[],rs:J.brightness?[]:k,ds:[]}}return b.invalidate=!0,u[f._id]={index:b.ds.length,begin:b.vs.length/3,batch:p},b.ds.push(f),b},dg=function(g,C){return C!=k&&1!==C?[g[0]*C,g[1]*C,g[2]*C,g[3]]:g},Rc=function(G,T,z){var K=G.getBrightness(T),A=rd(z.color||"white"),n=A[3]<1,W=Math.ceil(z.width)||1,I=(n?"T":"O")+W,Z=G._wireframeIndexMap,u=G._wireframeModelMap,a=u[I];a||(a=u[I]={vs:[],cs:[],ps:[],ds:[],T:n,W:W});var x,J=G.getData3dUI(T),g=Oc(J);if(z.geometry){if(!g)return;if(x=_j(g),!x)return}else x=z.short?$r:Tr;a.invalidate=!0;var w=a.vs,U=a.cs,M=a.ds,h=Z[T._id]={index:M.length,begin:w.length/3,batch:I};M.push(T);var s=_k(T,z.mat),j=J._calcAnchorMat(T);j&&bg(s,s,j),$p(w,s,x);var L=h.size=w.length/3-h.begin;Rb(U,dg(A,K),L)},Kg=function(F,A,h,N,x,t,Z,w,E){var C=F.getBrightness(A);C==k&&(C=1);var p=dg(rd(N),C),y=p[3]<1;t=Math.ceil(t)||1;var u=(y?"T":"O")+t;if(Z){var G=Z[0],S=(Z[1]||G)+G;u+="-"+G+"-"+S,E&&(u+="-"+Ze(E)+"-"+C,E=dg(rd(E),C))}var b=F._polylineIndexMap,L=F._polylineModelMap,c=L[u];c||(c=L[u]={vs:[],cs:[],ps:[],ds:[],ls:Z?[]:k,T:y,W:t},Z&&(c.D=G,c.G=S,c.A=E)),c.invalidate=!0;var o,z=c.vs,j=c.cs,m=c.ds,r=c.ls,D=b[A._id]={index:m.length,begin:z.length/3,batch:u};m.push(A),ke(z,h);var q,l=D.size=z.length/3-D.begin,n=h.length,B=0,g=[];if(Z||x)for(o=0;n>o;o+=6)q=wh([h[o],h[o+1],h[o+2]],[h[o+3],h[o+4],h[o+5]]),g.push(q),B+=q;if(B&&x){var $,O=dg(rd(x),C),T=[O[0]-p[0],O[1]-p[1],O[2]-p[2],O[3]-p[3]],K=0;for(o=0;n>o;o+=6)$=K/B,Rb(j,[p[0]+T[0]*$,p[1]+T[1]*$,p[2]+T[2]*$,p[3]+T[3]*$],1),K+=g[o/6],$=K/B,Rb(j,[p[0]+T[0]*$,p[1]+T[1]*$,p[2]+T[2]*$,p[3]+T[3]*$],1)}else Rb(j,p,l);if(Z)for(K=w||0,o=0;n>o;o+=6)r.push(K),K+=g[o/6],r.push(K)},Tq=function(o,e,y){if(e)for(var g=4*e.begin,d=y[e.batch].ps,N=0;N<e.size;N++)d[g++]=o[0],d[g++]=o[1],d[g++]=o[2],d[g++]=o[3]},Kr=function(x,Z){var c=Z+["32"],P=x[Z],f=x[c];P?f&&f.length===P.length?(f.set(P),f._bufId=null):x[c]=new vn(P):delete x[c]},Jf=function(n,q,a,Z,s,J,y,P,Q){if(sn(a))a.forEach(function(v){Jf(n,q,v,Z,s,J,y,P,Q)});else if(Uc(a))Jf(n,q,Oc(Z,a),Z,s,J,y,P,Q);else if(wb(a)){var B,F=Sq(a.mat,q,n),H=Sq(a.s3,q,n),j=Sq(a.t3,q,n),M=Sq(a.r3,q,n);if((H||M||j||F)&&(B=fl(F,H,M,Sq(a.rotationMode,q,n),j),J.push(B)),a.shape3d)Jf(n,q,a.shape3d,Z,s,J,y,P,a);else{var m=Z.s;Q=Q||dk;var f=J[0],e=J.length,W=m("shape3d.color",a.color,Q.color);if(s||(s=m("shape3d.blend",a.blend,Q.blend)),e>1){f=Te(f);for(var $=1;e>$;$++)bg(f,f,J[$])}a.vs&&m(er,a.visible,Q.visible)&&uc(f,y,P,a.vs,a.uv,a.is,s,W),a.top_vs&&m(ek,a.topVisible,Q.topVisible)&&uc(f,y,P,a.top_vs,a.top_uv,a.top_is,s,m("shape3d.top.color",a.topColor,Q.topColor)||W),a.bottom_vs&&m(re,a.bottomVisible,Q.bottomVisible)&&uc(f,y,P,a.bottom_vs,a.bottom_uv,a.bottom_is,s,m("shape3d.bottom.color",a.bottomColor,Q.bottomColor)||W),a.from_vs&&m(Qe,a.fromVisible,Q.fromVisible)&&uc(f,y,P,a.from_vs,a.from_uv,a.from_is,s,m("shape3d.from.color",a.fromColor,Q.fromColor)||W),a.to_vs&&m(Zh,a.toVisible,Q.toVisible)&&uc(f,y,P,a.to_vs,a.to_uv,a.to_is,s,m("shape3d.to.color",a.toColor,Q.toColor)||W)}B&&J.pop()}},uc=function(f,S,F,l,g,I,B,c){var E,q=S.cs,d=S.uv,L=S.bs;if(I){E=I.length;for(var i=0;E>i;i++){var v=I[i];$p(F,f,[l[3*v],l[3*v+1],l[3*v+2]]),d&&ke(d,[g[2*v],g[2*v+1]])}}else E=l.length/3,$p(F,f,l),d&&ke(d,g);q&&Rb(q,c,E),L&&(B?Yr(L,B,E):ke(L,Eq,E))},ie=function(M,H,X,o){var h=[];o?Jf(M.gv,M.data,o,M,M.getBodyColor(),[H],X,h):(xs(M,fq,H,X,h),xs(M,nb,H,X,h),xs(M,Vi,H,X,h),xs(M,ze,H,X,h),xs(M,Bp,H,X,h),xs(M,sm,H,X,h),xs(M,"csg",H,X,h)),h.length&&(ke(X.vs,h),ke(X.ns,ri(h)))},xs=function(e,m,L,h,H){var U=e[m];if(U){var P=U.tuv;if(P){var V,X,c,w,b=U.uvScale,f=U.uvOffset;if(b)for(V=P.length,X=b[0],c=b[1],w=0;V>w;w+=2)P[w]*=X,P[w+1]*=c;if(f)for(V=P.length,X=f[0],c=f[1],w=0;V>w;w+=2)P[w]+=X,P[w+1]+=c}uc(L,h,H,U.vs,P,k,U.blend,U.color)}},oi=function(J,g,j,E,I,v,$,V){var c,R=j.cs,z=j.uv,s=j.bs;if(J.getFaceVisible(g,v)){var Q=J.getFaceMat(g,v);if(Q&&(I=_k(g,Q)),$p($,I,V),R&&Rb(R,J.getFaceColor(g,v),6),z){var C=J.getFaceUv(g,v)||E[v+"Uv"],f=J.getFaceUvScale(g,v)||E[v+"UvScale"],o=J.getFaceUvOffset(g,v)||E[v+"UvOffset"];C=C?[C[6],C[7],C[0],C[1],C[2],C[3],C[2],C[3],C[4],C[5],C[6],C[7]]:Ql;var i=C[0],D=C[1],X=C[2],K=C[3],W=C[4],S=C[5],l=C[6],Y=C[7],B=C[8],d=C[9],N=C[10],a=C[11];if(f){var b=f[0],k=f[1];i*=b,D*=k,X*=b,K*=k,W*=b,S*=k,l*=b,Y*=k,B*=b,d*=k,N*=b,a*=k}if(o){var T=o[0],U=o[1];i+=T,D+=U,X+=T,K+=U,W+=T,S+=U,l+=T,Y+=U,B+=T,d+=U,N+=T,a+=U}z.push(i,D,X,K,W,S,l,Y,B,d,N,a)}s&&(c=J.getBodyColor(g)||J.getFaceBlend(g,v),c?Yr(s,c,6):ke(s,Eq,6))}},ae=function(j,U,S,H){var s=j.getGL(),I=j._prg,g=j._buffer;if(!j.drawFilter&&!cq(U)){vi(j),Pm(s,I);for(var R in U){var W=U[R];if(!(H&&!W.T||!H&&W.T)){W.invalidate?(W.invalidate=!1,Kr(W,"vs"),Kr(W,"cs"),Kr(W,"ls"),Kr(W,"ps")):S&&Kr(W,"ps");var L=W.vs32,z=S?W.ps32:W.cs32;ep(s,I,W.W,k,g.vs,L);var a=W.D,C=!j._dashDisabled&&a;xo(s,I.uAlphaTest,_.alphaTest),C&&(xo(s,I.uDash,!0),xo(s,I.uDashDistance,a),xo(s,I.uDashGapDistance,W.G),nj(s,I.aLineDistance),zj(s,g.lineDistance,W.ls32,I.aLineDistance,1),xo(s,I.uDiffuse,W.A||dl));var P=!j._batchColorDisabled;P&&(xo(s,I.uBatchColor,!0),nj(s,I.aBatchColor),zj(s,g.batchColor,z,I.aBatchColor,4)),Vf(s),eh(s,0,L.length/3,s.LINES),Em(s),P&&(xo(s,I.uBatchColor,!1),jf(s,I.aBatchColor)),C&&(xo(s,I.uDash,!1),jf(s,I.aLineDistance))}}ji(s,I)}},tj=function(d,C,q){var A,H,e,z,m,G,U,R,p,j,M,u=d.getGL(),c=d._prg,N=d._buffer,O=d._batchModelMap;if(!cq(O)){vi(d);for(A in O)if(H=se[A]||dk,!(q&&!H.transparent||!q&&H.transparent)&&(e=O[A],C||!H.transparentMask)){var S=q&&H.autoSort!==!1&&(d._33Q||e.invalidate);if(e.invalidate?(e.invalidate=!1,Kr(e,"vs"),Kr(e,"ns"),Kr(e,"cs"),Kr(e,"rs"),Kr(e,"ps"),Kr(e,"bs"),Kr(e,"uv")):C&&Kr(e,"ps"),m=e.vs32,G=C?e.ps32:e.cs32,p=e.uv32,U=e.bs32,R=e.rs32,M=m.length/3,S&&(e.is=gp(m,d.getEye())),M){z=H.light,j=d.getTexture(H.image),ug(u,c,k,H.light,H.opacity,H.reverseFlip,H.reverseColor,H.reverseCull),G?d._batchColorDisabled||(xo(u,c.uBatchColor,!0),nj(u,c.aBatchColor),zj(u,N.batchColor,G,c.aBatchColor,4)):xo(u,c.uDiffuse,H.color||dl);var Y=H.alphaTest;xo(u,c.uAlphaTest,Y===V?_.alphaTest:Y);var n=U&&!d._batchBlendDisabled;n&&(xo(u,c.uBatchBlend,!0),nj(u,c.aBatchBlend),zj(u,N.batchBlend,U,c.aBatchBlend));var f=R&&!d._batchBrightnessDisabled;f&&(xo(u,c.uBatchBrightness,!0),nj(u,c.aBatchBrightness),zj(u,N.batchBrightness,R,c.aBatchBrightness,1)),p?Vf(u,c,j,H.discardSelectable,N.uv,p,H.uvOffset,H.uvScale):Vf(u),zj(u,N.vs,m,c.aPosition),zj(u,N.ns,e.ns32,c.aNormal),e.is?(qq(u,N.is,e.is),lp(u,0,M)):eh(u,0,M),p?Em(u,c,j):Em(u),G&&!d._batchColorDisabled&&(xo(u,c.uBatchColor,!1),jf(u,c.aBatchColor)),n&&(xo(u,c.uBatchBlend,!1),jf(u,c.aBatchBlend)),f&&(xo(u,c.uBatchBrightness,!1),jf(u,c.aBatchBrightness)),Fo(u,c)}}}},gp=function(a,c){for(var z=a.length/3,h=new Array(z),i=z/3,H=new Array(i),_=0;i>_;_++)H[_]=_;H.sort(function(Y,A){var M=9*Y,p=[(a[M]+a[M+3]+2*a[M+6])/4,(a[M+1]+a[M+4]+2*a[M+7])/4,(a[M+2]+a[M+5]+2*a[M+8])/4];M=9*A;var R=[(a[M]+a[M+3]+2*a[M+6])/4,(a[M+1]+a[M+4]+2*a[M+7])/4,(a[M+2]+a[M+5]+2*a[M+8])/4],x=wh(c,p)-wh(c,R);return x>0?-1:0>x?1:0});for(var _=0;i>_;_++){var $=3*_,p=3*H[_];h[$]=p,h[$+1]=p+1,h[$+2]=p+2}return new Df(h)},Tc={obj:function(A,X){var u={mat:A.mat,s3:A.s3,r3:A.r3,rotationMode:A.rotationMode,t3:A.t3,cube:A.cube==k?!0:A.cube,center:A.center==k?!0:A.center,ignoreMtls:A.ignoreMtls,ignoreTransparent:A.ignoreTransparent,ignoreColor:A.ignoreColor,ignoreImage:A.ignoreImage,ignoreNormal:A.ignoreNormal,prefix:A.prefix,flipY:A.flipY,flipFace:A.flipFace,reverseFlipMtls:A.reverseFlipMtls,finishFunc:function(V,c){if(V){var c=[];for(var S in V){var p=V[S];c.rawS3=p.rawS3,c.push(p),A.eachModel&&A.eachModel(S,p)}c.json=A,X(c)}else X()}};I.loadObj(A.obj,A.mtl,u)}};I.getModelTypeHandlers=function(){return Tc},I.setModelTypeHandler=function(Z,p){Tc[Z]=p},I.getModelTypeHandler=function(e){return Tc[e]},I.handleModelLoaded=function(){},I.handleUnfoundModel=function(){};var Wb=k,Jq=k,Th=function(P){Wb&&!P._loadingModelView_&&(Jq||(Jq={}),Jq[P._loadingModelView_=No()]=P)},sf=function(E,h){Wb||(Wb={});var C=Wb[E];if(C){if(C.url===h)return;C.request.onload=ql,C.request.onerror=ql}var K=new ib;if(Wb[E]={request:K,url:h},h=I.beforeLoadURL(h),h.data){var a=I.parse(h.data);zr(E,a,h)}else{K.onload=function(T){if(200===this.status||0===this.status){delete Wb[E];var P=I.parse(T.target.response||T.target.responseText);zr(E,P,h)}else mk(E,I.handleUnfoundModel(E,h)||k)},K.onerror=function(){mk(E,I.handleUnfoundModel(E,h)||k)};var X={};X.url=encodeURI(h),X.sync=!1,K.send(X)}},zr=function(D,h,v){var M=h.modelType;if(!M)return mk(D,h),I.handleModelLoaded(D,h),void 0;var t=I.getModelTypeHandler(M);if(t){if(Wb||(Wb={}),Wb[D])return;Wb[D]=!0;var c=function(i){i?(mk(D,i),I.handleModelLoaded(D,i)):mk(D,I.handleUnfoundModel(D,v)||k)};t(h,c)}else mk(D,I.handleUnfoundModel(D,v)||k)},mk=function(w,j){if(ec[w]=j,delete Wb[w],cq(Wb)&&(Wb=k,Jq)){for(var J in Jq){var t=Jq[J];t._2O&&(t._2O={}),t.invalidateAll&&t.invalidateAll(V,"modelLoaded",w),t.redraw&&t.redraw(),t.iv(),delete t._loadingModelView_}Jq=k}if(j&&Jq)for(var J in Jq){var t=Jq[J];t.invalidateAll&&t.invalidateAll(V,"modelLoading",w),t.redraw&&t.redraw(),t.iv()}},In=new vn([0,0,0,1,1,1,1,0]),Id=new vn([0,0,1,0,0,1,0,0,1,0,0,1]),Ym=new Df([0,1,2,2,3,0]),ej=new vn([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),$e=new Df([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Rm=new vn([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),hg=ri(ej,$e),Jl=(new vn([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Df([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[fq,Vi,nb,ze,Bp,sm]),Tr=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],$r=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],yd=function(H,X,r,L,_,V){V=V||16,H=H||16,X=X||0,r=r||H;var k,l,Y,M,A,W,z,D,G=.5,C=[],q=[],F=o/H,N=K/V;for(k=0;V>k;k++)for(A=k+1,M=k*N,D=A*N,l=X;r>l;l++)W=l+1,Y=l*F,z=W*F,C.push(G*e(M)*P(Y),G*P(M),-G*e(M)*e(Y),G*e(D)*P(z),G*P(D),-G*e(D)*e(z),G*e(M)*P(z),G*P(M),-G*e(M)*e(z),G*e(M)*P(Y),G*P(M),-G*e(M)*e(Y),G*e(D)*P(Y),G*P(D),-G*e(D)*e(Y),G*e(D)*P(z),G*P(D),-G*e(D)*e(z)),q.push(l/H,k/V,W/H,A/V,W/H,k/V,l/H,k/V,l/H,A/V,W/H,A/V);if(L){var Z=[],O=[];for(Y=X*F,k=0;V>k;k++)A=k+1,M=k*N,D=A*N,Z.push(0,0,0,G*e(D)*P(Y),G*P(D),-G*e(D)*e(Y),G*e(M)*P(Y),G*P(M),-G*e(M)*e(Y)),O.push(0,.5,X/H,A/V,X/H,k/V)}if(_){var b=[],m=[];for(Y=r*F,k=0;V>k;k++)A=k+1,M=k*N,D=A*N,b.push(0,0,0,G*e(M)*P(Y),G*P(M),-G*e(M)*e(Y),G*e(D)*P(Y),G*P(D),-G*e(D)*e(Y)),m.push(1,.5,r/H,k/V,r/H,A/V)}return{vs:C,uv:q,from_vs:Z,from_uv:O,to_vs:b,to_uv:m}},gl=function(L,Z,u){L=L||.17,Z=Z||12,u=u||18,0>L?L=0:L>.25&&(L=.25);var N,E,q,D,w,p,m,n=.5,X=[],H=[],t=[],W=o/u,J=o/Z,r=n-L;for(E=0;Z>=E;E++)for(D=-K+E*J,p=P(D),w=e(D),N=0;u>=N;N++)q=N*W,m=r+L*p,X.push(P(q)*m,w*L,-e(q)*m),H.push(N/u,1-E/Z);for(E=0;Z>E;E++){var T=E*(u+1),x=(E+1)*(u+1);for(N=0;u>N;N++)t.push(T+N,x+N+1,x+N,T+N,T+N+1,x+N+1)}return{vs:X,uv:H,is:t}},qh=function(v,s,u,f,J,n,c){c=c||12,v=v||18,s=s||0,u=u||v,n=n||.17,0>n?n=0:n>.25&&(n=.25);var r,B,S,H,D,_,h,p,X,m,W=.5,g=[],N=[],U=o/v,M=o/c,F=W-n;for(S=0;c>S;S++)for(H=S+1,h=-K+S*M,p=-K+H*M,r=s;u>r;r++)B=r+1,D=r*U,_=B*U,X=F+n*P(h),m=F+n*P(p),g.push(P(D)*X,e(h)*n,-e(D)*X,P(_)*X,e(h)*n,-e(_)*X,P(_)*m,e(p)*n,-e(_)*m,P(D)*X,e(h)*n,-e(D)*X,P(_)*m,e(p)*n,-e(_)*m,P(D)*m,e(p)*n,-e(D)*m),N.push(r/v,1-S/c,B/v,1-S/c,B/v,1-H/c,r/v,1-S/c,B/v,1-H/c,r/v,1-H/c);if(f){var z=[],V=[];for(S=0;c>S;S++)H=S+1,h=-K+S*M,p=-K+H*M,D=s*U,X=F+n*P(h),m=F+n*P(p),z.push(P(D)*X,e(h)*n,-e(D)*X,P(D)*m,e(p)*n,-e(D)*m,P(D)*F,0,-e(D)*F),V.push(.5+.5*P(h),.5-.5*e(h),.5+.5*P(p),.5-.5*e(p),.5,.5)}if(J){var Z=[],Q=[];for(S=0;c>S;S++)H=S+1,h=-K+S*M,p=-K+H*M,D=u*U,X=F+n*P(h),m=F+n*P(p),Z.push(P(D)*X,e(h)*n,-e(D)*X,P(D)*F,0,-e(D)*F,P(D)*m,e(p)*n,-e(D)*m),Q.push(.5-.5*P(h),.5-.5*e(h),.5,.5,.5-.5*P(p),.5-.5*e(p))}return{vs:g,uv:N,from_vs:z,from_uv:V,to_vs:Z,to_uv:Q}},Sc=function(K,V){for(var b,q,I,u=.5,g=16,H=[],d=[],a=[],Z=o/g,J=0;g>=J;J++)b=J*Z,q=P(b)*u,I=e(b)*u,H.push(q,-u,I,q,u,I),d.push(1-J/g,1,1-J/g,0);for(J=0;g>J;J++)a.push(2*J,2*J+1,2*J+3,2*J,2*J+3,2*J+2);if(V){var l=[],R=[],A=[];for(l.push(0,-u,0),R.push(.5,.5),J=0;g>=J;J++)b=J*Z,q=P(b),I=e(b),l.push(q*u,-u,-I*u),R.push(.5+.5*q,.5+.5*I);for(J=0;g>J;J++)A.push(0,J+2,J+1)}if(K){var w=[],W=[],$=[];for(w.push(0,u,0),W.push(.5,.5),J=0;g>=J;J++)b=J*Z,q=P(b),I=e(b),w.push(q*u,u,-I*u),W.push(.5+.5*q,.5-.5*I);for(J=0;g>J;J++)$.push(0,J+1,J+2)}return{vs:H,uv:d,is:a,bottom_vs:l,bottom_uv:R,bottom_is:A,top_vs:w,top_uv:W,top_is:$}},$o=function(D,Z,z,I,G,i,W){D=D||12,Z=Z||0,z=z||D;for(var O,c,m,u,Y,q,v,B,f=.5,k=[],p=[],Q=o/D,r=Z;z>r;r++)O=r+1,c=r*Q,m=O*Q,u=P(c)*f,Y=e(c)*f,q=P(m)*f,v=e(m)*f,k.push(u,-f,-Y,q,-f,-v,u,f,-Y,q,-f,-v,q,f,-v,u,f,-Y),p.push(r/D,1,O/D,1,r/D,0,O/D,1,O/D,0,r/D,0);if(W){var U=[],E=[];for(r=Z;z>r;r++)c=Q*r,m=Q*(r+1),u=P(c),Y=e(c),q=P(m),v=e(m),U.push(u*f,-f,-Y*f,0,-f,0,q*f,-f,-v*f),E.push(.5+.5*u,.5+.5*Y,.5,.5,.5+.5*q,.5+.5*v)}if(i){var S=[],N=[];for(r=Z;z>r;r++)c=Q*r,m=Q*(r+1),u=P(c),Y=e(c),q=P(m),v=e(m),S.push(u*f,f,-Y*f,q*f,f,-v*f,0,f,0),N.push(.5+.5*u,.5-.5*Y,.5+.5*q,.5-.5*v,.5,.5)}if(I){var K=[],_=[];c=Q*Z,u=P(c)*f,Y=e(c)*f,B=Z/D,K.push(0,f,0,0,-f,0,u,-f,-Y,u,-f,-Y,u,f,-Y,0,f,0),_.push(0,0,0,1,B,1,B,1,B,0,0,0)}if(G){var F=[],y=[];c=Q*z,u=P(c)*f,Y=e(c)*f,B=z/D,F.push(0,-f,0,0,f,0,u,f,-Y,u,f,-Y,u,-f,-Y,0,-f,0),y.push(1,1,1,0,B,0,B,0,B,1,1,1)}return{vs:k,uv:p,bottom_vs:U,bottom_uv:E,top_vs:S,top_uv:N,from_vs:K,from_uv:_,to_vs:F,to_uv:y}},xj=function(z,I,t,j,g){I=I||18,t=t||0,j=j==k?o:j,g=g==k?.5:g;for(var c,A,n,M,D,S,f=[0,.5,.75,.875,.9375],J=[],E=[],y=[],U=j/I,a=0;a<f.length;a++){var K=0===a%2?0:.5;for(c=0;I>=c;c++)A=(c+K)*U+t,n=1-f[a],J.push(P(A)*g*n,-g+2*f[a]*g,-e(A)*g*n),E.push((c+K)/I,n)}for(a=0;a<f.length-1;a++){var d=a*(I+1),Q=(a+1)*(I+1);for(c=0;I>c;c++)y.push(d+c,Q+c+1,Q+c,d+c,d+c+1,Q+c+1)}for(S=J.length/3-(I+1),c=0;I>c;c++)J.push(0,g,0),E.push((c+.5)/I,0);for(c=0;I>c;c++)y.push(S+c,S+c+1,S+(I+1)+c);if(z){var R=[],N=[],v=[];for(R.push(0,-g,0),N.push(.5,.5),c=0;I>=c;c++)A=c*U+t,M=P(A),D=e(A),R.push(M*g,-g,-D*g),N.push(.5+.5*M,.5+.5*D);for(c=0;I>c;c++)v.push(0,c+2,c+1)}return{vs:J,uv:E,is:y,bottom_vs:R,bottom_uv:N,bottom_is:v}},Tk=function(E,O,G,b,x,n){E=E||16,O=O||0,G=G||E;for(var a=.5,T=[],Z=[],C=o/E,W=O;G>W;W++){var M=W+1,i=C*W,w=C*M;T.push(P(i)*a,-a,-e(i)*a,P(w)*a,-a,-e(w)*a,0,a,0),Z.push(W/E,1,M/E,1,(W+M)/2/E,0)}if(n){var R=[],g=[];for(W=O;G>W;W++){i=C*W,w=C*(W+1);var D=P(i),k=e(i),B=P(w),s=e(w);R.push(D*a,-a,-k*a,0,-a,0,B*a,-a,-s*a),g.push(.5+.5*D,.5+.5*k,.5,.5,.5+.5*B,.5+.5*s)}}if(b){var X=[],V=[];i=C*O,X.push(0,a,0,0,-a,0,P(i)*a,-a,-e(i)*a),V.push(0,0,0,1,O/E,1)}if(x){var j=[],d=[];i=C*G,j.push(0,-a,0,0,a,0,P(i)*a,-a,-e(i)*a),d.push(1,1,1,0,G/E,1)}return{vs:T,uv:Z,bottom_vs:R,bottom_uv:g,from_vs:X,from_uv:V,to_vs:j,to_uv:d}},Ec=function(p,w,g,y,E,X,Y,A){for(var H=[],J=0;J<p.length-1;J+=2)H.push({x:p[J],y:p[J+1]});return Lq(H,w,g,y,E,X,Y,A,!1)},rn={roundRect:function(K,q){return Ec([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],K,q,3)},star:function(f,s){return Ec([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],f,s)},rect:function(_,Z){return Ec([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],_,Z)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(T,l){return Ec([0,-.5,.5,.5,-.5,.5],[1,2,2,5],T,l)},rightTriangle:function(Y,u){return Ec([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],Y,u)},parallelogram:function(L,W){return Ec([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],L,W)},trapezoid:function(y,x){return Ec([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],y,x)}},Le={sphere:1,cylinder:1,cone:1,torus:1},Fq={torus:1,sphere:1},dp=fs(pb(rn),{cylinder:1}),Vo=fs(pb(rn),{cylinder:1,cone:1}),qb=function(A,w,o){var L,s=Sq(A.anchor3d,o,w),V=Sq(A.mat,o,w),z=Sq(A.s3,o,w),D=Sq(A.t3,o,w),i=Sq(A.r3,o,w),m=z||i||D||V;if(s||m){L=Te(w._6O);var n=m?fl(V,z,i,Sq(A.rotationMode,o,w),D):cn();s&&xl(n,[.5-s[0],.5-s[1],.5-s[2]]),vi(w,n)}return L},Ap=function(q,b,N,Y,U,B,e){if(sn(N))N.forEach(function(c){Ap(q,b,c,Y,U,B,e)});else if(Uc(N))Ap(q,b,Oc(Y,N),Y,U,B,e);else if(wb(N))if(N.shape3d){var f=qb(N,q,b);Ap(q,b,N.shape3d,Y,U,B,N),f&&_r(q,f)}else Vh(q,b,N,Y.s,U,B,e)},Vh=function(l,K,D,Y,_,r,X){if(X=X||dk,!r||r(Y("shape3d.transparent",D.transparent,X.transparent))){var J=qb(D,l,K);pl(D);var w=l._26I,N=l._prg,H=l._buffer,u=Y("shape3d.color",D.color,X.color);_||(_=Y("shape3d.blend",D.blend,X.blend));var B,U=D.opacity==k?X.opacity:D.opacity,o=Y("shape3d.opacity");B=o!=k&&U!=k?U*o:U!=k?U:o,ug(w,N,_,Y("shape3d.light",D.light,X.light),B,Y("shape3d.reverse.flip",D.reverseFlip,X.reverseFlip),Y("shape3d.reverse.color",D.reverseColor,X.reverseColor),Y("shape3d.reverse.cull",D.reverseCull,X.reverseCull));var M=Y("polygonOffset",D.polygonOffset,X.polygonOffset);D.vs&&Y(er,D.visible,X.visible)&&Gd(w,N,H,u,l.getTexture(Y("shape3d.image",D.image,X.image),K),Y("shape3d.discard.selectable",D.discardSelectable,X.discardSelectable),D.vs,D.uv,D.ns,D.is,Y("shape3d.uv.offset",D.uvOffset,X.uvOffset),Y("shape3d.uv.scale",D.uvScale,X.uvScale),M),D.top_vs&&Y(ek,D.topVisible,X.topVisible)&&Gd(w,N,H,Y("shape3d.top.color",D.topColor,X.topColor)||u,l.getTexture(Y("shape3d.top.image",D.topImage,X.topImage),K),Y("shape3d.top.discard.selectable",D.topDiscardSelectable,X.topDiscardSelectable),D.top_vs,D.top_uv,D.top_ns,D.top_is,Y("shape3d.top.uv.offset",D.topUvOffset,X.topUvOffset),Y("shape3d.top.uv.scale",D.topUvScale,X.topUvScale),M),D.bottom_vs&&Y(re,D.bottomVisible,X.bottomVisible)&&Gd(w,N,H,Y("shape3d.bottom.color",D.bottomColor,X.bottomColor)||u,l.getTexture(Y("shape3d.bottom.image",D.bottomImage,X.bottomImage),K),Y("shape3d.bottom.discard.selectable",D.bottomDiscardSelectable,X.bottomDiscardSelectable),D.bottom_vs,D.bottom_uv,D.bottom_ns,D.bottom_is,Y("shape3d.bottom.uv.offset",D.bottomUvOffset,X.bottomUvOffset),Y("shape3d.bottom.uv.scale",D.bottomUvScale,X.bottomUvScale),M),D.from_vs&&Y(Qe,D.fromVisible,X.fromVisible)&&Gd(w,N,H,Y("shape3d.from.color",D.fromColor,X.fromColor)||u,l.getTexture(Y("shape3d.from.image",D.fromImage,X.fromImage),K),Y("shape3d.from.discard.selectable",D.fromDiscardSelectable,X.fromDiscardSelectable),D.from_vs,D.from_uv,D.from_ns,D.from_is,Y("shape3d.from.uv.offset",D.fromUvOffset,X.fromUvOffset),Y("shape3d.from.uv.scale",D.fromUvScale,X.fromUvScale),M),D.to_vs&&Y(Zh,D.toVisible,X.toVisible)&&Gd(w,N,H,Y("shape3d.to.color",D.toColor,X.toColor)||u,l.getTexture(Y("shape3d.to.image",D.toImage,X.toImage),K),Y("shape3d.to.discard.selectable",D.toDiscardSelectable,X.toDiscardSelectable),D.to_vs,D.to_uv,D.to_ns,D.to_is,Y("shape3d.to.uv.offset",D.toUvOffset,X.toUvOffset),Y("shape3d.to.uv.scale",D.toUvScale,X.toUvScale),M),Fo(w,N),J&&_r(l,J)}},Gd=function(D,j,b,i,K,p,B,g,R,h,H,u,S){B&&(S&&Gp(D,S),xo(D,j.uDiffuse,i),g?Vf(D,j,K,p,b.uv,g,H,u):Vf(D),zj(D,b.vs,B,j.aPosition),zj(D,b.ns,R,j.aNormal),h?(Wd(D,b.is,h),lp(D,0,h.length)):eh(D,0,B.length/3),g?Em(D,j,K):Em(D),S&&gq(D))},Oc=function(H,G){var l=H.s;if(G||(G=l(il)),!G)return k;var q=Rg(G);if(q)return q;if("text"===G){var M={amount:l("shape3d.text.amount"),size:l("shape3d.text.size"),font:l("shape3d.text.font"),style:l("shape3d.text.style"),weight:l("shape3d.text.weight"),fill:l("shape3d.text.fill"),curveSegments:l("shape3d.text.curveSegments"),spacing:l("shape3d.text.spacing")},L=H.gv.getShape3dText(H.data),K=L;for(var O in M)K+="_"+(M[O]===V?"U":M[O]);return H._cachedTextKey===K?H._cachedTextGeometry:(H._cachedTextKey=K,H._cachedTextGeometry=I.createTextGeometry(L,M))}var O=G;if(Le[G]){var D=l("shape3d.side"),y=l("shape3d.side.from"),W=l("shape3d.side.to"),t=l(Qe),T=l(Zh);3>D?(D=0,y=0,W=0,t=!1,T=!1):((y==k||0>y)&&(y=0),(W==k||W>D)&&(W=D),0===y&&W===D&&(t=!1,T=!1)),O+="-"+D+"-"+y+"-"+W+"-"+t+"-"+T}if(dp[G]){var o=l(ek);O+="-"+o}if(Vo[G]){var E=l(re);O+="-"+E}if("torus"===G){var Y=l("shape3d.torus.radius");0>Y?Y=0:Y>.25&&(Y=.25),O+="-"+Y}if(Fq[G]){var w=l(zs);O+="-"+w}return q=bc[O],q||("box"===G?q=I.createBoxModel():rn[G]?q=rn[G](o,E):"sphere"===G?q=I.createSphereModel(D,y,W,t,T,w):G===zk?q=I.createCylinderModel(D,y,W,t,T,o,E):"cone"===G?q=I.createConeModel(D,y,W,t,T,E):"torus"===G&&(q=I.createTorusModel(D,y,W,t,T,Y,w)),bc[O]=q),q},pl=function(){var E=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],v=["is","top_is","bottom_is","from_is","to_is"];return u=Xk(vr.substr(vr.indexOf("^#")+2)),Se(I[sl(Zl+E[15]+"n"+E[16])]())&&$d()?function(e){e&&!e._complete_&&(e._complete_=!0,e.vs&&Jp(e.ns)&&(e.ns=ri(e.vs,e.is)),e.top_vs&&Jp(e.top_ns)&&(e.top_ns=ri(e.top_vs,e.top_is)),e.bottom_vs&&Jp(e.bottom_ns)&&(e.bottom_ns=ri(e.bottom_vs,e.bottom_is)),e.from_vs&&Jp(e.from_ns)&&(e.from_ns=ri(e.from_vs,e.from_is)),e.to_vs&&Jp(e.to_ns)&&(e.to_ns=ri(e.to_vs,e.to_is)),E.forEach(function(I){var m=e[I];sn(m)&&(e[I]=new vn(m))}),v.forEach(function(V){var O=e[V];sn(O)&&(e[V]=new Df(O))}))}:void 0}(),ic=function(V,l){var w=V[l];sn(w)&&(V[l]=new vn(w))};fs(bi,{_25Q:function(u){u._16O=function(Y,x,P,M,F,Z,$,h,B){var H=this.info;if(H){var y,N,p,R,w,S,E=cn();if(dn[x]?(y=H.p3,N=H.c1,p=H.c2):Vd[x]?(N=H.s1||H.c1,p=H.s2||H.c2):(N=H.t1||H.c1,p=H.t2||H.c2),y)S=Cl(x,wk,P,M,h,B);else{var O=rr(p,N),K=wh(N,p);R=[0,-q(O[2],O[0]),D(O[1]/K)],w="zyx",y=[(N[0]+p[0])/2,(N[1]+p[1])/2,(N[2]+p[2])/2],S=Cl(x,[K,0,0],P,M,h,B)}return Kh(E,S,y,M,F,Z,$,Y,R,w)}return Yi},u._80o=function(e,k,T){var u=this,E=u.shapeModel;if(E){var K=u.gv;vi(K),Ap(K,u.data,E,u,u.getBodyColor(),T)}},u.createLineModel=function(i,d,U,c,m){for(var B=this,P=B.s,l=Gj(i,d,P(zs)),H=[],j=0;j<l.length;j++){var M=l[j],C=M.length;if(C>1){var y=M[0];H.push(y.x,y.y,y.z);for(var D=1;C-1>D;D++)y=M[D],H.push(y.x,y.y,y.z),H.push(y.x,y.y,y.z);y=M[C-1],H.push(y.x,y.y,y.z)}}var o,$,W,I=P(c+".color"),Z=P(m),t=0;return Z&&($=P(m+".color"),o=P(m+".pattern"),t=P(m+".offset"),W=I),Kg(B.gv,B.data,H,$||I,W?k:P(c+".gradient.color"),U,o||P(c+".pattern"),t,W),l},u.createTubeModel=function(J,Z,n,M){for(var S=this,$=S.s,G=$("shape3d.side")||$f,h=$("shape3d.start.angle"),u=$("shape3d.sweep.angle"),x=$(ek)?$("shape3d.top.cap"):k,t=$(re)?$("shape3d.bottom.cap"):k,s="flat"===x,R="flat"===t,T=s&&(M?M.uv:$("shape3d.top.image")),Q=R&&(M?M.uv:$("shape3d.bottom.image")),i=M?M.uv:$("shape3d.image"),B={vs:[],uv:i?[]:k,top_vs:s?[]:k,top_uv:T?[]:k,bottom_vs:R?[]:k,bottom_uv:Q?[]:k},f=Gj(J,Z,$(zs),n),A=0,m=f.length;m>A;A++)Ag(B,f[A],$(dd),n,G,h,u,x,t);if(M){var a=[];Jf(S.gv,S.data,B,S,S.getBodyColor(),[],M,a),a.length&&(ke(M.vs,a),ke(M.ns,ri(a)))}else S.shapeModel=B;return f},u.getCache=function(){var H=this.info;if(H){var N=H.list;if(N){var T=H.cache;return T||(T=H.cache=Dg(N)),T}}return k}}});var jn=function(X,$){for(var A,Z=0,y=X.length,F=0,N=y-1;N>=F;)if(Z=E(F+(N-F)/2),A=X[Z].length-$,0>A)F=Z+1;else{if(!(A>0)){N=Z;break}N=Z-1}Z=N;var s=X[Z],z=s.point;return Z===y-1||s.length===$||(z=(new Ub).subVectors(X[Z+1].point,z).normalize().multiplyScalar($-s.length).add(z)),{point:z,tangent:s.tangent}},Dg=function(I){for(var y,N,k=[],E=0,j=0;j<I.length;j++){for(var m=I[j],T=0;T<m.length;T++){y=m[T],N&&(E+=N.distanceTo(y));var U=new Ub,g=m[T+1];g?U.subVectors(g,y):N?U.subVectors(y,N):U.x=1,U.normalize(),k.push({point:y,length:E,tangent:U}),N=y}N=null}return k},Gj=function(Q,T,E,W){E=E||yo;for(var q=[],o=0,c=Q.size();c>o;o++){var l=Q.get(o);q.push(new Ub(l.x,l.e||0,l.y))}T&&(Zq(T)&&(T=T._as),T.length||(T=null));for(var s,v,Y,Z,j,h=[],K=0,B=0,V=T?T.length:c;V>B;B++)if(j=T?T[B]:0===B?1:2,1===j)h.push(Y=[]),Y.push(q[K++]);else if(2===j||5===j)if(Z=2===j?q[K++]:Y[0],W){var x=T?T[B+1]:V>B+1?2:k;if(2===x||5===x){var g=Y[Y.length-1],S=2===x?q[K]:Y[0],A=(new Ub).subVectors(g,Z),u=(new Ub).subVectors(S,Z),R=A.length(),G=u.length();if(R&&G)if(W>R/2&&W>G/2)Y.push(Z);else for(A.multiplyScalar($(W,R/2)/R).add(Z),u.multiplyScalar($(W,G/2)/G).add(Z),s=new Tf(A,Z,u).getPoints(E),v=0;E>=v;v++)Y.push(s[v])}else Y.push(Z)}else Y.push(Z);else if(3===j)for(s=new Tf(Y[Y.length-1],q[K++],q[K++]).getPoints(E),v=1;E>=v;v++)Y.push(s[v]);else if(4===j)for(s=new Tg(Y[Y.length-1],q[K++],q[K++],q[K++]).getPoints(E),v=1;E>=v;v++)Y.push(s[v]);return h},Zg=function(C){for(var I,X,Y=new Ub,k=[],p=[],x=[],v=0,T=C.length;T>v;v++)I=C[v],X=C[v+1],X?Y.subVectors(X,I):Y.subVectors(I,C[v-1]),k.push(Y.normalize().clone());var g,q,s,_,f=new Ub,c=new Ub,N=new Bj,D=1e-4,z=Number.MAX_VALUE,V=k[0],e=p[0]=new Ub,A=x[0]=new Ub;for(q=F(V.x),s=F(V.y),_=F(V.z),z>=q&&(z=q,f.set(1,0,0)),z>=s&&(z=s,f.set(0,1,0)),z>=_&&f.set(0,0,1),c.crossVectors(V,f).normalize(),e.crossVectors(V,c),A.crossVectors(V,e),v=1;T>v;v++)p[v]=p[v-1].clone(),x[v]=x[v-1].clone(),c.crossVectors(k[v-1],k[v]),c.length()>D&&(c.normalize(),g=M(iq(k[v-1].dot(k[v]),-1,1)),p[v].applyMatrix4(N.makeRotationAxis(c,g))),x[v].crossVectors(k[v],p[v]);return{B:x,T:k,N:p}},Ag=function(){var b=function(k){for(var K=1;K<arguments.length;K++){var G=arguments[K];k.push(G.x,G.y,G.z)}},c=function(w){for(var s=1;s<arguments.length;s++){var c=arguments[s].uv;w.push(c[0],c[1])}},W=function(R,l,k,Y,t){var c=-Y*P(t),X=Y*e(t);return new Ub(R.x+c*k.x+X*l.x,R.y+c*k.y+X*l.y,R.z+c*k.z+X*l.z)},h=function(Y,U,u,J,G,h,j,q){j=j||o;for(var D=[],g=j/G,x=0;G>=x;x++){var B=W(Y,U,u,J,x*g+h);D.push(B),q!=k&&(B.uv=[q,x/G])}return D},E=function(d,R,a,k,Y,c,h,$,D){D=D||o;var U=R?d.top_vs:d.bottom_vs;if(U)for(var m=R?d.top_uv:d.bottom_uv,V=D/h,l=0;h>l;l++){var H,I;R?(H=l*V+$,I=(l+1)*V+$):(I=l*V+$,H=(l+1)*V+$),b(U,W(a,k,Y,c,H),W(a,k,Y,c,I),a),m&&m.push(.5-.5*P(H),.5-.5*e(H),.5-.5*P(I),.5-.5*e(I),.5,.5)}};return function(I,T,d,a,A,x,O,L,s){var K=T.length;if(K>1){var M,H,f,l,J,o,U,Z=Zg(T),m=Z.T,G=Z.N,W=Z.B;"flat"===L&&E(I,!0,T[0],W[0],G[0],a,A,x,O),"flat"===s&&E(I,!1,T[K-1],W[K-1],G[K-1],a,A,x,O);var r,F,y=[],X=g(A/2),p="round"===L,e="round"===s,D=T[0],_=m[0],q=W[0],t=G[0],z=T[K-1],Q=m[K-1],u=W[K-1],C=G[K-1];if(p){for(f=1;X>=f;f++)G.splice(0,0,t),W.splice(0,0,q),m.splice(0,0,_),F=-f/X*a,T.splice(0,0,_.clone().multiplyScalar(F).add(D)),y[X-f]=i(a*a-F*F);K+=X}if(e){for(f=1;X>=f;f++)G.push(C),W.push(u),m.push(Q),F=f/X*a,T.push(Q.clone().multiplyScalar(F).add(z)),y[T.length-1]=i(a*a-F*F);K+=X}if(I.uv){var w=0,R=0,B=[];for(d&&(w=d),J=T[0],B[0]=0,f=1;K>f;f++)l=T[f],B[f]=J.distanceTo(l),J=l,d||(w+=B[f]);for(r=[],f=0;K>f;f++)R+=B[f],r[f]=w?R/w:0}for(f=0;K>f;f++){if(l=T[f],o=W[f],U=G[f],M=h(l,o,U,y[f]===V?a:y[f],A,x,O,r?r[f]:k),H)for(var P=0;A>P;P++){var $=H[P],n=H[P+1]||H[0],S=M[P],j=M[P+1]||M[0];b(I.vs,n,$,S,S,j,n),I.uv&&c(I.uv,n,$,S,S,j,n)}H=M}}}}();fs(I,{getLineLength:function(E){return E[E.length-1].length},getLineOffset:function(D,T){return jn(D,T)},getLineCacheInfo:function(m,R,L,k){return Dg(Gj(m,R,L,k))}});var Qm=C.graph3d.RenderLite={},Mk=new ArrayBuffer(0),Jm=Qm.Buffer=function(K,j,u,f){this.gl=K,this.buffer=K.createBuffer(),this.type=j||K.ARRAY_BUFFER,this.drawType=f||K.STATIC_DRAW,this.data=Mk,u&&this.upload(u)};Jm.prototype.upload=function(_,P,s){s||this.bind();var G=this.gl;_=_||this.data,P=P||0,this.data.byteLength>=_.byteLength?G.bufferSubData(this.type,P,_):G.bufferData(this.type,_,this.drawType),this.data=_},Jm.prototype.bind=function(){var C=this.gl;C.bindBuffer(this.type,this.buffer)},Jm.createVertexBuffer=function(j,y,o){return new Jm(j,j.ARRAY_BUFFER,y,o)},Jm.createIndexBuffer=function(T,n,t){return new Jm(T,T.ELEMENT_ARRAY_BUFFER,n,t)},Jm.create=function(O,e,F,i){return new Jm(O,e,i)},Jm.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var vg=Qm.Shader=function(X,u,S){this.gl=X,this.program=Ce(X,u,S),this.attributes=Ul(X,this.program);var x=Vk(X,this.program);this.uniforms=mg(X,x)};vg.prototype.bind=function(){this.gl.useProgram(this.program)},vg.prototype.destroy=function(){this.gl};var Ce=function(I,D,n){var X=Gg(I,I.VERTEX_SHADER,D),y=Gg(I,I.FRAGMENT_SHADER,n);I.getShaderParameter(y,I.COMPILE_STATUS)||console.error(I.getError());var V=I.createProgram();return I.attachShader(V,X),I.attachShader(V,y),I.linkProgram(V),I.getProgramParameter(V,I.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",I.getProgramParameter(V,I.VALIDATE_STATUS)),console.error("gl.getError()",I.getError()),""!==I.getProgramInfoLog(V)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",I.getProgramInfoLog(V)),I.deleteProgram(V),V=null),I.deleteShader(X),I.deleteShader(y),V},Gg=function(L,Z,E){var A=L.createShader(Z);return L.shaderSource(A,E),L.compileShader(A),L.getShaderParameter(A,L.COMPILE_STATUS)?A:(console.log(L.getShaderInfoLog(A)),null)},Vk=function(H,t){for(var D={},y=H.getProgramParameter(t,H.ACTIVE_UNIFORMS),v=0;y>v;v++){var $=H.getActiveUniform(t,v),o=$.name.replace(/\[.*?\]/,""),Q=Ed(H,$.type);D[o]={type:Q,size:$.size,location:H.getUniformLocation(t,o),value:Wj(Q,$.size)}}return D},Ul=function(z,C){for(var P={},V=z.getProgramParameter(C,z.ACTIVE_ATTRIBUTES),H=0;V>H;H++){var c=z.getActiveAttrib(C,H),e=Ed(z,c.type);P[c.name]={type:e,size:Eh(e),gl:z,location:z.getAttribLocation(C,c.name),pointer:oj}}return P},oj=function(Q,N,f,j,V){var q=this.gl;q.enableVertexAttribArray(this.location),q.bindBuffer(Q.type,Q.buffer),q.vertexAttribPointer(this.location,this.size,N||q.FLOAT,f||!1,j||0,V||0)},Eh=function(l){return ns[l]},ns={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Ed=function(S,h){if(!rj){var u=c.keys(dc);
rj={};for(var Q=0;Q<u.length;++Q){var l=u[Q];rj[S[l]]=dc[l]}}return rj[h]},rj=null,dc={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Wj=function(A,G){switch(A){case"float":return 0;case"vec2":return new Float32Array(2*G);case"vec3":return new Float32Array(3*G);case"vec4":return new Float32Array(4*G);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*G);case"ivec3":return new Int32Array(3*G);case"ivec4":return new Int32Array(4*G);case"bool":return!1;case"bvec2":return bb(2*G);case"bvec3":return bb(3*G);case"bvec4":return bb(4*G);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},bb=function(M){for(var Q=new Array(M),e=0;e<Q.length;e++)Q[e]=!1;return Q},mg=function(j,g){var C={data:{}};C.gl=j;for(var v=c.keys(g),D=0;D<v.length;D++){var $=v[D],r=$.split("."),I=r[r.length-1],B=En(r,C),f=g[$];B.data[I]=f,B.gl=j,c.defineProperty(B,I,{get:zl(I),set:Fl(I,f)})}return C},zl=function(t){var d=qk.replace("%%",t);return new Function(d)},Fl=function(E,H){var k,O=kk.replace(/%%/g,E);return k=1===H.size?cr[H.type]:Bk[H.type],k&&(O+="\nthis.gl."+k+";"),new Function("value",O)},En=function(o,r){for(var P=r,C=0;C<o.length-1;C++){var g=P[o[C]]||{data:{}};P[o[C]]=g,P=g}return P},qk=["return this.data.%%.value;"].join("\n"),kk=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),cr={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Bk={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Vl=C.Light=function(){uj(Vl,this),this.s(hi,_[hi]),this.s(il,"sphere"),this.s3(20,20,20)};zo("Light",gd,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(_,N,w){Vl.superClass.onStyleChanged.apply(this,arguments),_===hi&&this.s("shape3d.color",w)}});var yj=tq.Graph3dView=function(r,u){var C=this;C._attributes=u||I.graph3dViewAttributes,C._25I={},C._view=Hb(1,C);var L=C._canvas=os(C._view);L.addEventListener("webglcontextlost",function(r){r.preventDefault(),op(C),C._26I&&C._doBufferGC(C._26I,!0),C._26I=k,C._1o.texture=k,C._35O=!0},m),L.addEventListener("webglcontextrestored",function(){C._35O=!1,C.iv()},m),C._batchIndexMap={},C._batchModelMap={},C._wireframeIndexMap={},C._wireframeModelMap={},C._wireframeIndexMapSwap={},C._wireframeModelMapSwap={},C._polylineIndexMap={},C._polylineIndexMap={},C._polylineIndexMapSwap={},C._polylineIndexMapSwap={},C._8O=[],C._7O=cn(),C._6O=cn(),C._1o=new cf(C),C._30O=new Vp(C),C._31O=new Re(C),C._32O=new mp(C),C._raycaster=new Yk(C),C._highlightHelper=new qe(C),C._postProcessing=new rm(C),C.vr=new wj(C),C._33Q=!0,C._eye=pb(I.graph3dViewEye),C._center=pb(I.graph3dViewCenter),C._up=pb(I.graph3dViewUp),C._lightChanged=!1,C._59O=[],C._spots=[],C._dirs=[],C._frameId=0,C.overlappingBox=new Dc(C),C.dm(r?r:new $b),C._coreInteractor=new Ib(this),C.setInteractors([new Mg(C)])},fc={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},Yb=0;Qn("Graph3dView",c,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Lp,ci,"firstPersonMode",wd,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Zp,Op,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:I.graph3dViewEditHelperDisabled,_devicePixelRatio:V,_boundaries:V,_moveStep:I.graph3dViewMoveStep,_rotateStep:I.graph3dViewRotateStep,_pannable:I.graph3dViewPannable,_rotatable:I.graph3dViewRotatable,_walkable:I.graph3dViewWalkable,_resettable:I.graph3dViewResettable,_zoomable:I.graph3dViewZoomable,_firstPersonMode:I.graph3dViewFirstPersonMode,_mouseRoamable:I.graph3dViewMouseRoamable,_gridVisible:I.graph3dViewGridVisible,_gridSize:I.graph3dViewGridSize,_gridGap:I.graph3dViewGridGap,_gridColor:I.graph3dViewGridColor,_originAxisVisible:I.graph3dViewOriginAxisVisible,_centerAxisVisible:I.graph3dViewCenterAxisVisible,_axisXColor:I.graph3dViewAxisXColor,_axisYColor:I.graph3dViewAxisYColor,_axisZColor:I.graph3dViewAxisZColor,_ortho:I.graph3dViewOrtho,_orthoWidth:I.graph3dViewOrthoWidth,_fovy:I.graph3dViewFovy,_near:I.graph3dViewNear,_far:I.graph3dViewFar,_headlightColor:I.graph3dViewHeadlightColor,_headlightIntensity:I.graph3dViewHeadlightIntensity,_headlightRange:I.graph3dViewHeadlightRange,_headlightDisabled:I.graph3dViewHeadlightDisabled,_rectSelectable:I.graph3dViewRectSelectable,_rectSelectBackground:I.graph3dViewRectSelectBackground,_editSizeColor:I.graph3dViewEditSizeColor,_autoMakeVisible:km,_fogDisabled:I.graph3dViewFogDisabled,_fogColor:I.graph3dViewFogColor,_fogNear:I.graph3dViewFogNear,_fogFar:I.graph3dViewFogFar,_dashDisabled:I.graph3dViewDashDisabled,_batchColorDisabled:I.graph3dViewBatchColorDisabled,_batchBlendDisabled:I.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:I.graph3dViewBatchBrightnessDisabled,setEye:function(y,d,L){1===arguments.length&&(d=y[1],L=y[2],y=y[0]);var t=this._eye;t[0]=y,t[1]=d,t[2]=L,this.fp(Zp,k,t)},setCenter:function(E,p,F){1===arguments.length&&(p=E[1],F=E[2],E=E[0]);var t=this._center;t[0]=E,t[1]=p,t[2]=F,this.fp(Op,k,t)},setUp:function(F,C,m){1===arguments.length&&(C=F[1],m=F[2],F=F[0]);var d=this._up;d[0]=F,d[1]=C,d[2]=m,this.fp("up",k,d)},getDevicePixelRatio:function(){return this._devicePixelRatio||Wg},isTransparentMask:function(j){return j.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var F=this,t=F._aspect;return t?t:(t=F.getWidth()/F.getHeight(),t||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(Q){var P=this,G=P._dataModel,q=P._selectionModel;G!==Q&&(G&&(G.ump(P.handleDataModelPropertyChange,P),G.umm(P.handleDataModelChange,P),G.umd(P.handleDataPropertyChange,P),q||G.sm().ums(P.handleSelectionChange,P)),P._dataModel=Q,Q.mp(P.handleDataModelPropertyChange,P),Q.mm(P.handleDataModelChange,P),Q.md(P.handleDataPropertyChange,P),q?q._21I(Q):Q.sm().ms(P.handleSelectionChange,P),P._postProcessing.handleDataModleChange(G,Q),P.invalidateAll(!0),P.invalidateLight(),P.fp(Jc,G,Q),P._canvas.style.background=Q.getBackground()||"")},handleDataModelPropertyChange:function(k){if("background"===k.property){var x=this._canvas.style.background,b=k.newValue||"";this._canvas.style.background=b,this.fp("canvasBackground",x,b)}else"envmap"===k.property&&this.iv()},handleDataPropertyChange:function($){var a=$.data;this.invalidateData(a),Jd(a)&&"s:light.type"===$.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(G){var i=this,j=G.property;i.iv(),i._18Q=k,"eye"===j?i._33Q=!0:"devicePixelRatio"===j?i._42(k,i.getDevicePixelRatio()):fc[j]&&op(i)},_5O:function(s){var b=s._22Q();return b?new b(this,s):k},getData3dUI:function(N){var C=this._25I[N._id];return C===V&&(C=this._5O(N),this._25I[N._id]=C),C},invalidateAll:function($){var B=this;if($){for(var t in B._25I){var b=B._25I[t];b&&b.dispose()}B._25I={},B.iv(),Qh(B)}else Qh(B),B.dm().each(function(j){B.invalidateData(j)})},invalidateSelection:function(){var v=this;v.sm().each(function(X){v.invalidateData(X)})},invalidateData:function(w){var x=this,h=x.getData3dUI(w);h&&(h.iv(),x.iv()),Qh(x,w)},getShape3dText:function(J){return J.getStyle("shape3d.text")||this.getLabel(J)},invalidateBatch:function(W){var m=this,O=m._batchModelMap,c=O[W],U=[],a={};if(c){c.ds.forEach(function(K){var E=m.getData3dUI(K);E&&E.iv(),delete m._batchIndexMap[K._id],U.push(K._id)}),delete O[W];for(var X,Z,x,Y,I,G,E,i,R,J=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],C=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],t=0;t<J.length;t++){var D=m[J[t]],f=m[C[t]];for(a={},i=0;i<U.length;i++){var p=f[U[i]];if(p){delete f[U[i]],R=p.batch,X=D[R];var k=p.begin,v=p.size,u=3*k,Q=3*v,s=4*k,S=4*v;for(Z=X.ds,x=X.vs,Y=X.cs,I=X.ps,G=X.ls,E=p.index,X.invalidate=!0,Z[E]=V,E=u;u+Q>E;E++)x[E]=V;for(E=s;s+S>E;E++)Y[E]=V;for(E=s;s+S>E;E++)I[E]=V;if(G)for(E=u;u+Q>E;E++)G[E]=V;a[R]=!0}}for(R in a){X=D[R],Z=X.ds,x=X.vs,Y=X.cs,I=X.ps,G=X.ls;var o=[];for(E=0;E<Z.length;E++)Z[E]!==V&&o.push(Z[E]);if(0===o.length)delete D[R];else{for(X.ds=o,o=[],E=0;E<x.length;E++)x[E]!==V&&o.push(x[E]);for(X.vs=o,o=[],E=0;E<Y.length;E++)Y[E]!==V&&o.push(Y[E]);for(X.cs=o,o=[],E=0;E<I.length;E++)I[E]!==V&&o.push(I[E]);if(X.ps=o,G){for(o=[],E=0;E<G.length;E++)G[E]!==V&&o.push(G[E]);X.ls=o}}}}m.iv()}},handleDataModelChange:function(O){var V=this,Q=O.kind,J=O.data;if("add"===Q)V.invalidateData(J),hk(J)&&J.getEdgeGroup()&&J.getEdgeGroup().eachSiblingEdge(V.invalidateData,V),Jd(J)&&V.invalidateLight();else if(Q===ro){var p=J._id,i=V._25I[p];i&&(i.dispose(),delete V._25I[p],V.iv()),J===V._currentSubGraph&&V.setCurrentSubGraph(k),Qh(V,J),Jd(J)&&V.invalidateLight()}else Q===Ef&&(V.invalidateAll(!0),V.setCurrentSubGraph(k),Qh(V),V.invalidateLight())},toCanvas:function(F,q,V){var z=this,w=z.getGL();if(z.validate(),F){var a=w.getParameter(w.COLOR_CLEAR_VALUE);lm(w,F)}z._42(k,1);var T=z.getWidth(),W=z.getHeight(),P=new Uint8Array(4*T*W),R=os(),L=R.getContext("2d");w.readPixels(0,0,T,W,w.RGBA,w.UNSIGNED_BYTE,P),Oi(R,T,W,1);for(var p=L.getImageData(0,0,T,W),C=p.data,i=0;i<C.length;i+=4){var X=i/4,S=E(X/T),J=X-S*T;X=4*((W-1-S)*T+J),C[X]=P[i],C[X+1]=P[i+1],C[X+2]=P[i+2],C[X+3]=P[i+3]}if(L.putImageData(p,0,0),F&&lm(w,a),z._42(k,z.getDevicePixelRatio()),q&&V){var G=os(),U=G.getContext("2d");return q=q,V=V,Oi(G,q,V,1),I.drawImage(U,R,0,0,q,V),G}return R},toDataURL:function(S,R){var J=this,q=J.getGL();if(J.validate(),S){var b=q.getParameter(q.COLOR_CLEAR_VALUE);lm(q,S)}J._42(k,1);var o=J._canvas.toDataURL(R||"image/png",1);return S&&lm(q,b),J._42(k,J.getDevicePixelRatio()),o},getGL:function(){var R=this,h=R._26I;if(R._prg,!h)try{R._2O={},h=R._26I=R._canvas.getContext("webgl",R._attributes)||R._canvas.getContext("experimental-webgl",R._attributes),h._emptyTexture=og(h),h._emptyBlendTexture=og(h),h._bufPool={},h._id=++Yb,R._buffer={vs:Un(h),ns:Un(h),is:Un(h),uv:Un(h),batchColor:Un(h),batchBlend:Un(h),batchBrightness:Un(h),lineDistance:Un(h)},R._1O=Vg(h);var v=R._cube={vs:Un(h),ns:Un(h),is:Un(h),uv:Un(h)};rs(h,v.vs,ej),rs(h,v.ns,hg),rs(h,v.uv,Rm),qq(h,v.is,$e)}catch(O){}return R.acquireProgram(),h},acquireProgram:function(){var T=this,d=T._26I;if(d){var I=C.Default.getImage(T.dm().getEnvmap())?!0:!1,M=T._prg&&T._prg.envMapFlag?!0:!1;if(!T._prg||I!==M){var x=T._prg=d.createProgram();if(!x)return k;x.envMapFlag=I;var X=T._dirs.length,G=T._spots.length,O=T._59O.length,N=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];X&&N.push("uDirColor","uDirDirection"),G&&N.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),O&&N.push("uPointColor","uPointRange","uPointPosition"),lm(d,[0,0,0,0]),d.clearDepth(1),d.enable(d.DEPTH_TEST),d.depthFunc(d.LEQUAL),d.enable(d.BLEND),d.blendFuncSeparate(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA,d.ONE,d.ONE_MINUS_SRC_ALPHA),Hk||(vr=Xk(vr.substring(0,vr.indexOf("^#"))),Tj=Xk(Tj),Hk=!0);var Q=["#define MAX_DIR "+X,"#define MAX_SPOT "+G,"#define MAX_POINT "+O,T._fogDisabled?"":"#define FOG",T._dashDisabled?"":"#define DASH",I?"#define USE_ENVMAP":"",T._batchColorDisabled?"":"#define BATCHCOLOR",T._batchBlendDisabled?"":"#define BATCHBLEND",T._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),S=rl(d,x,d.VERTEX_SHADER,vr.replace("PREFIX",Q));d.getShaderParameter(S,d.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",d.getShaderInfoLog(S));var f=rl(d,x,d.FRAGMENT_SHADER,Tj.replace("PREFIX",Q));d.getShaderParameter(f,d.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",d.getShaderInfoLog(f)),Y?N.push("aPosition"):(x.aPosition=0,d.bindAttribLocation(x,0,"aPosition")),d.linkProgram(x),N.forEach(function(r){x[r]=/^u/.test(r)?d.getUniformLocation(x,r):d.getAttribLocation(x,r)}),d.useProgram(x),d.deleteShader(S),d.deleteShader(f)}}},getBrightness:function(g){var $=g.s("brightness"),U=this.isSelected(g)?g.s("select.brightness"):k;return $==k?U:U==k?$:$*U},bindEnvMap:function(P){var K=this,$=K._prg,Z=5,I=K.dm().getEnvmap(),v=C.Default.getImage(I);if(v){if(I!==K._lastEnvMap){K._envMapTexture&&P.deleteTexture(K._envMapTexture);var J=K._envMapTexture=P.createTexture();P.bindTexture(P.TEXTURE_CUBE_MAP,J),P.texParameteri(P.TEXTURE_CUBE_MAP,P.TEXTURE_MAG_FILTER,P.LINEAR),P.texParameteri(P.TEXTURE_CUBE_MAP,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texImage2D(P.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,v),P.texImage2D(P.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,v),P.texImage2D(P.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,v),P.texImage2D(P.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,v),P.texImage2D(P.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,v),P.texImage2D(P.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,v),P.bindTexture(P.TEXTURE_CUBE_MAP,null),K._lastEnvMap=I}P.activeTexture(P.TEXTURE0+Z),P.bindTexture(P.TEXTURE_CUBE_MAP,K._envMapTexture),P.uniform1i($.uEnvMap,Z)}},getWireframe:function(b){var M=b.s("wf.visible"),U=b.s("wf.width");return M===!0||U>0&&"selected"===M&&this.isSelected(b)?{color:b.s("wf.color"),width:U,"short":b.s("wf.short"),mat:b.s("wf.mat")}:void 0},_transformPointToViewSpace:function(q){var s=[q[0],q[1],q[2]];return nc(s,this._viewMatrix),s},_transformDirectionToViewSpace:function(S,w){var k=[S[0],S[1],S[2]];nc(k,this._viewMatrix);var i=w?[w[0],w[1],w[2]]:[0,0,0];nc(i,this._viewMatrix);var B=i[0]-k[0],e=i[1]-k[1],I=i[2]-k[2],n=Math.sqrt(B*B+e*e+I*I);return n?[B/n,e/n,I/n]:[B,e,I]},getWireframeGeometry:function(i){return i.s("wf.geometry")?{color:i.s("wf.color"),width:i.s("wf.width"),mat:i.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(t){return t.s("body.color")},getMat:function(i){return i.getMat?i.getMat():i.s("mat")},getFaceMat:function(N,C){return N.getFaceMat?N.getFaceMat(C):N.s(C+".mat")},getFaceBlend:function(k,G){return k.s(G+".blend")||k.s("all.blend")},getFaceColor:function(f,V){return f.s(V+".color")||f.s("all.color")},getFaceImage:function(L,c){return L.s(c+".image")||L.s("all.image")},getFaceBlendImage:function(O,r){return O.s(r+".blend.image")||O.s("all.blend.image")},getFaceDiscardSelectable:function(z,r){var b=z.s(r+".discard.selectable");return b==k?z.s("all.discard.selectable"):b},getFaceUv:function(h,Q){return h.s(Q+".uv")||h.s("all.uv")},getFaceUvOffset:function(k,i){return k.s(i+".uv.offset")||k.s("all.uv.offset")},getFaceUvScale:function(g,$){return g.s($+".uv.scale")||g.s("all.uv.scale")},getFaceLight:function(i,H){var n=i.s(H+".light");return n==k?i.s("all.light"):n},getFaceVisible:function(M,y){var K=M.s(y+".visible");return K==k?M.s("all.visible"):K},getFaceOpacity:function(V,E){var y=V.s(E+".opacity");return y==k?V.s("all.opacity"):y},getFaceTransparent:function(U,V){var b=U.s(V+".transparent");return b==k?U.s("all.transparent"):b},getFaceReverseColor:function(t,K){return t.s(K+".reverse.color")||t.s("all.reverse.color")},getFaceReverseFlip:function(q,u){var z=q.s(u+".reverse.flip");return z==k?q.s("all.reverse.flip"):z},getFaceReverseCull:function(F,$){var Y=F.s($+".reverse.cull");return Y==k?F.s("all.reverse.cull"):Y},getTextureMap:function(){return this._2O},deleteTexture:function(y){var M=this,E=M._2O[y];E&&(delete M._2O[y],M.getGL().deleteTexture(E))},invalidateShape3dCachedImage:function(c){var I=this.getData3dUI(c);I.invalidateCachedTexture(this.getGL())},isInteractive:function(p){return p.s("interactive")},getTexture:function(U,V){if(!U)return k;var r=this,w=r.getGL(),y=r._2O[U];if(!y){var x=Ne(U);if(x)if(x.tagName){if(x.dynamic)return Vg(w,x,r._1O);y=r._2O[U]=Vg(w,x)}else{var e,K=V&&V.s("shape3d.image.cache")&&!r.isInteractive(V),l=r.vr.isPresenting();l&&(V._textureUpdateFrame===w._renderInfo.frame?K=!0:V._textureUpdateFrame=w._renderInfo.frame),K&&(e=r.getData3dUI(V),y=e.getCachedTexture());var $;if(!y){var G=V&&V.s("shape3d.fixSizeOnScreen"),S=G?w.NEAREST:w.LINEAR;G||V&&V.s("shape3d.vector.dynamic")&&(e||(e=r.getData3dUI(V)),G=e.getVectorDynamicSize(),G&&($=r.getDevicePixelRatio(),G[0]*=$,G[1]*=$));var J,t,z=V&&V.s("shape3d.texture.scale")||1;if(G?($||($=r.getDevicePixelRatio()),J=G[0]>0?G[0]:z*Or(x,V)*$,t=G[1]>0?G[1]:z*fb(x,V)*$):(J=z*Or(x,V),t=z*fb(x,V)),J>=1&&t>=1){var Q=Mn(J,t);if(!e&&V&&(e=r.getData3dUI(V)),e&&e.interactiveInfo){var B=U;"object"==typeof B&&(B=B.uuid||(B.uuid=C.Math.generateUUID()));var h=e.interactiveInfo[B]={};Q.interactiveInfo=h.bodyInfo={compInfos:[],matrix:new sq,rect:{x:0,y:0,width:J,height:t}}}Gb(Q,x,0,0,J,t,V,r),Q.interactiveInfo&&(Q.interactiveInfo=null),Q.restore(),(K||l)&&kg(x,V)?(y=Vg(w,rb,null,S),e.setCachedTexture(y),rb=null):y=Vg(w,rb,r._1O,S)}}}}return y},redraw:function(){this.iv()},validateImpl:function(){var S=this;if(S._lightChanged){S._lightChanged=!1;var V=[],t=[],F=[];S.dm().each(function(K){if(Jd(K)){var R=K.s("light.type");R===Qi?V.push(K):R===Bq?t.push(K):R===Hm&&F.push(K)}}),(V.length!==S._59O.length||t.length!==S._spots.length||F.length!==S._dirs.length)&&op(S),S._59O=V,S._spots=t,S._dirs=F}S._42(),S._1o.iv()},getRenderInfo:function(){var C=this.getGL();return C?C._renderInfo:void 0},showDebugTip:function(){var A=this,k=A._debugDiv;if(!k){k=A._debugDiv=b.createElement("div"),k.style.position="absolute",k.style.overflow="hidden",k.style.backgroundColor="white",k.style.color="black";var s=A.getView();A._79O?s.insertBefore(k,A._79O):s.appendChild(k),A._debugTipTimerId=setInterval(function(){var i=A.getRenderInfo();if(i){var N=A.getGL()._validBufCount||0,B="Draw Calls: "+i.calls+"<br/>"+"Vertices: "+i.vertices+"<br/>"+"Faces: "+i.faces+"<br/>"+"Lines: "+i.lines+"<br/>"+"Buffer Count: "+N;A.vr.isPresenting()&&(B+="<br/>VR fps: "+A.vr.getFps()),k.innerHTML=B}},10)}},hideDebugTip:function(){var J=this,k=J._debugDiv;k&&(delete J._debugDiv,cancelAnimationFrame(J._debugTipTimerId),delete J._debugTipTimerId,J.getView().removeChild(k))},_42:function(M,R){var V=this;if(!V._35O&&(!jh||Mr(jh))){var D,A;M&&(M instanceof gd?A=M:D=M);var X=V._canvas,i=V.getGL(),K=V._prg;if(i){var l=V.getWidth(),B=V.getHeight();R?M||Oi(X,l,B,R):(R=V.getDevicePixelRatio(),M||l===X.clientWidth&&B===X.clientHeight||Oi(X,l,B,R)),i.clear(i.COLOR_BUFFER_BIT),i._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:M?V._frameId:++V._frameId};var L=function(){if(V.overlappingBox.clear(),V._81O=k,i.clear(i.DEPTH_BUFFER_BIT),xo(i,K.uBrightness,1),xo(i,K.uOpacity,1),xo(i,K.uPartOpacity,1),i._picking=!!M,xo(i,K.uPick,!!M),xo(i,K.uTexture,!1),xo(i,K.uBlendTexture,!1),xo(i,K.uAlphaTest,_.alphaTest),xo(i,K.uTransparent,!1),xo(i,K.uFix,!1),xo(i,K.uBatchColor,!1),xo(i,K.uBatchBlend,!1),xo(i,K.uBatchBrightness,!1),xo(i,K.uReflectivity,V._envmapReflectivity||.5),xo(i,K.uCameraPosition,V.getEye()),xo(i,K.uPMatrix,V._projectMatrix=br(V)),xo(i,K.uViewMatrix,fg(V,V._7O)),V.bindEnvMap(i),V._viewMatrix=Te(V._7O),M||(qj(V,i,K),V._fogDisabled||(xo(i,K.uFogColor,V._fogColor),xo(i,K.uFogNear,V._fogNear),xo(i,K.uFogFar,V._fogFar))),nj(i,K.aPosition),nj(i,K.aNormal),jf(i,K.aUv),jf(i,K.aBatchColor),jf(i,K.aBatchBlend),jf(i,K.aBatchBrightness),jf(i,K.aLineDistance),A){var U=i.getParameter(i.COLOR_CLEAR_VALUE);i.clearColor(0,0,0,0),i.disable(i.BLEND),jf(i,K.aNormal),rs(i,V._cube.vs,k,K.aPosition),qq(i,V._cube.is),jc(A,V,fq,0),jc(A,V,Vi,6),jc(A,V,nb,12),jc(A,V,ze,18),jc(A,V,Bp,24),jc(A,V,sm,30),nj(i,K.aNormal),lm(i,U)}else if(D){D.value=2;var U=i.getParameter(i.COLOR_CLEAR_VALUE);i.clearColor(0,0,0,0),i.disable(i.BLEND),V._95I(i,K,D),tj(V,D),ae(V,V._polylineModelMap,D),ae(V,V._wireframeModelMap,D),xo(i,K.uTransparent,!0),V._95I(i,K,D,!0),tj(V,D,!0),ae(V,V._polylineModelMap,D,!0),ae(V,V._wireframeModelMap,D,!0),xo(i,K.uTransparent,!1),i.clear(i.DEPTH_BUFFER_BIT),V._swapLineMap(),V._95I(i,K,D,!1,!0),ae(V,V._polylineModelMap,D),ae(V,V._wireframeModelMap,D),V._swapLineMap(),V._swapLineMap(),V._95I(i,K,D,!1,!0),ae(V,V._polylineModelMap,D),ae(V,V._wireframeModelMap,D),xo(i,K.uTransparent,!0),V._95I(i,K,D,!0,!0),ae(V,V._polylineModelMap,D,!0),ae(V,V._wireframeModelMap,D,!0),xo(i,K.uTransparent,!1),V._swapLineMap(),i.disable(i.DEPTH_TEST),V.drawFilter||V._30O._42(i,K,D),i.enable(i.DEPTH_TEST),lm(i,U)}else i.disable(i.BLEND),V.drawSky(i,K),V._31O._42(i,K),V._95I(i,K),tj(V),ae(V,V._polylineModelMap),ae(V,V._wireframeModelMap),i.enable(i.BLEND),xo(i,K.uTransparent,!0),i.depthMask(!1),V._95I(i,K,k,!0),tj(V,k,!0),ae(V,V._polylineModelMap,k,!0),ae(V,V._wireframeModelMap,k,!0),i.depthMask(!0),xo(i,K.uTransparent,!1),i.clear(i.DEPTH_BUFFER_BIT),V._swapLineMap(),i.disable(i.BLEND),V._95I(i,K,k,!1,!0),ae(V,V._polylineModelMap),ae(V,V._wireframeModelMap),i.enable(i.BLEND),xo(i,K.uTransparent,!0),i.depthMask(!1),V._95I(i,K,k,!0,!0),ae(V,V._polylineModelMap,k,!0),ae(V,V._wireframeModelMap,k,!0),i.depthMask(!0),xo(i,K.uTransparent,!1),V._swapLineMap(),i.disable(i.DEPTH_TEST),i.disable(i.BLEND),V._32O._42(i,K),V._30O._42(i,K),V._highlightHelper._42(i,K),i.enable(i.DEPTH_TEST);rs(i,k),qq(i,k)},d=!1,J=l*R,u=B*R,P=V.vr;P.enable&&P._42(i,J,u,L)&&(d=!0);var C=V.envRenderer;C&&C.enable&&C._42(i,J,u,L)&&(d=!0);var w=V._postProcessing;w._42(i,J,u,L,M)&&(d=!0),d||(V.setViewport(i,0,0,l*R,B*R),L()),V._33Q=!1,V._doBufferGC(i)}}},enablePostProcessing:function(o,Y){return this._postProcessing.enableModule(o,Y)},getPostProcessingModule:function(b){return this._postProcessing.getModule(b)},setViewport:function(O,n,A,C,H){this._viewport=[n,A,C,H],O.viewport(n,A,C,H)},getViewport:function(){return this._viewport},setBufferGCInterval:function(m){this._bufferGCInterval=m},_doBufferGC:function(l,_){var k,b,u=l._bufPool,$=0,x=0,t=l._renderInfo.frame,M=this._bufferGCInterval||10;for(k in u)$++,b=u[k],b&&(_||t-b._fid>M?(l.deleteBuffer(b._buf),b._buf=null,u[k]=null):x++);if($/2>x&&$>128){var n={};for(k in u)u[k]&&(n[k]=u[k]);l._bufPool=n}l._validBufCount=x},_swapLineMap:function(){var P=this;W=P._polylineModelMap,P._polylineModelMap=P._polylineModelMapSwap,P._polylineModelMapSwap=W,W=P._wireframeModelMap,P._wireframeModelMap=P._wireframeModelMapSwap,P._wireframeModelMapSwap=W,W=P._polylineIndexMap,P._polylineIndexMap=P._polylineIndexMapSwap,P._polylineIndexMapSwap=W,W=P._wireframeIndexMap,P._wireframeIndexMap=P._wireframeIndexMapSwap,P._wireframeIndexMapSwap=W},_updateSkyBox:function(i){if(this._skyBox&&i){var f=i.property,M=!1,o=this._skyBox;if("eye"===f||"forceUpdate"===f){var l=this._eye;o.p3(l[0],l[1],l[2]),M=!0}if("near"===f||"far"===f||"forceUpdate"===f){var F=this._near,v=this._far,C=o.getFinalScale3d();if(C[0]/=2,C[1]/=2,C[2]/=2,C[0]<=F||C[0]>=v||C[1]<=F||C[1]>=v||C[2]<=F||C[2]>=v){var Z=2*F*v/(F+v),N=Math.min(C[0],C[1],C[2]),G=Z/N,k=o.getScale3d();o.setScale3d(k[0]*G,k[1]*G,k[2]*G),M=!0}}M&&this.invalidateData(o)}},setSkyBox:function(s){var r=this._skyBox;r&&this._skyBoxStyleMap&&(r.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null),this._skyBox=s,this.ump(this._updateSkyBox,this),s&&(s.dm()&&s.dm().remove(s),this._skyBoxStyleMap=C.Default.clone(s.getStyleMap()),s.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",r,s)},drawSky:function(u,f,b){var N=this,e=N._skyBox;if(e){var H=N._headlightIntensity,G=rd(N._headlightColor),f=N._prg;1!==H&&(G=[G[0]*H,G[1]*H,G[2]*H]),xo(u,f.uHeadlightColor,[G[0],G[1],G[2],1]);var z=N.getData3dUI(e);z&&z._42(u,f,b,function(){return!0}),u.clear(u.DEPTH_BUFFER_BIT),xo(u,f.uHeadlightColor,[G[0],G[1],G[2],N._headlightDisabled?1:0])}},_95I:function(m,y,M,O,$){function I(G){if(!!G.s("shape3d.alwaysOnTop")==!!$&&i.isVisible(G)&&(!a||U)){if(!M&&i.isTransparentMask(G))return;var E=i.getData3dUI(G);E&&E._42(m,y,M,w)}}var i=this,w=function(w){return O?w:!w};i.sky&&m.clear(m.DEPTH_BUFFER_BIT);var o=i.drawFilter;o?i.dm().each(function(U){o(U)||I(U)}):i.dm().each(function(C){I(C)})},getLogicalPoint:function(T){return Iq(T,this._canvas)},isRectOverlapping:function(D){var j=this.getData3dUI(D);return j._rectOverlapping},getHitFaceInfo:function(s){s.target&&(s=this.lp(s));var v=this.getDataInfoAt(s);if(v){var j=this._1o.face(v.data,pe(s.x,s.y));if(j)return{data:v.data,face:j}}return k},unproject:function(M,A){var j=this,R=j.getWidth(),K=j.getHeight(),L=M.target?j.lp(M):M,e=L.x-R/2,Y=L.y-K/2,a=2*(e/R),X=2*(-1*Y/K);A=A||0;var o=cn(),P=br(j),g=fg(j);bg(o,P,g),ng(o);var t=dr([a,X,A,1],o);return[t[0]/t[3],t[1]/t[3],t[2]/t[3]]},getDataAt:function(H){var v=this.getDataInfoAt(H);return v?v.data:k},getDataInfoAt:function($,i){return $.target&&($=this.lp($)),this._1o.get(pe($.x,$.y,i),!0)},getDatasInRect:function(W){return this._1o.get(W)},setEditable:function(j){var E=this,X=E._editable;E._editable=j,this.fp(Tn,X,j)},isEditable:function($){var p=this;return p._editable?tn($)?$.s("3d.editable")?p._editableFunc?p._editableFunc($):!0:!1:!1:!1},isSelectable:function(O){return O.s("3d.selectable")&&this.sm().isSelectable(O)},isMovable:function(I){var q=this;return hk(I)&&I.getStyle(fp)!==Rh?!1:I.s("3d.movable")?q._movableFunc?q._movableFunc(I):!0:!1},isSizeEditable:function(v){return tn(v)?this._sizeEditableFunc?this._sizeEditableFunc(v):!0:!1},isRotationEditable:function(v){return tn(v)&&v.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(v):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(j){this.setZoom(ni,j)},zoomOut:function(Z){this.setZoom(1/ni,Z)},setZoom:function(r,f){if(1!==r){var B=this;if(B._ortho)return B.setOrthoZoom(r,f),void 0;B._14o&&B._14o.stop(!0);var w=1/r,p=B._eye,q=B._center,M=q[0]+(p[0]-q[0])*w-p[0],n=q[1]+(p[1]-q[1])*w-p[1],j=q[2]+(p[2]-q[2])*w-p[2];if(!(wh(p,q)<B._moveStep&&1>w)){if(f=rg(f)){var V=pb(p);return f.action=function(_){B.fi({kind:B._zooming?"betweenZoom":"beginZoom"}),B._zooming=1,p[0]=V[0]+M*_,p[1]=V[1]+n*_,p[2]=V[2]+j*_,B.fp(Zp,k,p)},f._37o=function(){delete B._14o,delete B._zooming,B.fi({kind:"endZoom"}),B.onZoomEnded()},B._14o=Yl(f)}p[0]+=M,p[1]+=n,p[2]+=j,B.fp(Zp,k,p)}}},setOrthoZoom:function(Q,j){if(1!==Q){var E=this;E._14o&&E._14o.stop(!0);var a=E._orthoWidth,f=a/Q-a;if(!(a<E._moveStep&&Q>1))return(j=rg(j))?(j.action=function(U){E.fi({kind:E._zooming?"betweenZoom":"beginZoom"}),E._zooming=1,E.setOrthoWidth(a+f*U)},j._37o=function(){delete E._14o,delete E._zooming,E.fi({kind:"endZoom"}),E.onZoomEnded()},E._14o=Yl(j)):(E.setOrthoWidth(a/Q),void 0)}},getPositionInfo:function(x){var l=this,F=l._eye,w=l._center,H=l.getAspect(),$=x?Lj(rr(w,F,!0),rr(x,F)):wh(F,w);if(l._ortho){var b=l._orthoWidth;return{length:$,height:b/H,width:b}}var Y=2*A(l._fovy/2)*$;return{length:$,height:Y,width:Y*H}},getCenterInfo:function(){var F=this;return F._81O||(F._81O=F.getPositionInfo()),pb(F._81O)},rotate:function(j,J,n,I){var N=this;if(j||J){I==k&&(I=N._firstPersonMode),N._88O&&N._88O.stop(!0);var X=N._center,v=N._eye,z=N.getCenterInfo().length,V=I?X:v,w=I?v:X,M=rr(V,w),x=q(M[0],M[2]),l=q(i(M[0]*M[0]+M[2]*M[2]),M[1]),R=I?Op:Zp;return I&&(J=-J),(n=rg(n))?(n.action=function(b){N.fi({kind:N._rotating?"betweenRotate":"beginRotate"}),N._rotating=1;var Z=x+j*b,q=l+J*b;q=gm(q),M[0]=z*e(q)*e(Z),M[1]=z*P(q),M[2]=z*e(q)*P(Z),V[0]=w[0]+M[0],V[1]=w[1]+M[1],V[2]=w[2]+M[2],N.fp(R,k,V)},n._37o=function(){delete N._88O,delete N._rotating,N.fi({kind:"endRotate"}),N.onRotateEnded()},N._88O=Yl(n)):(x+=j,l+=J,l=gm(l),M[0]=z*e(l)*e(x),M[1]=z*P(l),M[2]=z*e(l)*P(x),V[0]=w[0]+M[0],V[1]=w[1]+M[1],V[2]=w[2]+M[2],N.fp(R,k,V),void 0)}},pan:function(g,U,P,K){if(g||U){var h=this;K==k&&(K=h._firstPersonMode),h._89O&&h._89O.stop(!0);var V=fg(h),E=[V[0]*g,V[4]*g,V[8]*g],m=[V[1]*U,V[5]*U,V[9]*U],w=E[0]+m[0],t=E[1]+m[1],H=E[2]+m[2],Q=h._center,$=h._eye;if(K){var O=Om(h.getBoundaries(),$[0],$[2],$[0]+w,$[2]+H,i(w*w+H*H));w=O[0],H=O[1]}if(P=rg(P)){var A=pb($),N=pb(Q);return P.action=function(o){h.fi({kind:h._panning?"betweenPan":"beginPan"}),h._panning=1,Q[0]=N[0]+w*o,Q[1]=N[1]+t*o,Q[2]=N[2]+H*o,$[0]=A[0]+w*o,$[1]=A[1]+t*o,$[2]=A[2]+H*o,h.fp(Zp,k,$),h.fp(Op,k,Q)},P._37o=function(){delete h._89O,delete h._panning,h.fi({kind:"endPan"}),h.onPanEnded()},h._89O=Yl(P)}Q[0]+=w,Q[1]+=t,Q[2]+=H,$[0]+=w,$[1]+=t,$[2]+=H,h.fp(Zp,k,$),h.fp(Op,k,Q)}},walk:function(t,e,C){if(t){var f=this;C==k&&(C=f._firstPersonMode),f._90O&&f._90O.stop(!0);var E=f._center,i=f._eye,K=rr(E,i,!0);if(C){var s=Om(f.getBoundaries(),i[0],i[2],i[0]+K[0]*t,i[2]+K[2]*t,F(t));if(t=wh(s),!t)return;K=[s[0]/t,0,s[1]/t]}if(e=rg(e)){var J=pb(i),q=pb(E);return e.action=function(b){f.fi({kind:f._walking?"betweenWalk":"beginWalk"}),f._walking=1;var d=t*b;i[0]=J[0]+K[0]*d,i[1]=J[1]+K[1]*d,i[2]=J[2]+K[2]*d,E[0]=q[0]+K[0]*d,E[1]=q[1]+K[1]*d,E[2]=q[2]+K[2]*d,f.fp(Zp,k,i),f.fp(Op,k,E)},e._37o=function(){delete f._90O,delete f._walking,f.fi({kind:"endWalk"}),f.onWalkEnded()},f._90O=Yl(e)}i[0]+=K[0]*t,i[1]+=K[1]*t,i[2]+=K[2]*t,E[0]+=K[0]*t,E[1]+=K[1]*t,E[2]+=K[2]*t,f.fp(Zp,k,i),f.fp(Op,k,E)}},handleScroll:function(z,_){z.preventDefault();var m=this,d=m._moveStep;m.isFirstPersonMode()?m.isPannable()&&m.pan(0,_>0?d:-d):m.isZoomable()&&m.setZoom(0>_?1/eg:eg)},handlePinch:function(e,X){this.isZoomable()&&this.setZoom(X>e?1/Ac:Ac)},reset:function(){this.setCenter(I.graph3dViewCenter),this.setEye(I.graph3dViewEye),this.setUp(I.graph3dViewUp)
},moveSelection:function(A,o,O){var S=this;S.dm().beginTransaction(),_e(this.sm().toSelection(this.isMovable,this),A,o,O),S.dm().endTransaction()},getMoveMode:function(e,u){var r=u.s("3d.move.mode");if(r)return r;var w="88",Q="89",E="90";return ub(e)||Gh[w]&&Gh[Q]&&Gh[E]?"xyz":Gh[w]&&Gh[Q]?"xy":Gh[w]&&Gh[E]?"xz":Gh[Q]&&Gh[E]?"yz":Gh[w]?"x":Gh[Q]?"y":Gh[E]?"z":"xz"},handleTick:function(){var E=this,y=!1,l=E._moveStep,Q=l,L=!1,Y=!0,Z=E._rotateStep*(Y?-1:1);if(E.isWalkable()||(Q=0),E.isPannable()||(l=0),E.isRotatable()||(Z=0),E._32Q){var i=(sp()-E._32Q)/50;Q*=i,l*=i,Z*=i}E._31Q&&(be(E._31Q),delete E._31Q,delete E._32Q),pn()&&(y=!0,E.pan(-l,0,L,Y)),bo()&&(y=!0,E.pan(l,0,L,Y)),_c()&&(y=!0,ub()?E.pan(0,l,L,Y):E.walk(Q,L,Y)),lk()&&(y=!0,ub()?E.pan(0,-l,L,Y):E.walk(-Q,L,Y)),_o()&&(y=!0,E.rotate(-Z,0,L,Y)),_b()&&(y=!0,E.rotate(Z,0,L,Y)),yc()&&(y=!0,E.rotate(0,-Z/2,L,Y)),Vc()&&(y=!0,E.rotate(0,Z/2,L,Y)),y&&(E._32Q=sp(),E._31Q=Cm(E.handleTick,E))},handleKeyDown:function(k){var c=this;!pr(k)&&mi[k.keyCode]?c.handleTick():Ah(k)?c.selectAll():Fm(k)?c.handleDelete(k):Eg(k)&&this.isResettable()&&c.reset()},checkDoubleClickOnNote:function(y,Q,o){var L=this;if(o===Fk){if(Q.s("note.toggleable"))return Q.s(Xc,!Q.s(Xc)),L.fi({kind:"toggleNote",event:y,data:Q,part:o}),!0}else if(o===zq&&Q.s("note2.toggleable"))return Q.s(Qp,!Q.s(Qp)),L.fi({kind:"toggleNote2",event:y,data:Q,part:o}),!0;return!1},checkDoubleClickOnRotation:function(n,o,U){return U===$n?(o.setRotationX(0),!0):U===fk?(o.setRotationY(0),!0):U===Bh?(o.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(f){var A=this;if(A.isOrtho())return A.getWidth()/A.getOrthoWidth();var z=A.getCenter(),$=A.getHeight(),i=A.getEye(),m=[z[0]-i[0],z[1]-i[1],z[2]-i[2]],q=[f[0]-i[0],f[1]-i[1],f[2]-i[2]],U=Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2]),u=1/Math.tan(A.getFovy()/2);return $*U*u/(q[0]*m[0]+q[1]*m[1]+q[2]*m[2])},inViewSpace:function(K){var s,G=this,r=G._transformPointToViewSpace(K),H=G.getAspect(),g=G.getNear(),y=G.getFar();return-r[2]<g||-r[2]>y?!1:G.isOrtho()?(s=G.getOrthoWidth()/2,Math.abs(r[0])<=s&&Math.abs(r[1]*H)<=s):(s=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2])*Math.tan(G.getFovy()/2),Math.abs(r[1]<=s)&&Math.abs(r[0])<=s*H)},toViewPosition:function(g){var G=this,X=G.getWidth()/2,t=G.getHeight()/2,$=G._18Q;return $&&$._wh===X/t||($=br(G),G._18Q=bg($,$,fg(G)),G._18Q._wh=X/t),g=dr([g[0],g[1],g[2],1],$),{x:X+X*g[0]/g[3],y:t-t*g[1]/g[3]}},getHitPosition:function(m,d,M){var A=this,J=A.getWidth(),r=A.getHeight(),j=m.target?A.lp(m):m,H=j.x-J/2,p=j.y-r/2,y=A.getCenterInfo(),Q=fg(A);d=d?d:[0,0,0],M=M?M:[0,1,0],H=H/J*y.width,p=-1*p/r*y.height;var x=[Q[0]*H,Q[4]*H,Q[8]*H],q=[Q[1]*p,Q[5]*p,Q[9]*p],b=[x[0]+q[0],x[1]+q[1],x[2]+q[2]],S=A.getCenter(),e=Yo(A,d,M,[b[0]+S[0],b[1]+S[1],b[2]+S[2]]);return e?e:[0,0,0]},intersectObject:function(m,z){return this._raycaster.intersectObject(m,z)},intersectObjects:function(P,M,g){return this._raycaster.intersectObjects(P,M,g)},getLineLength:function(M){this.validate();var k=this.getData3dUI(M);if(k&&k.getCache){var q=k.getCache();if(q)return q[q.length-1].length}return 0},getLineOffset:function(Q,P){var _=this.getData3dUI(Q);if(_&&_.getCache){var y=_.getCache();if(y)return jn(y,P)}return k},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(S,p,f){var i=this,H=i.getEye();H=[H[0],H[1],H[2]];var P=i.getCenter();if(P=[P[0],P[1],P[2]],S||(S=H),p||(p=P),i._flyAnim&&i._flyAnim.stop(!0),f=rg(f),!f)return i.setEye(S[0],S[1],S[2]),i.setCenter(p[0],p[1],p[2]),delete i._flyAnim,!0;var J=[S[0]-H[0],S[1]-H[1],S[2]-H[2]],O=[p[0]-P[0],p[1]-P[1],p[2]-P[2]];return f.action=function(y){i.setCenter(P[0]+O[0]*y,P[1]+O[1]*y,P[2]+O[2]*y),i.setEye(H[0]+J[0]*y,H[1]+J[1]*y,H[2]+J[2]*y)},f._37o=function(){delete i._flyAnim},i._flyAnim=Yl(f)},flyTo:function(){function P(g,j,R){if(R instanceof C.Node){m.fromArray(_k(R,j.getMat(R)));var i=R.getAnchor3d();g.push((new ge).set(0-i.x,0-i.y,0-i.z).applyMatrix4(m)),g.push((new ge).set(0-i.x,0-i.y,1-i.z).applyMatrix4(m)),g.push((new ge).set(0-i.x,1-i.y,0-i.z).applyMatrix4(m)),g.push((new ge).set(0-i.x,1-i.y,1-i.z).applyMatrix4(m)),g.push((new ge).set(1-i.x,0-i.y,0-i.z).applyMatrix4(m)),g.push((new ge).set(1-i.x,0-i.y,1-i.z).applyMatrix4(m)),g.push((new ge).set(1-i.x,1-i.y,0-i.z).applyMatrix4(m)),g.push((new ge).set(1-i.x,1-i.y,1-i.z).applyMatrix4(m))}}var u=new ge,b=new ge,Y=new ge,G=new ge,m=new un,L=new C.Math.Quaternion,S=new Gl;return function(O,o,h){var v=this;if(h!==V)o={animation:o,ratio:h};else{var x=typeof o;("boolean"===x||"object"===x&&o.duration)&&(o={animation:o})}o=o||{},u.fromArray(v.getEye()),b.fromArray(v.getCenter());var e,I,K=[],f=o.center,B=o.distance===V;if(f&&Y.fromArray(f),O instanceof C.Node)f||Y.fromArray(O.p3()),B&&(P(K,v,O),e=K.length);else{if(O||(O=v.dm().getDatas()),!O.length)return;if((B||!f)&&(K=[],O.forEach(function(C){P(K,v,C)}),e=K.length),!e)return;if(!f){for(Y.set(0,0,0),I=0;e>I;I++)Y.add(K[I]);Y.multiplyScalar(1/e)}}if(v.setCenter(Y.x,Y.y,Y.z),G.subVectors(u,b),o.direction||o.worldDirection){!o.worldDirection&&O instanceof C.Node?L.setFromEuler(S.set(O.r3(),O.getRotationMode(),!0)):L.set(0,0,0,1);var z=G.length();G.fromArray(o.worldDirection||o.direction).applyQuaternion(L).setLength(z)}if(B){for(var j,r,y,M,n,H=v.getNear(),X=10,h=o.ratio||.8;X--;){for(v._eye[0]=G.x+Y.x,v._eye[1]=G.y+Y.y,v._eye[2]=G.z+Y.z,j=br(v),bg(j,j,fg(v)),M=!0,n=-1/0,I=0;e>I;I++){if(y=K[I],r=dr([y.x,y.y,y.z,1],j),r[3]<H&&X){G.multiplyScalar(2),M=!1;break}n=Math.max(n,Math.max(Math.abs(r[0]),Math.abs(r[1]))/h-r[3])}if(M)break}G.setLength(n+G.length()).add(Y)}else G.setLength(o.distance).add(Y);v._flyAnim&&v._flyAnim.stop(!0);var p=rg(o.animation);if(p){v.setEye(u.x,u.y,u.z),v.setCenter(b.x,b.y,b.z);var W=(new ge).subVectors(G,u),c=(new ge).subVectors(Y,b),m=new ge,k=new ge;return p.action=function(O){m.copy(u).addScaledVector(W,O),k.copy(b).addScaledVector(c,O),v.setCenter(k.x,k.y,k.z),v.setEye(m.x,m.y,m.z)},p._37o=function(){delete v._flyAnim},{lastEye:u,lastCenter:b,eye:G,center:Y,animation:v._flyAnim=Yl(p)}}return v.setEye(G.x,G.y,G.z),delete v._flyAnim,{lastEye:u,lastCenter:b,eye:G,center:Y}}}(),getBoundingBox:function(){function q(V,q,I){O.fromArray(_k(I,q.getMat(I)));var M=I.getAnchor3d();V.push((new ge).set(0-M.x,0-M.y,0-M.z).applyMatrix4(O)),V.push((new ge).set(0-M.x,0-M.y,1-M.z).applyMatrix4(O)),V.push((new ge).set(0-M.x,1-M.y,0-M.z).applyMatrix4(O)),V.push((new ge).set(0-M.x,1-M.y,1-M.z).applyMatrix4(O)),V.push((new ge).set(1-M.x,0-M.y,0-M.z).applyMatrix4(O)),V.push((new ge).set(1-M.x,0-M.y,1-M.z).applyMatrix4(O)),V.push((new ge).set(1-M.x,1-M.y,0-M.z).applyMatrix4(O)),V.push((new ge).set(1-M.x,1-M.y,1-M.z).applyMatrix4(O))}var O=new un;return function(h){if(h=h||this.sm().getSelection(),h instanceof C.Node&&(h=[h]),0===h.length)return k;var y=[];h.forEach(function(C){q(y,this,C)},this);var M=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];return y.forEach(function(Z){M[0]=Math.min(Z.x,M[0]),M[1]=Math.min(Z.y,M[1]),M[2]=Math.min(Z.z,M[2]),c[0]=Math.max(Z.x,c[0]),c[1]=Math.max(Z.y,c[1]),c[2]=Math.max(Z.z,c[2])}),{min:M,max:c}}}()}),tq.RenderEnv=function(M){this.gv=M,this.enable=!1},c.defineProperties(tq.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(i){this._debugOn=i,this.capture&&this.capture()}}}),c.assign(tq.RenderEnv.prototype,{renderEnvToCube:function(N,g,j,G){var I=this,Y=I.gv;if(!N||!g||!j)return I.enable=!1,I._42=null,void 0;I.enable=!0;var X=Math.floor(G/N*g),H=Y.getGL(),v=I._renderTargets;v?v.length<j&&(v=I._renderTargets=v.concat(new Array(j-v.length))):v=I._renderTargets=new Array(j);for(var W=0;j>W;W++)v[W]?v[W].setSize(H,G,X):v[W]=new tq.RenderTarget(Y,H,G,X);var D=!1;I.capture=function(){D=!0,Y._42(),D=!1};var b=new ge,F=new ge,Q=new ge,A=new ge,R=(new ge).setY(0),q=2*Math.PI/j,z=N/2/Math.tan(Math.PI/j),n=2*Math.atan2(g/2,z),o=N/g;I._42=function(k,y,h,O){var x=I._debugOn;if(!D&&!x)return!1;b.copy(Y.getEye()),A.copy(Y.getCenter()).sub(b);var i=Math.atan2(A.z,A.x),r=Y.getNear(),$=Y.getFovy(),s=Y.getAspect();F.copy(Y.getCenter());for(var Z,W=0;j>W;W++)if(Z=v[W],R.setZ(Math.cos(i)).setX(Math.sin(i)).multiplyScalar(z),i-=q,Q.addVectors(b,R),Y.setNear(z),Y.setCenter([Q.x,Q.y,Q.z]),Y.setFovy(n),Y.setAspect(o),x){var f=Math.round(y/j);k.viewport(f*W,0,f,h),O()}else pm(k,Z.frame),k.viewport(0,0,Z.width,Z.height),k.clear(k.COLOR_BUFFER_BIT),O(),Ie(k),Z.assureTexture();return Y.setNear(r),Y.setCenter([F.x,F.y,F.z]),Y.setFovy($),Y.setAspect(s),!0},I.capture()},getTextureInfo:function(Y){var i=this._renderTargets;if(!i)return null;var j=this._renderTargets[Y];return j?{index:Y,texture:j.texture,textureName:j.uuid}:null}}),c.assign(tq.Graph3dView.prototype,{renderEnvToCube:function(k,Q,T,P){var p=this;p.envRenderer||(p.envRenderer=new tq.RenderEnv(p)),p.envRenderer.renderEnvToCube(k,Q,T,P)}}),tq.RenderTarget=function(G,e,f,s,r){var t=this;r=r||{},t.uuid=C.Math.generateUUID(),t.gv=G,t.init(G,e,r),t.setSize(e,f,s)},c.assign(tq.RenderTarget.prototype,{init:function(w,y,k){var e=this,P=e.texture=y.createTexture();y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,P),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,k.minFilter||y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,k.magFilter||y.LINEAR),y.bindTexture(y.TEXTURE_2D,null),e.render=y.createRenderbuffer(),e.frame=y.createFramebuffer(),w._2O[e.uuid]=P},assureTexture:function(){var p=this,Y=p.uuid,y=p.gv._2O;y[Y]||(y[Y]=p.texture)},setSize:function(p,W,e){var s=this;if(s.width!==W||s.height!==e){var C=p.RGBA,R=p.TEXTURE_2D,h=p.RENDERBUFFER,I=p.FRAMEBUFFER;Pd(p,s.texture),p.texImage2D(R,0,C,W,e,0,C,p.UNSIGNED_BYTE,k),p.bindRenderbuffer(h,s.render),p.renderbufferStorage(h,p.DEPTH_COMPONENT16,W,e),pm(p,s.frame),p.framebufferTexture2D(I,p.COLOR_ATTACHMENT0,R,s.texture,0),p.framebufferRenderbuffer(I,p.DEPTH_ATTACHMENT,h,s.render),Pd(p,k),p.bindRenderbuffer(h,k),Ie(p),s.width=W,s.height=e}},toCanvas:function(){var V=this,l=V.gv.getGL();pm(l,V.frame);var M=V.width,q=V.height,_=new Uint8Array(4*M*q);l.readPixels(0,0,M,q,l.RGBA,l.UNSIGNED_BYTE,_),Ie(l);var B=b.createElement("canvas");B.width=M,B.height=q;var U=B.getContext("2d"),u=U.createImageData(M,q);return u.data.set(_),U.putImageData(u,0,0),B}});var up=tq.Interactor=function(G){this.gv=G};Qn("Interactor",c,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Mg=tq.DefaultInteractor=function(c){uj(Mg,this,[c])};Qn("DefaultInteractor",up,{handle_contextmenu:function(i){_d(i)},handle_mousewheel:function(W){this.gv.handleScroll(W,W.wheelDelta/40)},handle_DOMMouseScroll:function(G){2===G.axis&&this.gv.handleScroll(G,-G.detail)},handle_keydown:function(k){this.gv.handleKeyDown(k)},handle_mousedown:function($){this.handle_touchstart($)},handle_touchstart:function(m){_d(m);var c=this,S=c.gv,P=Bn(m),Y=S.getDataInfoAt(m),O=Y?Y.data:k,B=Y?Y.part:k,D=S.sm(),I=js(m),e=Nc(m);S.setFocus(m)&&(c._62O=k,c._57I=k,O?pr(m)?D.co(O)?D.rs(O):D.as(O):D.co(O)||D.ss(O):P&&(pr(m)?S.isRectSelectable()&&(c._62O=pj):c._57I=ms(m)),c._31Q&&(be(c._31Q),delete c._31Q,delete c._32Q),c._62O||(S.isFirstPersonMode()&&(ub(m)||e>2?c._62O="pan":S.isMouseRoamable()||uh?(c._62O="roaming",c.foward=I&&Bn(m),c._32Q=sp(),c._31Q=Cm(c.tick,c)):P||(c._62O="roaming")),c._62O||(P&&I&&hm[B]?(c._62O=B,c.p3=O.p3()):P&&I&&tn(O)&&S.isSelected(O)?S.isMovable(O)?(c._62O="move",c.p3=O.p3(),c.movedata=O):S.isInteractive(O)&&(c._62O="none"):uh&&(e>2?c._62O="pan":2===e&&(c.dist=Kc(m),c._62O="pinch")))),c.point=S.lp(m),rk(c,m),sj(m)?S.handleDoubleClick(m,O,B):S.handleClick(m,O,B))},tick:function(){var R=this,Q=R.gv,f=Q._moveStep;R.point&&Q.isWalkable()&&(R._32Q&&(f*=(sp()-R._32Q)/50),Q.walk(R.foward?f:-f),R._32Q=sp(),R._31Q=Cm(R.tick,R))},handle_mouseup:function(D){this.handle_touchend(D)},handle_touchend:function(n){var W=this._57I;W&&(wh(W,ms(n))<=1&&this.gv.sm().cs(),this._57I=k)},handleWindowMouseMove:function(w){this.handleWindowTouchMove(w)},handleWindowTouchMove:function(z){var T,l,c=this,J=c.gv,h=c._62O,Y=c.point,r=J.dm(),s=J.lp(z),C=s.x-Y.x,P=s.y-Y.y,w=J.getWidth(),L=J.getHeight();if(w&&L){var x=-o*C/w,p=-o*P/L;if("roaming"===h)c.rotate(z,x/2,p/2);else if(h===$n||h===fk||h===Bh)J._86O||r.beginTransaction(),J.fi({kind:J._86O?"betweenEditRotation":"beginEditRotation",event:z}),J._86O=1,J.sm().each(function(Z){if(tn(Z)&&J.isRotationEditable(Z)){var e=F(x)>F(p)?x:p;h===$n?Z.setRotationX(Z.getRotationX()+e):h===fk?Z.setRotationY(Z.getRotationY()+e):h===Bh&&Z.setRotationZ(Z.getRotationZ()+e)}});else if("move"===h||hm[h]){h===Rl||h===vs||h===nl?(J._87O||r.beginTransaction(),J.fi({kind:J._87O?"betweenEditScale":"beginEditScale",event:z}),J._87O=1):(J._moving||r.beginTransaction(),J.fi({kind:J._moving?"betweenMove":"beginMove",event:z}),J._moving=1);var V,K=c.p3,i=J.getPositionInfo(K),E=fg(J);V=h===jo?"x":h===Tp?"y":h===Gf?"z":h===Rl?"sx":h===vs?"sy":h===nl?"sz":J.getMoveMode(z,c.movedata),C=C/w*i.width,P=-1*P/L*i.height;var t,v,e=[E[0]*C,E[4]*C,E[8]*C],n=[E[1]*P,E[5]*P,E[9]*P],Z=e[0]+n[0],$=e[1]+n[1],j=e[2]+n[2],H=[K[0]+Z,K[1]+$,K[2]+j],I=rr(J.getEye(),H,!0);if("xyz"===V?(t=H,J.moveSelection(Z,$,j)):"xz"===V?(t=Yo(J,K,[0,1,0],H),t&&J.moveSelection(t[0]-K[0],0,t[2]-K[2])):"xy"===V?(t=Yo(J,K,[0,0,1],H),t&&J.moveSelection(t[0]-K[0],t[1]-K[1],0)):"yz"===V?(t=Yo(J,K,[1,0,0],H),t&&J.moveSelection(0,t[1]-K[1],t[2]-K[2])):"x"===V||"sx"===V?(I[0]=0,t=Yo(J,K,I,H),t&&(v=t[0]-K[0],"x"===V?J.moveSelection(v,0,0):J.sm().each(function(s){tn(s)&&J.isSizeEditable(s)&&(T=s.getScaleX()+v/100,l=T/s.getScaleX(),s.setScaleX(T),ub(z)&&(s.setScaleY(s.getScaleY()*l),s.setScaleTall(s.getScaleTall()*l)))}))):"y"===V||"sy"===V?(I[1]=0,t=Yo(J,K,I,H),t&&(v=t[1]-K[1],"y"===V?J.moveSelection(0,v,0):J.sm().each(function(r){tn(r)&&J.isSizeEditable(r)&&(T=r.getScaleTall()+v/100,l=T/r.getScaleTall(),r.setScaleTall(T),ub(z)&&(r.setScaleY(r.getScaleY()*l),r.setScaleX(r.getScaleX()*l)))}))):("z"===V||"sz"===V)&&(I[2]=0,t=Yo(J,K,I,H),t&&(v=t[2]-K[2],"z"===V?J.moveSelection(0,0,v):J.sm().each(function(u){tn(u)&&J.isSizeEditable(u)&&(T=u.getScaleY()+v/100,l=T/u.getScaleY(),u.setScaleY(T),ub(z)&&(u.setScaleX(u.getScaleX()*l),u.setScaleTall(u.getScaleTall()*l)))}))),!t)return;c.p3=t}else if(h===pj){var y=c.div;y||(y=c.div=Xf(),Ll(c.getView(),y),y.op=Y,y.style.background=J.getRectSelectBackground()),J.fi({kind:J._rectSelecting?"betweenRectSelect":"beginRectSelect",event:z}),J._rectSelecting=1,y.rect=Fd(y.op,s),qi(y,y.rect)}else if("pinch"===h&&2===Nc(z)){J.fi({kind:J._pinching?"betweenPinch":"beginPinch",event:z}),J._pinching=1;var v=Kc(z);J.handlePinch(v,c.dist),c.dist=v}else"pan"===h||ub(z)?c.pan(z,C,P):"none"===h||J.isFirstPersonMode()||(Bn(z)?c.rotate(z,x,p):(c.pan(z,C,0),J.isWalkable()&&(J.fi({kind:J._walking?"betweenWalk":"beginWalk",event:z}),J._walking=1,J.walk(P/J.getHeight()*J.getCenterInfo().height))));c.point=s}},pan:function(U,q,V){var I=this.gv;if(I.isPannable()){var W=I.getWidth(),y=I.getHeight();if(!W||!y)return;var H=I.getCenterInfo(),b=q/W*H.width,S=-1*V/y*H.height;I.fi({kind:I._panning?"betweenPan":"beginPan",event:U}),I._panning=1,I.pan(-b,-S)}},rotate:function(V,D,h){var f=this.gv;f.isRotatable()&&(f.fi({kind:f._rotating?"betweenRotate":"beginRotate",event:V}),f._rotating=1,f.rotate(D,h))},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},handleWindowTouchEnd:function(y){var z=this,A=z.gv,r=A.dm(),K=z.div;if(K){var c=A.getDatasInRect(K.rect);if(!c.isEmpty()){var $=A.sm(),u=$.toSelection();c.each(function(F){$.co(F)?u.remove(F):u.add(F)}),$.ss(u)}Zj(K)}A._moving&&(delete A._moving,A.fi({kind:"endMove",event:y}),A.onMoveEnded(),r.endTransaction()),A._panning&&(delete A._panning,A.fi({kind:"endPan",event:y}),A.onPanEnded()),A._rotating&&(delete A._rotating,A.fi({kind:"endRotate",event:y}),A.onRotateEnded()),A._86O&&(delete A._86O,A.fi({kind:"endEditRotation",event:y}),r.endTransaction()),A._87O&&(delete A._87O,A.fi({kind:"endEditScale",event:y}),r.endTransaction()),A._pinching&&(delete A._pinching,A.fi({kind:"endPinch",event:y}),A.onPinchEnded()),A._rectSelecting&&(delete A._rectSelecting,A.fi({kind:"endRectSelect",event:y}),A.onRectSelectEnded()),A._walking&&(delete A._walking,A.fi({kind:"endWalk",event:y}),A.onWalkEnded()),z.dist=z.point=z._62O=z.p3=z.movedata=z.div=z._57I=z._32Q=z._31Q=z.foward=k}});var fi=tq.MapInteractor=function(P){uj(fi,this,[P]),this._minPhi=0,this._maxPhi=5*K/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};Qn("MapInteractor",up,{handle_contextmenu:function(T){_d(T)},handle_mousewheel:function(x){this.gv.handleScroll(x,x.wheelDelta/40)},handle_DOMMouseScroll:function(N){2===N.axis&&this.gv.handleScroll(N,-N.detail)},handle_keydown:function(R){this.gv.handleKeyDown(R)},handle_mousedown:function(Z){this.handle_touchstart(Z)},handle_touchstart:function(R){_d(R);var M=this,S=M.gv;if(S.setFocus(R)){S.lp(R);var U=S.getDataInfoAt(R),b=U?U.data:k,E=U?U.part:k;if(!b||!S.isInteractive(b)){var Y=M.editing={point:S.lp(R)};uh?Y.touch=!0:(Y.touch=!1,Y.pan=Bn(R)),rk(M,R)}sj(R)?S.handleDoubleClick(R,b,E):S.handleClick(R,b,E)}},handle_mouseup:function(C){this.handle_touchend(C)},handle_touchend:function(){},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(g){var r=this,s=r.gv,d=r.editing;if(d){var q=s.lp(g),e=d.point,H=q.x-e.x,B=q.y-e.y;if(!d.moved){if(Math.abs(H)<r.threshold&&Math.abs(B)<r.threshold&&!(g.touches&&g.touches.length>1))return;d.moved=!0}if(d.point=q,d.touch){var V=g.touches.length;if(2!==V)r.pan(g,H,B);else{if(1>=V)return;var a=g.touches,z={x:a[0].clientX,y:a[0].clientY},y={x:a[1].clientX,y:a[1].clientY},c={x:y.x-z.x,y:y.y-z.y},D=d.lastCenter,Z=Math.atan2(c.y,c.x),J=d.theta,A=0;J==k?J=d.theta=Z:(A=Z-J,d.thetaStarted||Math.abs(A)>r.touchRotateThreshold?(d.thetaStarted=!0,d.theta=Z):A=0);var I=K*(z.y+y.y)/2/s.getHeight(),i=d.phi,O=0;i==k?i=d.phi=I:(O=I-i,d.phiStarted||Math.abs(O)>r.touchRotateThreshold?(d.phiStarted=!0,d.phi=I):O=0);var Q,m=Math.sqrt(c.x*c.x+c.y*c.y),u=d.vlen;if(u){var S=z.x-D.x,n=z.y-D.y,$=y.x-D.x,Y=y.y-D.y,h=Math.sqrt(S*S+n*n),X=Math.sqrt($*$+Y*Y),L=u/2,T=r._sign2(h-L),R=r._sign2(X-L);0>T*R||0===T&&0===R?(Q=1,d.vlen=m):(Q||(Q=m/u),d.scaleStarted||Math.abs(Q-1)>r.touchScaleThreshold?(d.vlen=m,d.scaleStarted=!0):Q=1)}else u=d.vlen=m,Q=1;1!==Q&&s.setZoom(Q),(O||A)&&r.rotate(g,A,-O),d.lastCenter={x:(y.x+z.x)/2,y:(y.y+z.y)/2}}}else if(d.pan)r.pan(g,H,B);else{var v=s.getWidth(),F=s.getHeight();if(!v||!F)return;var j=-o*H/v,G=-o*B/F;r.rotate(g,j,G)}}},_sign2:function(y){return Math.abs(y)<this._touchScaleCheckAccuracy?0:y>0?1:-1},handleWindowMouseUp:function(F){this.handleWindowTouchEnd(F)},handleWindowTouchEnd:function(K){var R=this,W=R.editing;if(R.editing=null,W){var V=R.gv;if(!W.moved&&W.pan){var m=V.getDataAt(K);m?V.sm().setSelection([m]):V.sm().clearSelection()}else V._panning=null,V._rotating=null,V.fi({kind:W.pan?"endPan":"endRotate",event:K})}},pan:function(M,r,m){var h=this,U=h.gv;if(U.isPannable()){var J=U.getWidth(),R=U.getHeight();if(J&&R){var Y=U.getCenterInfo(),I=-r/J*Y.width,n=1*m/R*Y.height;U.fi({kind:U._panning?"betweenPan":"beginPan",event:M}),U._panning=1;var F=h.keepHorizon,W=h.editing.touch;if((W&&M.touches&&M.touches.length>1||!W&&ub(M))&&(F=!F),!F)return U.pan(I,n);if(I||n){var p=fg(U),X=[p[0]*I,p[4]*I,p[8]*I],o=[p[1],0,p[9]],v=Math.sqrt(o[0]*o[0]+o[2]*o[2]);v&&(o=[o[0]/v*n,0,o[2]/v*n]);var V=X[0]+o[0],N=X[1]+o[1],T=X[2]+o[2],u=U._center,b=U._eye;u[0]+=V,u[1]+=N,u[2]+=T,b[0]+=V,b[1]+=N,b[2]+=T,U.fp(Zp,k,b),U.fp(Op,k,u)}}}},rotate:function(d,g,B){var R=this,h=R.gv;if(h.isRotatable()){var X=h._center,E=h._eye,D=rr(E,X),L=q(i(D[0]*D[0]+D[2]*D[2]),D[1]),C=L+B;C=Math.max(R.minPhi,Math.min(R.maxPhi,C)),B=C-L,h.fi({kind:h._rotating?"betweenRotate":"beginRotate",event:d}),h._rotating=1,h.rotate(g,B)}}}),c.defineProperties(fi.prototype,{minPhi:{get:function(){return this._minPhi},set:function(W){this._minPhi=W}},maxPhi:{get:function(){return this._maxPhi},set:function(V){this._maxPhi=V}},keepHorizon:{get:function(){return this._keepHorizon},set:function(M){this._keepHorizon=M}},threshold:{get:function(){return this._threshold},set:function(C){this._threshold=C}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(_){this._touchScaleThreshold=_}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function($){this._touchRotateThreshold=$}}});var cf=function(V){this.gv=V};Zi(cf,c,{_iv:!0,iv:function(){this._iv=!0},face:function(v,r){var F=this,Y=F.gv.getGL();if(!Y||!tn(v))return k;var p=r.x,C=r.width,S=r.height,P=F.height-r.y-S,H=E(C/2),W=new Uint8Array(4*C*S),d=0;for(F.iv(),F.validate(v),pm(Y,F.frame),Y.readPixels(p,P,C,S,Y.RGBA,Y.UNSIGNED_BYTE,W),Ie(Y),F.iv();H>=d;d++)for(var A=H-d,D=H+d,Z=A;D>=Z;Z++)for(var U=A;D>=U;U++)if(Z===A||Z===D||U===A||U===D){var g=bm.m[W[4*(Z*C+U)]];if(g)return g}},get:function(C,S){this.validate();var m=this,L=m.gv.getGL();if(!L)return k;var n,U,D=C.x,t=C.width,i=C.height,z=m.height-C.y-i,a=E(t/2),G=new Uint8Array(4*t*i),p=0,Y=G.length,u=S?k:new pq,w=S?k:{};if(pm(L,m.frame),L.readPixels(D,z,t,i,L.RGBA,L.UNSIGNED_BYTE,G),Ie(L),S){for(;a>=p;p++)for(var Z=a-p,Q=a+p,v=Z;Q>=v;v++)for(var d=Z;Q>=d;d++)if((v===Z||v===Q||d===Z||d===Q)&&(n=m.info(G,4*(v*t+d))))return n}else for(;Y>p;p+=4)n=m.info(G,p),n&&(U=n.data,w[U._id]||(u.add(U),w[U._id]=U));return u},info:function(o,m){return this.colorMap[(o[m]<<16)+(o[m+1]<<8)+o[m+2]+((127&o[m+3])<<24)]},validate:function(X){var h=this,I=h.gv,A=I.getGL();if(A){var f=I.getWidth(),M=I.getHeight(),V=A.RGBA,$=A.TEXTURE_2D,n=A.RENDERBUFFER,e=A.FRAMEBUFFER;h.texture||(h.texture=Vg(A),h.render=A.createRenderbuffer(),h.frame=A.createFramebuffer()),(h.width!==f||h.height!==M)&&(Pd(A,h.texture),A.texImage2D($,0,V,f,M,0,V,A.UNSIGNED_BYTE,k),_q(A,A.TEXTURE_MIN_FILTER,A.LINEAR),A.bindRenderbuffer(n,h.render),A.renderbufferStorage(n,A.DEPTH_COMPONENT16,f,M),pm(A,h.frame),A.framebufferTexture2D(e,A.COLOR_ATTACHMENT0,$,h.texture,0),A.framebufferRenderbuffer(e,A.DEPTH_ATTACHMENT,n,h.render),Pd(A,k),A.bindRenderbuffer(n,k),Ie(A),h.width=f,h.height=M),h._iv&&(h._iv=!1,pm(A,h.frame),I._42(X||(h.colorMap={}),1),Ie(A))}}});var Re=function(z){this.gv=z};Zi(Re,c,{gap:0,size:0,_42:function(z,P){var j=this,s=j.gv,I=s._gridGap,Q=s._gridSize;if(s._gridVisible){if(j.gap!==I||j.size!==Q){for(var N=[],U=s._gridSize/2,b=I*U,A=0;2*U+1>A;A++){var _=6*A,p=6*(2*U+1)+_;N[_]=-b,N[_+1]=0,N[_+2]=-b+A*I,N[_+3]=b,N[_+4]=0,N[_+5]=-b+A*I,N[p]=-b+A*I,N[p+1]=0,N[p+2]=-b,N[p+3]=-b+A*I,N[p+4]=0,N[p+5]=b}j.vs=new vn(N),j.gap=I,j.size=Q}vi(s),Pm(z,P),Vf(z),ep(z,P,1,s._gridColor,s._buffer.vs,j.vs),eh(z,0,j.vs.length/3,z.LINES),Em(z),ji(z,P)}else j.vs=j.gap=j.size=k}});var mp=function(y){this.gv=y};Zi(mp,c,{_42:function(b,R){var n=this.gv,r=n._buffer.vs,p=n._axisXColor,h=n._axisYColor,j=n._axisZColor,T=n._originAxisVisible,A=n._centerAxisVisible;if(T||A){var m=Y?b.TRIANGLES:b.TRIANGLE_FAN,D=b.LINES;if(vi(n),Pm(b,R),Vf(b),T){var Z=n.getCenterInfo(),e=$(Z.width,Z.height)/5,t=.8*e,i=.05*e;ep(b,R,1.5,p,r,new vn([0,0,0,e,0,0,t,i,0,t,0,i,t,-i,0,t,0,-i,t,i,0,0,0,0,0,e,0,i,t,0,0,t,i,-i,t,0,0,t,-i,i,t,0,0,0,0,0,0,e,i,0,t,0,i,t,-i,0,t,0,-i,t,i,0,t])),eh(b,0,2,D),eh(b,1,6,m),ep(b,R,k,h),eh(b,7,2,D),eh(b,8,6,m),ep(b,R,k,j),eh(b,14,2,D),eh(b,15,6,m)}if(A){var U=n._center,d=U[0],f=U[1],G=U[2],Z=n.getPositionInfo(U);e=$(Z.width,Z.height)/20,ep(b,R,1.5,p,r,new vn([d,f,G,d+e,f,G,d,f,G,d,f+e,G,d,f,G,d,f,G+e])),eh(b,0,2,D),ep(b,R,k,h),eh(b,2,2,D),ep(b,R,k,j),eh(b,4,2,D)}Em(b),ji(b,R)}}});var qe=function(W){this.gv=W,this.onMouseOver=this.onMouseOver.bind(this),this.mode=2};qe.Mode={Disable:0,Selection:1,MouseOver:2},Zi(qe,c,{onMouseOver:function(V){I.preventDefault(V);var H=this.gv.getDataAt(V);H!==this.mouseOverData&&(this.mouseOverData=H,this.gv.iv())},setFetchTargetFunc:function(d){this.fetchTargetFunc=d},_42:function(k,u){var N,v=this,i=v._mode;if(i!==qe.Mode.Disable&&(i===qe.Mode.Selection?N=v.gv.sm().getSelection().toArray():i===qe.Mode.MouseOver&&v.mouseOverData&&(N=[v.mouseOverData]),v.fetchTargetFunc&&(N=v.fetchTargetFunc(N)),N&&N.length)){var W=v.gv,K=W.vr.isPresenting(),w=W.getWidth();if(K){var z=W.getWidth;w/=2,W.getWidth=function(){return w};var c=W.getViewport()}var R,r=W.getDevicePixelRatio(),t=w*r,S=W.getHeight()*r;(R=v._renderTarget)?R.setSize(k,t,S):v._renderTarget=R=new tq.RenderTarget(W,k,t,S),pm(k,R.frame),W.drawFilter=function(M){return N.indexOf(M)<0?!0:void 0},W._42({}),W.drawFilter=null,Ie(k),K&&(W.getWidth=z,W.setViewport(k,c[0],c[1],c[2],c[3])),v.shader||(v.shader=new Qm.Shader(k,hj.vs,hj.fs));var $=v.shader;if(v.shader.bind(),k.enable(k.BLEND),k.activeTexture(k.TEXTURE0+0),k.bindTexture(k.TEXTURE_2D,R.texture),$.uniforms.image=0,$.uniforms.textureSize=[t,S],$.uniforms.edgeWidth=_["highlight.width"],v.highlightColor!==_["highlight.color"]){var H=Ze(v.highlightColor=_["highlight.color"]);v.highlightColorData=[H[0]/255,H[1]/255,H[2]/255,H[3]/255]}$.uniforms.edgeColor=v.highlightColorData,v.ibuffer?(v.ibuffer.upload(),v.vbuffer.upload()):(v.ibuffer=Qm.Buffer.createIndexBuffer(k,new Uint16Array([0,2,1,1,2,3])),v.vbuffer=Qm.Buffer.createVertexBuffer(k,new Float32Array([0,0,1,0,0,1,1,1]))),$.attributes.pos.pointer(v.vbuffer),k.drawElements(k.TRIANGLES,6,k.UNSIGNED_SHORT,0),k.disable(k.BLEND),k.bindTexture(k.TEXTURE_2D,null),k.useProgram(u)}}}),c.defineProperties(qe.prototype,{mode:{get:function(){return this._mode},set:function(R){var $=this._mode;R!==$&&(this._mode=R,R===qe.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):$===qe.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var hj={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Vp=function(J){this.gv=J},jo="edit_tx",Tp="edit_ty",Gf="edit_tz",$n="edit_rx",fk="edit_ry",Bh="edit_rz",Rl="edit_sx",vs="edit_sy",nl="edit_sz",hm={};hm[jo]=1,hm[Tp]=1,hm[Gf]=1,hm[$n]=1,hm[fk]=1,hm[Bh]=1,hm[Rl]=1,hm[vs]=1,hm[nl]=1,Zi(Vp,c,{_42:function(y,H,o){var Q=this,F=Q.gv,a=F.sm().ld();if(a&&F.isEditable(a)&&!F.isEditHelperDisabled()&&tn(a)&&(!F.isFirstPersonMode()||!F.isMouseRoamable()&&!uh)){vi(F);var d,B,P=F.isMovable(a),z=F.isRotationEditable(a),c=F.isSizeEditable(a),l=F._axisXColor,$=F._axisYColor,i=F._axisZColor,q=F._editSizeColor,p=a.p3(),O=wh(F.getEye(),p)/10,N=O/(o?5:10),j=.7*O,u=.4*j,Y=p[0],W=p[1],L=p[2];d=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],P&&Q._17O(y,H,a,o,jo,l,d,[Y,W-N,L,Y+j,W-N,L,Y+j,W,L,Y+j,W,L,Y,W,L,Y,W-N,L,Y,W-N,L+N,Y+j,W-N,L+N,Y+j,W-N,L,Y+j,W-N,L,Y,W-N,L,Y,W-N,L+N]),B=Y+j,c&&Q._17O(y,H,a,o,Rl,q,d,[B,W-N,L,B+u,W-N,L,B+u,W,L,B+u,W,L,B,W,L,B,W-N,L,B,W-N,L+N,B+u,W-N,L+N,B+u,W-N,L,B+u,W-N,L,B,W-N,L,B,W-N,L+N]),B+=u,z&&Q._17O(y,H,a,o,$n,l,d,[B,W-N,L,B+u,W-N,L,B+u,W,L,B+u,W,L,B,W,L,B,W-N,L,B,W-N,L+N,B+u,W-N,L+N,B+u,W-N,L,B+u,W-N,L,B,W-N,L,B,W-N,L+N]),d=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],P&&Q._17O(y,H,a,o,Tp,$,d,[Y,W,L,Y,W+j,L,Y-N,W+j,L,Y-N,W+j,L,Y-N,W,L,Y,W,L,Y,W,L,Y,W,L-N,Y,W+j,L-N,Y,W+j,L-N,Y,W+j,L,Y,W,L]),B=W+j,c&&Q._17O(y,H,a,o,vs,q,d,[Y,B,L,Y,B+u,L,Y-N,B+u,L,Y-N,B+u,L,Y-N,B,L,Y,B,L,Y,B,L,Y,B,L-N,Y,B+u,L-N,Y,B+u,L-N,Y,B+u,L,Y,B,L]),B+=u,z&&Q._17O(y,H,a,o,fk,$,d,[Y,B,L,Y,B+u,L,Y-N,B+u,L,Y-N,B+u,L,Y-N,B,L,Y,B,L,Y,B,L,Y,B,L-N,Y,B+u,L-N,Y,B+u,L-N,Y,B+u,L,Y,B,L]),d=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],P&&Q._17O(y,H,a,o,Gf,i,d,[Y,W,L,Y,W,L+j,Y,W-N,L+j,Y,W-N,L+j,Y,W-N,L,Y,W,L,Y,W-N,L,Y-N,W-N,L,Y-N,W-N,L+j,Y-N,W-N,L+j,Y,W-N,L+j,Y,W-N,L]),B=L+j,c&&Q._17O(y,H,a,o,nl,q,d,[Y,W,B,Y,W,B+u,Y,W-N,B+u,Y,W-N,B+u,Y,W-N,B,Y,W,B,Y,W-N,B,Y-N,W-N,B,Y-N,W-N,B+u,Y-N,W-N,B+u,Y,W-N,B+u,Y,W-N,B]),B+=u,z&&Q._17O(y,H,a,o,Bh,i,d,[Y,W,B,Y,W,B+u,Y,W-N,B+u,Y,W-N,B+u,Y,W-N,B,Y,W,B,Y,W-N,B,Y-N,W-N,B,Y-N,W-N,B+u,Y-N,W-N,B+u,Y,W-N,B+u,Y,W-N,B])}},_17O:function(S,H,c,g,w,i,N,n){var o=this.gv._buffer;el(S,H,g,!0,c,w),ug(S,H,k,!0,k,!0,k,!1),xo(S,H.uDiffuse,i),rs(S,o.vs,new vn(n),H.aPosition),rs(S,o.ns,new vn(N),H.aNormal),Vf(S),eh(S,0,12),Em(S),Fo(S,H)}});var Yk=C.Raycaster=function(R){this.gv=R,this.maxTriangleTest=1/0};zo("Raycaster",c,{intersect:function(s){var V=this,K=V.gv,b=K.getDataAt(s);return b?V.intersectObject(s,b):null},intersectObjects:function(m,D,n){var l,R,u,x,J=this,$=1/0,Q=m.origin||(new ge).fromArray(J.gv.getEye()),U=J.maxTriangleTest,o=[];return D.forEach(function(W){n&&n(W)===!1||W.s("intersect")!==!1&&o.push(W)}),o.sort(function(O,o){return Q.distanceToSquared2(O.p3())-Q.distanceToSquared2(o.p3())}),J.countTriangles=0,o.forEach(function(f){J.countTriangles>U||(l=J.intersectObject(m,f),l&&(R=Q.distanceToSquared(l.world),$>R&&(u=f,x=l,$=R)))}),J.countTriangles=0,{data:u,intersect:x}},intersectObject:function(Y,$){if(Y instanceof Oh)return this._intersectObjectImpl(Y,$);var b,B,c=this,n=c.gv;B=n.unproject(Y);var H=n.getEye();n.isOrtho()?(b=rr(n.getCenter(),H),b[0]+=b[0],b[1]+=b[1],b[2]+=b[2]):b=H,b=new ge(b);var l=new ge(B).sub(b).normalize(),J=new C.Math.Ray(b,l);return c._intersectObjectImpl(J,$)},_intersectObjectImpl:function(){function g(){var R=new ge;return R.subVectors(B,z),o.subVectors(X,z),R.cross(o).normalize(),R}function D(_,x,l,R,u,C,s){return th.barycoordFromPoint(_,x,l,R,f),u.multiplyScalar(f.x),C.multiplyScalar(f.y),s.multiplyScalar(f.z),u.add(C).add(s),u.clone()}var A=new un,P=new un,e=new Oh,w=new ge,s=new ge,I=new ge,T=new ge,b=new ge,X=new ge,z=new ge,B=new ge,m=new lf,V=new lf,$=new lf,o=new ge,H={vs:ej,is:$e,uv:Rm},f=new ge;return function(v,p){var r=this.gv.getData3dUI(p),c=p.mat||r.mat;if(c){A.fromArray(c),P.getInverse(A),e.copy(v).applyMatrix4(P);var u,M,W="body",S=r.shapeModel;if(S||(S=Oc(r)),S||(p instanceof C.Node&&!(p instanceof C.Shape)?(u=!0,S=H):(M=!0,S=[r.left,r.front,r.right,r.back,r.top,r.bottom])),!S)return console.log("Can not find shape model."),null;sn(S)||(S=[S]);var i,Y,U,E,_,L,q,K,J,o,R,d,O,n,j,G,a=1/0,N=["","top_","bottom_"],x=!1;for(i=0,Y=S.length;Y>i;i++)if(O=S[i])for(U=0,E=N.length;E>U;U++)if(n=N[U],q=O[n+"vs"],K=O[n+"is"],J=O[n+"uv"]||O[n+"tuv"],q){if(j=O[n+"boundingBox"]){var R=e.intersectBox(j);if(!R)continue;if(e.origin.distanceTo(R)>a)continue;G=!1}else O[n+"boundingBox"]=j=new C.Math.Box3,G=!0;for(_=0,L=K?K.length:q.length/3;L>_;_+=3)this.countTriangles++,K?(s.fromArray(q,3*K[_]),I.fromArray(q,3*K[_+1]),T.fromArray(q,3*K[_+2])):(s.fromArray(q,3*_),I.fromArray(q,3*(_+1)),T.fromArray(q,3*(_+2))),G&&(j.expandByPoint(s),j.expandByPoint(I),j.expandByPoint(T)),o=e.intersectTriangle(s,I,T,!0,w),o&&(d=e.origin.distanceTo(o),a>d&&(a=d,b.copy(o),X.copy(s),z.copy(I),B.copy(T),""!==n?W=n.slice(0,-1):u?W=Jl[Math.floor(_/6)]:M&&(W=Jl[i]),J&&(x=!0,K?(m.fromArray(J,2*K[_]),V.fromArray(J,2*K[_+1]),$.fromArray(J,2*K[_+2])):(m.fromArray(J,2*_),V.fromArray(J,2*(_+1)),$.fromArray(J,2*(_+2))))))
}if(!isFinite(a))return null;var f,l=b.clone().applyMatrix4(A);x&&(f=D(b,X,z,B,m,V,$));var y=g(X,z,B),F=g(X.applyMatrix4(A),z.applyMatrix4(A),B.applyMatrix4(A)),Q=e.direction.dot(y);return Q>0&&(y.multiplyScalar(-1),F.multiplyScalar(-1)),{world:l,local:b.clone(),worldNormal:F,normal:y,uv:f,part:W}}}}()});var Pe=function(P,U){this.gv=P,this.s=function(Z,B,R){return B==k&&(B=R),B==k?U.getStyle(Z):Sq(B,U,P)},this.data=U};Zi(Pe,c,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(p,V,j,l){var Q=this,y=Q.data;if(!(y instanceof as)){var K,Y,w,X,J,b,i,r=Q.gv,U=y._id,o=Q.s("shape3d.alwaysOnTop")?null:Q.s("batch"),C=r._batchIndexMap,s=r._batchModelMap,v=r.isSelectable(y),u=r.getBrightness(y),f=u!=k&&1!==u;if(Q.needValidate(p)){if(w=Qd(C,s,y,o),Q.validate(w,o?se[o]||dk:k),w&&(X=C[U],J=X.size=w.vs.length/3-X.begin,i=w.rs))for(u=f?u:1,b=0;J>b;b++)i.push(u);if(tn(y)){var H=r.getWireframeGeometry(y);if(H)Rc(r,y,H);else{var B=r.getWireframe(y);B&&Rc(r,y,B)}}Q.labelInfo=Q.label2Info=Q.noteInfo=Q.note2Info=Q._38o=k,Q._24O(Sr,"getLabel"),Q._24O($h,"getLabel2"),Q._26O(Fk,"getNote"),Q._26O(zq,"getNote2"),Q._15O(),Q.interactiveInfo=r.isInteractive(y)?{}:k,Q._iv=!1}f&&xo(p,V.uBrightness,u),xo(p,V.uAlphaTest,Q.s("alphaTest")),xo(p,V.uUseEnvMap,y.s("envmap")?!0:!1),xo(p,V.uReflectivity,y.s("envmap")||.01),Y=el(p,V,j,v,y,Jn),Y&&(Tq(Y,C[U],s),Tq(Y,r._polylineIndexMap[U],r._polylineModelMap),Tq(Y,r._wireframeIndexMap[U],r._wireframeModelMap)),C[U]||Q._80o(p,V,l),r.isLabelVisible(y)&&((K=Q.labelInfo)&&(el(p,V,j,v,y,Sr),Q._28O(K,Sr,l)),(K=Q.label2Info)&&(el(p,V,j,v,y,$h),Q._28O(K,$h,l))),r.isNoteVisible(y)&&((K=Q.noteInfo)&&(el(p,V,j,v,y,Fk),Q._29O(K,Fk,l)),(K=Q.note2Info)&&(el(p,V,j,v,y,zq),Q._29O(K,zq,l))),(K=Q._38o)&&Q._99O(p,V,K,j,v,l),f&&xo(p,V.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Yi},_80o:function(){},dispose:function(){},_calcAnchorMat:function(Z){if(Z.hasOwnProperty("_anchor")||Z.hasOwnProperty("_anchorElevation")){var w=Z.getAnchor3d(),O={x:w.x-.5,y:w.y-.5,z:w.z-.5},l=cn();return xl(l,[-O.x,-O.y,-O.z]),l}},getBodyColor:function(d){var h=this.data,L=this.gv.getBodyColor(h);return L?L:d?h.getStyle(d):k},_24O:function(i,O){var j=this,y=j.data,Y=j.gv,D=j.s,f=Y[O](y);if(f!=k){var A=D(i+".scale"),s=D(i+".max"),t=j[i+"Info"]={label:f,textureScale:D(i+".texture.scale"),color:Y[O+"Color"](y),font:D(i+".font"),align:D(i+".align"),background:Y[O+"Background"](y)},q=t.rect=So(t,f);s>0&&s<q.width&&(t.labelWidth=q.width,q.width=s),q.x=q.y=0,q.width*=A,q.height*=A,t.mat=j._16O(D(i+".autorotate"),D(i+".position"),q,D(i+".face"),D(i+".t3"),D(i+".r3"),D(i+".rotationMode"));var R=q.width/2,P=q.height/2;t.vs=new vn([-R,P,0,-R,-P,0,R,-P,0,R,P,0]),q.width/=A,q.height/=A}},_26O:function(d,Z){var h=this,y=h.data,H=h.gv,v=h.s,S=H[Z](y);if(S!=k){var _=v(d+".scale"),b=this[d+"Info"]={note:S,textureScale:v(d+".texture.scale"),expanded:v(d+".expanded"),font:v(d+".font"),color:v(d+".color"),align:v(d+".align"),borderWidth:v(d+".border.width"),borderColor:v(d+".border.color"),background:H[Z+"Background"](y)};if(b.expanded){var D=v(d+".max"),n=So(b,S);n.width+=6,n.height+=2,D>0&&D<n.width&&(b.labelWidth=n.width,n.width=D);var c={x:-n.width/2,y:-8-n.height,width:n.width,height:n.height+8}}else c={x:-6,y:-18,width:12,height:18};b.mat=h._16O(v(d+".autorotate"),v(d+".position"),k,v(d+".face"),v(d+".t3"),v(d+".r3"),v(d+".rotationMode")),b.rect=c,1!==_&&(c=pb(c),c.x*=_,c.height*=_,c.y=-c.height,c.width*=_);var L=c.x,l=c.y,P=c.width,Q=c.height;b.vs=new vn([L,-l,0,L,-l-Q,0,L+P,-l-Q,0,L+P,-l,0])}},_28O:function(P,O,M){if(M(this.s(O+".transparent"))){var u=P.rect,B=P.textureScale,S=u.width*B,r=u.height*B;if(S>=1&&r>=1){var A=Mn(S,r);1!==B&&(A.translate(A,u.x,u.y),A.scale(B,B),A.translate(A,-u.x,-u.y)),ui(A,P),A.restore(),An(this,O,P.mat,P.vs,!0)}}},_29O:function(k,C,F){if(F(this.s(C+".transparent"))){var j=k.rect,s=k.textureScale,e=j.x,n=j.y,q=j.width*s,N=j.height*s;if(q>=1&&N>=1){j.x=j.y=0;var d=Mn(q,N);1!==s&&d.scale(s,s),Qq(d,k),d.restore(),j.x=e,j.y=n,An(this,C,k.mat,k.vs,!1)}}},_99O:function(h,I,g,W,m,A){if(g){var z=this,t=z.gv,p=z.data,L=t._buffer,B=t._1O,b=g.icons;for(var s in b){var f=b[s],R=g.rects[s];if(R&&A(Sq(f.transparent,p,t))){el(h,I,W,m,p,s);var D=Sq(f.shape3d,p,t),q=D?[D]:Sq(f.names,p,t),w=q?q.length:0,N=Sq(f.textureScale,p,t)||1,i=Sq(f.light,p,t);i==k&&(i=D?!0:!1),ug(h,I,Sq(f.blend,p,t),i,Sq(f.opacity,p,t),Sq(f.reverseFlip,p,t),Sq(f.reverseColor,p,t),Sq(f.reverseCull,p,t));for(var K=0;w>K;K++){var x=q[K],Z=R[K];if(Ud(z,Z.mat),D)Ap(t,p,Oc(z,D),z);else{var d=Ne(x);if(d){var E=Z.width*N,u=Z.height*N;if(E>=1&&u>=1){var $=Mn(E,u);fo($,d,Sq(f.stretch,p,t),0,0,E,u,p,t),$.restore(),Vg(h,rb,B),Vf(h,I,B,Sq(f.discardSelectable,p,t),L.uv,In),rs(h,L.vs,Z.vs,I.aPosition),zj(h,L.ns,Id,I.aNormal),Wd(h,L.is,Ym),lp(h,0,Ym.length),Em(h,I,B)}}}_r(t)}Fo(h,I)}}}}});var Yh=function(f,F){uj(Yh,this,[f,F])};Zi(Yh,Pe,{_16O:function(x,c,V,Q,W,J,S,b,q){var E=this.data,$=E.getFinalScale3d(),G=Cl(c,$,V,Q,b,q);if(E.hasOwnProperty("_anchor")||E.hasOwnProperty("_anchorElevation")){var i=E.getAnchor3d();G[0]-=(i.x-.5)*$[0],G[1]-=(i.y-.5)*$[1],G[2]-=(i.z-.5)*$[2]}return Kh(cn(),G,E.p3(),Q,W,J,S,x,E.getFinalRotation3d(),E.getRotationMode())},clear:function(){var X=this;X.faceMat=X.mat=X.shapeModel=X.left=X.right=X.front=X.back=X.top=X.bottom=X.csg=k},needValidate:function(C){if(this._iv)return this._validateFrameId=C._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var o=C._renderInfo.frame;if(this._validateFrameId!==o)return this._validateFrameId=o,!0}return!1},validate:function(L,Q){var y=this,l=y.gv,K=y.data,h=Oc(y);y._updateAutoRotation(),y._updateFixSize2d(),y._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Kj(l,K,"_wireframeModelMap","_wireframeIndexMap"),Kj(l,K,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var r=_k(K,l.getMat(K),h?y.s("shape3d.scaleable"):!0),k=y._calcAnchorMat(K);if(k&&bg(r,r,k),K.mat=r,y.clear(),L){var v=[];h?Jf(l,K,h,y,y.getBodyColor(),[r],L,v):(oi(l,K,L,Q,r,fq,v,Hc),oi(l,K,L,Q,r,nb,v,ab),oi(l,K,L,Q,r,Bp,v,Gn),oi(l,K,L,Q,r,sm,v,mj),oi(l,K,L,Q,r,Vi,v,ok),oi(l,K,L,Q,r,ze,v,Wl)),v.length&&(ke(L.vs,v),ke(L.ns,ri(v)))}else y.mat=r,(y.shapeModel=h)||(y._cubeUvs=null,y.vf(fq,0),y.vf(nb,16),y.vf(Vi,8),y.vf(ze,24),y.vf(Bp,32),y.vf(sm,40))},_updateAutoRotation:function(){var I=new Gl;return function(){var Z=this,o=Z.data,C=Z.s("shape3d.autorotate");if(!C)return o._dynamicRotation&&delete o._dynamicRotation,void 0;var K,M=Z.gv;K="string"==typeof C?[C.indexOf("x")<0?M._eye[0]:M._center[0],C.indexOf("y")<0?M._eye[1]:M._center[1],C.indexOf("z")<0?M._eye[2]:M._center[2]]:M._eye;var m=M._center,g=o.p3(),T=ym([g[0]+K[0]-m[0],g[1]+K[1]-m[1],g[2]+K[2]-m[2]],g,M._up),c=o.r3();I.set(0,0,0,o.getRotationMode(),!0).setFromRotationMatrix(T),Math.abs(c[0]-I.x)<1e-5&&Math.abs(c[1]-I.y)<1e-5&&Math.abs(c[2]-I.z)<1e-5||(o._dynamicRotation=[I.x,I.y,I.z])}}(),_updateFixSize2d:function(){var o=this,L=o.data,q=o.s("shape3d.fixSizeOnScreen");if(!q)return L._dynamicScale3d&&delete L._dynamicScale3d,void 0;var u=o.gv;L.getFinalScale3d();var l=_k(L,u.getMat(L)),G=nc([0,0,0],l),E=u.toViewPosition(G);if(!isNaN(E.x)&&!isNaN(E.y)){var $=nc([1,0,0],l),V=u.toViewPosition($),r=nc([0,1,0],l),P=u.toViewPosition(r),x=V.x-E.x,C=P.y-E.y;if(x&&C){var W=L._dynamicScale3d||[1,1,1],y=Ne(L.s("shape3d.image")),k=q[0]>0?q[0]:y?Or(y,o):20,Z=q[1]>0?q[1]:y?fb(y,o):20,J=Math.abs(x/k),w=Math.abs(C/Z);Math.abs(J-1)<.001&&Math.abs(w-1)<.001||(L._dynamicScale3d=[W[0]/J,W[1]/w,W[2]])}}},_updateOverlapping:function(){var c=this,d=c.s("hide.overlapping.group");if(!d)return c._rectOverlapping&&(c._rectOverlapping=V),void 0;var T,s,o,m=c.gv,$=c.data,P=_k($,m.getMat($)),z=1/0,C=1/0,I=-1/0,H=-1/0,R=$.getAnchor3d(),O=R.x,U=R.y,f=R.z;for(T=0;8>T;T++){if(s=nc([(T>>2)-O,(1&T>>1)-U,(1&T)-f],P),o=m.toViewPosition(s),isNaN(o.x)||isNaN(o.y))return;z=Math.min(z,o.x),I=Math.max(I,o.x),C=Math.min(C,o.y),H=Math.max(H,o.y)}var q={x:z,y:C,w:I-z,h:H-C};c._rectOverlapping=m.overlappingBox.isOverlapping(d,q)},getVectorDynamicSize:function(){var n,$=this,P=$.s("shape3d"),t=$.data;if("billboard"===P||"plane"===P||(n=t._currentCubeElementId)!=k){var G,S,V=$.gv,E=_k(t,V.getMat(t)),w=t.getAnchor3d(),Y=.5-w.x,K=.5-w.y,s=.5-w.z,i=$.s("shape3d.vector.dynamic.maxsize"),h=function(z,x){z[0]+=Y,z[1]+=K,z[2]+=s,x[0]+=Y,x[1]+=K,x[2]+=s;var C=V.toViewPosition(nc(z,E)),c=V.toViewPosition(nc(x,E)),H=C.x-c.x,I=C.y-c.y;return Math.min(i,Math.sqrt(H*H+I*I))};if("billboard"===P)G=h([-.5,0,0],[.5,0,0]),S=h([0,-.5,0],[0,.5,0]);else if("plane"===P)G=h([-.5,0,0],[.5,0,0]),S=h([0,0,-.5],[0,0,.5]);else if(t._currentCubeElementId!=k){var O=3*$e[n+1],v=3*$e[n],_=3*$e[n+2];G=h([ej[O],ej[O+1],ej[O+2]],[ej[_],ej[_+1],ej[_+2]]),S=h([ej[O],ej[O+1],ej[O+2]],[ej[v],ej[v+1],ej[v+2]])}return[G,S]}},getCachedTexture:function(){var A=this,K=A.data,w=K._currentCubeElementId;return w!=k?A._cubeCachedImage?A._cubeCachedImage[w]:null:A._shape3dCachedImage},setCachedTexture:function(H){var n=this,N=n.data,f=N._currentCubeElementId;if(f!=k){if(!n._cubeCachedImage)return n._cubeCachedImage={};n._cubeCachedImage[f]=H}else n._shape3dCachedImage=H},invalidateCachedTexture:function(X){var a,x,I,u=this;if((I=u._shape3dCachedImage)&&(X.deleteTexture(I),u._shape3dCachedImage=null),x=u._cubeCachedImage){for(a in x)X.deleteTexture(x[a]);u._cubeCachedImage=null}},vf:function(k,e){var C=this;if(C.gv.getFaceVisible(C.data,k)){var y=Uh(C,k);y.mat&&(C.faceMat=!0);var $=y.uv;if($){var v=C._cubeUvs;v||(v=C._cubeUvs=new vn([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var X=0;8>X;X++)v[e+X]=$[X]}return y}},_80o:function(Z,V,M){var c=this;if(c._rectOverlapping)return!0;var I=c.gv,f=c.data,u=I._cube,U=c.shapeModel;vi(I,c.mat),U?Ap(I,f,U,c,c.getBodyColor(),M):(rs(Z,u.vs,k,V.aPosition),rs(Z,u.ns,k,V.aNormal),qq(Z,u.is),c._18O(Z,V,c.left,0,M),c._18O(Z,V,c.front,6,M),c._18O(Z,V,c.right,12,M),c._18O(Z,V,c.back,18,M),c._18O(Z,V,c.top,24,M),c._18O(Z,V,c.bottom,30,M)),_r(I),c.faceMat&&(c._18O(Z,V,c.left,0,M,!0),c._18O(Z,V,c.front,6,M,!0),c._18O(Z,V,c.right,12,M,!0),c._18O(Z,V,c.back,18,M,!0),c._18O(Z,V,c.top,24,M,!0),c._18O(Z,V,c.bottom,30,M,!0))},_18O:function(y,C,b,w,s,d){if(b){if(!s(b.transparent))return;if(d&&!b.mat||!d&&b.mat)return;var c=this.data.s("polygonOffset");c&&Gp(y,c),d&&vi(this.gv,b.mat);var R=this,M=R.data;M._currentCubeElementId=w;var m=R.gv,g=m.getTexture(b.texture,M),x=b.uv,u=b.uvScale,D=b.uvOffset,A=b.discardSelectable;g?x?Vf(y,C,g,A,m._buffer.uv,R._cubeUvs,D,u):Vf(y,C,g,A,m._cube.uv,k,D,u):Vf(y),ug(y,C,b.blend,b.light,b.opacity,b.reverseFlip,b.reverseColor,b.reverseCull),xo(y,C.uDiffuse,b.color),lp(y,w,6),Fo(y,C),Em(y,C,g),d&&_r(m),c&&gq(y),M._currentCubeElementId=null}}});var mc=function(d,y){uj(mc,this,[d,y])};Zi(mc,Pe,{_25Q:1,validate:function(F){var h=this,i=h.gv,p=h.data,e=h.s,u=e("edge.width"),K=p._40I,V=p._41I;if(h.shapeModel=h.info=k,K&&V){var j,G,J,Q,b,w,A,q,D,a,E=p.isLooped(),c=e(fp),r=I.getEdgeType(c);if(r){var n=r(p,gf(h,i,p,E,c),i,h._19Q);if(!n.points||n.points.isEmpty())return;w=h.info={},A=n.segments,b=n.points,q=b.size();for(var H=K.getElevation(),B=V.getElevation(),y=0;q>y;y++){var M=b.get(y);M.e==k&&(M.e=H+(B-H)*y/(q-1))}D=Kp(b.get(0)),a=Kp(b.get(q-1));var P=q%2;0===P?(w.c1=Kp(b.get(q/2-1)),w.c2=Kp(b.get(q/2))):w.p3=Kp(b.get((q-P)/2)),w.s1=D,w.s2=Kp(b.get(1)),w.t1=Kp(b.get(q-2)),w.t2=a}else{b=new pq,w=h.info={};var z=e("edge.offset"),t=e("edge.center"),g=e("edge.source.t3"),X=e("edge.target.t3"),O=K.p3(),x=V.p3();if(g&&(O[0]+=g[0],O[1]+=g[1],O[2]+=g[2]),X&&(x[0]+=X[0],x[1]+=X[1],x[2]+=X[2]),c===Rh){A=e("edge.segments");var T=w.points=e(ee)||kb;if(q=T.size()){D=Kp(T.get(0)),a=Kp(T.get(q-1)),!t&&z&&(J=rr(D,O,!0),z=$(z,wh(O,D)),O=[O[0]+J[0]*z,O[1]+J[1]*z,O[2]+J[2]*z],J=rr(x,a,!0),z=$(z,wh(a,x)),x=[x[0]-J[0]*z,x[1]-J[1]*z,x[2]-J[2]*z]);var P=q%2;0===P?(j=Kp(T.get(q/2-1)),G=Kp(T.get(q/2))):w.p3=Kp(T.get((q-P)/2)),w.s1=O,w.s2=D,w.t1=a,w.t2=x}else!t&&z&&(J=rr(x,O,!0),Q=wh(O,x),z=Nr(z,Q),O=[O[0]+J[0]*z,O[1]+J[1]*z,O[2]+J[2]*z],x=[x[0]-J[0]*z,x[1]-J[1]*z,x[2]-J[2]*z]),j=O,G=x;b.add({x:O[0],y:O[2],e:O[1]}),b.addAll(T),b.add({x:x[0],y:x[2],e:x[1]})}else{var o=gf(h,i,p,E,c);if(h._19Q||(o=-o),E){var v=O[0],m=O[1],Y=O[2],d=K.getTall()/2+o;j=[v-o,m+d,Y],G=[v+o,m+d,Y],b.add({x:v-o,y:Y,e:m}),b.add({x:v-o,y:Y,e:m+d}),b.add({x:v+o,y:Y,e:m+d}),b.add({x:v+o,y:Y,e:m})}else{J=rr(x,O,!0),Q=wh(O,x);var N={x:O[0],y:O[2]},C={x:x[0],y:x[2]},s=Pi(k,N,C,o),W=s.x-N.x,R=s.y-N.y;z=Nr(z,Q),J[0]*=z,J[1]*=z,J[2]*=z,j=[O[0]+J[0]+W,O[1]+J[1],O[2]+J[2]+R],G=[x[0]-J[0]+W,x[1]-J[1],x[2]-J[2]+R],t?(b.add({x:O[0],y:O[2],e:O[1]}),b.add({x:j[0],y:j[2],e:j[1]}),b.add({x:G[0],y:G[2],e:G[1]}),b.add({x:x[0],y:x[2],e:x[1]})):(b.add({x:j[0],y:j[2],e:j[1]}),b.add({x:G[0],y:G[2],e:G[1]}))}}w.c1=j,w.c2=G}w.list=e(il)===zk?h.createTubeModel(b,A,u/2,F):h.createLineModel(b,A,u,"edge","edge.dash")}}});var dj=function(v,M){uj(dj,this,[v,M])};Zi(dj,Yh,{_80o:function(S,l,T){var R=this,u=R.gv,p=R.shapeModel;vi(u,R.mat),p?Ap(u,R.data,p,R,R.getBodyColor(),T):(hr(R,S,l,R.left,T),hr(R,S,l,R.front,T),hr(R,S,l,R.right,T),hr(R,S,l,R.back,T),hr(R,S,l,R.top,T),hr(R,S,l,R.bottom,T)),_r(u)},validate:function(l,d){var j,$,r=this,H=r.s,A=r.data,V=A.p3(),T=A._thickness/2,E=A.isClosePath(),z=A.getPoints(),O=A.getSegments(),Q=H(zs),_=l&&l.uv;if(r.clear(),0>T)$=r.shapeModel=Lq(z,O,H(ek),H(re),Q,H(dd),A.getTall(),A.getShapeElevation(),E),H(er)?H("shape3d.image")||delete $.uv:(delete $.vs,delete $.ns,delete $.uv),H("shape3d.top.image")||delete $.top_uv,H("shape3d.bottom.image")||delete $.bottom_uv;else if(H(il)===zk)j=vb(z,O,Q,E),$=r.shapeModel={vs:[]},H("shape3d.image")&&($.uv=[],$.sum=H(dd)||Ao(j)||1,$.len=0),H(ek)&&!E&&($.top_vs=[],H("shape3d.top.image")&&($.top_uv=[])),H(re)&&!E&&($.bottom_vs=[],H("shape3d.bottom.image")&&($.bottom_uv=[])),r._12O(j,T);else{var c,n,W,h,C,Y,s,o,t,g;if(j=vb(z,O,Q,E),C=r.vf(Vi,_,!1,d),T&&(Y=r.vf(ze,_,!1,d),s=E?k:r.vf(fq,_,!1,d),o=E?k:r.vf(nb,_,!1,d),t=r.vf(Bp,_,!1,d),g=r.vf(sm,_,!1,d)),T){for(var F=0,M=j.length;M>F;F++)j[F]=r._tryRemoveBezierPoints(j[F],T);r._12O(j,T)}else C&&j.forEach(function(U){if(h=U.length,h>0)for(c=U[0],W=1;h>W;W++)n=U[W],r.addV(C.vs,c,n),c=n});r._20Q(j),l||(C&&(C.ns=ri(C.vs),ic(C,"vs"),ic(C,Pc)),T&&(Y&&(Y.ns=ri(Y.vs),ic(Y,"vs"),ic(Y,Pc)),s&&(s.ns=ri(s.vs),ic(s,"vs"),ic(s,Pc)),o&&(o.ns=ri(o.vs),ic(o,"vs"),ic(o,Pc)),t&&(t.ns=ri(t.vs),ic(t,"vs"),ic(t,Pc)),g&&(g.ns=ri(g.vs),ic(g,"vs"),ic(g,Pc))))}var m=r.mat=cn();xl(m,V),wi(m,A.getFinalRotation3d(),A.getRotationMode());var q=A.getScale3d(),L=A._dynamicScale3d;L&&(q[0]*=L[0],q[1]*=L[1],q[2]*=L[2]),ch(m,q),xl(m,tr(V)),l&&(ie(r,m,l,$),r.clear())},_20Q:function(p){var Q,d,X,G,n,b,M,i=this,h=i.front,e=i.back,T=i.top,z=i.bottom,t=h?h.tuv:k,V=e?e.tuv:k,g=T?T.tuv:k,U=z?z.tuv:k,$=0;(t||V||g||U)&&(Q=i.s(dd)||Ao(p)||1,p.forEach(function(m){if(d=m.length,d>0)for(b=m[0],X=1;d>X;X++)M=m[X],G=$/Q,$+=wh(b,M),n=$/Q,i._14O(h,G,n),i._14O(e,1-n,1-G),i._14O(T,G,n),i._14O(z,G,n),b=M}))},_14O:function(M,_,V){if(M){var p=M.uv,s=M.tuv;if(s){if(p)var Q=p[0]+(p[6]-p[0])*_,j=p[1]+(p[7]-p[1])*_,W=p[2]+(p[4]-p[2])*_,K=p[3]+(p[5]-p[3])*_,z=p[2]+(p[4]-p[2])*V,Y=p[3]+(p[5]-p[3])*V,o=p[0]+(p[6]-p[0])*V,H=p[1]+(p[7]-p[1])*V;else Q=_,j=0,W=_,K=1,z=V,Y=1,o=V,H=0;s.push(W,K,z,Y,o,H,o,H,Q,j,W,K)}}},_13O:function(o){var j=o.uv,p=o.tuv;p&&(j?p.push(j[2],j[3],j[4],j[5],j[6],j[7],j[6],j[7],j[0],j[1],j[2],j[3]):p.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(M,j){var i=M.length;if(4>i)return M;var Z,W,g,R,$,E,O=!1,G=function(W){return M[W]},L=function(Y){return M[i-1-Y]};for($=0;1>=$;$++)for(E=$?L:G,W=E(0),g=E(1),Z=2;i-1>Z;Z++)if(R=E(Z),!R.remove)if(R.b){var N=Pi(W,g,R,j);N.adjust?(R.remove=!0,O=!0):(W=g,g=R)}else W=g,g=R;if(!O)return M;var F=[];for(Z=0;i>Z;Z++)M[Z].remove||F.push(M[Z]);return F},_12O:function(B,N){var j,L,a,h,Z,D=this;B.forEach(function(E){if(Z=E.length,Z>0)for(j={p:E[0],n:!0},h=1;Z>h;h++)L=E[h],a=Z-1>h?E[h+1]:k,D.addPoint(j,L,a,N,E)})},addPoint:function(X,W,T,Q,C){var t,I,H,E,_,d,y,F,A,R=this,Y=X.p,S=X.f,$=X.b,z=R.s("shape3d.side")||$f,w=R.s("shape3d.start.angle"),c=R.s("shape3d.sweep.angle"),j=R.shapeModel,m=R.data.isClosePath();if(X.n&&(X.n=!1,S=m&&C.length>2?Pi(C[C.length-2],Y,W,Q):Pi(k,Y,W,Q),$=ml(Y,S),j?j.top_vs&&R._10O($,S,z,w,c,j.top_vs,j.top_uv):(t=R.left)&&(R.addV(t.vs,$,S),R._13O(t))),I=T?Pi(Y,W,T,Q):m&&C.length>2?Pi(Y,W,C[1],Q):Pi(Y,W,k,Q),H=ml(W,I),j){var n,M,O=j.vs,G=j.uv,L=j.sum;for(G&&(n=j.len/L,j.len+=wh(Y,W),M=j.len/L),d=R._9O($,S,z,w,c),y=R._9O(H,I,z,w,c),F=0;z>F;F++)A=F+1,ke(O,d[A]),ke(O,y[F]),ke(O,d[F]),ke(O,y[F]),ke(O,d[A]),ke(O,y[A]),G&&(E=F/z,_=A/z,G.push(n,_,M,E,n,E,M,E,n,_,M,_));!T&&j.bottom_vs&&R._10O(H,I,z,w,c,j.bottom_vs,j.bottom_uv,!0)}else!T&&(t=R.right)&&(R.addV(t.vs,I,H),R._13O(t)),(t=R.front)&&R.addV(t.vs,S,I),(t=R.back)&&R.addV(t.vs,H,$),(t=R.top)&&R.addH(t.vs,S,I,H,$,!0),(t=R.bottom)&&R.addH(t.vs,$,H,I,S);X.p=W,X.f=I,X.b=H},_10O:function(F,n,x,O,h,H,l,R){var A,Z,k=this,_=k.data,X=k._9O(F,n,x,O,h),d=(F.x+n.x)/2,$=(F.y+n.y)/2,s=_.getShapeElevation(),a=0;for(a=0;x>a;a++)R?(ke(H,X[a]),ke(H,X[a+1])):(ke(H,X[a+1]),ke(H,X[a])),ke(H,[d,s,$]),l&&(R?(A=o*(a+1)/x+O,Z=o*a/x+O):(A=o*a/x+O,Z=o*(a+1)/x+O),l.push(.5-.5*P(Z),.5-.5*e(Z),.5-.5*P(A),.5-.5*e(A),.5,.5))},_9O:function(y,E,w,z,T){var D,r,Z=this,K=Z.data,b=[],m=(y.x+E.x)/2,q=(y.y+E.y)/2,d=K.getTall()/2,G=K.getShapeElevation(),x=0;for(T=T||o;w>=x;x++)D=T*x/w+z,r=P(D),b.push([m+(y.x-m)*r,G+d*e(D),q+(y.y-q)*r]);return b},addV:function(L,X,x){var O=X.x,j=X.y,K=x.x,k=x.y,y=this.data,B=y.getShapeElevation(),z=y.getTall()/2;L.push(O,B-z,j,K,B-z,k,K,B+z,k,K,B+z,k,O,B+z,j,O,B-z,j)},addH:function(c,r,K,k,Y,X){var o=this.data,F=o.getTall()/2,I=o.getShapeElevation()+(X?F:-F);c.push(r.x,I,r.y,K.x,I,K.y,k.x,I,k.y,k.x,I,k.y,Y.x,I,Y.y,r.x,I,r.y)},vf:function(n,G,X,o){var M,f=this,l=f.gv.getFaceVisible(f.data,n);return(X||l)&&(M=Uh(f,n,o),M.vs=[],M.tuv=l&&(M.texture||G)?[]:k,M.visible=l),M}});var gb=function(v,k){uj(gb,this,[v,k])};Zi(gb,Pe,{_25Q:1,validate:function(J){var t=this,K=t.data,g=t.s,r=K.getPoints(),G=r.size();if(t.shapeModel=t.info=k,G>1){var y=t.info={},d=K.getSegments(),O=K.getThickness(),b=Kp(r.get(0)),C=Kp(r.get(G-1)),D=G%2;0===D?(y.c1=Kp(r.get(G/2-1)),y.c2=Kp(r.get(G/2))):y.p3=Kp(r.get((G-D)/2)),y.s1=b,y.s2=Kp(r.get(1)),y.t1=Kp(r.get(G-2)),y.t2=C,y.list=g(il)===zk?t.createTubeModel(r,d,O/2,J):t.createLineModel(r,d,O,"shape.border","shape.dash")}var q=K.p3(),Y=t.mat=cn();xl(Y,q),wi(Y,K.getFinalRotation3d(),K.getRotationMode());var V=K.getScale3d(),I=K._dynamicScale3d;I&&(V[0]*=I[0],V[1]*=I[1],V[2]*=I[2]),ch(Y,V),xl(Y,tr(q))},_80o:function(L,F,m){var S=this,G=S.shapeModel;if(G){var u=S.gv;vi(u,S.mat),Ap(u,S.data,G,S,S.getBodyColor(),m),_r(u)}}});var wj=C.graph3d.VR=function(q){var U=this;U.gv=q,U._controllers=[],U.switch=new Rp(U),U._enable=!1,U._defaultCallLater=C.Default.callLater,U._defaultCancelLater=be,"undefined"!=typeof B&&"VRFrameData"in B&&(U._frameData=new B.VRFrameData),U.measureOflength=1,U.eyesOffset=[0,0,0],U._orientation=new C.Math.Quaternion,U._lastHeadPose=[0,0,0],U._offsetToBeAdd=[0,0,0],U._fpsInfo={time:0,fps:0,frames:0}};Zi(wj,c,{ms_fire:!0,_42:function(Q,T,$,b){var s=this,A=s.gv;if(!A.drawFilter&&s._deviceInAction){var v=s._device;if(v){var p=s._measureOflength;v.depthNear=A.getNear()*p,v.depthFar=A.getFar()*p;var S=s._offsetToBeAdd;if(s.eyesOffset[0]+=S[0],s.eyesOffset[1]+=S[1],s.eyesOffset[2]+=S[2],S[0]=0,S[1]=0,S[2]=0,v.isPresenting===!1)return s._controllers.forEach(function(c){c&&c.update()}),A.iv(),!1;var R=s._frameData;v.getFrameData(R);var Y=R.pose.position;if(Y){var e=s.toViewPosition(Y);A.setEye(e),s._orientation.fromArray(R.pose.orientation);var E=new C.Math.Vector3(0,0,-10*s._scaleFactor);E.applyQuaternion(s._orientation),A.setCenter([e[0]+E.x,e[1]+E.y,e[2]+E.z])}s._controllers.forEach(function(a){a&&a.update()}),A.setViewport(Q,0,0,T/2,$),s._viewMatrix=s._copyViewMatrix(R.leftViewMatrix),s._projectMatrix=s._copyProjectMatrix(R.leftProjectionMatrix),b(),A.setViewport(Q,T/2,0,T/2,$),s._viewMatrix=s._copyViewMatrix(R.rightViewMatrix),s._projectMatrix=s._copyProjectMatrix(R.rightProjectionMatrix),b(),s._lastViewMatrix=s._viewMatrix,s._lastProjectMatrix=s._projectMatrix,s._viewMatrix=null,s._projectMatrix=null,s.submitFrame();var U=Date.now(),t=s._fpsInfo;return U-t.time>1e3?(t.fps=Math.round(1e3*(t.frames+1)/(U-t.time)),t.time=U,t.frames=0):t.frames++,!0}}},onVRDisplayPresentChange:function(){var Z=this.isPresenting();this._injectGraphView(Z),this.fp("present",!Z,Z)},getOrientation:function(){return this._orientation},addController:function(G){G=G||0;var J=this,I=J.getController(G);return I?I:(I=new hf(J,G),J._controllers.push(I),I)},getController:function(E){E=E||0;for(var b=this._controllers,x=0,r=b.length;r>x;x++)if(b[x]&&b[x].id===E)return b[x];return null},removeController:function(M){M=M||0;for(var l=this._controllers,Q=0,W=l.length;W>Q;Q++)if(l[Q]&&l[Q].id===M)return l.splice(Q,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(E,k){var C=this,t=C._scaleFactor,D=C._eyesOffset,j=C._lastHeadPose;return j[0]=E[0]*t,j[1]=E[1]*t,j[2]=E[2]*t,k?(k[0]=j[0]+D[0],k[1]=j[1]+D[1],k[2]=j[2]+D[2],k):[j[0]+D[0],j[1]+D[1],j[2]+D[2]]},addEyesOffset:function(U,M,c){var z=this._offsetToBeAdd;z[0]+=U,z[1]+=M,z[2]+=c},_copyViewMatrix:function(K){var O=this.dup(K),r=this._scaleFactor;O[12]*=r,O[13]*=r,O[14]*=r;var B=this._eyesOffset;if(B&&(B[0]||B[1]||B[2])){var H=B[0],v=B[1],o=B[2];O[12]-=O[0]*H+O[4]*v+O[8]*o,O[13]-=O[1]*H+O[5]*v+O[9]*o,O[14]-=O[2]*H+O[6]*v+O[10]*o}return O},shutdown:function(){var b=this._device;b&&b.isPresenting&&b.exitPresent()},isPresenting:function(){var S=this._device;return S&&S.isPresenting},_copyProjectMatrix:function(n){var q=this.dup(n),t=this._scaleFactor;return q[14]*=t,q},dup:function(Z,X){for(var W=Z.length,L=X||new Array(W);W--;)L[W]=Z[W];return L},getViewMatrix:function(j){var t=this._viewMatrix;return t?this.dup(t,j):void 0},getProjectMatrix:function(){var Y=this._projectMatrix;return Y?this.dup(Y):void 0},submitFrame:function(){var j=this;if(j._enable&&j._deviceInAction){var C=j._device;C&&C.isPresenting&&(C.submitFrame(),j.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(L){var m=this.gv;return m.intersectObjects(L,m.dm().getDatas())},setDevice:function(D){var E=this;E._device=D},_injectGraphView:function(){var P,H,W;return function(B){var Q=this.gv;if(!B)return P&&(Q.getWidth=P,Q.getHeight=H,Q.getDevicePixelRatio=W),void 0;var h=this._device,d=h.getEyeParameters("left"),g=d.renderWidth,n=d.renderHeight;P=Q.getWidth,H=Q.getHeight,W=Q.getDevicePixelRatio,Q.getWidth=function(){return 2*g},Q.getHeight=function(){return n},Q.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(i){var p=this;if(!i)return Cm=C.Default.callLater=p._defaultCallLater,be=C.Default.cancelLater=p._defaultCancelLater,void 0;var p=this;Cm=C.Default.callLater=function(I,U,g,u){var l=p._device;return l&&l.isPresenting?u?N(function(){Cm(I,U,g)},u):l.requestAnimationFrame(function(){p._deviceInAction=!0,I.apply(U,g),p._deviceInAction=!1}):p._defaultCallLater(I,U,g,u)},be=C.Default.cancelLater=function(q,c){var Z=p._device;return Z&&Z.isPresenting?c?T(q):Z.cancelAnimationFrame(q):p._defaultCancelLater(q,c)}}}),c.defineProperties(wj.prototype,{enable:{get:function(){return this._enable},set:function(f){var U=this;U._enable!==f&&(U._enable=f,f?(U.switch.showButton(),U._injectCallLaterFunc(!0)):(U.shutdown(),U.switch.hideButton(),U._injectCallLaterFunc(!1)),U.fp("enable",!f,f))}},measureOflength:{get:function(){return this._measureOflength},set:function(V){this._measureOflength=V;var K=this._scaleFactor=1/V;this._controllers.forEach(function(j){j&&j._setScaleFactor(K)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(o){this._eyesOffset=o}},controllerModel:{get:function(){return this._controllerModel},set:function(y){var t;"object"==typeof y?(t=y.mtl,y=y.obj):(t=y+".mtl",y+=".obj");var w=this,r=w._controllerModel;r&&r.obj===y&&r.mtl===t||(r=w._controllerModel={obj:y,mtl:t},I.loadObj(y,t,{finishFunc:function(T,U){w._controllerModel===r&&I.setShape3dModel("vrControllerModel",U)}}))}},interactive:{get:function(){return!!this._interactive},set:function(v){!!v!=!!this._interactive&&(this._interactive=v,v&&this.addController(0),this.gv.getCoreInteractor().enableVR(v))}}});var hf=function(l,h){function e(u){var P=navigator.getGamepads&&navigator.getGamepads();if(P)for(var H=0,b=0,C=P.length;C>H;H++){var l=P[H];if(l){var J=l.id;if("OpenVR Gamepad"===J||"OpenVR Controller"===J||0===J.indexOf("Oculus Touch")||0===J.indexOf("Spatial Controller")){if(b===u)return l;b++}}}}function K(m,l,U){return Math.abs(m[0]-l[0])<U&&Math.abs(m[1]-l[1])<U&&Math.abs(m[2]-l[2])<U?!0:!1}var L=this;L.vr=l,L.id=h;var a,x,R=[0,0],c=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],G=new gd;G.s("shape3d","vrControllerModel"),G.isController=!0,G.s("intersect",!1),L.getGamepad=function(){return x},L.isButtonPressed=function(z){for(var J,o=0,G=c.length;G>o;o++)if(J=c[o],J.id===z)return J.pressed;return!1},L.getNode=function(){return G};var f=.003;L.setRotationEpsilon=function(Y){f=Y};var _=5e-4,p=_;L.setPositionEpsilon=function(z){_=z,p=z*L.vr._scaleFactor},L._setScaleFactor=function(i){G.s3(i,i,i),p=_*i},L._setScaleFactor(L.vr._scaleFactor);var S,T=new ig,d=new un,Z=[0,0,0],E=[0,0,0],w=new Gl,J=new ge,v=new Oh;L.getRay=function(){return S?(v.origin.fromArray(Z),v.direction.copy(J),S=!1,v):v},L.update=function(){if(a=x,x=e(h),a!=x&&console.log("gamepad changed",x),!x||x.pose===V)return x=null,G.s("3d.visible",!1),void 0;if(I.getShape3dModel("vrControllerModel")){G.dm()||l.gv.dm().add(G),G.s("3d.visible",!0);var U=x.pose;if(null!==U){U.position&&(L.vr.toViewPosition(U.position,Z),K(G.p3(),Z,p)||(S=!0,G.p3(Z))),U.orientation&&(T.fromArray(U.orientation),J.set(0,0,-1).applyQuaternion(T).normalize(),d.makeRotationFromQuaternion(T),w.set(0,0,0,G.getRotationMode(),!0).setFromRotationMatrix(d),E[0]=w.x,E[1]=w.y,E[2]=w.z,K(G.r3(),E,f)||(S=!0,G.r3(E))),S&&l.fp("gamepad.pose",null,{position:Z,rotation:E,id:h});var _=x.axes;(R[0]!==_[0]||R[1]!==_[1])&&(R=[_[0],_[1]],l.fp("gamepad.axes",null,{id:h,axes:R}));var M,y,C,n,g=x.buttons;for(M=0,y=g.length;y>M;M++)if(C=g[M],n=C.pressed,n!==c[M].pressed){c[M].pressed=n;var k={id:h},Q="state";k[Q]=k._62O=n?"down":"up",l.fp("gamepad.button."+c[M].id,null,k)}}}}},Rp=function(O){this.vr=O,this._button=null};Zi(Rp,c,{showButton:function(){var m=this.assureButton();if(!m.parentNode){var G=this.vr.gv,x=G.getView();G._79O?x.insertBefore(m,G._79O):x.appendChild(m)}},hideButton:function(){var f=this._button;f&&f.parentNode&&f.parentNode.removeChild(f)},assureButton:function(){var w=this._button;return w?w:this._button=this.createButton(this.vr.gv)},createButton:function(p){function J(c,G){c.textContent=G&&G.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function A(w){y.style.display="",y.style.cursor="pointer",y.style.left="calc(50% - 50px)",y.style.width="100px",J(y,w),y.onmouseenter=function(){y.style.opacity="1.0"},y.onmouseleave=function(){y.style.opacity="0.5"},y.onclick=function(){w.isPresenting?w.exitPresent():w.requestPresent([{source:p.getCanvas()}])},p.vr.setDevice(w)}function c(){y.style.display="",y.style.cursor="auto",y.style.left="calc(50% - 75px)",y.style.width="150px",J(y,null),y.onmouseenter=null,y.onmouseleave=null,y.onclick=null,p.vr.setDevice(null)}function S(s){s.style.position="absolute",s.style.bottom="20px",s.style.padding="12px 6px",s.style.border="1px solid #fff",s.style.borderRadius="4px",s.style.color="#000",s.style.font="normal 13px sans-serif",s.style.textAlign="center",s.style.opacity="0.5",s.style.outline="none",s.style.zIndex="999"}if("getVRDisplays"in navigator){var y=this._button=b.createElement("button");return y.style.display="none",S(y),B.addEventListener("vrdisplayconnect",function(v){A(v.display)},m),B.addEventListener("vrdisplaydisconnect",function(){c()},m),B.addEventListener("vrdisplaypresentchange",function(E){J(y,E.display),p.vr.onVRDisplayPresentChange()},m),navigator.getVRDisplays().then(function(i){i.length>0?A(i[0]):c()}),y}var o=b.createElement("a");return o.href="https://webvr.info",o.innerHTML="当前不支持 webvr",o.style.left="calc(50% - 90px)",o.style.width="180px",o.style.textDecoration="none",S(o),o}}),c.defineProperties(Rp.prototype,{});var rm=C.graph3d.PostProcessing=function(W){function _(){if(!N){var O=W.getGL();N=new tq.RenderTarget(W,O),H=new Qm.Shader(O,f.vs,f.fs),C=Qm.Buffer.createIndexBuffer(O,new Uint16Array([0,2,1,1,2,3])),V=Qm.Buffer.createVertexBuffer(O,new Float32Array([0,0,1,0,0,1,1,1]))}}var N,H,C,V,X=this,y={},D=!1;!function(){c.keys(rm).forEach(function(u){y[u]=new rm[u](W)})}(),X.getModule=function(q){return q?y[q]:y},X.getModuleList=function(){return c.keys(y)},X.handleDataModleChange=function(q,Y){q&&(q.setPostProcessingData(X.serialize()),q.removeSerializeListener(X.onDataModelSerialize,X)),Y&&(Y.addSerializeListener(X.onDataModelSerialize,X),X.deserialize(Y.getPostProcessingData()))},X.onDataModelSerialize=function(K){"serialize"===K.type?W.dm()._postProcessingData=X.serialize():"deserialize"===K.type&&X.deserialize(W.dm().getPostProcessingData())},X.serialize=function(){var C,o,k,w={};for(C in y)o=y[C],w[C]={enable:o.enable},k=o.serializeProperties,k&&k.forEach(function(g){w[C][g]=o[g]});return w},X.deserialize=function(u){if(u){var S,U,e,c;for(S in u)if(U=y[S]){e=u[S],X.enableModule(S,e.enable);for(c in e)"enable"!==c&&(U[c]=e[c])}}else{var S,U;for(S in y)U=y[S],U.enable=!1,U.resetProperties&&U.resetProperties()}},X.enableModule=function(F,P){var f,q,h,M=F.split(",");for(f=0,q=M.length;q>f;f++)h=M[f].trim(),y[h]&&(y[h].enable=P);D=!1;for(h in y)if(y[h].enable){D=!0;break}D&&_()};var f={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};X._42=function(O,I,m,k,G){if(D&&!G){N.setSize(O,I,m),pm(O,N.frame),O.clear(O.COLOR_BUFFER_BIT|O.DEPTH_BUFFER_BIT),W.setViewport(O,0,0,I,m),k();var i,B=N;for(i in y)B=y[i]._42(O,B)||B;return Ie(O),W.setViewport(O,0,0,I,m),O.clear(O.COLOR_BUFFER_BIT|O.DEPTH_BUFFER_BIT),H.bind(),O.activeTexture(O.TEXTURE0+0),O.bindTexture(O.TEXTURE_2D,B.texture),H.uniforms.image=0,C.upload(),V.upload(),H.attributes.pos.pointer(V),O.drawElements(O.TRIANGLES,6,O.UNSIGNED_SHORT,0),O.bindTexture(O.TEXTURE_2D,null),O.useProgram(W._prg),!0}}},Zm=C.graph3d.PostProcessing.Bloom=function(W){function j(){var I=W.getWidth(),g=W.getHeight();if(I&&g){G=[I,g],t=!0;var w,f=W.getGL(),A=Math.round(G[0]/2),_=Math.round(G[1]/2);for(O=new tq.RenderTarget(W,f,A,_),w=0;v>w;w++)S.push(new tq.RenderTarget(W,f,A,_)),P.push(new tq.RenderTarget(W,f,A,_)),A=Math.round(A/2),_=Math.round(_/2);p=new Qm.Shader(f,Zm.highPassShader.vs,Zm.highPassShader.fs);for(var w=0;v>w;w++)C[w]=new Qm.Shader(f,Zm.blurShader.vs,Zm.blurShader.fs.replace(/DEFINE_VALUE/g,d[w]));U=new Qm.Shader(f,Zm.compositeShader.vs,Zm.compositeShader.fs.replace(/NUM_MIPS/g,v)),Y=new Qm.Shader(f,Zm.finalShader.vs,Zm.finalShader.fs),r=Qm.Buffer.createIndexBuffer(f,new Uint16Array([0,2,1,1,2,3])),M=Qm.Buffer.createVertexBuffer(f,new Float32Array([0,0,1,0,0,1,1,1]))}}var y,K,E,r,M,z=this,F=!1,t=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){y=1.5,K=.55,E=.4},c.defineProperties(z,{enable:{get:function(){return F},set:function(H){!!F!=!!H&&(F=H,H&&!t&&j())}},strength:{get:function(){return y},set:function(O){y=O}},threshold:{get:function(){return K},set:function(U){K=U}},radius:{get:function(){return E},set:function(j){E=j}}}),this.resetProperties();var O,p,U,Y,G=[256,256],S=[],P=[],v=5,d=[3,5,7,9,11],C=[];z._42=function(Z,i){function m(k,u,l,x){pm(Z,u.frame),W.setViewport(Z,0,0,u.width,u.height),x?x(Z):Z.clear(Z.COLOR_BUFFER_BIT|Z.DEPTH_BUFFER_BIT),A!==k&&k.bind();
var y=0;for(var v in l){var G=l[v];G instanceof WebGLTexture&&(Z.activeTexture(Z.TEXTURE0+y),Z.bindTexture(Z.TEXTURE_2D,G),G=y,y++),k.uniforms[v]=G}for(A!==k&&(r.upload(),M.upload(),k.attributes.pos.pointer(M),A=k),Z.drawElements(Z.TRIANGLES,6,Z.UNSIGNED_SHORT,0);y--;)Z.activeTexture(Z.TEXTURE0+y),Z.bindTexture(Z.TEXTURE_2D,null);Ie(Z)}if(F){t||j();var A;m(p,O,{smoothWidth:.01,luminosityThreshold:K,tDiffuse:i.texture});var $,o=O,N=Math.round(G[0]/2),R=Math.round(G[1]/2);for($=0;v>$;$++)m(C[$],S[$],{colorTexture:o.texture,direction:[1,0],texSize:[N,R]}),m(C[$],P[$],{colorTexture:S[$].texture,direction:[0,1],texSize:[N,R]}),N=Math.round(N/2),R=Math.round(R/2),o=P[$];return m(U,S[0],{blurTexture1:P[0].texture,blurTexture2:P[1].texture,blurTexture3:P[2].texture,blurTexture4:P[3].texture,blurTexture5:P[4].texture,bloomStrength:y,bloomRadius:E,bloomTintColor:[1,1,1]}),m(Y,i,{image:S[0].texture},function(S){S.enable(S.BLEND),S.blendEquation(S.FUNC_ADD),S.blendFunc(S.SRC_ALPHA,S.ONE)}),Z.blendEquationSeparate(Z.FUNC_ADD,Z.FUNC_ADD),Z.blendFuncSeparate(Z.SRC_ALPHA,Z.ONE_MINUS_SRC_ALPHA,Z.ONE,Z.ONE_MINUS_SRC_ALPHA),i}}};Zm.highPassShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D tDiffuse;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4(0.0, 0.0, 0.0, 0.0);","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},Zm.blurShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D colorTexture;","uniform vec2 texSize;","uniform vec2 direction;","#define KERNEL_RADIUS DEFINE_VALUE","#define SIGMA DEFINE_VALUE","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float fSigma = float(SIGMA);","float weightSum = gaussianPdf(0.0, fSigma);","vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;","for( int i = 1; i < KERNEL_RADIUS; i ++ ) {","float x = float(i);","float w = gaussianPdf(x, fSigma);","vec2 uvOffset = direction * invSize * x;","vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;","vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;","diffuseSum += (sample1 + sample2) * w;","weightSum += 2.0 * w;","}","gl_FragColor = vec4(diffuseSum/weightSum, 1.0);","}"].join("\n")},Zm.compositeShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D blurTexture1;","uniform sampler2D blurTexture2;","uniform sampler2D blurTexture3;","uniform sampler2D blurTexture4;","uniform sampler2D blurTexture5;","uniform sampler2D dirtTexture;","uniform float bloomStrength;","uniform float bloomRadius;","uniform vec3 bloomTintColor;","float lerpBloomFactor(const in float factor) {","float mirrorFactor = 1.2 - factor;","return mix(factor, mirrorFactor, bloomRadius);","}","void main() {","gl_FragColor = bloomStrength * ( lerpBloomFactor(1.0) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture1, vUv) + ","lerpBloomFactor(0.8) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture2, vUv) + ","lerpBloomFactor(0.6) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture3, vUv) + ","lerpBloomFactor(0.4) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture4, vUv) + ","lerpBloomFactor(0.2) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture5, vUv) );","}"].join("\n")},Zm.finalShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")},fs(I,{accordionViewExpandIcon:Jo(xr),accordionViewCollapseIcon:Jo(xr,!0),accordionViewLabelColor:ls,accordionViewLabelFont:sd,accordionViewTitleBackground:Be,accordionViewSelectBackground:jd,accordionViewSelectWidth:3,accordionViewSeparatorColor:V,splitViewDividerSize:1,splitViewDividerBackground:Be,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Kk,rect:[2,2,12,12],background:xr}]},propertyViewLabelColor:zn,propertyViewLabelSelectColor:ls,propertyViewLabelFont:sd,propertyViewExpandIcon:Jo(ws),propertyViewCollapseIcon:Jo(ws,!0),propertyViewBackground:As,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:hc,propertyViewColumnLineColor:hc,propertyViewSelectBackground:jd,listViewLabelColor:zn,listViewLabelSelectColor:ls,listViewLabelFont:sd,listViewRowLineVisible:!1,listViewRowLineColor:hc,listViewSelectBackground:jd,treeViewLabelColor:zn,treeViewLabelSelectColor:ls,treeViewLabelFont:sd,treeViewExpandIcon:Jo(Cc),treeViewCollapseIcon:Jo(Cc,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:hc,treeViewSelectBackground:jd,treeViewDoubleClickToToggle:!0,tableViewLabelColor:zn,tableViewLabelSelectColor:ls,tableViewLabelFont:sd,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:hc,tableViewColumnLineColor:hc,tableViewSelectBackground:jd,treeTableViewLabelColor:zn,treeTableViewLabelSelectColor:ls,treeTableViewLabelFont:sd,treeTableViewExpandIcon:Jo(Cc),treeTableViewCollapseIcon:Jo(Cc,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:hc,treeTableViewColumnLineColor:hc,treeTableViewSelectBackground:jd,tableHeaderLabelColor:zn,tableHeaderLabelFont:sd,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Di,tableHeaderBackground:As,tableHeaderMoveBackground:qr,tableHeaderInsertColor:jd,tableHeaderSortDescIcon:li(ws,!0),tableHeaderSortAscIcon:li(ws),tabViewTabGap:1,tabViewLabelColor:ls,tabViewLabelFont:sd,tabViewTabBackground:Be,tabViewSelectWidth:3,tabViewSelectBackground:jd,tabViewMoveBackground:qr,tabViewInsertColor:jd,toolbarLabelColor:zn,toolbarLabelSelectColor:ls,toolbarLabelFont:sd,toolbarBackground:As,toolbarSelectBackground:jd,toolbarItemGap:8,toolbarSeparatorColor:ul},!0);var Cp={translateX:1,sortColumn:1},Sn={sortable:1,sortOrder:1,sortFunc:1},us={focusData:1},Dj={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Xl={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},bd=function(I,T){T.add(I),I.hasChildren()&&I.eachChild(function(h){bd(h,T)})},ck=function(C,v,B,t,J,M,Z,D,f,U,A){var P,K=B.getValueType(U),s=B.getAlign(U);if(B.getEnumValues(U)){var S=B.toEnumLabel(v,U),u=Rj||0,w=0,N=M,Q=I.getTextSize(t,S).width;return P=Ne(B.toEnumIcon(v,U)),P&&(w=M+Rj/2,"center"===s?w+=(D-(u+Q))/2:"right"===s&&(w=w+D-(u+Q)),Cd(C,P,w,Z+f/2,U,A),N=w+Rj/2),S!=k&&(P?qg(C,S,t,J,N,Z,D-(N-M),f):qg(C,S,t,J,M,Z,D,f,s)),void 0}return v=B.formatValue(v),v!=k?K===Nb?(yq(C,M,Z,D,f,v),void 0):K===md||!K&&Wq(v)?(P=Ne(v?Vr:Md),Cd(C,P,M+D/2,Z+f/2,U,A),void 0):(qg(C,v,t,J,M,Z,D,f,s),void 0):void 0},Ih=function(E,A){var D=A.view,r=Dk(E),z=A.column||A.property;D.getDataModel().beginTransaction(),A.editor=E,E.info=A,D.setCurrentEditor(E),D.getView().insertBefore(r,D._79O),qi(E,A.editorRect),E.setFocus?E.setFocus():jj(E),E.commitValue=function(y,W){E._17Q&&(E=E._17Q),W||D.setValue(A.data,z,E.getValue?E.getValue():E.value),E.close&&E.close(),Zj(r)},z.onEditorCreated&&z.onEditorCreated(A)},Dr=function(v,S,P,e,F){var K=eo(v,P),u=S.value,M=S.view,V=F.getValueType(S.data);return K.onblur=K.onchange=function(){M.endEditing()},"input"===v?(u=F.formatValue(u),u!=k&&(K.value=u),K.onkeydown=function(K){Wh(K)?M.endEditing():_m(K)&&M.endEditing(!0)},(V===Zl||V===he)&&K.addEventListener(Xg,I.numberListener,m)):v===pj&&e.forEach(function(Y){var z=b.createElement("option");z.innerHTML=F.toEnumLabel(Y),z.value=Y,F.isEnumEqual(u,Y)&&(z.selected=!0),Ll(K,z)}),Ih(K,S),K},ag=C.widget={},Oe=function(o,x,I){Zi(v+".widget."+o,x,I)};fs(bi,{ms_value:function(d){d.getValue=function(t){var g=this.getItemById(t),e=g.element;return Uc(e)?e:e?e.getValue?e.getValue():e.value:g.selected},d.setValue=function(z,M){var J=this.getItemById(z);if(J){var l=J.element;l&&!Uc(l)?l.setValue?l.setValue(M):l.value=M:Wq(M)?(J.selected=M,this.iv()):(J.element=M,this.iv())}},d.v=function(z,P){var W=this;if(2===arguments.length)W.setValue(z,P);else{if(!wb(z))return W.getValue(z);for(var E in z)W.setValue(E,z[E])}return W}},_46o:function(Z){Z._icon=k,Z._accessType=k,Z._valueType=k,Z._editable=!1,Z._batchEditable=!0,Z._align=fq,Z._nullable=!0,Z._emptiable=!1,Z.setParent=He,Z.formatValue=function(f){var Z=this,C=Z._valueType;return Z.getEnumValues()?Z.toEnumLabel(f):C===md?!!f:f!=k&&C===Zl?L(f):f},Z.setEnum=function(S,m,y,h,v,A,K){var $=this;S&&!sn(S)&&S.values&&(h=S.editable,y=S.icons,m=S.labels,v=S.strict,A=S.maxHeight,K=S.dropDownWidth,S=S.values),Zq(S)&&(S=S._as),Zq(m)&&(m=m._as),Zq(y)&&(y=y._as),$._enumValues=S,$._enumLabels=m,$._enumIcons=y,$._enumEditable=h,$._enumStrict=v==k?!0:v,$._enumMaxHeight=A,$._enumDropDownWidth=K,S&&S.length&&tg(S[0])&&($._valueType=he),$.fp("enum",!1,!0)},Z.getEnumDropDownWidth=function(){return this._enumDropDownWidth},Z.getEnumMaxHeight=function(){return this._enumMaxHeight},Z.isEnumEditable=function(){return this._enumEditable},Z.getEnumValues=function(){return this._enumValues},Z.getEnumLabels=function(){return this._enumLabels},Z.getEnumIcons=function(){return this._enumIcons},Z.isEnumStrict=function(){return this._enumStrict},Z.isEnumEqual=function(Z,l){return this._enumStrict?Z===l:Z==l},Z.toEnumLabel=function(y,O){var l=this,I=l.getEnumValues(O),u=l.getEnumLabels(O);if(I&&u)for(var m=0;m<I.length;m++)if(l.isEnumEqual(y,I[m]))return u[m];return y},Z.toEnumIcon=function(R,I){var E=this,_=E.getEnumValues(I),G=E.getEnumIcons(I);if(_&&G)for(var c=0;c<_.length;c++)if(E.isEnumEqual(R,_[c]))return G[c];return V}},_45o:function(h){h._87o=function(V,x,E,y,l,B){if(V){var L=this,b=L._90I,e=Xf(1);L._columnLineVisible&&(l-=1),L._rowLineVisible&&(B-=1),0>=l||0>=B||(L._90I||(b=L._90I={}),b[x]||(b[x]=new pq),qi(e,L.tx()+E,L.ty()+y,l,B),Ll(e,V),L._view.insertBefore(e,L._79O),V.onParentAdded&&V.onParentAdded(e),b[x].add(e))}},h._76o=function(){var s=this,X=s._90I;if(X){for(var A in X)X[A].each(function($){Zj($)});delete s._90I}},h._77o=function(x){var p=this;if(p._90I){var P=p._90I[x];P&&(P.each(function(U){Zj(U)}),delete p._90I[x])}}},_47o:function(f){f.getValue=function(F,X){return X.getValue?X.getValue(F,X,this):Xp(F,X.getAccessType(),X.getName())},f.setValue=function(U,C,y){if(C.isEmptiable(U)||""!==y||(y=V),C.isNullable(U)||y!=k){var r=this,R=C.getName(U),x=C.getAccessType(U),$=C.getValueType(U);$===Zl&&Uc(y)?y=d(y):$===he&&Uc(y)?y=parseFloat(y):$===md&&Uc(y)&&(y="true"===y),r._batchEditable&&C._batchEditable&&r.isSelected(U)?r.sm().each(function(D){C.setValue?C.setValue(D,C,y,r):Il(D,x,R,y)}):C.setValue?C.setValue(U,C,y,r):Il(U,x,R,y)}},f.setCurrentEditor=function(n){this.endEditing(),this._currentEditor=n,this.redraw()},f.isEditing=function(c,C){var H=this,w=H._currentEditor;if(!w)return!1;if(C){var G=w.info;return G?(G.column||G.property)===C&&G.data===c:!1}return!0},f.endEditing=function(F){var $=this,W=$._currentEditor;W&&(delete $._currentEditor,W.commitValue&&W.commitValue(W.info,F),$.redraw(),$.getDataModel().endTransaction())},f.beginEditing=function(g){this.endEditing();var t=this,$=g.column||g.property;if($.beginEditing)$.beginEditing(g);else{var M=g.data,R=g.value,_=t.getSelectBackground(M),D=$.getEnumValues(M),K=$.getSlider(M),H=$.getColorPicker(M);if(K){var i=kq(ag.Slider,K);return i.setValue(R),i.getView().onblur=function(){t.endEditing()},i.isInstant()&&(i.onValueChanged=function(){t.setValue(M,$,i.getValue())}),Ih(i,g),void 0}if(H||$.getValueType(M)===Nb){var C=kq(ag.ColorPicker,H);return C.setValue(R),C.onClosed=function(){t.endEditing()},C.isInstant()&&(C.onValueChanged=function(d,f){t.setValue(M,$,f)}),Ih(C,g),C.open(),void 0}if(D){if(ag.ComboBox){var J=new ag.ComboBox;J.setValue(R),J.setValues(D),J.setLabels($.getEnumLabels(M)),J.setIcons($.getEnumIcons(M)),J.setEditable($.isEnumEditable(M)),J.setStrict($.isEnumStrict(M)),J.setMaxHeight($.getEnumMaxHeight(M)),J.setDropDownWidth($.getEnumDropDownWidth(M)),J.onClosed=function(){t.endEditing()},Ih(J,g),J.open()}else Dr(pj,g,_,D,$);return}var v=$.getValueType(M);if(v===md||Wq(R))return t.setValue(M,$,!R),void 0;if($.getItemEditor(M)){var P=sg($.getItemEditor(M)),G=new P(M,$,t,g),N=G.getView();return N._17Q=G,G.setValue(R),hp(N),Ih(N,g),G.editBeginning&&G.editBeginning(),void 0}Dr("input",g,_,k,$)}}},_44o:function(l){l.init=function(J){var p=this,L=p.th=new $c(J),d=p._view=Hb(1,p);p.tv=p._tableView=J,Ll(d,L.getView()),Ll(d,J.getView()),L.mp(function(o){o.property===Ch&&p.iv()}),p.iv()},l.getTableView=function(){return this.tv},l.getTableHeader=function(){return this.th},l.getDataModel=function(){return this.tv.dm()},l.getColumnModel=function(){return this.tv.getColumnModel()},l.setColumns=function(I){this.tv.setColumns(I)},l.addColumns=function(Y){this.tv.addColumns(Y)},l.endEditing=function(){this.tv.endEditing()},l.validateImpl=function(){var q=this,K=q.th,S=yf(K),$={x:0,y:0,width:q.getWidth(),height:S};qi(K,$),$.y=S,$.height=j(0,q.getHeight()-S),qi(q.tv,$)}},ms_vs:function(T){T._41o=function(){return this._29I.height<this._59I},T._43o=function(){var M=this;M._41o()&&(M._58I||(N(function(){M._94O()},Gk),M.iv()),M._58I=new Date)},T._94O=function(){var K=this;if(K._58I){var L=new Date;L.getTime()-K._58I.getTime()>=Gk?(delete K._58I,K.iv()):N(function(){K._94O()},Gk)}},T._93I=function(){var e=this,f=e._27I;if(e._58I||!e._autoHideScrollBar){f||Ll(e._79O,f=e._27I=Xf());var q=e._29I,B=q.height,U=e._59I,J=e.getScrollBarSize(),i=q.width-J-2,G=B*(-e.ty()/U),t=B*(B/U),P=f.style;U>B?(Pb>t&&(G=G+t/2-Pb/2,0>G&&(G=0),G+Pb>B&&(G=B-Pb),t=Pb),P.visibility=Mb,P.background=e.getScrollBarColor(),P.borderRadius=J/2+cp,qi(f,i,G,J,t)):P.visibility=Pq}else f&&(f.style.visibility=Pq)}},ms_hs:function(e){e._40o=function(){return this._29I.width<this._91I},e._42o=function(){var E=this;E._40o()&&(E._95O||(N(function(){E._94I()},Gk),E.iv()),E._95O=new Date)},e._94I=function(){var v=this;if(v._95O){var d=new Date;d.getTime()-v._95O.getTime()>=Gk?(delete v._95O,v.iv()):N(function(){v._94I()},Gk)}},e._92I=function(){var f=this,V=f._28I;if(f._95O||!f._autoHideScrollBar){V||Ll(f._79O,V=f._28I=Xf());var n=f._29I,j=n.width,G=f._91I,h=f.getScrollBarSize(),L=n.height-h-2,g=j*(-f.tx()/G),H=j*(j/G),t=V.style;G>j?(Pb>H&&(g=g+H/2-Pb/2,0>g&&(g=0),g+Pb>j&&(g=j-Pb),H=Pb),t.visibility=Mb,t.background=f.getScrollBarColor(),t.borderRadius=h/2+cp,qi(V,g,L,H,h)):t.visibility=Pq}else V&&(V.style.visibility=Pq)}}}),yg(Vr,qd(16,16,[{type:Xd,rect:[1,1,14,14],background:jd},{type:Yg,rect:[1,1,14,14],width:1,color:Oo},{type:Dq,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),yg(Md,qd(16,16,{type:Yg,rect:[1,1,14,14],width:1,color:Oo})),yg(Cg,qd(16,16,[{type:Dn,rect:[2,2,12,12],borderWidth:1,borderColor:Oo,background:"#FFF"},{type:Dn,rect:[4,4,8,8],background:jd}])),yg(Gm,qd(16,16,{type:Dn,rect:[2,2,12,12],borderWidth:1,borderColor:Oo})),bi._15Q=function(H){H._29I=Bf,H._59I=0,H._91I=0,H._5o=function(C){var F=this;F._30I=new pq,F._rows=new pq,F._rowMap={},F._31I=0,F._14I=0,F._view=Hb(1,F),F._canvas=os(F._view),Ll(F._view,F._79O=Xf()),F.dm(C?C:new $b)},H.getCheckIcon=function(u){var a=this.sm(),N=a.co(u);return a.sg()?Ne(N?Cg:Gm):Ne(N?Vr:Md)},H.checkData=function(z){var T=this.sm(),k=T.co(z);T.sg()&&k||(this._32o=1,k?T.rs(z):T.as(z),delete this._32o)},H.getDataAt=function(D){D.target&&(D=this.lp(D));var M=E(D.y/this._rowHeight),Q=this._rows;return 0>M||M>=Q.size()?k:Q.get(M)},H.onDataDoubleClicked=function(){},H.onDataClicked=function(){},H.adjustTranslateX=function(){return 0},H.adjustTranslateY=function(X){var d=this.getHeight()-this._59I;return d>X&&(X=d),X>0?0:L(X)},H.onPropertyChanged=function(o){var A=this,n=o.property;Dj[n]?A.ivm():us[n]||A.redraw(),n===Up?A._42o():n===Dp&&A._43o()},H.getLabel=function(D){return D.toLabel()},H.getLabelFont=function(){return this._labelFont},H.getLabelColor=function(d){var U=this;if(U.isCheckMode()){if(U._focusData===d)return U._labelSelectColor}else if(U.isSelected(d))return U._labelSelectColor;return U._labelColor},H.getStartRowIndex=function(){return this._31I},H.getEndRowIndex=function(){return this._14I},H.getRowDatas=function(){return this._rows},H.getRowIndex=function(B){return this._rowMap[B._id]},H.getRowSize=function(){return this._rows.size()},H.getViewRect=function(){return pb(this._29I)},H.isVisible=function(y){return this._visibleFunc?this._visibleFunc(y):!0},H.getCurrentSortFunc=function(){return this._sortFunc},H.setDataModel=function(X){var f=this,p=f._dataModel,V=f._selectionModel;p!==X&&(p&&(p.umm(f.handleDataModelChange,f),p.umd(f.handleDataPropertyChange,f),p.umh(f.handleHierarchyChange,f),V||p.sm().ums(f.handleSelectionChange,f)),f._dataModel=X,X.mm(f.handleDataModelChange,f),X.md(f.handleDataPropertyChange,f),X.mh(f.handleHierarchyChange,f),V?V._21I(X):X.sm().ms(f.handleSelectionChange,f),f.fp("dataModel",p,X))},H.validateModel=function(){var U=this;U._rows.clear(),U._rowMap={},U.buildChildren(U._dataModel._roots);var O=U._rows=U._rows.toList(U.isVisible,U),D=0,r=U.getCurrentSortFunc(),b=O.size();for(r&&O.sort(r);b>D;D++)U._rowMap[O.get(D)._id]=D},H.buildChildren=function(Z){var n=this;Z.each(function(V){n._rows.add(V),n.buildChildren(V._children)})},H.handleDataModelChange=function(){this.ivm()},H.handleDataPropertyChange=function(b){"parent"===b.property?this.ivm():this.invalidateData(b.data)},H.handleHierarchyChange=function(){this.ivm()},H.handleSelectionChange=function(q){q.datas.each(this.invalidateData,this),this.onSelectionChanged(q)},H.onSelectionChanged=function(m){var C=this,N=C.sm();!C.isAutoMakeVisible()||1!==N.size()||"set"!==m.kind&&"append"!==m.kind||C._32o||C.makeVisible(N.ld())},H.handleBackgroundClick=function(A){Bn(A)&&!this.isCheckMode()&&this.sm().cs()},H.makeVisible=function(q){q&&(this._23I=q,this.iv())},H.scrollToIndex=function(H){var d=this,U=d._29I,r=U.height,b=d._rowHeight,F=b*H;H>=0&&H<d._rows.size()&&r>0&&(F+b>U.y+r?d.ty(-F+r-b):F<U.y&&d.ty(-F))},H.autoScroll=function(e,r){var j=this,R=j._rowHeight,V=R,Z=R/4,_=j._29I,f=j.lp(e),N={x:j.tx(),y:j.ty()};return R>0&&_&&(f.x-_.x<V?j.translate(Z,0):_.x+_.width-f.x<V&&j.translate(-Z,0),f.y-_.y<V?j.translate(0,Z):_.y+_.height-f.y<V&&j.translate(0,-Z)),N.x=j.tx()-N.x,N.y=j.ty()-N.y,r&&(r.x+=N.x,r.y+=N.y),N},H.getTopRowOrderSelection=function(){var t=this.sm().getTopSelection(),l={},h=new pq;return t.each(function(h){l[h._id]=h}),this._rows.each(function(J){l[J._id]&&h.add(J)}),h},H.getRowOrderSelection=function(){var C=new pq;return this._rows.each(function(c){this.isSelected(c)&&C.add(c)},this),C},H.ivm=function(){this.invalidateModel()},H.invalidateModel=function(){var c=this;c._96I||(c._96I=1,c._32I=1,delete c._24I),c.iv()},H.redraw=function(){var E=this;E._32I||(E._32I=1,delete E._24I,E.iv())},H.invalidateData=function(L){var Q=this;O?Q.redraw():Q._32I||(Q._24I||(Q._24I={}),Q._24I[L._id]=L,Q.iv())},H.getFocusData=function(){return this._focusData},H.setFocusDataById=function(y){this.setFocusData(this.dm().getDataById(y))},H.setFocusData=function(a){var L=this,l=L._focusData;l!==a&&(L._focusData=a,L.fp("focusData",l,a),l&&L.invalidateData(l),a&&(L.invalidateData(a),L.isAutoMakeVisible()&&L.makeVisible(a)))},H.drawRowBackground=function(K,J,E,A,p,k,N){var n=this,w=n.isCheckMode();(J===n._focusData&&w||E&&!w)&&yq(K,A,p,k,N,n.getSelectBackground(J))},H.drawData=function(S,E,G){var V=this,x=V._rowHeight,K=x*G,Q=V._29I,s=Q.x,k=Q.width;S.save(),S.beginPath(),S.rect(s,K,k,x),S.clip(),V._87o(V.drawRow(S,E,V.isSelected(E),s,K,k,x),G,s,K,k,x),S.restore(),V._rowLineVisible&&yq(S,s,K+x-1,k,1,V._rowLineColor)},H._12I=function(U){var W=this,f=W._31I,x=W._29I,C=x.x,y=x.y,l=x.width,L=x.height;for(U.beginPath(),U.rect(C,y,l,L),U.clip(),U.clearRect(C,y,l,L),W._76o(),W._93db(U);f<W._14I;f++)W.drawData(U,W._rows.get(f),f);W._92db(U)},H._13I=function(u){for(var v,p=this,o=p._rowHeight,$=p._29I,w=$.x,F=$.width,Q=p._31I,x=p._30I;Q<p._14I;Q++)v=p._rows.get(Q),p._24I[v._id]&&x.add({data:v,index:Q});x.isEmpty()||(u.beginPath(),x.each(function(_){u.rect(w,_.index*o,F,o)}),u.clip(),x.each(function(E){u.clearRect(w,E.index*o,F,o)}),x.each(function(q){p._77o(q.index)}),p._93db(u),x.each(function(N){p.drawData(u,N.data,N.index)}),p._92db(u),x.clear())},H.preValidateModel=function(){this.endEditing&&this.endEditing()},H.validateImpl=function(){var G=this,q=G._canvas,t=G.getWidth(),v=G.getHeight(),r=G._rowHeight,y=G._32I;(t!==q.clientWidth||v!==q.clientHeight)&&(Oi(q,t,v),y=1);var u=a&&!U;G._96I&&!u&&(G.preValidateModel(),G.validateModel());var w=G._29I,M={x:-G.tx(),y:-G.ty(),width:t,height:v},W=G._rows.size(),p=Rq(q),K=G._23I;y||yk(M,w)||(y=1),G._29I=M,G._59I=W*r+G.getScrollBarSize(),G._31I=E(M.y/r),G._14I=g((M.y+M.height)/r),G._31I<0&&(G._31I=0),G._14I>W&&(G._14I=W),G._99I&&y&&G._99I(),Ko(p,G.tx(),G.ty(),1),y?G._12I(p):G._24I&&G._13I(p),G._93I(),G._92I(),p.restore(),G._32I=G._24I=G._96I=k,K&&(G.scrollToIndex(G.getRowIndex(K)),delete G._23I),G.tx(G.tx()),G.ty(G.ty())}},bi._48o=function(H){H._rootVisible=!0,H._rootData=k,H._35o=function(){this._expandMap={},this._levelMap={}},H.validateModel=function(){var T=this,O=T._rootData;T._rows.clear(),T._levelMap={},T._rowMap={},T._currentLevel=0,O?T._rootVisible?T.isVisible(O)&&T.buildData(O):T.buildChildren(O):T.buildChildren(),delete T._currentLevel},H.buildData=function(N){var o=this,Y=N._id,L=o._rows;o._rowMap[Y]=L.size(),L.add(N),o._levelMap[Y]=o._currentLevel,o.isExpanded(N)&&(o._currentLevel++,o.buildChildren(N),o._currentLevel--)},H.buildChildren=function(p){var B=this,v=p?p._children:B._dataModel._roots,$=B.getCurrentSortFunc();$&&B.isChildrenSortable(p)?v.toList(B.isVisible,B).sort($).each(B.buildData,B):v.each(function(f){B.isVisible(f)&&B.buildData(f)})},H.getLevel=function(V){return this._levelMap[V._id]},H.getToggleIcon=function(R){var G=this,O=G._loader,x=G._collapseIcon;return O&&!O.isLoaded(R)?x:R.hasChildren()?G.isExpanded(R)?G._expandIcon:x:k},H.isCheckMode=function(){return this._checkMode!=k},H.isChildrenSortable=function(){return!0},H.handleDataModelChange=function(G){var l=this;G.kind===ro?delete l._expandMap[G.data._id]:G.kind===Ef&&(l._expandMap={}),l.ivm()},H.toggle=function(o){var X=this;X.isExpanded(o)?X.collapse(o):X.expand(o)},H.isExpanded=function(c){return 1===this._expandMap[c._id]},H.expand=function(E){var Z=this,b=Z._loader;Z.isExpanded(E)||(b&&!b.isLoaded(E)&&b.load(E),Z._expandMap[E._id]=1,Z.ivm(),Z.onExpanded(E))},H.onExpanded=function(){},H.collapse=function(I){var e=this;e.isExpanded(I)&&(delete e._expandMap[I._id],e.ivm(),e.onCollapsed(I))},H.onCollapsed=function(){},H.expandAll=function(w){if(w)this.expand(w),w.eachChild(function(d){this.expandAll(d)},this);else{var N=this;N._dataModel.each(function(e){e.hasChildren()&&(N._expandMap[e._id]=1)}),N.ivm()}},H.collapseAll=function(){this._expandMap={},this.ivm()},H.makeVisible=function(j){if(j){var i=this;if(!i._rootData||j.isDescendantOf(i._rootData)){for(var y=j._parent;y;)i.expand(y),y=y._parent;i._23I=j,i.iv()}}},H.checkData=function(w){var Z,c=this,n=c._checkMode,r=c.sm(),q=r.co(w);if(!r.sg()||!q){if(c._32o=1,n===Rk)q?r.rs(w):r.as(w);else if(n===td)Z=new pq(w),Z.addAll(w._children);else if("descendant"===n)Z=new pq,bd(w,Z);else if("all"===n&&(Z=new pq,bd(w,Z),!q))for(var L=w._parent;L;)Z.add(L),L=L._parent;Z&&(q?r.rs(Z):r.as(Z)),delete c._32o}},H._97I=function(q,h,u,n,S,b,l){var V=this,Q=V._indent,R=V._levelMap[h._id],m=V.getIconWidth(h),_=Ne(V.getToggleIcon(h));_?(n+=Q*R,Cd(q,_,n+Q/2,S+l/2,h,V),n+=Q):n+=Q*(R+1),V._checkMode&&(Cd(q,V.getCheckIcon(h),n+Q/2,S+l/2,h,V),n+=Q),V.drawIcon(q,h,n,S,m,l),V.drawLabel(q,h,n+m,S,l)}},bi._14Q=function(V){V.getIcon=function(R){return R.getIcon()},V.getIconWidth=function(m){return this.getIcon(m)?this._indent:0},V.drawIcon=function(l,v,k,C,M,A){if(M){var o=this,R=o.getBodyColor(v),c=Ne(o.getIcon(v),R);c&&(A-=o.isRowLineVisible()?1:0,fo(l,c,yr,k,C,M,A,v,o,R),so(l,o.getBorderColor(v),k,C,M,A))}},V.drawLabel=function(p,u,R,k,n){var i=this;qg(p,i.getLabel(u),i.getLabelFont(u),i.getLabelColor(u),R,k,0,n)}},bi._50o=function(r){r._98I=function(){var C=this,y=C._39o=new $b;C._60I=new pq,y.mm(C._17o,C),y.md(C._18o,C),y.mh(C._19o,C)},r.setColumns=function(A){this._39o.clear(),this.addColumns(A)},r.addColumns=function(u){var F=this._39o;u.forEach(function(l){if(!(l instanceof Pn)){var Y=sg(l.className);l=kq(Y?Y:Pn,l)}F.add(l)})},r.onColumnClicked=function(){},r.onCheckColumnClicked=function(){},r._3Q=function(H){for(var i,x=0,E=this._60I,Q=E.size();Q>x;x++)if(i=E.get(x),i.column===H)return i;return k},r.getColumnAt=function(K){var R=this._4Q(K);return R?R.column:k},r._4Q=function(Y){for(var N=this,V=Y.target?N.lp(Y).x:Y.x,u=N._60I,O=0;O<u.size();O++){var p=u.get(O),H=p.startX;if(V>=H&&V<H+p.column.getWidth())return p}return k},r.getToolTip=function(M){var E=this,e=E.getDataAt(M),I=E.getColumnAt(M);return e&&I?I.getToolTip(e,E):k},r.adjustTranslateX=function(t){var J=this.getWidth()-this._91I;return J>t&&(t=J),t>0?0:L(t)},r._99I=function(){var g=this,s=g._29I,m=g._60I;m.clear(),g._91I=0,g._39o._roots.each(function(K){if(K.isVisible()){var Y=g._91I+K.getWidth();g._91I<=s.x+s.width&&Y>=s.x&&m.add({column:K,startX:g._91I}),g._91I=Y}}),g._91I+=g.getScrollBarSize()},r.drawData=function(o,K,k){var I=this,s=I._rowHeight,C=s*k,Z=I.isSelected(K),y=I._29I,R=y.x,e=y.width;I.drawRowBackground(o,K,Z,R,C,e,s),I._60I.each(function($){var i=$.column,P=$.startX,R=i.getWidth();R>0&&!I.isEditing(K,i)&&(o.save(),o.beginPath(),o.rect(P,C,R,s),o.clip(),I._87o(I.drawCell(o,K,Z,i,P,C,R,s),k,P,C,R,s),I._columnLineVisible&&yq(o,P+R-1,C,1,s,I._columnLineColor),o.restore())}),I._rowLineVisible&&yq(o,R,C+s-1,e,1,I._rowLineColor)},r.drawCell=function(n,s,Y,e,k,X,u,C){var D=this;if(e.drawCell)return e.drawCell(n,s,Y,e,k,X,u,C,D);var h=D.getValue(s,e);ck(n,h,e,D.getLabelFont(s,e,h),D.getLabelColor(s,e,h),k,X,u,C,s,D)},r.getColumnModel=function(){return this._39o},r._17o=function(){this.redraw()},r._18o=function(K){var u=this;K.data===u._sortColumn&&Sn[K.property]?u.ivm():(u._42o(),u.redraw())},r._19o=function(){this.redraw()},r.getCurrentSortFunc=function(){var U=this,K=U._sortColumn;if(K&&K.isSortable()){var J=K.getSortFunc(),j=Ep===K.getSortOrder()?1:-1;return J||(J=hb),function(v,L){return J.call(U,U.getValue(v,K),U.getValue(L,K),v,L)*j}}return U._sortFunc},r.isCellEditable=function(N,E,y){return E.isEditable()&&this.isEditable()?E.isCellEditable?E.isCellEditable(N,E,y,this):!0:!1},r._37O=function(B,T){if(Bn(T))for(var h=this,g=h.lp(T),b=h._60I,D=h._rowHeight,e=h._29I,H=e.x,r=e.y,C=e.width,X=e.height,s=0;s<b.size();s++){var j=b.get(s),K=j.startX,p=j.column,m=p.getWidth();if(p!==h._31o&&p!==h._4o&&g.x>=K&&g.x<K+m&&h.isCellEditable(B,p,T)){var P={x:K,y:h.getRowIndex(B)*D,width:m,height:D},R={x:P.x+h.tx(),y:P.y+h.ty(),width:P.width,height:P.height},u=0,V=0;return P.x<H?u=P.x-H:P.x+P.width>H+C&&(u=P.x+P.width-H-C),u&&(h.tx(h.tx()-u),R.x-=u),P.y<r?V=P.y-r:P.y+D>r+X&&(V=P.y+D-r-X),V&&(h.ty(h.ty()-V),R.y-=V),h.beginEditing({data:B,column:p,value:h.getValue(B,p),event:T,rect:P,editorRect:R,view:h}),void 0}}}},ag.BaseItemEditor=function(u,j,S,W){this._data=u,this._column=j,this._master=S,this._editInfo=W},Oe("BaseItemEditor",c,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Xm=C.Tab=function(){uj(Xm,this)};zo("Tab",Sk,{ms_ac:["view","closable","disabled"],_icon:k,_closable:!1,_disabled:!1,setParent:He});var Pn=C.Column=function(){uj(Pn,this)};zo("Column",Sk,{_46o:1,ms_ac:["accessType","valueType",Mb,Tn,Nn,Qg,"align",Nb,"sortOrder",le,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Ep,_sortFunc:k,_sortable:!0,_clickable:!0,setWidth:function(F){16>F&&(F=16);var i=this._width;this._width=F,this.fp(Qg,i,F)},getToolTip:function(X,f){return this.formatValue(f.getValue(X,this))}});var fj=C.Property=function(){uj(fj,this)};zo("Property",Sk,{_46o:1,ms_ac:["accessType","valueType",Tn,Nn,"categoryName",Nb,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:k,getToolTip:function(v,Z,J){var d=this;return Z?d.formatValue(J.getValue(v,d)):J.getPropertyName(d)}}),ag.AccordionView=function(){var Q=this;Q._20o={},Q._21o=new pq,Q._10o=k,Q._9o=k,Q._11o=k,Q._view=Hb(0,Q),Q.iv()},Oe("AccordionView",c,{ms_v:1,ms_fire:1,ms_ac:[Hf,vj,"titleHeight",vh,to,"titleBackground","selectWidth",en,"orientation","separatorColor"],_expandIcon:I.accordionViewExpandIcon,_collapseIcon:I.accordionViewCollapseIcon,_titleHeight:Ho,_labelColor:I.accordionViewLabelColor,_labelFont:I.accordionViewLabelFont,_titleBackground:I.accordionViewTitleBackground,_selectBackground:I.accordionViewSelectBackground,_selectWidth:I.accordionViewSelectWidth,_orientation:"v",_separatorColor:I.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(r,N,I,M){var S=this,F=Xf();if(S._20o[r])throw r+" already exists";F.onmousedown=_d,F.style.cursor=Mh,F.addEventListener(uh?oq:Af,function($){_d($)},m),F.addEventListener(uh?$k:cs,function(Q){_d(Q),Bn(Q)&&(S._10o===r?S.collapse():S.expand(r))},m),Ll(S._view,F),S._20o[r]={content:N,div:F,canvas:os(F),icon:M},S._21o.add(r),I&&S.expand(r),S.iv()},remove:function(Y){var a=this,g=a._20o[Y];g&&(Zj(g.div),delete a._20o[Y],a._21o.remove(Y),a.iv())},clear:function(){var b=this;b._21o.toArray().forEach(b.remove,b),b._20o={},b._21o.clear(),b.iv()},isExpanded:function(p){return this._10o===p},expand:function(r){var o=this;o._20o[r]&&o._10o!==r&&(o._10o=r,o.onExpanded(r),o.iv())},onExpanded:function(){},collapse:function(){var U=this;U._10o&&(U.onCollapsed(U._10o),delete U._10o,U.iv())},onCollapsed:function(){},initCanvas:function(E,d,U){Oi(E,d,U);var i=Rq(E);return Ko(i,0,0,1),i.clearRect(0,0,d,U),i},drawTitle:function(P,V,G,D,W){var n=this,p=Ne(W.icon),y=n.isExpanded(V),O=n._titleHeight,f=n._titleBackground,g=n._selectWidth,x=n._separatorColor,$=Ne(y?n._expandIcon:n._collapseIcon),S=g+4;yq(P,0,0,G,D,f),y&&g&&yq(P,0,0,g,D,n._selectBackground),(y||n._21o.get(n._21o.size()-1)!==V)&&yq(P,0,D-1,G,1,x?x:Bm(f)),p&&(Cd(P,p,S+Or(p)/2,O/2),S+=Or(p)+2),qg(P,V,n.getLabelFont(V),n.getLabelColor(V),S,0,0,O),$&&Cd(P,$,G-Or($)/2-4,O/2)},validateImpl:function(){var n=this,Q=n._view,B=0,x=0,b=n.getWidth(),E=n.getHeight(),W=n._titleHeight,K=n._21o.size()*W,I=n._11o,d=n._9o;delete n._11o,delete n._9o,n._21o.each(function(T){var q,z,l=n._20o[T],t=l.content,Z=n._10o===T;Rn(n)?(qi(l.div,B,0,W,E),q=n.initCanvas(l.canvas,W,E),Ig(q,0,E),ef(q,-r),n.drawTitle(q,T,E,W,l),q.restore(),Z?(z=j(0,b-K),t&&(n._11o=t,n._9o=Dk(t),qi(t,B+W,0,z,E)),B+=W+z):B+=W):(qi(l.div,0,x,b,W),q=n.initCanvas(l.canvas,b,W),n.drawTitle(q,T,b,W,l),q.restore(),Z?(z=j(0,E-K),t&&(n._11o=t,n._9o=Dk(t),qi(t,0,x+W,b,z)),x+=W+z):x+=W)});var H=n._9o;I&&I!==n._11o&&I.endEditing&&I.endEditing(),H&&H!==d&&Ll(Q,H),d&&d!==H&&Zj(d)}}),ag.SplitView=function(p,L,F,R){var Y=this,a=Y._dividerDiv=Xf(),r=Y._60O=os(),n=Y._61O=os(),y=r.style,x=n.style;Y._view=Hb(1,Y),Ll(Y._view,a),y.msTouchAction=Ni,y.pointerEvents=Ni,y.cursor=Mh,x.msTouchAction=Ni,x.pointerEvents=Ni,x.cursor=Mh,p&&Y.setLeftView(p),L&&Y.setRightView(L),F&&Y.setOrientation(F),R!=k&&Y.setPosition(R),Y.setStatus(Dd),new Jr(Y)
},Oe("SplitView",c,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:I.splitViewDividerSize,_dividerBackground:I.splitViewDividerBackground,_dragOpacity:I.splitViewDragOpacity,_toggleIcon:I.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(t,R){var y=this,B=y._position;isNaN(t)||(R||(y._82O=0>t?-1:t>1?1:0),y._position=t,y.fp(hs,B,t))},getLeftView:function(){return this._leftView},setLeftView:function(o){var R=this,E=R._leftView,d=R._view;if(R._leftView!==o){if(E&&E!==R._rightView){var u=Dk(E);u.parentNode===d&&Zj(u)}if(R._leftView=o,o){var C=Dk(o);C.parentNode!==d&&d.insertBefore(C,R._dividerDiv)}R.fp("leftView",E,o)}},getRightView:function(){return this._rightView},setRightView:function(f){var k=this,m=k._rightView,O=k._view;if(k._rightView!==f){if(m&&m!==k._leftView){var D=Dk(m);D.parentNode===O&&Zj(D)}if(k._rightView=f,f){var C=Dk(f);C.parentNode!==O&&O.insertBefore(C,k._dividerDiv)}k.fp("rightView",m,f)}},validateImpl:function(){var z=this,b=z._draggable,A=z._position,d=z.getWidth(),E=z.getHeight(),B=z._dividerSize,p=z._dividerBackground,t=uh?18:8,S=z._dividerDiv,e=z._82O,Z=z._60O,q=z._61O,C=z._toggleIcon,x=z._status,H=S.style,Q=null,T=uh?20:4,P=C.comps[0];B>=t||0===B?z._coverDiv&&(Zj(z._coverDiv),delete z._coverDiv):z._coverDiv||(z._coverDiv=Xf(),Y&&(z._coverDiv.style.background=ks),Ll(S,z._coverDiv)),z._togglable?Z.parentNode||(Ll(S,Z),Ll(S,q)):(Zj(Z),Zj(q));var M=z._coverDiv,u=z._leftView,h=z._rightView;if(Rn(z)){if(B>d&&(B=d),x===Dd)if(1===e)var c=$(A,d),R=j(0,d-B-c);else-1===e?(R=$(-A,d),c=j(0,d-B-R)):(c=L((d-B)*A),R=j(0,d-B-c));else"cl"===x?(c=0,R=j(0,d-B)):"cr"===x&&(R=0,c=j(0,d-B));u&&qi(u,0,0,c,E),h&&qi(h,c+B,0,R,E),qi(S,c,0,B,E),z._22o=c,M&&(qi(M,B/2-t/2,0,t,E),M.style.cursor=b?rf:""),S.style.cursor=b?rf:"";var O=S.clientHeight/2,X=S.clientWidth;Oi(Z,X,X),qi(Z,0,O-X-T,X,X),Q=Rq(Z),Ko(Q,0,0,1),P.rotation=-r,Gb(Q,C,0,0,X,X),Q.restore(),Oi(q,X,X),qi(q,0,O+T,X,X),Q=Rq(q),Ko(Q,0,0,1),P.rotation=r,Gb(Q,C,0,0,X,X),Q.restore()}else{if(B>E&&(B=E),x===Dd)if(1===e)var s=$(A,E),v=j(0,E-B-s);else-1===e?(v=$(-A,E),s=j(0,E-B-v)):(s=L((E-B)*A),v=j(0,E-B-s));else"cl"===x?(s=0,v=j(0,E-B)):"cr"===x&&(v=0,s=j(0,E-B));u&&qi(u,0,0,d,s),h&&qi(h,0,s+B,d,v),qi(S,0,s,d,B),z._22o=s,M&&(qi(M,0,B/2-t/2,d,t),M.style.cursor=b?Pr:""),H.cursor=b?Pr:"";var y=S.clientWidth/2,X=S.clientHeight;Oi(Z,X,X),qi(Z,y-X-T,0,X,X),Q=Rq(Z),Ko(Q,0,0,1),P.rotation=0,Gb(Q,C,0,0,X,X),Q.restore(),Oi(q,X,X),qi(q,y+T,0,X,X),Q=Rq(q),Ko(Q,0,0,1),P.rotation=K,Gb(Q,C,0,0,X,X),Q.restore()}H.background=p}});var Jr=function(S){this.sv=S,this.addListeners()};Zi(Jr,c,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(P){var u=this,y=u.sv,A=y._dividerDiv,R=y._60O,s=y._61O,r=y._status,O=P.target;if(O===R)r===Dd?y.setStatus("cl"):"cr"===r&&y.setStatus(Dd);else if(O===s)r===Dd?y.setStatus("cr"):"cl"===r&&y.setStatus(Dd);else if(js(P)&&(O===A||O===y._coverDiv)&&(_d(P),y.isDraggable())){y.getLeftView(),y.getRightView();var T=u.maskDiv=Xf();if(T.style.left=0,T.style.top=0,T.style.width=y.getWidth()+"px",T.style.height=y.getHeight()+"px",y.getView().appendChild(T),!y.isContinuousLayout()){var Z=u.resizeDiv=Xf();Z.style.left=A.style.left,Z.style.top=A.style.top,Z.style.width=A.style.width,Z.style.height=A.style.height,Z.style.opacity=y.getDragOpacity(),Z.style.background=y.getDividerBackground(),Ll(u.getView(),Z)}u._lastAbsPosition=y._22o,u._86o=Rn(y)?ms(P).x:ms(P).y,rk(u,P)}},handleWindowTouchMove:function(m){js(m)&&this.update(m,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(r){var C=this;C.update(r,!0),C.sv.setStatus(Dd),C.maskDiv&&Zj(C.maskDiv),C.resizeDiv&&Zj(C.resizeDiv),C.maskDiv=C.resizeDiv=k},handle_mousedown:function(o){Bn(o)&&this.handle_touchstart(o)},handleWindowMouseMove:function(q){this.handleWindowTouchMove(q)},handleWindowMouseUp:function(b){this.handleWindowTouchEnd(b)},update:function(X,A){var i=this,j=i.sv,s=Rn(j)?j.getWidth():j.getHeight(),_=j._dividerSize,E=i._lastAbsPosition-i._86o;Rn(j)?(E+=ms(X).x,E>s-_&&(E=s-_),0>E&&(E=0),i.resizeDiv&&(i.resizeDiv.style.left=E+cp)):(E+=ms(X).y,E>s-_&&(E=s-_),0>E&&(E=0),i.resizeDiv&&(i.resizeDiv.style.top=E+cp)),A&&s!==_&&(1===j._82O?j.setPosition(E,1):-1===j._82O?j.setPosition(E-s+_,1):j.setPosition(E/(s-_),1))}}),ag.TabView=function(){var V=this,E=V._view=Hb(1,V),F=V._91O=Xf(1),N=V._tabModel=new $b,H=N.sm(),e=V.invalidate;V._7o=new pq,V._canvas=os(F),Ll(E,F),Ll(E,V._92O=Xf(1)),H.setSelectionMode(Hj),H.ms(V.handleSelectionChange,V),N.mm(e,V),N.md(e,V),N.mh(e,V),V._interactor=new Sp(V),V.iv()},Oe("TabView",c,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",vh,to,"tabBackground","selectWidth",en,"moveBackground","insertColor"],_tabPosition:Bp,_tabHeight:Ho,_tabGap:I.tabViewTabGap,_labelColor:I.tabViewLabelColor,_labelFont:I.tabViewLabelFont,_tabBackground:I.tabViewTabBackground,_selectWidth:I.tabViewSelectWidth,_selectBackground:I.tabViewSelectBackground,_moveBackground:I.tabViewMoveBackground,_insertColor:I.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(y,u,h){var K,t=this._tabModel;return y instanceof Xm?(K=y,u&&K.setView(u)):(K=new Xm,K.setName(y),K.setView(u)),t.add(K),h&&t.sm().ss(K),K},getLabel:function(w){return w.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(u){this._23o=u,this.iv()},get:function(_){var t=this,s=t._tabModel;if(tg(_))return s._roots.get(_);if(Uc(_)){var Y;return s.each(function(k){_===t.getLabel(k)&&(Y=k)}),Y}return _ instanceof Xm?_:k},select:function(O){this._tabModel.sm().ss(this.get(O))},remove:function(n){var z=this;if(n=z.get(n)){var B=z._tabModel,m=B._roots.indexOf(n);z._tabModel.remove(n),z.selectByIndex(--m)}},getCurrentTab:function(){return this._8o},hideTabView:function(G,Y){Y.parentNode===this._92O&&(cb(Y)?(Y.style.display=yp,Y._tab_=G):Zj(Y),xm())},showTabView:function(Y,r){cb(r)&&(r.style.display="block",r._tab_=Y),r.parentNode!==this._92O&&(Ll(this._92O,r),xm())},_24o:function(){var n,g=this,h=g._8o,Q=g._9o,V=g._tabModel.sm().ld();V&&(n=Dk(V.getView())),n!==Q&&(Q&&(h.getView()&&h.getView().endEditing&&h.getView().endEditing(),g.hideTabView(h,Q)),n&&g.showTabView(V,n)),g._8o=V,g._9o=n,h!==V&&g.onTabChanged(h,V)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(Q,U){this.selectByIndex(--U)},selectByIndex:function(s){var B=this,E=B._tabModel,I=E.size();if(I&&!E.sm().ld()){s==k&&(s=0),s>=I&&(s=I-1),0>s&&(s=0);for(var z=s;z>=0;z--){var l=B.get(z);if(!l.isDisabled())return B.select(l),l}for(z=s+1;I>z;z++)if(l=B.get(z),!l.isDisabled())return B.select(l),l}},getTabWidth:function(u){var v=4,$=Ne(u.getIcon());$&&(v+=Or($,u)+4);var g=this.getLabel(u);return g&&(v+=Qk(this.getLabelFont(u),g).width+4),u.isClosable()&&(v+=10),v},drawTab:function(W,C,g,U,I,b,j){var h,v=this,i=v._tabPosition,$=g+4,L=v._selectWidth,O=Ne(C.getIcon()),J=C.isDisabled(),q=v.getLabelColor(C),V=v.getLabelFont(C),T=v.getLabel(C),N=v._selectBackground,k=i===fq+"-vertical",y=i===nb+"-vertical";(k||y)&&($=U+4),J&&(W.globalAlpha=xg),yq(W,g,U,I,b,j),C===v._8o&&L&&(i===Bp?yq(W,g,U+b-L,I,L,N):i===fq?yq(W,g+I-L,U,L,b,N):i===nb?yq(W,g,U,L,b,N):k?yq(W,g+I-L,U,L,b,N):y?yq(W,g,U,L,b,N):yq(W,g,U,I,L,N));var n=I/2;if(k&&(Ig(W,n,U+b/2),ef(W,K),Ig(W,-n,-U-b/2)),O){var D=fb(O,C),S=Or(O,C);if(k||y){var d=g+I/2,x=$+D/2;Ig(W,d,x),ef(W,r),Ig(W,-d,-x),Cd(W,O,g+I/2,$+D/2,C,v),Ig(W,d,x),ef(W,-r),Ig(W,-d,-x),$+=D+4}else Cd(W,O,$+S/2,U+b/2,C,v),$+=S+4}return k||y?(Ig(W,I/2,$+I/2),ef(W,r),Ig(W,-I/2,-$-I/2),qg(W,T,V,q,g,$,b,I),Ig(W,I/2,$+I/2),ef(W,-r),Ig(W,-I/2,-$-I/2)):qg(W,T,V,q,$,U,I,b),k&&(Ig(W,n,U+b/2),ef(W,-K),Ig(W,-n,-U-b/2)),C.isClosable()&&(h=y?{x:g+I-12,y:U+b-12,width:12,height:12}:{x:g+I-12,y:U+2,width:12,height:12},this.drawCloseIcon(C,W,q,h)),J&&(W.globalAlpha=1),h},drawCloseIcon:function($,K,E,p){var u=p.x,W=p.y;K.strokeStyle=E,K.lineWidth=1,K.beginPath(),K.moveTo(u+2,W+8),K.lineTo(u+8,W+2),K.moveTo(u+8,W+8),K.lineTo(u+2,W+2),K.stroke()},getTabAt:function(c){var p=this._interactor._8Q(c);return p?p.tab:null},validateImpl:function(){var b=this;b._24o();var W,h=b._canvas,a=b._tabPosition,i=b._91O,P=b._92O,C=b._tabModel,o=b.getWidth(),Z=b.getHeight(),m=b._tabHeight,H=b._7o,K=b._tabGap,x=a===Bp,r=a===fq,y=a===nb,N=a===fq+"-vertical",L=a===nb+"-vertical",E=b._23o,S=0;if((r||y)&&C._roots.each(function(i){S=j(b.getTabWidth(i),S)}),x?(qi(i,0,0,o,m),W={x:0,y:m,width:o,height:j(0,Z-m)}):r?(qi(i,0,0,S,Z),W={x:S,y:0,width:j(0,o-S),height:Z}):y?(qi(i,o-S,0,S,Z),W={x:0,y:0,width:j(0,o-S),height:Z}):N?(qi(i,0,0,m,Z),W={x:m,y:0,width:j(0,o-m),height:Z}):L?(qi(i,o-m,0,m,Z),W={x:0,y:0,width:j(0,o-m),height:Z}):(qi(i,0,Z-m,o,m),W={x:0,y:0,width:o,height:j(0,Z-m)}),qi(P,W),N||L){b._9o&&(W.x=0,qi(b._8o.getView(),W)),Oi(h,m,Z);var M=Rq(h),D=0;if(Ko(M,0,b.ty(),1),M.clearRect(0,0,m,Z),H.clear(),C._roots.each(function($){var Q,n=b.getTabWidth($);E&&E.tab===$||(Q=b.drawTab(M,$,0,D,m,n,b._tabBackground)),H.add({_75o:Q,tab:$,startY:D,endY:D+n,height:n}),D+=n+K}),b._23Q=j(0,D-K),E){var $=E.position;b.drawTab(M,E.tab,0,E.startY,m,E.height,b._moveBackground),yq(M,0,$,m,1,b._insertColor)}if(M.restore(),b._selectionChanged){b._selectionChanged=!1;for(var s=b.ty(),k=0;k<H.size();k++){var U=H.get(k);if(U.tab===b._8o){if(U.endY+s<0){b.ty(-U.startY);break}if(U.startY+s>Z){b.ty(Z-U.endY);break}}}}b.ty(b.ty())}else if(r||y){b._9o&&(W.x=0,qi(b._8o.getView(),W)),Oi(h,S,Z);var M=Rq(h),D=0;if(Ko(M,0,b.ty(),1),M.clearRect(0,0,S,Z),H.clear(),C._roots.each(function(V){var j;E&&E.tab===V||(j=b.drawTab(M,V,0,D,S,m,b._tabBackground)),H.add({_75o:j,tab:V,startY:D,endY:D+m,height:m}),D+=m+K}),b._23Q=j(0,D-K),E){var $=E.position;b.drawTab(M,E.tab,0,E.startY,S,E.height,b._moveBackground),yq(M,0,$,S,1,b._insertColor)}if(M.restore(),b._selectionChanged){b._selectionChanged=!1;for(var s=b.ty(),k=0;k<H.size();k++){var U=H.get(k);if(U.tab===b._8o){if(U.endY+s<0){b.ty(-U.startY);break}if(U.startY+s>Z){b.ty(Z-U.endY);break}}}}b.ty(b.ty())}else{b._9o&&(W.y=0,qi(b._8o.getView(),W)),Oi(h,o,m);var M=Rq(h),n=0;if(Ko(M,b.tx(),0,1),M.clearRect(0,0,o,m),H.clear(),C._roots.each(function(A){var F,u=b.getTabWidth(A);E&&E.tab===A||(F=b.drawTab(M,A,n,0,u,m,b._tabBackground)),H.add({_75o:F,tab:A,startX:n,endX:n+u,width:u}),n+=u+K}),b._64I=j(0,n-K),E){var $=E.position;b.drawTab(M,E.tab,E.startX,0,E.width,m,b._moveBackground),xn(M,b._insertColor,$,0,m)}if(M.restore(),b._selectionChanged){b._selectionChanged=!1;for(var q=b.tx(),k=0;k<H.size();k++){var U=H.get(k);if(U.tab===b._8o){if(U.endX+q<0){b.tx(-U.startX);break}if(U.startX+q>o){b.tx(o-U.endX);break}}}}b.tx(b.tx())}for(var v=[],f=P.children,k=0;k<f.length;k++){var d=f[k],V=d._tab_;V&&!C.contains(V)&&v.push(d)}v.forEach(function(f){P.removeChild(f)})}});var Sp=function(e){this.tv=e,this.addListeners()};Zi(Sp,c,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(c){this.handleScroll(c,10*(c.wheelDelta/40))},handle_DOMMouseScroll:function(Y){this.handleScroll(Y,10*-Y.detail)},handleScroll:function(O,Y){_d(O);var j=this.tv,g=j._tabPosition;!j._40o()||g!==Bp&&g!==sm||j.tx(this.tv.tx()+Y),!j._41o()||g!==fq&&g!==nb&&g!==fq+"-vertical"&&g!==nb+"-vertical"||j.ty(this.tv.ty()+Y)},_8Q:function(h){var j,Q,B=this.tv,e=B._tabPosition,D=B._7o;if(e===Bp||e===sm){var i=B.lp(h).x;for(j=0;j<D.size();j++)if(Q=D.get(j),Q.startX<=i&&i<=Q.endX)return Q}else if(e===fq||e===nb||e===fq+"-vertical"||e===nb+"-vertical"){var x=B.lp(h).y;for(j=0;j<D.size();j++)if(Q=D.get(j),Q.startY<=x&&x<=Q.endY)return Q}return k},isClickable:function(H){var k=this.tv,K=k._tabPosition,J=this._73o=this._8Q(H);return!k._40o()||K!==Bp&&K!==sm?!k._41o()||K!==fq&&K!==nb&&K!==fq+"-vertical"&&K!==nb+"-vertical"?J&&(!J.tab.isDisabled()||k.isMovable()):!0:!0},handle_mousemove:function(X){var P=this;Pg?P._74o=P._8Q(X):P.getView().style.cursor=P.isClickable(X)?Mh:""},handle_mousedown:function(p){this.handle_mousemove(p),this.handle_touchstart(p)},handle_touchstart:function(u){var U=this,T=U.tv,$=T._tabPosition;_d(u),Bn(u)&&U.isClickable(u)&&($===Bp||$===sm?(U.x=ms(u).x,U.lp=T.lp(u),U.tx=T.tx()):(U.y=ms(u).y,U.lp=T.lp(u),U.ty=T.ty()),rk(U,u))},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(d){var m,u=this,I=u.tv,A=I._tabPosition,n=u._73o;if(A===Bp||A===sm){if(m=ms(d).x-u.x,!u._25o&&!u.moving&&F(m)>2&&(I._40o()&&!pr(d)?u._25o=1:n&&I.isMovable()&&(u.moving=1)),u._25o)I.tx(u.tx+m);else if(u.moving){var S=u.lp.x+m,p=I._tabGap/2;I._7o.each(function(u){var q=u.endX,r=S-u.startX<q-S;S>=u.startX&&q>=S&&I._7Q({tab:n.tab,startX:n.startX+m,width:n.width,front:r,insertTab:u.tab,position:r?j(0,u.startX-p):$(I._64I,q+p)})})}}else if(m=ms(d).y-u.y,!u._25o&&!u.moving&&F(m)>2&&(I._41o()&&!pr(d)?u._25o=1:n&&I.isMovable()&&(u.moving=1)),u._25o)I.ty(u.ty+m);else if(u.moving){var q=u.lp.y+m,p=I._tabGap/2;I._7o.each(function(g){var X=g.endY,d=q-g.startY<X-q;q>=g.startY&&X>=q&&I._7Q({tab:n.tab,startY:n.startY+m,height:n.height,front:d,insertTab:g.tab,position:d?j(0,g.startY-p):$(I._23Q,X+p)})})}},handleWindowMouseUp:function(r){this.handleWindowTouchEnd(r)},handleWindowTouchEnd:function(){var H=this,m=H.tv,I=m._tabPosition,i=m.getTabModel(),S=i._roots,Z=H._73o;if(H.moving){var t=m._23o;if(t&&t.insertTab!==t.tab){var n=t.tab,j=S.remove(n),x=S.indexOf(t.insertTab);x>=0&&(t.front||x++,x<=S.size()&&(S.add(n,x),i._38I(n,j,x)))}m._7Q(k),delete H.moving}else if(!H._25o&&Z){n=Z.tab;var T=H._74o;if(!T||T.tab===n)if(!n.isDisabled()&&Wi(Z._75o,H.lp)){var C=function(){var z=S.indexOf(n);i.remove(n),m.onTabClosed(n,z)};m.onTabClosing(n,C)&&C()}else n.isDisabled()||m._8o===n||i.sm().ss(n)}H._25o=H._73o=H._74o=I===Bp||I===sm?H.x=H.lp=H.tx=k:H.y=H.lp=H.ty=k}}),ag.PropertyView=function(O){var l=this;l._view=Hb(1,l),l._canvas=os(l._view),Ll(l._view,l._79O=Xf()),l._rows=new pq,l._28o=new pq,l._26o={},l._26Q={};var T=l._propertyModel=new $b,Y=l.ivm;T.mm(Y,l),T.md(Y,l),T.mh(Y,l),l.dm(O?O:new $b),new Er(l)},Oe("PropertyView",c,{ms_ac:[vh,ce,to,Tn,Nn,"categorizable",ki,le,wd,Hf,vj,Td,df,Yp,"selectRowIndex",en,"background",$j,zg,Bg,Sf,Am],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Bf,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Rj,_background:I.propertyViewBackground,_expandIcon:I.propertyViewExpandIcon,_collapseIcon:I.propertyViewCollapseIcon,_scrollBarColor:gg,_scrollBarSize:lb,_autoHideScrollBar:mm,_selectBackground:I.propertyViewSelectBackground,_rowHeight:ys,_rowLineVisible:I.propertyViewRowLineVisible,_rowLineColor:I.propertyViewRowLineColor,_10I:.5,_columnLineVisible:I.propertyViewColumnLineVisible,_columnLineColor:I.propertyViewColumnLineColor,_labelColor:I.propertyViewLabelColor,_labelSelectColor:I.propertyViewLabelSelectColor,_labelFont:I.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(J){0>J&&(J=0),J>1&&(J=1);var k=this,h=k._10I;k._10I=J,k.fp("columnPosition",h,J)},getPropertyName:function(b){return b.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(g,Y,E){return E===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(H,B){return B===this._selectRowIndex?this._labelSelectColor:H.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(K){var O=this.getHeight()-this._59I;return O>K&&(K=O),K>0?0:L(K)},isExpanded:function(A){if(!A)return!0;var _=this._26o[A];return _?_.isExpanded:!(this._26Q[A]===!1)},toggle:function(l){var w=this;w.isExpanded(l)?w.collapse(l):w.expand(l)},expandAll:function(){this.validate();for(var $ in this._26o)this.expand($)},expand:function(Y){if(Y&&Y!==yp){var H=this,S=H._26o[Y];S&&!S.isExpanded&&(S.isExpanded=!0,H.onExpanded(Y),H.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var j in this._26o)this.collapse(j)},collapse:function(k){if(k&&k!==yp){var y=this,i=y._26o[k];i&&i.isExpanded&&(i.isExpanded=!1,y.onCollapsed(k),y.ivm())}},onCollapsed:function(){},getCategoryName:function(G){if(!this.isCategorizable())return yp;var x=G.getCategoryName();return x?x:yp},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(q){var J=this,S=J._dataModel;S!==q&&(S&&(S.umd(J.handlePropertyChange,J),J._selectionModel||S.sm().ums(J.handleSelectionChange,J)),J._dataModel=q,q.md(J.handlePropertyChange,J),J._selectionModel?J._selectionModel._21I(q):q.sm().ms(J.handleSelectionChange,J),J.fp(Jc,S,q))},isVisible:function(p){return this._visibleFunc?this._visibleFunc(p):!0},onPropertyChanged:function(F){var _=this,h=F.property;Xl[h]?_.ivm():_.iv(),h===Dp&&_._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:kb},handlePropertyChange:function(X){this._27o===X.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var D=this;D._96I||(D.setSelectRowIndex(-1),D._96I=1,D.iv())},redraw:function(){this.iv()},validateModel:function(){var Y=this,B=Y._rows,I=Y._28o,p={},g=new pq,y=Y._27o;Y.updateCurrentData(),y!==Y._27o&&Y.endEditing(),B.clear(),I.clear(),Y.getRawProperties().each(function(S){if(Y.isVisible(S)){g.add(S);var x=Y.getCategoryName(S);p[x]||(I.add(x,x===yp?0:V),p[x]={isExpanded:Y.isExpanded(x),properties:new pq})}}),Y._sortFunc&&g.sort(Y._sortFunc);for(var a in Y._26o)Y._26Q[a]=Y.isExpanded(a);Y._26o=p,I.each(function(N){N!==yp&&B.add(N);var d=p[N];d.isExpanded&&g.each(function(V){Y.getCategoryName(V)===N&&(d.properties.add(V),B.add({property:V,data:Y._27o}))},Y)})},validateImpl:function(){var Q=this;Q._76o(),Q._96I&&(Q.validateModel(),delete Q._96I);var U=Q._canvas,q=Q.getWidth(),s=Q.getHeight(),Z=-Q.ty(),b=Q._rowHeight,n=Q._indent,e=q-n,z=Q._rows,v=z.size(),V=Q._9I=n+e*Q._10I,K=Q._59I=v*b;Oi(U,q,s),Q._29I={x:0,y:Z,width:q,height:s},Q._31I=E(Z/b),Q._14I=g((Z+s)/b),Q._31I<0&&(Q._31I=0),Q._14I>v&&(Q._14I=v);var P,S=Rq(U),c=Q._background;Ko(S,0,-Z,1),S.beginPath(),S.rect(0,Z,q,s),S.clip(),S.clearRect(0,Z,q,s),Q._93db(S),c&&yq(S,0,0,n,K,c);for(var J=Q._31I;J<Q._14I;J++){var G=z.get(J),Z=b*J;if(Uc(G))c&&yq(S,n,Z,e,b,c),P=Ne(Q.isExpanded(G)?Q._expandIcon:Q._collapseIcon),P&&fo(S,P,yr,0,Z,n,b),S.save(),S.beginPath(),S.rect(n,Z,e,b),S.clip(),Q.drawCategoryName(S,G,J,n,Z,e,b),S.restore();else{var x=G.property,B=G.data,P=Ne(x.getIcon()),l=Q._selectRowIndex===J?Q.getSelectBackground():k;if(P&&fo(S,P,yr,0,Z,n,b),l&&yq(S,n,Z,e,b,l),S.save(),S.beginPath(),S.rect(n,Z,V-n,b),S.clip(),Q.drawPropertyName(S,x,J,n,Z,V-n,b),S.restore(),!Q.isEditing(B,x)){var R=V+1,f=q-V-1;S.save(),S.beginPath(),S.rect(R,Z,f,b),S.clip(),Q._87o(Q.drawPropertyValue(S,x,Q.getValue(B,x),J,R,Z,f,b,B),J,R,Z,f,b),S.restore()}}Q._rowLineVisible&&yq(S,n,Z+b-1,e,1,Q._rowLineColor)}Q._columnLineVisible&&(yq(S,V,0,1,K,Q._columnLineColor),yq(S,q-1,0,1,K)),Q._92db(S),Q._93I(),S.restore(),Q.ty(Q.ty())},drawCategoryName:function(e,b,$,f,y,g,N){qg(e,b,this.getCategoryFont(b),this.getCategoryColor(b),f,y,g,N)},drawPropertyName:function(X,q,A,H,U,g,O){return q.drawPropertyName?(q.drawPropertyName(X,q,A,H,U,g,O,this),void 0):(qg(X,this.getPropertyName(q),this.getPropertyFont(q,A),this.getPropertyColor(q,A),H,U,g,O),void 0)},drawPropertyValue:function(n,D,Y,z,S,j,p,e,M){return D.drawPropertyValue?D.drawPropertyValue(n,D,Y,z,S,j,p,e,M,this):(ck(n,Y,D,this.getLabelFont(D,Y,z),this.getLabelColor(D,Y,z),S,j,p,e,M,this),void 0)},isPropertyEditable:function(L){return L.isEditable()&&this.isEditable()},setProperties:function(v){this._propertyModel.clear(),this.addProperties(v)},addProperties:function(v){if(v){var b=this._propertyModel;v.forEach(function(K){if(!(K instanceof fj)){var O=sg(K.className);K=kq(O?O:fj,K)}b.add(K)})}},getRowIndexAt:function(g){var c=this,F=E(c.lp(g).y/c._rowHeight);return F>=0&&F<c._rows.size()?F:-1},getPropertyAt:function(P){var E=this,Y=E.getRowIndexAt(P);return Y>=0?E._rows.get(Y).property:k},getToolTip:function(U){var W=this,C=W.getPropertyAt(U),A=W._27o;return C&&A?C.getToolTip(A,W._9I<W.lp(U).x,W):k}});var Er=function(P){this.pv=P,this.addListeners()};Zi(Er,c,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(s){this.getView().style.cursor=s},clear:function(){var o=this;o._62O=o.cp=o.ty=o.p=k,o.setCursor(Rk)},handle_mousedown:function(i){this.handle_touchstart(i)},handle_touchstart:function(o){var t=this,s=t.pv;_d(o),s.setFocus(o)&&(Bn(o)?(t.cp=ms(o),t.ty=s.ty(),t.p=s.getColumnPosition(),t.handle_touchmove(o)):s.setSelectRowIndex(s.getRowIndexAt(o)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(j){this.handle_touchend(j)},handle_touchend:function(e){var x=this;if(x.cp&&!x._62O){var W=x.pv,N=W.lp(e),$=N.x,I=N.y,L=W._indent,s=W.getRowIndexAt(e),G=W._9I;if(s>=0){var q=W._rowHeight,z=q*s,B=W._rows.get(s),R=B.property;if(Uc(B))Ne(W.isExpanded(B)?W._expandIcon:W._collapseIcon)&&$>=0&&L>=$&&I>=z&&z+q>=I?W.toggle(B):sj(e)&&W.toggle(B);else if($>G&&W.isPropertyEditable(R,e)){var m={x:G+1,y:z,width:W.getWidth()-G-1,height:q},X={x:m.x+W.tx(),y:m.y+W.ty(),width:m.width,height:m.height},l=0,J=W._29I;m.y<J.y?l=m.y-J.y:m.y+q>J.y+J.height&&(l=m.y+q-J.y-J.height),l&&(W.ty(W.ty()-l),X.y-=l),W.beginEditing({data:B.data,property:R,value:W.getValue(B.data,R),event:e,rect:m,editorRect:X,view:W})}}W.setSelectRowIndex(s)}x.clear()},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(A){var u=this,q=u.pv,c=u.ty,F=u.cp,P=ms(A),z=u._62O;if("p"===z)q.setTranslateY(c+P.y-F.y);else if("c"===z){var v=q.getWidth()-q._indent;if(v>16){var G=u.p-(F.x-P.x)/v,$=16/v;$>G&&(G=$),G>1-$&&(G=1-$),q.setColumnPosition(G)}}else"s"===z&&q.setTranslateY(c+(F.y-P.y)*q._59I/q._29I.height)},handle_mousemove:function(t){this.handle_touchmove(t)},handle_touchmove:function(u){if(!Pg&&Bn(u)){var G=this,K=G.pv,S=F(K.lp(u).x-K._9I)<=(uh?8:3);G.cp?G._62O||(S?(G._62O="c",rk(G)):F(ms(u).y-G.cp.y)>=2&&(G._62O=G.isV(u)?"s":"p",rk(G))):(S?G.setCursor(rf):G.setCursor(Rk),G.isV(u)&&K._43o())}},isV:function(O){var m=this.pv,K=m._29I;return m._41o()&&K.x+K.width-m.lp(O).x<oo},handle_mousewheel:function(p){this.handleScroll(p,p.wheelDelta/40)},handle_DOMMouseScroll:function(h){2===h.axis&&this.handleScroll(h,-h.detail)},handleScroll:function(g,K){var D=this.pv;_d(g),D.endEditing(),D.translate(0,K*D.getRowHeight())},handle_keydown:function(h){var J=this.pv,z=J._rows.size(),j=J._selectRowIndex+(yc(h)?-1:1);(yc(h)||Vc(h))&&(0>j&&(j=0),j>=z&&(j=z-1),J.setSelectRowIndex(j))}}),ag.ListView=function(o){this._5o(o),new Pp(this)},Oe("ListView",c,{ms_ac:[vh,ce,to,$j,ki,zg,Bg,le,wd,Td,df,Yp,ci,en],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Rj,_rowHeight:ys,_rowLineVisible:I.listViewRowLineVisible,_rowLineColor:I.listViewRowLineColor,_scrollBarColor:gg,_scrollBarSize:lb,_autoMakeVisible:km,_autoHideScrollBar:mm,_selectBackground:I.listViewSelectBackground,_labelColor:I.listViewLabelColor,_labelSelectColor:I.listViewLabelSelectColor,_labelFont:I.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(L){var u=this,F=u._checkMode;u._checkMode=L,u.fp(Pk,F,L)},drawRow:function(c,C,g,R,x,j,V){var t=this,e=0,N=t._indent,$=t.getIconWidth(C);t.drawRowBackground(c,C,g,R,x,j,V),t._checkMode&&(Cd(c,Ne(t.getCheckIcon(C)),e+N/2,x+V/2,C,t),e+=N),t.drawIcon(c,C,e,x,$,V),t.drawLabel(c,C,e+$,x,V)}});var Pp=function(p){this.list=p,this._lastSelectDataTime=sp(),this.addListeners()};Zi(Pp,c,{ms_listener:1,getView:function(){return this.list._view},clear:function(S){var I=this,c=I.list;S&&"d"===I._62O&&!I.dragCancel&&c.handleDragAndDrop(S,"end"),c.draggingData&&(c.draggingData=null,c.redraw()),I.dragCancel=I._62O=I._isV=I._isH=I.cp=I.tx=I.ty=k},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(G){var u=this,s=u.list;if(_d(G),s.setFocus(G)){var W=s.getDataAt(G);u.cp=ms(G),u.tx=s.tx(),u.ty=s.ty(),Bn(G)?W&&s.handleDragAndDrop&&!u.isV(G)&&!u.isH(G)&&(s.draggingData=W,s.redraw(),s.handleDragAndDrop(G,"prepare")):(W&&u._33o(G,W),u.clear(G))}},handleWindowMouseUp:function(n){this.clear(n)},handleWindowTouchEnd:function(u){this.clear(u)},handle_mouseup:function(T){this.handle_touchend(T)},handle_touchend:function(r){var _=this,c=_.list;if(!_._isV&&!_._isH&&_.cp&&!_._62O){var U=c.getDataAt(r);U?(c.isCheckMode()?_._34o(r,U):_._33o(r,U),sj(r)?c.onDataDoubleClicked(U,r):c.onDataClicked(U,r)):c.handleBackgroundClick(r)}_.clear(r)},handleWindowMouseMove:function(P){this.handleWindowTouchMove(P)},handleWindowTouchMove:function(r){var Y=this,F=Y.list,N=Y._62O,V=Y.tx,s=Y.ty,c=Y.cp,U=ms(r),u=F._29I;"p"===N?F.setTranslate(V+U.x-c.x,s+U.y-c.y):"v"===N?F.ty(s+(c.y-U.y)*F._59I/u.height):"h"===N?F.tx(V+(c.x-U.x)*F._91I/u.width):"d"===N&&(Y.dragCancel||F.handleDragAndDrop(r,"between"))},handle_mousemove:function(F){this.handle_touchmove(F)},handle_touchmove:function(p){if(!Pg&&Bn(p)){var m=this,T=m.list;if(m._isV=m.isV(p),m._isH=m.isH(p),m.cp){if(!m._62O){if(wh(ms(p),m.cp)<2)return;m._isV?m._62O="v":m._isH?m._62O="h":T.draggingData&&!this.dragCancel?(m._62O="d",T.handleDragAndDrop(p,"begin")):m._62O="p",m._62O&&"d"!==m._62O&&T.draggingData&&(T.draggingData=null,T.redraw()),rk(m)}}else m._isV&&T._43o(),m._isH&&T._42o()}},isV:function(w){var k=this.list,$=k._29I;return k._41o()&&$.x+$.width-k.lp(w).x<oo},isH:function(I){var u=this.list,B=u._29I;return u._40o()&&B.y+B.height-u.lp(I).y<oo},handle_mousewheel:function(r){this.handleScroll(r,r.wheelDelta/40,r.wheelDelta!==r.wheelDeltaX)},handle_DOMMouseScroll:function(C){this.handleScroll(C,-C.detail,1)},handleScroll:function(o,v,Y){var i=this.list;_d(o),i.endEditing&&i.endEditing(),Y&&i._41o()?i.translate(0,v*i.getRowHeight()):i._40o()&&i.translate(10*v,0)},handle_keydown:function(R){if(!I.isInput(R.target)){var X,T=this.list,a=T.sm(),y=T._rows,f=y.size();if(Ah(R))T.selectAll();else if(Fm(R))T.handleDelete&&T.handleDelete(R);else if(_m(R))"d"!==this._62O||this.dragCancel||(T.handleDragAndDrop(R,"cancel"),this.dragCancel=!0);else if(Eg(R))T.isCheckMode()&&(X=T.getFocusData(),X&&T.checkData(X));else if(yc(R)||Vc(R)){var o=T.isCheckMode();if(X=o?T.getFocusData():a.ld()){var w=T.getRowIndex(X);w>=0&&(yc(R)?0!==w&&(X=y.get(w-1),o?T.setFocusData(X):a.ss(X)):w!==f-1&&(X=y.get(w+1),o?T.setFocusData(X):a.ss(X)))}else f>0&&(X=y.get(0),o?T.setFocusData(X):a.ss(X))}}},_34o:function(b,V){var j=this.list,Z=j.lp(b).x;return Z>=0&&Z<=j._indent?(j.checkData(V),void 0):(j.setFocusData(V),void 0)},_33o:function(L,y){var r=this.list,T=r.sm(),_=T.ld();if(pr(L))r.isSelected(y)?T.rs(y):T.as(y);else if(ub(L))if(_)for(var o=r.getRowIndex(_),v=r.getRowIndex(y);o!==v;)o+=v>o?1:-1,T.as(r._rows.get(o));else T.ss(y);else if(Bn(L)){var S=sp();if(T.contains(y)){var P=S-this._lastSelectDataTime;r.handleDataDoubleSelect&&P>500&&1500>P&&r.handleDataDoubleSelect(L,y)}T.ss(y),this._lastSelectDataTime=S}else T.contains(y)||T.ss(y)}}),ag.TreeView=function(r){var V=this;V._35o(),V._5o(r),new tf(V)},Oe("TreeView",c,{ms_ac:[vh,ce,to,"rootVisible",Pk,"rootData",le,wd,Td,df,Yp,ki,$j,zg,Bg,Hf,vj,ci,en,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:k,_indent:Rj,_rowHeight:ys,_rowLineVisible:I.treeViewRowLineVisible,_rowLineColor:I.treeViewRowLineColor,_scrollBarColor:gg,_scrollBarSize:lb,_autoHideScrollBar:mm,_expandIcon:I.treeViewExpandIcon,_collapseIcon:I.treeViewCollapseIcon,_autoMakeVisible:km,_selectBackground:I.treeViewSelectBackground,_labelColor:I.treeViewLabelColor,_labelSelectColor:I.treeViewLabelSelectColor,_labelFont:I.treeViewLabelFont,_doubleClickToToggle:I.treeViewDoubleClickToToggle,drawRow:function(v,R,M,A,x,S,a){var s=this;s.drawRowBackground(v,R,M,A,x,S,a),s._97I(v,R,M,0,x,S,a)},isOnToggleIcon:function(r){var Z=this.getDataAt(r);if(Z){var h=this.getIndent(),U=this.lp(r).x;if(Ne(this.getToggleIcon(Z))){var t=h*this.getLevel(Z);if(U>=t&&t+h>=U)return!0}}return!1}});var tf=function(d){uj(tf,this,[d])};Zi(tf,Pp,{toggle:function(z,m,x,E){var D=this.list,y=D.lp(z).x;if(Ne(D.getToggleIcon(m))){var d=x*E;if(y>=d&&d+x>=y)return D.toggle(m),!0}return D.isDoubleClickToToggle()&&sj(z)?(D.toggle(m),!0):!1},_34o:function(t,M){var v=this.list,T=v.lp(t).x,G=v._levelMap[M._id],e=v._indent,N=e*(G+1);return T>=N&&N+e>=T?(v.checkData(M),void 0):(this.toggle(t,M,e,G)||v.setFocusData(M),void 0)},_33o:function(Q,o){var I=this,q=I.list;I.toggle(Q,o,q._indent,q.getLevel(o))||tf.superClass._33o.call(I,Q,o)},handle_keydown:function(t){if(_o(t)||_b(t)){var Q=this.list,j=Q._rows,z=Q.isCheckMode(),x=Q.sm(),D=z?Q.getFocusData():x.ld();D?D.hasChildren()&&(_o(t)?Q.collapse(D):Q.expand(D)):j.size()>0&&(D=j.get(0),z?Q.setFocusData(D):x.ss(D))}else tf.superClass.handle_keydown.call(this,t)}});var Ur=ag.TableView=function(M){this._98I(),this._5o(M),new wc(this)};Oe("TableView",c,{ms_ac:[vh,ce,to,"sortMode",Tn,Nn,$j,zg,Bg,Sf,Am,"sortColumn",le,wd,Td,df,Yp,ci,en],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:de,_editable:!0,_batchEditable:!1,_rowHeight:ys,_rowLineVisible:I.tableViewRowLineVisible,_rowLineColor:I.tableViewRowLineColor,_columnLineVisible:I.tableViewColumnLineVisible,_columnLineColor:I.tableViewColumnLineColor,_scrollBarColor:gg,_scrollBarSize:lb,_autoHideScrollBar:mm,_autoMakeVisible:km,_selectBackground:I.tableViewSelectBackground,_labelColor:I.tableViewLabelColor,_labelSelectColor:I.tableViewLabelSelectColor,_labelFont:I.tableViewLabelFont,getCheckColumn:function(){var K=this;if(!K._31o){var $=K._31o=new Pn;$.setEditable(!0),$.setWidth(40),$.getValue=K.getCheckColumValue,$.drawCell=K.drawCheckColumnCell}return K._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(D){var y=this,A=y._39o,M=y.getCheckColumn();D!==y.isCheckMode()&&(D?A.add(M,0):A.remove(M),y.fp(Pk,!D,D))},getCheckColumValue:function(w,u,k){return k.isSelected(w)},drawCheckColumnCell:function(f,q,$,g,B,w,t,Q,R){Cd(f,R.getCheckIcon(q),B+t/2,w+Q/2,q,R)}});var wc=function(b){uj(wc,this,[b])};Zi(wc,Pp,{_34o:function(T,c){var z=this.list,Y=z._31o;if(z.isCellEditable(c,Y,T)){var A=z._3Q(Y),B=z.lp(T).x;if(A&&B>=A.startX&&B<A.startX+Y.getWidth())return z.checkData(c),void 0}z._37O(c,T),z.setFocusData(c)},_33o:function(W,f){this.list._37O(f,W),wc.superClass._33o.apply(this,arguments)}});var _p=ag.TreeTableView=function(X){var r=this,x=r._4o=new Pn;r._35o(),r._98I(),r._5o(X),x.setDisplayName("Name"),x.setEditable(!0),x.setWidth(180),x.drawCell=wm,x.getValue=kf,r._39o.add(x),new gc(r)},wm=function(h,b,I,A,G,M,P,V,R){R._97I(h,b,I,G,M,P,V)},kf=function(L,w,p){return p.getLabel(L)};Oe("TreeTableView",c,{ms_ac:[vh,ce,to,"sortMode",Tn,Nn,ki,Pk,"rootData","rootVisible",le,wd,"sortColumn",Hf,vj,Td,df,Yp,ci,Bg,$j,zg,Sf,Am,en,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:de,_checkMode:k,_editable:!0,_batchEditable:!1,_indent:Rj,_rowHeight:ys,_rowLineVisible:I.treeTableViewRowLineVisible,_rowLineColor:I.treeTableViewRowLineColor,_columnLineVisible:I.treeTableViewColumnLineVisible,_columnLineColor:I.treeTableViewColumnLineColor,_expandIcon:I.treeTableViewExpandIcon,_collapseIcon:I.treeTableViewCollapseIcon,_scrollBarColor:gg,_scrollBarSize:lb,_autoHideScrollBar:mm,_autoMakeVisible:km,_selectBackground:I.treeTableViewSelectBackground,_labelColor:I.treeTableViewLabelColor,_labelSelectColor:I.treeTableViewLabelSelectColor,_labelFont:I.treeTableViewLabelFont,getTreeColumn:function(){return this._4o
}});var gc=function(S){uj(gc,this,[S])};Zi(gc,Pp,{_34o:function(u,r){var H=this.list,E=H._4o,w=H._3Q(E),f=H.lp(u).x;if(w){var L=H._indent,G=w.startX+L*H.getLevel(r);if(Ne(H.getToggleIcon(r))&&f>=G&&G+L>=f)return H.toggle(r),void 0;if(H.isCellEditable(r,E)&&(G+=L,f>=G&&G+L>=f))return H.checkData(r),void 0}H._37O(r,u),H.setFocusData(r)},_33o:function(x,I){var D=this.list,s=D.lp(x).x;if(Ne(D.getToggleIcon(I))){var j=D._3Q(D._4o);if(j){var u=D._indent,Z=j.startX+u*D.getLevel(I);if(s>=Z&&Z+u>=s)return D.toggle(I),void 0}}D._37O(I,x),gc.superClass._33o.apply(this,arguments)}});var $c=ag.TableHeader=function(c){var M=this,W=M._view=Hb(1,M),X=M._39o=c.getColumnModel(),Z=M.iv;M.tv=M._tableView=c,M._60I=new pq,M._canvas=os(W),W.style.background=I.tableHeaderBackground||"",W.style.height=Nq+cp,X.mm(Z,M),X.md(Z,M),X.mh(Z,M),c.mp(function(Q){Cp[Q.property]&&M.iv()},M),new Pj(M),M.iv()};Oe("TableHeader",c,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",vh,to,ki,"moveBackground","insertColor",Sf,Am,"resizable","movable"],_checkIcon:Md,_movable:!0,_resizable:!0,_labelColor:I.tableHeaderLabelColor,_labelFont:I.tableHeaderLabelFont,_columnLineColor:I.tableHeaderColumnLineColor,_columnLineVisible:I.tableHeaderColumnLineVisible,_sortDescIcon:I.tableHeaderSortDescIcon,_sortAscIcon:I.tableHeaderSortAscIcon,_moveBackground:I.tableHeaderMoveBackground,_insertColor:I.tableHeaderInsertColor,_indent:Rj,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(g){return g.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(C){return C.getColor()||this._labelColor},getLabelAlign:function(H){return H._align},onPropertyChanged:function(){this.iv()},_5Q:function(Q){this._61I=Q,this.iv()},getLogicalPoint:function(h){return Iq(h,this._canvas,this.tv.tx())},validateImpl:function(){var c=this,g=c._canvas,m=c.getWidth(),j=c.getHeight(),N=c.tv,Z=c._60I,O=c._61I,d=-N.tx(),$=0;(m!==g.clientWidth||j!==g.clientHeight)&&Oi(g,m,j),Z.clear(),c._39o._roots.each(function(b){if(b.isVisible()){var o=$+b.getWidth();d+m>=$&&o>=d&&Z.add({column:b,startX:$}),$=o}});var o=Rq(g);if(Ko(o,-d,0,1),o.beginPath(),o.rect(d,0,m,j),o.clip(),o.clearRect(d,0,m,j),Z.each(function(Z){var t=Z.column,b=Z.startX,x=t.getWidth();x>0&&(o.save(),o.beginPath(),o.rect(b,0,x,j),o.clip(),O&&O.column===t||c.drawColumn(o,t,b,0,x,j),c._columnLineVisible&&yq(o,b+x-1,0,1,j,c._columnLineColor),o.restore())}),O){var a=O.column,$=O.startX,y=O.position,I=a.getWidth();o.save(),o.beginPath(),o.rect($,0,I,j),o.clip(),o.fillStyle=c._moveBackground,o.fill(),c.drawColumn(o,a,$,0,I,j),o.restore(),xn(o,c._insertColor,y,0,j)}o.restore()},_6Q:function(B){var C=this.tv;return C._31o===B&&C.sm().getSelectionMode()===Je},drawColumn:function(a,e,z,t,v,E){var L=this,D=L.tv,T=Ne(e.getIcon()),V=L.getLabelAlign(e);if(L._6Q(e)){var Q=Ne(L._checkIcon);Cd(a,Q,z+v/2,t+E/2,e,L)}else{var R=L.getLabel(e),N=L.getLabelFont(e),H=L.getLabelColor(e),j=Qk(N,R).width,$=T?L._indent:0;V===fq?(T&&fo(a,T,yr,z,t,$,E),qg(a,R,N,H,z+$,t,v,E,fq)):V===nb?(T&&fo(a,T,yr,z+v-j-$,t,$,E),qg(a,R,N,H,z,t,v,E,nb)):(T&&fo(a,T,yr,z+(v-j-$)/2,t,$,E),qg(a,R,N,H,z+(v-j+$)/2,t,0,E,fq))}if(e.isSortable()&&D.getSortColumn()===e&&(T=Ne(e.getSortOrder()===Ep?L._sortAscIcon:L._sortDescIcon))){var S=Or(T,e)/2+2;Cd(a,T,V===nb?z+S:z+v-S,t+E/2,e,D)}}});var Pj=function(q){var T=this;T.th=q,T.tv=q._tableView,T.addListeners()};Zi(Pj,c,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(A){this.getView().style.cursor=A},handle_mousemove:function(Z){if(!Pg){var l=this;delete l._29o,l.setCursor(Rk);for(var I=l.th,S=I._60I,g=I.lp(Z).x,L=S.size()-1;L>=0;L--){var s=S.get(L),Q=s.column,j=s.startX+Q.getWidth();if(I.isResizable()&&F(j-g)<=(uh?10:3))return l._29o=s,l.setCursor(rf),void 0;g>s.startX&&j>g&&(l._29o=s),(Q.isClickable()||Q.isSortable()||I.isMovable()||l.tv.getCheckColumn&&Q===l.tv.getCheckColumn())&&g>s.startX&&j>g&&l.setCursor(Mh)}}},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(t){var q=this;_d(t),q.tv.endEditing(),q.handle_mousemove(t),q._29o&&(q.x=ms(t).x,q.lx=q.th.lp(t).x,q.w=q._29o.column.getWidth(),rk(q,t))},handleWindowMouseMove:function(T){this.handleWindowTouchMove(T)},handleWindowTouchMove:function(A){var u=this,B=u.th,P=u.getView().style.cursor,e=u._29o,l=ms(A).x-u.x;if(u.resizing||u.moving||(P===rf?u.resizing=1:B.isMovable()&&P===Mh&&F(l)>2&&(u.moving=1)),u.resizing)e.column.setWidth(u.w+l);else if(u.moving){var Y=u.lx+l;B._60I.each(function(N){var $=N.startX,Z=$+N.column.getWidth();if(Y>=$&&Z>=Y){var h={column:e.column,startX:e.startX+l,front:Z-Y>Y-$,insertColumn:N.column};h.position=h.front?$:Z,B._5Q(h)}})}},_16Q:function(b,O){var X=this,n=X.tv,D=X.th,H=D._checkIcon;if(D._6Q(b)){var J=Ne(H),F=X.lx,p=b.getWidth(),Q=Or(J,b);if(F>=O+p/2-Q&&O+p/2+Q>=F){D.setCheckIcon(H===Vr?Md:Vr);var z=n.sm(),e=n._rows;return H===Vr?z.rs(e):z.ss(e),n.onCheckColumnClicked(b),!0}}return!1},handleWindowMouseUp:function(K){this.handleWindowTouchEnd(K)},handleWindowTouchEnd:function(b){var h=this,U=h.tv,e=h.th,F=h._29o;if(h.moving){var v=e._61I;if(v&&v.insertColumn!==v.column){var B=v.column,j=U.getColumnModel()._roots,p=j.remove(B),H=j.indexOf(v.insertColumn);H>=0&&(v.front||H++,H<=j.size()&&(j.add(B,H),U.getColumnModel()._38I(B,p,H)))}e._5Q(k),delete h.moving}else if(!h.resizing&&F){B=F.column;var $=e.lp(b).x,y=F.startX,V=!0;if(e.onColumnClicked){var R=e.onColumnClicked(B,b,y);R===!1&&(V=!1)}if(V&&$>=y&&$<=y+B.getWidth()&&!h._16Q(B,y)){if(B.isSortable()){var D=U.getSortMode(),q=B.getSortOrder();D===de?U.getSortColumn()===B?(q===Qc&&U.setSortColumn(k),B.setSortOrder(q===Ep?Qc:Ep)):U.setSortColumn(B):"bistate"===D&&(U.getSortColumn()===B?B.setSortOrder(q===Ep?Qc:Ep):U.setSortColumn(B))}U.onColumnClicked(B,b,y)}}h._29o=h.resizing=h.x=h.lx=h.w=k}}),ag.TablePane=function(A){this.init(new Ur(A))},Oe("TablePane",c,{ms_v:1,_44o:1}),ag.TreeTablePane=function(J){this.init(new _p(J))},Oe("TreeTablePane",c,{ms_v:1,_44o:1}),ag.Toolbar=function(S){var _=this,x=_._view=Hb(1,_),R=x.style;R.background=I.toolbarBackground||"",R.height=Ho+cp,_._canvas=os(x),_._30o=new pq,_._90I=new pq,_.setItems(S||[]),x.handleGroupSelectedChanged=function(o){if(o.isSelected()){var Z=o.getGroupId();null!=Z&&_._items.forEach(function(p){var I=p.element;I&&I!==o&&I.setSelected&&I.getGroupId&&I.getGroupId()===Z&&I.setSelected(!1)})}},new aj(_)},Oe("Toolbar",c,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Ak,vh,to,ce,en,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:I.toolbarLabelColor,_labelSelectColor:I.toolbarLabelSelectColor,_labelFont:I.toolbarLabelFont,_selectBackground:I.toolbarSelectBackground,_itemGap:I.toolbarItemGap,_separatorColor:I.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(A){var m=this.getItemInfoAt(A);return m?m.item.toolTip:k},getLabelColor:function(g){return g&&g.selected&&g.type!==Vr&&g.type!==Wn?this._labelSelectColor:this._labelColor},onPropertyChanged:function(g){this.iv(),g.property===Ak&&this._items.forEach(function(R){fm(R)})},redraw:function(){this.iv()},addItem:function(m,t){var o=this._items;t==k?o.push(m):o.splice(t,0,m),this.fp(Ak,k,o)},removeItem:function(R){if(R)for(var s=this._items,N=0;N<s.length;N++)R===s[N]&&(s.splice(N,1),this.fp(Ak,k,s))},removeItemById:function(Z){if(Z!=k)for(var j=this._items,d=0;d<j.length;d++)if(Z===j[d].id){var o=j.splice(d,1)[0];return this.fp(Ak,k,j),o}},getItemById:function(L){if(L!=k)for(var r=this._items,J=0;J<r.length;J++){var p=r[J];if(L===p.id)return p}},setItemVisible:function(L,V){var D=this.getItemById(L);D&&(D.visible=V)},getItemInfos:function(){return this._30o},getItemInfoAt:function(W){var O=this,F=0,b=O._30o,M=O.lp(W),x=M.x,w=M.y;if(w>=0&&w<=O.getHeight())for(;F<b.size();F++){var G=b.get(F);if(G.startX<=x&&x<=G.endX)return G}return k},drawItem:function(c,G,o,L,W){if(G.visible===!1)return 0;if(od(G.visible)&&!G.visible())return 0;var D=this,f=G.disabled;f&&(c.globalAlpha=xg);var j=D.drawItemImpl(c,G,o,L,W),k=D._itemGap;return f&&(c.globalAlpha=1),this._currentItem!==G||"separator"===G||G.separator===!0||G.unfocusable||so(c,D._separatorColor,o-k/2,0,j+k,L),j},drawItemImpl:function(w,G,H,B,D){var m=this,z=m._view,Y=m._itemGap,n=B/2,i=G.type,s=G.element,E=G.label;Uc(s)&&(E=s,s=k);var x,$=m.getLabelFont(G),A=m.getLabelColor(G),d=G.selected,T=Ne(G.icon),U=Or(T,G),o=0,F=U+(E?Qk($,E).width:0);if("separator"===G||G.separator===!0)return xn(w,m._separatorColor,H,B/4,n),1;if(s){T&&Cd(w,T,H+U/2,n,G,m),qg(w,E,$,A,H+U,0,0,B);var t=Dk(s);D||m._90I.add(t),t.parentNode!==z&&Ll(z,t),s.iv&&s.iv(),s.validate&&s.validate();var P=t.getBoundingClientRect(),Q=P.width,h=t.style;return hp(t),h.left=m.tx()+H+F+cp,h.top=(B-P.height)/2+cp,F+Q}return i===Wn?x=Ne(d?Cg:Gm):i===Vr&&(x=Ne(d?Vr:Md)),x?(o=Or(x,G),Cd(w,x,H+o/2,n,G,m),H+=o,F+=o):d&&yq(w,H-Y/2,0,F+Y,B,m.getSelectBackground(G)),T&&Cd(w,T,H+U/2,n,G,m),qg(w,E,$,A,H+U,0,0,B),F},validateImpl:function(){var x=this,V=x._canvas,I=x.getWidth(),R=x.getHeight(),B=x._30o,o=x._items;Oi(V,I,R);var q=Rq(V),L=x._itemGap,E=L/2;Ko(q,x.tx(),0,1),q.clearRect(0,0,I,R);var u=x._90I;x._90I=new pq,B.clear(),o.forEach(function(b){var f=x.drawItem(q,b,E,R);B.add({item:b,startX:E,endX:E+f,width:f}),f&&(E+=f+L)}),u.each(function(V){x._90I.contains(V)||Zj(V)});var O=x._64I;x._64I=j(0,E),q.restore(),x._stickToRight?(x._65O=0,q=Rq(V),E=I-x._64I+L,Ko(q,0,0,1),q.clearRect(0,0,I,R),B.clear(),o.forEach(function(F){var e=x.drawItem(q,F,E,R,!0);B.add({item:F,startX:E,endX:E+e,width:e}),e&&(E+=e+L)}),q.restore()):x.tx(x.tx()),O!==x._64I&&x.onSumWidthChanged(O,x._64I)},onSumWidthChanged:function(){},handleClick:function(L,i){var Y=this,Q=L.type,G=L.action,d=L.groupId,g=L.selected;L.disabled||(d!=k?g||(L.selected=!0,this._items.forEach(function(b){b.groupId===d&&L!==b&&(b.selected=!1)}),G&&L.action(L,Y,i)):Q===Vr||"toggle"===Q?(L.selected=!g,G&&L.action(L,Y,i)):G&&L.action(L,Y,i)),xm(),Y.iv()}});var aj=function(S){this.tb=S,this.addListeners()};Zi(aj,c,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(E){this.handleScroll(E,10*(E.wheelDelta/40))},handle_DOMMouseScroll:function($){this.handleScroll($,10*-$.detail)},handleScroll:function(I,R){_d(I);var _=this.tb;_.isScrollable()&&!_._stickToRight&&(_.tx(_.tx()+R),Fj())},handle_mousemove:function(Q){var N=this;Pg||N.setItem(Q)},handle_mouseout:function(j){var u=this;j.target===u.getView()?u.tb.setCurrentItem(k):u.handle_mousemove(j)},handle_mousedown:function(j){this.handle_mousemove(j),this.handle_touchstart(j)},handle_touchstart:function($){var f=this,c=f.tb,h=$.target;Bn($)&&(h===f.getView()||h===c._canvas)&&(_d($),c.setFocus($)&&(this.setItem($,!0),(c.isScrollable()||f.info&&!f.info.item.disabled)&&(f.x=ms($).x,f.tx=c.tx(),rk(f,$))))},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function(V){var A=this,L=A.tb;if(!L._stickToRight){var s=ms(V).x-A.x;!A._25o&&F(s)>2&&L.isScrollable()&&(A._25o=1),A._25o&&L.tx(A.tx+s)}},handleWindowMouseUp:function(F){this.handleWindowTouchEnd(F)},handleWindowTouchEnd:function(M){var O=this,H=O.tb,b=O.info,_=O.tb.getItemInfoAt(M);if(!O._25o&&b){var S=b.item;_&&_.item===S&&H.handleClick(S,M)}O._25o=O.x=O.tx=k,O.setItem()},setItem:function(W,d){var U=this,R=U.tb,l=U.info=W?R.getItemInfoAt(W):k,r=l?l.item:k;R.setCurrentItem(r),d&&r&&od(r.onDown)&&r.onDown(W)}}),ag.BorderPane=function(){this._view=Hb(1,this),this.iv()},Oe("BorderPane",c,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(W,S){this._12o("leftView",W),S!=k&&this.setLeftWidth(S)},getRightView:function(){return this._rightView},setRightView:function(i,X){this._12o("rightView",i),X!=k&&this.setRightWidth(X)},getTopView:function(){return this._topView},setTopView:function(C,x){this._12o("topView",C),x!=k&&this.setTopHeight(x)},getBottomView:function(){return this._bottomView},setBottomView:function(W,I){this._12o("bottomView",W),I!=k&&this.setBottomHeight(I)},getCenterView:function(){return this._centerView},setCenterView:function(A){this._12o("centerView",A)},_12o:function(V,T){var Y=this,s="_"+V,A=Y._view,$=Y[s];$!==T&&($&&($.getView?Zj($.getView()):Zj($)),Y[s]=T,T&&(T.getView?Ll(A,T.getView(),1):Ll(A,T,1)),Y.fp(V,$,T))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var y=this,H=y._topView,$=y._bottomView,s=y._leftView,x=y._rightView,T=y._centerView,J=y.getWidth(),W=y.getHeight(),R=0,c=0,S=J,E=W,O=0,_=0,M=0,K=0;H&&(O=y._topHeight==k?yf(H):y._topHeight,c=O),$&&(_=y._bottomHeight==k?yf($):y._bottomHeight,E=W-_),s&&(M=y._leftWidth==k?To(s):y._leftWidth,R=M),x&&(K=y._rightWidth==k?To(x):y._rightWidth,S=J-K);var A=j(0,S-R),o=j(0,E-c);H&&qi(H,0,0,J,O),$&&qi($,0,E,J,_),s&&qi(s,0,c,M,o),x&&qi(x,S,c,K,o),T&&qi(T,R,c,A,o)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);