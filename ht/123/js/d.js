!function(Y,g,D){"use strict";var R="ht",o=Y[R],v=o.Default,O=o.graph,n=v.getInternal(),Z=n.ui(),E=Z.NodeUI.prototype,X=Z.ShapeUI.prototype,A=O.GraphView,t=A.prototype,u=Z.EdgeUI.prototype,w=o.Node,c=o.Shape,K=o.Edge,h=o.Group,J=v.isTouchable,G=v.preventDefault,P=Y.setTimeout,W=v.grow,p=v.isDragging,N=v.getDistance,a=null,i=o.List,C="undefined"!=typeof Float32Array?Float32Array:Array,_=Math,L=_.PI,S="Crossing",x="No Crossing",d=L/2,B=2*L,y=_.atan2,F=_.sqrt,j=_.pow,H=_.sin,k=_.cos,I=_.min,q=_.max,b=_.abs,V=_.ceil,r=_.round,Q=v.unionPoint,T=v.unionRect,z=v.containsPoint,s=v.clone,U="rgb(52, 152, 219)",f="red",m={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},$={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var h=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],a=0;a<h.length;a++){var o=h[a];o=0===a%2?o/400*$.width:o/100*$.height,h[a]=o}return $.width>120&&(h[4]=$.width-26,h[6]=$.width-40,h[10]=$.width-40,h[12]=$.width-26,h[18]=33),h}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},l={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:U,rotation:.61},{type:"circle",rect:[200,120,70,70],background:U,rotation:.61},{type:"circle",rect:[200,220,70,70],background:U,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:U},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:U}]},e={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:f,rotation:.61}]},M={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:U},{type:"circle",rect:[0,210,90,90],background:U},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:U}]},$f={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:f},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:f}]},$e={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:U}]},hc={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:f}]},pp={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},ee={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},vg=function(e){var i=e.touches[0];return i?i:e.changedTouches[0]},fo=function(v,r,e,c){return y(c-r,e-v)},cj=function(y,n){return{x:y.x*n,y:y.y*n}},ub=function(v,W){v.each(function(H){return v.isSelected(H)?W(H):void 0})},Yl=function(s,$){s.reverseEach(function(g){return s.isSelected(g)?$(g):void 0})},Vr=function(z,q,o){var m,W,s,x,e,p=this,v=q,t=p.gv;if(z instanceof c){s=z.getSegments();var U=t.getDataUI(z);e=U._55O.$15l,s&&s.size()||(s=Br(e)),z.isClosePath()&&s.indexOf(5)<0&&(s=new i(s._as),s.add(5)),m=Rh(z,U,v),W=e[m]}else{var K=t.getDataUI(z);e=Cm(K,z.s("edge.points")),s=z.s("edge.segments"),s&&s.size()||(s=Br(e)),e=e._as,m=Rh(z,K,v),W=e[m]}if(s&&(x=s.get(v)),2===x||1===x||5===x){var T=e[m+1];5===x&&(T=e[0]);var f=Hg(W,o,T);return f}return o},In=function(m,j,C,x){var K=j/2,s=C/2,_=Ll(m,-K,-s,x),E=Ll(m,K,-s,x),Z=Ll(m,-K,s,x),P=Ll(m,K,s,x),d=Ll(m,0,-s,x),z=Ll(m,K,0,x),$=Ll(m,0,s,x),c=Ll(m,-K,0,x);return[_,E,Z,P,d,z,$,c]},Hg=function(Q,h,g){var x={x:h.x-Q.x,y:h.y-Q.y},V={x:g.x-Q.x,y:g.y-Q.y},D=F(j(g.x-Q.x,2)+j(g.y-Q.y,2)),a={x:V.x/D,y:V.y/D},e=x.x*a.x+x.y*a.y,k={x:a.x*e,y:a.y*e};return{x:Q.x+k.x,y:Q.y+k.y}},Ll=function(W,w,A,G){var T=k(G)*w-H(G)*A,B=H(G)*w+k(G)*A;return W?{x:W.x+T,y:W.y+B}:{x:T,y:B}},hn=function(B,x){return x>2*B?B:x/2},Nq=function(F,M,y,Y){var T=N(F,M);return y=Y?I(y,T):hn(y,T),T?y/=T:y=0,{x:F.x+(M.x-F.x)*y,y:F.y+(M.y-F.y)*y}},Yd=function(t,V){var G,o,Z=t.gv,s=t._data,b=s._40I,M=s._41I,r=s.s("edge.offset"),E=s.s("edge.source.position"),R=s.s("edge.target.position"),A=s.s("edge.source.offset.x"),L=s.s("edge.source.offset.y"),J=s.s("edge.target.offset.x"),w=s.s("edge.target.offset.y"),g=s.s("edge.source.anchor.x"),B=s.s("edge.source.anchor.y"),P=s.s("edge.target.anchor.x"),u=s.s("edge.target.anchor.y");if(V?(G=n.getEdgeAgentPosition(Z,b,E,A,L,g,B),o=n.getEdgeAgentPosition(Z,M,R,J,w,P,u)):(G=n.getEdgeAgentPosition(Z,b,E,0,0,g,B),o=n.getEdgeAgentPosition(Z,M,R,0,0,P,u)),"points"===s.s("edge.type")&&r&&!s.s("edge.center")&&G){var v=s.s("edge.points")||new i,Y=v.size(),c=Nq(G,Y?v.get(0):o,r,Y),y=Nq(o,Y?v.get(Y-1):G,r,Y);G=c,o=y}return[G,o]},Cm=function(R,P,e){var V=R._78o,K=R._data,l=K.s("edge.type"),G=[V.sourcePoint,V.targetPoint];return"points"===l?e&&(G=Yd(R)):G=V.center?l?e?Yd(R):Yd(R,!0):e?Yd(R):[V.c1,V.c2]:e?Yd(R):Yd(R,!0),P=new i(P?P._as:a),P.add(G[0],0),P.add(G[1]),P},Om=function(p){return p=new i(p._as),p.removeAt(0),p.removeAt(p.size()-1),p},Br=function(m){m._as||(m=new i(m));var H=new i;H.add(1);for(var U=1;U<m.size();U++)H.add(2);return H},Wc=function(G,Z){return{x:(G.x+Z.x)/2,y:(G.y+Z.y)/2}},Rk=function(H,U){return{x:H.x+1*(U.x-H.x)/4,y:H.y+1*(U.y-H.y)/4}},nf=function(S,x){return{x:S.x+3*(x.x-S.x)/4,y:S.y+3*(x.y-S.y)/4}},Od=function(D,P,E,L){var U=P.x+P.width/2,v=P.y+P.height/2,K=F(U*U+v*v),s=y(v,U)+E;return{x:L.x+K*k(s),y:L.y+K*H(s)}},no=t.validateImpl,Pr=t.isRectEditable,sq=t.isPointEditable,Sq=t._42,Bk=X._79o,vk=u._79o,rp=X._48O,pq=X._47O,df=E._48O,Eo=E._80o,wn=X._80o,uo=E.getSelectWidth,ah=E._47O,Xl=u._47O,$l=t.isEditable,Ph=["northwest","north","northeast","east","southeast","south","southwest","west"],ye=function(E,l,b,U,q,y,R,J,Z,z){var e=E.x,h=E.y,c=E.width,u=E.height,r={x:e+c/2,y:h+u/2};U=U||0,l=Ll(r,l.x-r.x,l.y-r.y,-U),R&&!J&&(l.x+=Z,l.y+=z);var k=.01;if("northwest"===b?(l.x+q>e+c-k&&(l.x=e+c-q-k),l.y+q>h+u-k&&(l.y=h+u-q-k),E=Q(l,{x:e+c,y:h+u})):"north"===b?(l.y+q>h+u-k&&(l.y=h+u-q-k),E=Q({x:e,y:l.y},{x:e+c,y:h+u})):"northeast"===b?(l.x<e+q+k&&(l.x=e+q+k),l.y+q>h+u-k&&(l.y=h+u-q-k),E=Q({x:e,y:l.y},{x:l.x,y:h+u})):"west"===b?(l.x+q>e+c-k&&(l.x=e+c-q-k),E=Q({x:l.x,y:h},{x:e+c,y:h+u})):"east"===b?(l.x<e+q+k&&(l.x=e+q+k),E=Q({x:e,y:h},{x:l.x,y:h+u})):"southwest"===b?(l.x+q>e+c-k&&(l.x=e+c-q-k),l.y<h+q+k&&(l.y=h+q+k),E=Q({x:l.x,y:h},{x:e+c,y:l.y})):"south"===b?(l.y<h+q+k&&(l.y=h+q+k),E=Q({x:e,y:h},{x:e+c,y:l.y})):"southeast"===b&&(l.x<e+q+k&&(l.x=e+q+k),l.y<h+q+k&&(l.y=h+q+k),E=Q({x:e,y:h},l)),"keepRatio"===y&&(!R&&J||R&&!J)&&("northeast"===b||"southeast"===b||"northwest"===b||"southwest"===b)){var N=E.width,o=E.height,S=N/c,g=o/u,L=I(S,g);E.width=c*L,E.height=u*L,"northeast"===b?E.y=h+(u-E.height):"northwest"===b?(E.y=h+(u-E.height),E.x=e+(c-E.width)):"southwest"===b&&(E.x=e+(c-E.width))}E.x-=r.x,E.y-=r.y;var O=Od(a,E,U,r);return E.x=O.x-E.width/2,E.y=O.y-E.height/2,E},As=function(p,I,N,l){var j=p.getRotation(),F=I,G=F.x,_=F.y,W=F.width,L=F.height,u={x:G+F.width/2,y:_+F.height/2};l=Ll(u,l.x-u.x,l.y-u.y,-j),"northwest"===N?F=Q(l,{x:G+W,y:_+L}):"north"===N?F=Q({x:G,y:l.y},{x:G+W,y:_+L}):"northeast"===N?F=Q({x:G,y:l.y},{x:l.x,y:_+L}):"west"===N?F=Q({x:l.x,y:_},{x:G+W,y:_+L}):"east"===N?F=Q({x:G,y:_},{x:l.x,y:_+L}):"southwest"===N?F=Q({x:l.x,y:_},{x:G+W,y:l.y}):"south"===N?F=Q({x:G,y:_},{x:G+W,y:l.y}):"southeast"===N&&(F=Q({x:G,y:_},l)),p.setRect(F),F.x-=u.x,F.y-=u.y;var v=Od(p,F,j,u);p.p(v.x,v.y)},Lq=function(b,y,z,p,M,r,$,f){var e=a;r?(e=Ll(a,M.x-y.x,M.y-y.y,-z),e.x-=$.x,e.y-=$.y):e=Ll(a,M.x-y.x,M.y-y.y,0);var G={x:y.x+e.x,y:y.y+e.y};f&&(G=f(G.x,G.y)),G.e=b.getPoints().get(p).e,b.setPoint(p,G);var w=b.getWidth(),W=b.getHeight(),i=b.p().x-w/2,x=b.p().y-W/2;i-=y.x,x-=y.y;var O=Od(b,{x:i,y:x,width:w,height:W},z,y);b.p(O.x,O.y)},Rh=function(C,t,$){var j,p;if(C instanceof c?(j=C.getPoints(),p=C.getSegments()):C instanceof K&&"points"===C.s("edge.type")&&(j=C.s("edge.points"),p=C.s("edge.segments"),j=Cm(t,j)),p&&p.size()||(p=Br(j)),C instanceof c&&C.isClosePath()&&p.indexOf(5)<0&&(p=new i(p._as),p.add(5)),p)for(var O=-1,B=0;B<p.size();B++){if(B===$)return O;var T=p.get(B);1===T?O+=1:2===T?O+=1:3===T?O+=2:4===T&&(O+=3)}},Gm=function(G,E,B){var $,b;if(G instanceof c?($=G.getPoints(),b=G.getSegments()):G instanceof K&&"points"===G.s("edge.type")&&($=G.s("edge.points"),b=G.s("edge.segments"),$=Cm(E,$)),b&&b.size()||(b=Br($)),b)for(var l=-1,P=0;P<b.size();P++){var u=b.get(P);if(1===u?l+=1:2===u?l+=1:3===u?l+=2:4===u&&(l+=3),l===B)return P}},Fl=function(o,Y){var u=[o[0]-Y[0],o[1]-Y[1],o[2]-Y[2]];return u},Ib=function(){var Q=new C(16);return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q},Re=function(J,w){var a=J[0],Z=J[1],T=J[2];return J[0]=w[0]*a+w[4]*Z+w[8]*T+w[12],J[1]=w[1]*a+w[5]*Z+w[9]*T+w[13],J[2]=w[2]*a+w[6]*Z+w[10]*T+w[14],J},Rc=function(o,y){if(y){var O=H(y),i=k(y),c=o[0],d=o[1],h=o[2],F=o[3],n=o[8],z=o[9],p=o[10],N=o[11];o[0]=c*i-n*O,o[1]=d*i-z*O,o[2]=h*i-p*O,o[3]=F*i-N*O,o[8]=c*O+n*i,o[9]=d*O+z*i,o[10]=h*O+p*i,o[11]=F*O+N*i}},zh=function(O,M){for(var W=O.s("grid.row.count"),U=O.s("grid.column.count"),Q=0;W>Q;Q++)for(var u=0;U>u;u++){var v=O.getCellRect(Q,u);if(z(v,M))return{rowIndex:Q,columnIndex:u,rect:v,grid:O}}return null},Ck=function(N,H,K,D,f,Z){var C={},u=K-N,A=D-H,J=_.sqrt(u*u+A*A),B=u/J,R=A/J,s=(-N+f)*B+(-H+Z)*R;return 0>=s?(C.x=N,C.y=H):s>=J?(C.x=K,C.y=D):(C.x=N+s*B,C.y=H+s*R),u=f-C.x,A=Z-C.y,C.z=_.sqrt(u*u+A*A),C},hf=function(Z,I){var r,s,A,n,q,$,G,J,X=Z.getPoints(),M=Z.getSegments(),U=Z.p(),V=Z.getRotation();if(!M||!(M.indexOf(3)>0||M.indexOf(4)>0)){for(J=0;J<=X.size()-1;J++)if(J===X.size()-1?(q=X.get(0),n=X.get(J)):(n=X.get(J),q=X.get(J+1)),n=Ll(U,n.x-U.x,n.y-U.y,V),q=Ll(U,q.x-U.x,q.y-U.y,V),$=Ck(n.x,n.y,q.x,q.y,I.x,I.y),G=$.z,G<(Z.s("shape.border.width")||10)){s=n,A=q,r=J;break}if(r!=a){var E=Ck(s.x,s.y,A.x,A.y,I.x,I.y),f=N(s,E);return{attachIndex:r,attachOffset:f}}}},Te=function(b){for(var R=b._data,K=R.p(),J=R.getRotation(),U=R.getPoints(),T=a,h=[],m=0;m<U.size();m++)T=U.get(m),h.push(Ll(K,T.x-K.x,T.y-K.y,J));b._55O.$15l=h};v.setImage("xeditinteractor_parentIcon",l),v.setImage("xeditinteractor_hostIcon",e),v.setImage("xeditinteractor_edgeIcon",M),v.setImage("xeditinteractor_removeIcon",$f),v.setImage("xeditinteractor_sourceIcon",$e),v.setImage("xeditinteractor_targetIcon",hc),v.setImage("xeditinteractor_elevationIcon",pp),v.setImage("xeditinteractor_tallIcon",ee),t._editPointSize=J?24:9,t._edgeHelpers=["parent","remove","source","target"],t._leftTopHelpers=["parent"],t._rightTopHelpers=["host"],t._leftBottomHelpers=["edge"],t._rightBottomHelpers=["remove"],Ph=Ph.concat(Ph).concat(Ph),u._79o=function(){var t=this,C=t.gv,G=C.getZoom(),v=C._editInteractor,l=vk.call(t);if(!l)return null;var n=Yd(t,!0),U=n[0],H=n[1],X={x:l.x,y:l.y,width:l.width,height:l.height},$=Q(U,H);if(v instanceof O.XEditInteractor){X=T(X,$);var k=t._55O,g=C.getEditPointSize()/G+2,I=0;k&&k._43O&&(I+=g/2,W(X,I))}return X},u._47O=function(y){var U=this,C=U.gv,K=C._editInteractor;K instanceof O.XEditInteractor||Xl.call(U,y)},u.rectIntersects=function(X){var b=this,T=b._data,w=b.gv,n=w.getZoom(),i=b._55O,e=w._editInteractor;if(e instanceof O.XEditInteractor&&w.isEditable(T)&&i&&i._43O&&"points"===T.s("edge.type")){var s=T.s("edge.points"),q=T.s("edge.segments");s=Cm(b,s),q&&q.size()||(q=Br(s)),s=s._as;var K=!1,z=J?5:1,h=X.x+z,Q=X.y+z,u={x:h,y:Q};if(e._edge===T&&e._hoverSegmentIndex>=0){var f=w._editInteractor._hoverSegmentIndex,$=q.get(f),j=Rh(T,b,f),L=a;if(j!=a&&j>=0){var p=s[j],m=w.getSegmentHoverWidth()/n;if(2===$||1===$){var E=s[j+1];L=ef(new Bh(p.x,p.y),new Bh(E.x,E.y),new Bh(u.x-m,u.y-m),new Bh(u.x+2*m,u.y+2*m)),L.$62l===S&&(K=!0)}else if(3===$){var I=s[j+1],E=s[j+2];L=sg(new Bh(p.x,p.y),new Bh(I.x,I.y),new Bh(E.x,E.y),new Bh(u.x-m,u.y-m),new Bh(u.x+2*m,u.y+2*m)),L.$62l===S&&(K=!0)}else if(4===$){var _=s[j+1],R=s[j+2];E=s[j+3],L=he(new Bh(p.x,p.y),new Bh(_.x,_.y),new Bh(R.x,R.y),new Bh(E.x,E.y),new Bh(u.x-m,u.y-m),new Bh(u.x+2*m,u.y+2*m)),L.$62l===S&&(K=!0)}}}if(K)return!0}return a},X._47O=function(w){var S=this,s=S.gv,D=s._editInteractor;D instanceof O.XEditInteractor||pq.call(S,w)},X.rectIntersects=function(f){var Y=this,r=Y._data,W=Y.gv,q=W.getZoom(),Q=Y._55O,I=W._editInteractor;if(I instanceof O.XEditInteractor&&W.isEditable(r)&&Q&&Q._43O){var v=Q.$15l,B=!1,Z=J?5:1,X=f.x+Z,M=f.y+Z,R={x:X,y:M};if(v&&v.length===r.getPoints().size()||(Te(Y),v=Q.$15l),I._shape===r&&I._hoverSegmentIndex>=0){var o=r.getSegments();o&&o.size()||(o=Br(v));var m=W._editInteractor._hoverSegmentIndex,j=o.get(m),w=Rh(r,Y,m),C=a;if(w!=a&&w>=0){var F=v[w],P=W.getSegmentHoverWidth()/q;if(2===j||1===j){var K=v[w+1];C=ef(new Bh(F.x,F.y),new Bh(K.x,K.y),new Bh(R.x-P,R.y-P),new Bh(R.x+2*P,R.y+2*P)),C.$62l===S&&(B=!0)}else if(3===j){var d=v[w+1],K=v[w+2];C=sg(new Bh(F.x,F.y),new Bh(d.x,d.y),new Bh(K.x,K.y),new Bh(R.x-P,R.y-P),new Bh(R.x+2*P,R.y+2*P)),C.$62l===S&&(B=!0)}else if(4===j){var k=v[w+1],t=v[w+2];K=v[w+3],C=he(new Bh(F.x,F.y),new Bh(k.x,k.y),new Bh(t.x,t.y),new Bh(K.x,K.y),new Bh(R.x-P,R.y-P),new Bh(R.x+2*P,R.y+2*P)),C.$62l===S&&(B=!0)}}}if(B)return!0}return a},X._48O=function(){var o=this,L=o.gv,y=L._editInteractor;y instanceof O.XEditInteractor?(E._48O.call(o),o._55O._43O&&Te(o)):rp.call(o)},X._79o=function(){var L=this,E=L.gv,r=E.getZoom(),P=E._editInteractor,G=Bk.call(L);if(G){var x={x:G.x,y:G.y,width:G.width,height:G.height};if(P instanceof O.XEditInteractor){var w=L._55O,X=E.getEditPointSize()/r+2,C=0;w&&w._43O&&(C+=X/2,W(x,C))}return x}},E._47O=function(P){var F=this,b=F.gv,g=b._editInteractor;if(g instanceof O.XEditInteractor);else{var W=F._55O;W&&W._98o&&ah.call(F,P)}},E.getSelectWidth=function(){var w=this,n=w.gv,f=n._editInteractor,u=w._data;return n.isEditable(u)&&f instanceof O.XEditInteractor?0:uo.call(w)},E._80o=function(g){var W=this,j=W.gv._editInteractor;if(Eo.call(W,g),j&&j._debug){g.save(),g.beginPath(),g.lineWidth=1,g.strokeStyle="green";var E=W._79o();E&&(g.rect(E.x,E.y,E.width,E.height),g.stroke()),g.restore()}},X._80o=function(Y){var c=this,s=c.gv._editInteractor;if(wn.call(c,Y),s&&s._debug){Y.save(),Y.beginPath(),Y.lineWidth=1,Y.strokeStyle="green";var h=c._79o();Y.rect(h.x,h.y,h.width,h.height),Y.stroke(),Y.restore()}},E._48O=function(){var Z=this,T=Z.gv,D=Z._data,$=T._editInteractor,k=Z._55O,Q=D.p(),H=D.getRotation();if($ instanceof O.XEditInteractor){if(k._42O){var l=In(Q,D.getWidth(),D.getHeight(),H),q=l[0],f=l[1],r=l[2],C=l[3],c=l[4],x=l[5],o=l[6],u=l[7];k.$45l=[q,c,f,x,C,o,r,u]}}else df.call(Z)},t.getResizeMode=function(){return this.$25l||"normal"},t.setResizeMode=function(b){var e=this.$25l;this.$25l=b,this.fp("resizeMode",e,b)},t.getSnapAngle=function(){return this.$26l||Math.PI/36},t.setSnapAngle=function(p){var L=this.$26l;this.$26l=p,this.fp("snapAngle",L,p)},t.getSnapSpacing=function(){return this.$27l},t.setSnapSpacing=function(T){var b=this.$27l;this.$27l=T,this.fp("snapSpacing",b,T)},t.getPointSnapSpacing=function(){return this._pointSnapSpacing},t.setPointSnapSpacing=function(z){var I=this._pointSnapSpacing;this._pointSnapSpacing=z,this.fp("pointSnapSpacing",I,z)},t.setHelperEditableFunc=function(y){var l=this._helperEditableFunc;this._helperEditableFunc=y,this.fp("helperEditableFunc",l,y)},t.getHelperEditableFunc=function(){return this._helperEditableFunc},t.setLeftTopHelpers=function(g){var V=this._leftTopHelpers;this._leftTopHelpers=g,this.fp("leftTopHelpers",V,g)},t.getLeftTopHelpers=function(){return this._leftTopHelpers},t.setLeftTopHelpersAlign=function(W){var i=this._leftTopHelpersAlign;this._leftTopHelpersAlign=W,this.fp("leftTopHelpersAlign",i,W)},t.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},t.setRightTopHelpers=function(y){var s=this._rightTopHelpers;this._rightTopHelpers=y,this.fp("rightTopHelpers",s,y)},t.getRightTopHelpers=function(){return this._rightTopHelpers},t.setRightTopHelpersAlign=function(x){var O=this._rightTopHelpersAlign;this._rightTopHelpersAlign=x,this.fp("rightTopHelpersAlign",O,x)},t.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},t.setLeftBottomHelpers=function($){var G=this._leftBottomHelpers;this._leftBottomHelpers=$,this.fp("leftBottomHelpers",G,$)},t.getLeftBottomHelpers=function(){return this._leftBottomHelpers},t.setLeftBottomHelpersAlign=function(G){var _=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=G,this.fp("leftBottomHelpersAlign",_,G)},t.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},t.setRightBottomHelpers=function(f){var L=this._rightBottomHelpers;this._rightBottomHelpers=f,this.fp("rightBottomHelpers",L,f)},t.getRightBottomHelpers=function(){return this._rightBottomHelpers},t.setRightBottomHelpersAlign=function(d){var V=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=d,this.fp("rightBottomHelpersAlign",V,d)},t.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},t.setEdgeHelpers=function(e){var A=this._edgeHelpers;this._edgeHelpers=e,this.fp("edgeHelpers",A,e)},t.getEdgeHelpers=function(){return this._edgeHelpers},t.isHelperEditable=function(V,g){return V instanceof K&&("host"===g||"edge"===g||"elevation"===g||"tall"===g)?!1:V instanceof w&&("source"===g||"target"===g)?!1:"pointElevation"===g?this._helperEditableFunc?this._helperEditableFunc(V,g):!1:this._helperEditableFunc?this._helperEditableFunc(V,g):!0},t.getEditHelperSize=function(){return this._editHelperSize||(J?28:16)},t.setEditHelperSize=function(R){var I=this._editHelperSize;this._editHelperSize=R,this.fp("editHelperSize",I,R)},t.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},t.setEditRectBorderColor=function(X){var _=this.$28l;this.$28l=X,this.fp("editRectBorderColor",_,X)},t.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},t.setNodeBorderColor=function(N){var p=this.$29l;this.$29l=N,this.fp("nodeBorderColor",p,N)},t.getEditRectBorderStyle=function(){return this.$30l||"dashed"},t.setEditRectBorderStyle=function(t){var e=this.$30l;this.$30l=t,this.fp("editRectBorderStyle",e,t)},t.getControlPointBackground=function(){return this.$31l||"#ff0"},t.setControlPointBackground=function(A){var q=this.$31l;this.$31l=A,this.fp("controlPointBackground",q,A)},t.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},t.setControlPointBorderColor=function(A){var m=this.$32l;this.$32l=A,this.fp("controlPointBorderColor",m,A)},t.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},t.setJoinPointBackground=function(h){var O=this.$33l;this.$33l=h,this.fp("joinPointBackground",O,h)},t.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},t.setJoinPointBorderColor=function(J){var i=this.$34l;this.$34l=J,this.fp("joinPointBorderColor",i,J)},t.getDirectionLineColor=function(){return this.$35l||"#888"},t.setDirectionLineColor=function(z){var v=this.$35l;this.$35l=z,this.fp("directionLineColor",v,z)},t.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},t.setSegmentHoverColor=function(H){var _=this.$36l;this.$36l=H,this.fp("segmentHoverColor",_,H)},t.getSegmentHoverWidth=function(){return this.$22l||(J?16:8)},t.setSegmentHoverWidth=function(Z){var z=this.$22l;this.$22l=Z,this.fp("segmentHoverWidth",z,Z)},t.getSnapPointBorderColor=function(){return this.$38l||"#f00"},t.setSnapPointBorderColor=function(i){var S=this.$38l;this.$38l=i,this.fp("snapPointBorderColor",S,i)},t.getEditRectPadding=function(){return this.$39l!=a?this.$39l:6},t.setEditRectPadding=function(O){var f=this.$39l;this.$39l=O,this.fp("editRectPading",f,O)},t.isRectEditable=function(n){var V=this,r=V._editInteractor;return r instanceof O.XEditInteractor?V._rectEditableFunc?V._rectEditableFunc(n):!0:Pr.call(V,n)},t.isPointEditable=function(U){var $=this,R=$._editInteractor;return R instanceof O.XEditInteractor?$._pointEditableFunc?$._pointEditableFunc(U):!0:sq.call($,U)},t.validateImpl=function(){var N=this,t=N.$14l,G=N._editInteractor;if(t){var R=N.getWidth(),y=N.getHeight();(R!==t.clientWidth||y!==t.clientHeight)&&(G&&(G._68I=1),n.setCanvas(t,R,y),N._32I=1)}no.call(this)},t.isEditable=function(q){var Y=$l.call(this,q),J=this._editInteractor;if(J instanceof O.XEditInteractor&&q instanceof K){if(!q.s("2d.editable"))return!1;var u=this.getEditableFunc();Y=u?u(q):!0}return Y},t._42=function(x,I){var R=this,L=R._editInteractor;Sq.call(R,x,I),L instanceof O.XEditInteractor&&L._68I&&L._42()},t.isSnapPoint=function(){return!0};var Wh=function(Y){arguments.length>0&&this.$58l(Y)},fe=Wh.prototype;fe.$58l=function(k){this.$62l=k,this.points=new Array},fe.$56l=function(t){this.points.push(t)},fe.$57l=function(B){this.points=this.points.concat(B)};var Bh=function(C,n){arguments.length>0&&this.$58l(C,n)},vo=Bh.prototype;vo.$58l=function(i,E){this.x=i,this.y=E},vo.add=function(P){return new Bh(this.x+P.x,this.y+P.y)},vo.addEquals=function(X){return this.x+=X.x,this.y+=X.y,this},vo.$55l=function(R){return new Bh(this.x*R,this.y*R)},vo.eq=function(c){return this.x==c.x&&this.y==c.y},vo.lt=function(J){return this.x<J.x&&this.y<J.y},vo.lte=function(l){return this.x<=l.x&&this.y<=l.y},vo.gt=function(N){return this.x>N.x&&this.y>N.y},vo.gte=function(_){return this.x>=_.x&&this.y>=_.y},vo.lerp=function(a,d){return new Bh(this.x+(a.x-this.x)*d,this.y+(a.y-this.y)*d)},vo.distanceFrom=function(C){var X=this.x-C.x,s=this.y-C.y;return F(X*X+s*s)},vo.min=function(Q){return new Bh(I(this.x,Q.x),I(this.y,Q.y))},vo.max=function(v){return new Bh(q(this.x,v.x),q(this.y,v.y))},vo.toString=function(){return this.x+","+this.y};var qr=function(){this.$58l(arguments)},Uf=qr.prototype;qr.TO=1e-6,qr.AC=6,Uf.$58l=function(q){this.co=new Array;for(var Q=q.length-1;Q>=0;Q--)this.co.push(q[Q])},Uf.$55l=function(x){for(var H=new qr,U=0;U<=this.$50l()+x.$50l();U++)H.co.push(0);for(var U=0;U<=this.$50l();U++)for(var o=0;o<=x.$50l();o++)H.co[U+o]+=this.co[U]*x.co[o];return H},Uf.$59l=function(){for(var f=this.$50l();f>=0&&b(this.co[f])<=qr.TO;f--)this.co.pop()},Uf.$50l=function(){return this.co.length-1},Uf.$51l=function(){var q;switch(this.$59l(),this.$50l()){case 0:q=new Array;break;case 1:q=this.$52l();break;case 2:q=this.$53l();break;case 3:q=this.$54l();break;case 4:q=this.$63l();break;default:q=new Array}return q},Uf.$52l=function(){var J=new Array,T=this.co[1];return 0!=T&&J.push(-this.co[0]/T),J},Uf.$53l=function(){var G=new Array;if(2==this.$50l()){var f=this.co[2],E=this.co[1]/f,C=this.co[0]/f,d=E*E-4*C;if(d>0){var p=F(d);G.push(.5*(-E+p)),G.push(.5*(-E-p))}else 0==d&&G.push(.5*-E)}return G},Uf.$63l=function(){var K=new Array;if(4==this.$50l()){var G=this.co[4],m=this.co[3]/G,r=this.co[2]/G,i=this.co[1]/G,X=this.co[0]/G,o=new qr(1,-r,m*i-4*X,-m*m*X+4*r*X-i*i).$54l(),P=o[0],I=m*m/4-r+P;if(b(I)<=qr.TO&&(I=0),I>0){var e=F(I),l=3*m*m/4-e*e-2*r,g=(4*m*r-8*i-m*m*m)/(4*e),S=l+g,q=l-g;if(b(S)<=qr.TO&&(S=0),b(q)<=qr.TO&&(q=0),S>=0){var s=F(S);K.push(-m/4+(e+s)/2),K.push(-m/4+(e-s)/2)}if(q>=0){var s=F(q);K.push(-m/4+(s-e)/2),K.push(-m/4-(s+e)/2)}}else if(0>I);else{var g=P*P-4*X;if(g>=-qr.TO){if(0>g&&(g=0),g=2*F(g),l=3*m*m/4-2*r,l+g>=qr.TO){var C=F(l+g);K.push(-m/4+C/2),K.push(-m/4-C/2)}if(l-g>=qr.TO){var C=F(l-g);K.push(-m/4+C/2),K.push(-m/4-C/2)}}}}return K},Uf.$54l=function(){var V=new Array;if(3==this.$50l()){var G=this.co[3],u=this.co[2]/G,Y=this.co[1]/G,O=this.co[0]/G,e=(3*Y-u*u)/3,X=(2*u*u*u-9*Y*u+27*O)/27,m=u/3,R=X*X/4+e*e*e/27,l=X/2;if(b(R)<=qr.TO&&(R=0),R>0){var o,c,z=F(R);o=-l+z,c=o>=0?j(o,1/3):-j(-o,1/3),o=-l-z,o>=0?c+=j(o,1/3):c-=j(-o,1/3),V.push(c-m)}else if(0>R){var d=F(-e/3),s=y(F(-R),-l)/3,a=k(s),q=H(s),v=F(3);V.push(2*d*a-m),V.push(-d*(a+v*q)-m),V.push(-d*(a-v*q)-m)}else{var o;o=l>=0?-j(l,1/3):j(-l,1/3),V.push(2*o-m),V.push(-o-m)}}return V};var ik=function(r,w){arguments.length>0&&this.$58l(r,w)},vl=ik.prototype;vl.$58l=function(G,h){this.x=G,this.y=h},vl.length=function(){return F(this.x*this.x+this.y*this.y)},vl.$60l=function(U){return this.x*U.x+this.y*U.y};var Tq=function(l,w,u,K){var T,o=(K.x-u.x)*(l.y-u.y)-(K.y-u.y)*(l.x-u.x),F=(w.x-l.x)*(l.y-u.y)-(w.y-l.y)*(l.x-u.x),V=(K.y-u.y)*(w.x-l.x)-(K.x-u.x)*(w.y-l.y);if(0!=V){var H=o/V,s=F/V;H>=0&&1>=H&&s>=0&&1>=s?(T=new Wh(S),T.points.push(new Bh(l.x+H*(w.x-l.x),l.y+H*(w.y-l.y)))):T=new Wh(x)}else T=0==o||0==F?new Wh("C"):new Wh("P");return T},jh=function(r,P,y,Z,v){var F,n,O,L,s,f,j,o=Z.min(v),I=Z.max(v),h=new Wh(x);F=P.$55l(-2),O=r.add(F.add(y)),F=r.$55l(-2),n=P.$55l(2),L=F.add(n),s=new Bh(r.x,r.y),j=new ik(Z.y-v.y,v.x-Z.x),f=Z.x*v.y-v.x*Z.y;for(var Q=new qr(j.$60l(O),j.$60l(L),j.$60l(s)+f).$51l(),H=0;H<Q.length;H++){var C=Q[H];if(C>=0&&1>=C){var Y=r.lerp(P,C),R=P.lerp(y,C),u=Y.lerp(R,C);Z.x==v.x?o.y<=u.y&&u.y<=I.y&&(h.$62l=S,h.$56l(u)):Z.y==v.y?o.x<=u.x&&u.x<=I.x&&(h.$62l=S,h.$56l(u)):u.gte(o)&&u.lte(I)&&(h.$62l=S,h.$56l(u))}}return h},sg=function(O,X,m,B,A){var v=B.min(A),y=B.max(A),r=new Bh(y.x,v.y),s=new Bh(v.x,y.y),e=jh(O,X,m,v,r),p=jh(O,X,m,r,y),o=jh(O,X,m,y,s),b=jh(O,X,m,s,v),H=new Wh(x);return H.$57l(e.points),H.$57l(p.points),H.$57l(o.points),H.$57l(b.points),H.points.length>0&&(H.$62l=S),H},Ql=function(y,V,d,M,b,e){var j,$,C,s,N,h,X,Y,P,o,n=b.min(e),G=b.max(e),k=new Wh(x);j=y.$55l(-1),$=V.$55l(3),C=d.$55l(-3),s=j.add($.add(C.add(M))),N=new ik(s.x,s.y),j=y.$55l(3),$=V.$55l(-6),C=d.$55l(3),s=j.add($.add(C)),h=new ik(s.x,s.y),j=y.$55l(-3),$=V.$55l(3),C=j.add($),X=new ik(C.x,C.y),Y=new ik(y.x,y.y),o=new ik(b.y-e.y,e.x-b.x),P=b.x*e.y-e.x*b.y;for(var g=new qr(o.$60l(N),o.$60l(h),o.$60l(X),o.$60l(Y)+P).$51l(),v=0;v<g.length;v++){var J=g[v];if(J>=0&&1>=J){var R=y.lerp(V,J),i=V.lerp(d,J),r=d.lerp(M,J),T=R.lerp(i,J),t=i.lerp(r,J),L=T.lerp(t,J);b.x==e.x?n.y<=L.y&&L.y<=G.y&&(k.$62l=S,k.$56l(L)):b.y==e.y?n.x<=L.x&&L.x<=G.x&&(k.$62l=S,k.$56l(L)):L.gte(n)&&L.lte(G)&&(k.$62l=S,k.$56l(L))}}return k},he=function(O,G,w,L,V,l){var t=V.min(l),u=V.max(l),z=new Bh(u.x,t.y),N=new Bh(t.x,u.y),o=Ql(O,G,w,L,t,z),v=Ql(O,G,w,L,z,u),M=Ql(O,G,w,L,u,N),r=Ql(O,G,w,L,N,t),e=new Wh(x);return e.$57l(o.points),e.$57l(v.points),e.$57l(M.points),e.$57l(r.points),e.points.length>0&&(e.$62l=S),e},ef=function(t,f,K,N){var y=K.min(N),Q=K.max(N),o=new Bh(Q.x,y.y),g=new Bh(y.x,Q.y),d=Tq(y,o,t,f),H=Tq(o,Q,t,f),h=Tq(Q,g,t,f),k=Tq(g,y,t,f),V=new Wh(x);return V.$57l(d.points),V.$57l(H.points),V.$57l(h.points),V.$57l(k.points),V.points.length>0&&(V.$62l=S),V},ib=O.XEditInteractor=function(z){var A=this,M=A._view=document.createElement("canvas");M.className="editCanvas",M.style.position="absolute",ib.superClass.constructor.call(A,z)};v.def(ib,O.Interactor,{ms_edit:1,setUp:function(){var t=this,k=t.gv,y=k.getView(),n=t._view;ib.superClass.setUp.call(t),k.setEditInteractor(t),k.$14l=n,k._79O?y.insertBefore(n,k._79O):y.appendChild(n);var X=t.$49l=t.$11l.bind(t);k.dm().md(X),k.sm().ms(X),k.mp(X)},tearDown:function(){var g=this,q=g.gv,t=q.getView(),G=g.$49l;ib.superClass.tearDown.call(g),q.setEditInteractor(a),q.$14l=a,t.removeChild(g._view),q.dm().umd(G),q.sm().ums(G),q.ump(G)},clear:function(){var A=this,c=A.gv;delete A._hoverSegmentIndex,delete A._edge,delete A._shape,delete c._editing,delete A.$10l,delete A.$13l,delete A.$9l,delete A._removePointIndex,delete A._lp,A.$12l="",delete A.$40l,delete A.$67l,delete A.$72l,delete A.$73l,delete A.$75l,delete A.$1l,delete A.$3l,delete A.$2l,delete A.$92l,delete A.$93l,delete A.$94l,A.clearDragging()},handle_keydown:function(r){this.$48l!==r.shiftKey&&(this.$48l=r.shiftKey,this.handle_mousemove(r,D,!0))},handle_keyup:function(u){this.$48l!==u.shiftKey&&(this.$48l=u.shiftKey,this.handle_mousemove(u,D,!0))},handle_touchstart:function(L){this.handle_mousemove(L),this.handle_mousedown(L)},handle_mousedown:function(y){G(y);var E=this,j=E.$13l,L=E.gv,g=L.dm(),u=L.sm(),B=L.getZoom(),x=L.lp(y),q=v.isDoubleClick(y),Q=v.isLeftButton(y),$=E.$7l,H=E._shape,r=E._hoverSegmentIndex,F=E._edge,t=E.$87l,f=E.$88l,p=function(){E._68I||t===E.$87l&&f===E.$88l||E.$43l()};if(7!==E.$67l&&(delete E.$87l,delete E.$88l),Q&&(H||F)&&r>=0&&q&&(H&&u.contains(H)||F&&u.contains(F))){var O=Vr.call(E,H||F,r,x);return E.addShapePoint(H||F,r,O),P(function(){E.handle_mousemove(y)},40),void 0}if(Q&&(H||F)&&E._removePointIndex>=0&&q)return E.removeShapePoint(),E.$5l=1,P(function(){E.handle_mousemove(y)},40),void 0;if(!Q||!L._editing)return p(),void 0;if(H&&j>=0){var I=H.getPoints().get(j),V=H.p(),C=Ll(V,I.x-V.x,I.y-V.y,-$+H.getRotation());D=Ll(V,x.x-V.x,x.y-V.y,-$),E.$24l={x:D.x-C.x,y:D.y-C.y},E.startDragging(y),g.beginTransaction(),E.fi({kind:"beginEditPoint",event:y,data:H,index:j}),E.$88l=j,E.$87l=H}else if(E.$10l){var U=L.sm().getSelection(),T=E.$6l,l=E.$1l={},K=E.$3l={},N=E.$16l[m[E.$10l]],W={x:T.x,y:T.y},i={x:T.x+T.width/2,y:T.y+T.height/2};E.$24l={x:x.x-N.x/B,y:x.y-N.y/B},E.$2l=s(E.$8l),E.$4l=s(T),U.each(function(a){if(a instanceof w){var I=a.p(),c=a.getWidth(),x=a.getHeight(),o=Ll(i,I.x-i.x,I.y-i.y,-$);l[a.getId()]={x:I.x-c/2,y:I.y-x/2,width:c,height:x},K[a.getId()]={x:(o.x-W.x)/T.width,y:(o.y-W.y)/T.height}}}),E.startDragging(y),g.beginTransaction(),E.fi({kind:"beginEditRect",event:y,direction:E.$10l})}else if(F&&j>=0){var M=Cm(L.getDataUI(F),F.s("edge.points")),I=M.get(j);E.$24l={x:x.x-I.x,y:x.y-I.y},E.startDragging(y),g.beginTransaction(),E.fi({kind:"beginEditPoint",event:y,data:F,index:j}),E.$88l=j,E.$87l=F}else if(E.$40l){var T=E.$6l,i={x:T.x+T.width/2,y:T.y+T.height/2},R=s(E.$23l);R.x/=B,R.y/=B;var d=Ll(i,R.x-i.x,R.y-i.y,-$),D=Ll(i,x.x-i.x,x.y-i.y,-$);E.$24l={x:D.x-d.x,y:D.y-d.y},E.startDragging(y),g.beginTransaction(),E.fi({kind:"beginEditRotation",event:y,data:E._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(E.$67l)>=0){var A=E.$67l;(7===A||8===A||9===A)&&g.beginTransaction(),E.startDragging(y)}else if(E.$71l&&q&&E.$79l(E.$71l,x)){var n=u.toSelection();g.beginTransaction(),n.each(function(N){g.remove(N)}),g.endTransaction()}p()},$11l:function(){var x=this,e=x.gv;e._editing&&(x.$13l==a||x._shape==a&&x._edge==a)&&(x.$73l==a||1!==x.$67l&&5!==x.$67l&&6!==x.$67l)||(x.$5l=1),x._68I=1},$46l:function(Z){var W=this,m=W.gv,R=m.lp(Z),u=[];return Yl(m,function(N){var L=m.getDataUI(N);if(L){var M=L._79o();z(M,R)&&u.push(N)}}),u},$47l:function(z){var _=this,t=_.$13l,i=_.gv.dm();_.$10l?(_.fi({kind:"endEditRect",event:z,direction:_.$10l}),i.endTransaction()):_._shape&&t>=0?(_.fi({kind:"endEditPoint",event:z,data:_._shape,index:t}),i.endTransaction()):_._edge&&t>=0?(_.fi({kind:"endEditPoint",event:z,data:_._edge,index:t}),i.endTransaction()):_.$23l&&_.$40l&&(_.fi({kind:"endEditRotation",event:z}),i.endTransaction())},handleWindowTouchEnd:function(S){this.handleWindowMouseUp(S)},handleWindowMouseUp:function(B){var T=this,r=T.gv,q=r.dm(),P=T._shape,Z=T._edge,G=T.$13l,k=T.$40l,O=T.$9l,n=T.$10l,m=T.$67l;if((P||Z)&&G>=0&&O>=0){var u,E;if(P){var S=P.p(),I=P.getRotation();u=P.getPoints(),E=u.get(O),Lq(P,S,I,G,E,!1)}else if(u=Cm(r.getDataUI(Z),Z.s("edge.points"),!0),E=u.get(O),0===G){var s=u.get(0);Z.s("edge.source.offset.x",E.x-s.x),Z.s("edge.source.offset.y",E.y-s.y)}else if(G===u.size()-1){var l=u.get(u.size()-1);Z.s("edge.target.offset.x",E.x-l.x),Z.s("edge.target.offset.y",E.y-l.y)}else"points"===Z.s("edge.type")&&(u.set(G,E),Z.s("edge.points",Om(u)))}T.$47l(B);var A=T.$73l;1===m?(q.beginTransaction(),A?r.sm().each(function(V){if(V.setHost&&r.isHelperEditable(V,"host")){V.setHost(A);
var U=T.$75l,L=T.$74l;U&&(V.s("attach.row.index",U.rowIndex),V.s("attach.column.index",U.columnIndex)),L&&(V.s("attach.index",L.attachIndex),V.s("attach.offset",L.attachOffset),V.s("attach.offset.relative",!1),V.s("attach.offset.opposite",!1))}}):r.sm().each(function(z){z.setHost&&r.isHelperEditable(z,"host")&&(z.setHost(a),z.s("attach.row.index",D),z.s("attach.column.index",D),z.s("attach.index",D),z.s("attach.offset",D),z.s("attach.offset.relative",!1),z.s("attach.offset.opposite",!1))}),q.endTransaction()):2===m?(q.beginTransaction(),A?r.sm().each(function(M){M.setParent&&r.isHelperEditable(M,"parent")&&M.setParent(A)}):r.sm().each(function(L){L.setParent&&r.isHelperEditable(L,"parent")&&L.setParent(a)}),q.endTransaction()):3===m?A&&(q.beginTransaction(),r.sm().each(function(W){if(r.isHelperEditable(W,"edge")&&W instanceof w&&A instanceof w){var D=new o.Edge;q.add(D),D.setSource(W),D.setTarget(A),T.onEdgeCreated&&T.onEdgeCreated(B,D)}}),q.endTransaction()):5===m||6===m?A&&(q.beginTransaction(),r.sm().each(function(I){I instanceof K&&A instanceof w&&(5===m&&r.isHelperEditable(I,"source")?I.setSource(A):6===m&&r.isHelperEditable(I,"source")&&I.setTarget(A))}),q.endTransaction()):(7===m||8===m||9===m)&&q.endTransaction(),(n||k)&&T.$43l(!0),J?(T.clear(),delete T.$64l,T._68I||T.$43l()):(T.handle_mousemove(B,!0),m&&!T._68I&&T.$43l())},handleWindowTouchMove:function(P){this.handleWindowMouseMove(P)},handleWindowMouseMove:function(I){this._78I(I)},handle_mousemove:function(n,l,M){if(!this._pause){if(!M){var L=J?vg(n):n;this.$61l={clientX:L.clientX,clientY:L.clientY}}if(l===!0||!p()){var X=this,y=X.gv,E=!1,Y=a;X.clear(),y.sm().size()>0&&(Y=y.lp(M?X.$61l:n),E=X._79I(n,Y)),E&&(y._editing=1),X.$12l!==X.$65l&&(X.$65l=X.$12l,X.setCursor(X.$12l)),X.$40l!==X.$64l&&(X.$64l=X.$40l,X._68I||X.$43l()),X._hoverSegmentIndex!==X.$66l&&(X.$66l=X._hoverSegmentIndex,X._68I||X.$43l())}}},_78I:function(E){this.autoScroll(E);var z=this,p=z.gv,Z=p.lp(E),J=p.getZoom(),g=z.$13l;if((z._shape||z._edge)&&g>=0){var j,u,O,o=z._shape,W=z._edge,I=z.$24l,V=p.getPointSnapSpacing(),q=function(m,o){return V==a||isNaN(V)?{x:m,y:o}:{x:r(m/V)*V,y:r(o/V)*V}};if(o){j=o.getPoints();var C=o.p(),i=o.getRotation(),t=0;u=Ll(C,Z.x-C.x,Z.y-C.y,-i),Lq(o,C,i,g,Z,!0,I,q),z.fi({kind:"betweenEditPoint",event:E,data:o,index:g})}else if(W){j=Cm(p.getDataUI(W),W.s("edge.points"),!0),Z.x-=I.x,Z.y-=I.y,u=Z;var $,H,D=W.s("edge.offset"),A=j.size(),m=A>2;if(0===g){var x=j.get(0);D&&(x=Nq(x,j.get(1),-D,m),Z=Nq(Z,j.get(1),-D,m)),$=Z.x-x.x,H=Z.y-x.y,O=q($,H),W.s("edge.source.offset.x",O.x),W.s("edge.source.offset.y",O.y)}else if(g===A-1){var h=j.get(A-1);D&&(h=Nq(h,j.get(A-2),-D,m),Z=Nq(Z,j.get(A-2),-D,m)),$=Z.x-h.x,H=Z.y-h.y,O=q($,H),W.s("edge.target.offset.x",O.x),W.s("edge.target.offset.y",O.y)}else"points"===W.s("edge.type")&&(O=q(Z.x,Z.y),O.e=j.get(g).e,j.set(g,O),W.s("edge.points",Om(j)));z.fi({kind:"betweenEditPoint",event:E,data:W,index:g})}if(delete z.$9l,p.isSnapPoint(o)||p.isSnapPoint(W))for(t=0;t<j.size();t++)if(t!==g){var S=j.get(t);if(N(S,u)<p.getEditPointSize()/J){z.$9l=t;break}}}else if(z.$10l){var I=z.$24l;Z.x-=I.x,Z.y-=I.y;var n=p.sm().getSelection(),Q=z.$1l,k=z.$7l,U=z.$10l,T=z.$4l,M=z.$2l,s=p.getEditRectPadding()/J,X=2*s,R=p.getSnapSpacing(),f=R!=a&&!isNaN(R),G=ye(M,Z,U,k,2*s,p.getResizeMode(),f,!0),l=z.$6l;if(f){var e=G.width-X,_=G.height-X,Y=r(e/R)*R,Vh=r(_/R)*R,Ok=Y-e,Nl=Vh-_;("west"===U||"northwest"===U||"southwest"===U)&&(Ok=-Ok),("north"===U||"northwest"===U||"northeast"===U)&&(Nl=-Nl),G=ye(M,Z,U,k,2*s,p.getResizeMode(),f,!1,Ok,Nl)}z.$8l=G,l.x=G.x+s,l.y=G.y+s,l.width=G.width-X,l.height=G.height-X;var gl=G.x+G.width/2,Uo=G.y+G.height/2,jk=l.x,Gb=l.y,is=l.width/T.width,Zl=l.height/T.height;n.each(function(P){if(P instanceof w&&p.isEditable(P)&&p.isRectEditable(P)){var y=Q[P.getId()],g=z.$3l[P.getId()],e={x:y.x+y.width/2,y:y.y+y.height/2},n=0,a=0,j=U,t=180*b(k-P.getRotation())/L;"northeast"===U?t>=315||45>t?(n=y.width*is+y.x,a=y.height*(1-Zl)+y.y,j="northeast"):t>=45&&135>t?(n=y.width*(1-Zl)+y.x,a=y.height*(1-is)+y.y,j="northwest"):t>=135&&225>t?(n=y.width*(1-is)+y.x,a=y.height*Zl+y.y,j="southwest"):(n=y.width*Zl+y.x,a=y.height*is+y.y,j="southeast"):"north"===U?t>=315||45>t?(a=y.height*(1-Zl)+y.y,j="north"):t>=45&&135>t?(n=y.width*(1-Zl)+y.x,j="west"):t>=135&&225>t?(a=y.height*Zl+y.y,j="south"):(n=y.width*Zl+y.x,j="east"):"northwest"===U?t>=315||45>t?(n=y.width*(1-is)+y.x,a=y.height*(1-Zl)+y.y,j="northwest"):t>=45&&135>t?(n=y.width*(1-Zl)+y.x,a=y.height*is+y.y,j="southwest"):t>=135&&225>t?(n=y.width*is+y.x,a=y.height*Zl+y.y,j="southeast"):(n=y.width*Zl+y.x,a=y.height*(1-is)+y.y,j="northeast"):"west"===U?t>=315||45>t?(n=y.width*(1-is)+y.x,j="west"):t>=45&&135>t?(a=y.height*is+y.y,j="south"):t>=135&&225>t?(n=y.width*is+y.x,j="east"):(a=y.height*(1-is)+y.y,j="north"):"southwest"===U?t>=315||45>t?(n=y.width*(1-is)+y.x,a=y.height*Zl+y.y,j="southwest"):t>=45&&135>t?(n=y.width*Zl+y.x,a=y.height*is+y.y,j="southeast"):t>=135&&225>t?(n=y.width*is+y.x,a=y.height*(1-Zl)+y.y,j="northeast"):(n=y.width*(1-Zl)+y.x,a=y.height*(1-is)+y.y,j="northwest"):"east"===U?t>=315||45>t?(n=y.width*is+y.x,j="east"):t>=45&&135>t?(a=y.height*(1-is)+y.y,j="north"):t>=135&&225>t?(n=y.width*(1-is)+y.x,j="west"):(a=y.height*is+y.y,j="south"):"south"===U?t>=315||45>t?(a=y.height*Zl+y.y,j="south"):t>=45&&135>t?(n=y.width*Zl+y.x,j="east"):t>=135&&225>t?(a=y.height*(1-Zl)+y.y,j="north"):(n=y.width*(1-Zl)+y.x,j="west"):"southeast"===U&&(t>=315||45>t?(n=y.width*is+y.x,a=y.height*Zl+y.y,j="southeast"):t>=45&&135>t?(n=y.width*Zl+y.x,a=y.height*(1-is)+y.y,j="northeast"):t>=135&&225>t?(n=y.width*(1-is)+y.x,a=y.height*(1-Zl)+y.y,j="northwest"):(n=y.width*(1-Zl)+y.x,a=y.height*is+y.y,j="southwest"));var B=Ll(e,n-e.x,a-e.y,P.getRotation());As(P,y,j,{x:B.x,y:B.y});var i=jk+l.width*g.x,H=Gb+l.height*g.y,s={x:i,y:H};s=Ll({x:gl,y:Uo},s.x-gl,s.y-Uo,k),P.p(s.x,s.y)}}),z.fi({kind:"betweenEditRect",event:E,direction:U})}else if(z.$23l&&z.$40l){var hq=z.$8l,kj=hq.width,lp=hq.height,C={x:hq.x+kj/2,y:hq.y+lp/2},I=z.$24l,rg=z.$23l,$d=rg.x/J-C.x,ii=rg.y/J-C.y,_m=F($d*$d+ii*ii),wo=Math.asin(I.x/_m),Ig=p.sm().getSelection(),bs=d+y(Z.y-C.y,Z.x-C.x)-wo,cl=p.getSnapAngle(),bs=r(bs/cl)*cl;0>bs&&(bs+=B);var le=bs-z.$7l,Tc=[C.x,0,C.y];Ig.each(function(R){if(p.isEditable(R)&&p.isRotationEditable(R)&&p.isVisible(R)){var Z=Fl(R.p3(),Tc),d=Ib();Rc(d,-le),R.setRotation(R.getRotation()+le),Re(Z,d),R.p3(Tc[0]+Z[0],Tc[1]+Z[1],Tc[2]+Z[2])}}),z.$7l=bs,z.fi({kind:"betweenEditRotation",event:E})}else if([1,2,3,5,6].indexOf(z.$67l)>=0)z.$72l=E,z.$78l||(z.$78l=1,P(function(){v.isDragging()&&z.$43l(),delete z.$78l},12));else if(7===z.$67l){if(z.$87l instanceof c){var o=z.$87l,Fj=z.$88l,Kp=v.clone(o.getPoints().get(Fj)),Gp=Z.y-Kp.y;Kp.e||(Kp.e=0),z.$92l||(z.$92l=Kp.e),Kp.e=z.$92l-Gp,o.setPoint(Fj,Kp)}else if(z.$87l instanceof K){var W=z.$87l,Fj=z.$88l,j=Cm(p.getDataUI(W),W.s("edge.points")),Kp=j.get(Fj),Gp=Z.y-Kp.y;Kp.e||(Kp.e=0),z.$92l||(z.$92l=Kp.e),Kp.e=z.$92l-Gp,j.set(Fj,Kp),W.s("edge.points",Om(j))}}else if(8===z.$67l){var Ig=p.sm().getSelection(),Cb=z.$93l;Cb||(Cb=z.$93l={}),Ig.each(function(w){if(w.p3){var c=w.p3(),K=Cb[w.getId()];K==a&&(K=Cb[w.getId()]=c[1]),w.p3([c[0],K-(Z.y-z.$90l.y/J),c[2]])}})}else if(9===z.$67l){var Ig=p.sm().getSelection(),ol=z.$94l;ol||(ol=z.$94l={}),Ig.each(function(b){if(b.s3){var i=b.s3(),F=ol[b.getId()];F==a&&(F=ol[b.getId()]=i[1]);var u=F-(Z.y-z.$91l.y/J);0>u&&(u=.01),b.s3([i[0],u,i[2]])}})}},$79l:function(y,h){var N=this,R=N.gv,q=R.getZoom(),J=R.getEditHelperSize(),Z=y.x/q,B=y.y/q,U=J/q,F=U/2;return z({x:Z-F,y:B-F,width:U,height:U},h)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(d,G){for(var x=this,q=x.gv,R=q.getZoom(),J=q.getEditPointSize(),p=J/R,f=p/2,_=x.$46l(d),B=0;B<_.length;B++){var A,t,Y=_[B],X=q.getDataUI(Y);if(X&&X._55O){var H=X._55O;if(H._43O&&Y instanceof K){if(A=Y.s("edge.points"),A=Cm(X,A),t=Y.s("edge.segments"),t&&t.size()||(t=Br(A)),x.$42l(Y,G,A._as,t,"edge"))return!0;if("points"===Y.s("edge.type")&&x.$41l(Y,G,A._as,t,"edge"))return}if(H._43O&&Y instanceof c&&H.$15l&&H.$15l.length===Y.getPoints().size()){if(A=H.$15l,t=Y.getSegments(),t&&t.size()||(t=Br(A)),x.$42l(Y,G,A,t,"shape"))return!0;if(x.$41l(Y,G,A,t,"shape"))return}}}if(x.$16l){var A,$=x.$16l,Q=$[3].x-$[7].x,S=$[3].y-$[7].y,P=F(Q*Q+S*S),g=$[1].x-$[5].x,u=$[1].y-$[5].y,y=F(g*g+u*u),T={x:G.x*R,y:G.y*R};if(x._80I(T,0,$[0],"northwest",P,y)||x._80I(T,1,$[1],"north",P,y)||x._80I(T,2,$[2],"northeast",P,y)||x._80I(T,7,$[7],"west",P,y)||x._80I(T,3,$[3],"east",P,y)||x._80I(T,6,$[6],"southwest",P,y)||x._80I(T,5,$[5],"south",P,y)||x._80I(T,4,$[4],"southeast",P,y))return!0}if(x.$23l){var b=x.$23l,D=b.x/R,L=b.y/R;if(z({x:D-f,y:L-f,width:p,height:p},G))return x.$40l=1,x.$12l=x.getHelperCursor("rotation")||"crosshair",!0}return x.$68l&&x.$79l(x.$68l,G)?(x.$67l=1,x.$12l=x.getHelperCursor("host")||"crosshair",!0):x.$69l&&x.$79l(x.$69l,G)?(x.$67l=2,x.$12l=x.getHelperCursor("parent")||"crosshair",!0):x.$70l&&x.$79l(x.$70l,G)?(x.$67l=3,x.$12l=x.getHelperCursor("edge")||"crosshair",!0):x.$71l&&x.$79l(x.$71l,G)?(x.$67l=4,x.$12l=x.getHelperCursor("remove")||"crosshair",!0):x.$82l&&x.$79l(x.$82l,G)?(x.$67l=5,x.$12l=x.getHelperCursor("source")||"crosshair",!0):x.$83l&&x.$79l(x.$83l,G)?(x.$67l=6,x.$12l=x.getHelperCursor("target")||"crosshair",!0):x._pointElevationHelperPoint&&x.$79l(x._pointElevationHelperPoint,G)?(x.$67l=7,x.$12l=x.getHelperCursor("pointElevation")||"crosshair",!0):x.$90l&&x.$79l(x.$90l,G)?(x.$67l=8,x.$12l=x.getHelperCursor("elevation")||"crosshair",!0):x.$91l&&x.$79l(x.$91l,G)?(x.$67l=9,x.$12l=x.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(G,y,k,N,U,t){var S=this,f=S.gv,X=f.getEditPointSize(),j=X/2,H=f.sm(),R=f.isDirectionEditable;if(R&&1===H.size()){var Y=H.ld();if(R=R.bind(f),Y instanceof w){if(!R(Y,N))return!1;if("east"===N){if(R(Y,"northeast")&&R(Y,"southeast")&&2*X>=t)return!1}else if("west"===N){if(R(Y,"northwest")&&R(Y,"southwest")&&2*X>=t)return!1}else if("north"===N){if(R(Y,"northwest")&&R(Y,"northeast")&&2*X>=U)return!1}else if("south"===N&&R(Y,"southwest")&&R(Y,"southeast")&&2*X>=U)return!1}}else{if(2*X>=U&&("north"===N||"south"===N))return!1;if(2*X>=t&&("east"===N||"west"===N))return!1}if(z({x:k.x-j,y:k.y-j,width:X,height:X},G)){if(S.$10l!==N){var q=180*S.$7l/L,l="";q>=337.5||22.5>q?l="north":q>=22.5&&67.5>q?l="northeast":q>=67.5&&112.5>q?l="east":q>=112.5&&157.5>q?l="southeast":q>=157.5&&202.5>q?l="south":q>=202.5&&247.5>q?l="southwest":q>=247.5&&292.5>q?l="west":q>=292.5&&337.5>q&&(l="northwest");var d=Ph.indexOf(l),l=Ph[y-(1-d)+8];switch(l){case"northwest":S.$12l="nwse-resize";break;case"northeast":S.$12l="nesw-resize";break;case"southwest":S.$12l="nesw-resize";break;case"southeast":S.$12l="nwse-resize";break;case"north":S.$12l="ns-resize";break;case"east":S.$12l="ew-resize";break;case"south":S.$12l="ns-resize";break;case"west":S.$12l="ew-resize"}S.$10l=N}return!0}return!1},$42l:function(a,U,J,h,q){var X,I=this,t=I.gv,o=t.getEditPointSize(),Z=o/t.getZoom(),Y=-1,n={x:U.x,y:U.y,width:0,height:0},M=function(h){"shape"===q?I._shape=a:I._edge=a,I._removePointIndex=h},e=function(R){"shape"===q?I._shape=a:I._edge=a,I.$13l=R,I.$12l="crosshair"};for(W(n,Z/2),Y=J.length-1,X=h.size()-1;X>=0;X--){var H=h.get(X);if(1===H||2===H)Y-=1;else if(3===H){var L=J[Y-1];if(z(n,L))return e(Y-1),!0;Y-=2}else if(4===H){var m=J[Y-1],N=J[Y-2];if(z(n,m))return e(Y-1),!0;if(z(n,N))return e(Y-2),!0;Y-=3}}for(Y=J.length-1,X=h.size()-1;X>=0;X--){var H=h.get(X),Q=J[Y];if(z(n,Q))return M(Y),e(Y),!0;1===H||2===H?Y-=1:3===H?Y-=2:4===H&&(Y-=3)}return!1},$41l:function(Q,p,j,I,e){var A=this,D=A.gv,V=-1,Y=0,R={x:p.x,y:p.y,width:0,height:0},K=function(o,n){A._hoverSegmentIndex=n,A._lp=p,"shape"===e?A._shape=Q:A._edge=Q};for(W(R,D.getSegmentHoverWidth()/2/D.getZoom()),Q instanceof c&&Q.isClosePath()&&I.indexOf(5)<0&&(I=new i(I._as),I.add(5));Y<I.size();Y++){var r=I.get(Y);if(1===r){var u=j[V],s=j[V+1];if(u){var N=ef(new Bh(u.x,u.y),new Bh(s.x,s.y),new Bh(R.x,R.y),new Bh(R.x+R.width,R.y+R.height));if(N.$62l===S&&N.points.length>0)return K(N,Y),!0}V+=1}else if(2===r){var u=j[V],s=j[V+1],N=ef(new Bh(u.x,u.y),new Bh(s.x,s.y),new Bh(R.x,R.y),new Bh(R.x+R.width,R.y+R.height));if(N.$62l===S&&N.points.length>0)return K(N,Y),!0;V+=1}else if(3===r){var u=j[V],l=j[V+1],E=j[V+2],N=sg(new Bh(u.x,u.y),new Bh(l.x,l.y),new Bh(E.x,E.y),new Bh(R.x,R.y),new Bh(R.x+R.width,R.y+R.height));if(N.$62l===S)return K(N,Y),!0;V+=2}else if(4===r){var u=j[V],d=j[V+1],o=j[V+2],E=j[V+3],N=he(new Bh(u.x,u.y),new Bh(d.x,d.y),new Bh(o.x,o.y),new Bh(E.x,E.y),new Bh(R.x,R.y),new Bh(R.x+R.width,R.y+R.height));if(N.$62l===S)return K(N,Y),!0;V+=3}else if(5===r){var u=j[V],s=j[0];if(u){var N=ef(new Bh(u.x,u.y),new Bh(s.x,s.y),new Bh(R.x,R.y),new Bh(R.x+R.width,R.y+R.height));if(N.$62l===S&&N.points.length>0)return K(N,Y),!0}}}return!1},addShapePoint:function(u,$,T){var A=this,y=A.gv,C=y.dm();if(C.beginTransaction(),0===arguments.length&&(u=A._shape||A._edge,$=A._hoverSegmentIndex,T=A._lp),u instanceof c||u instanceof K){var I=Rh(u,y.getDataUI(u),$);if(!isNaN($)&&T&&!isNaN(I)){var n=T;if(u instanceof c){var Q=u.p(),X=u.getRotation(),D=u.toSegments();D&&D.size()||(D=Br(u.getPoints())),u.isClosePath()&&D.indexOf(5)<0&&(D=new i(D._as),D.add(5));var q=D.get($),S="addPoint",t="removePointAt";if(2===q||1===q){var O={x:n.x,y:n.y};D.add(q,$),O=Ll(Q,O.x-Q.x,O.y-Q.y,-X),u[S](O,I+1)}else if(3===q){var H=u.getPoints(),r=H.get(I),l=H.get(I+2),O={x:n.x,y:n.y};O=Ll(Q,O.x-Q.x,O.y-Q.y,-X);var f=Wc(r,O),v=Wc(O,l);D.removeAt($),D.add(3,$),D.add(3,$),u.setPoint(I+1,O),u[S](v,I+2),u[S](f,I+1)}else if(4===q){var H=u.getPoints(),r=H.get(I),l=H.get(I+3),O={x:n.x,y:n.y};O=Ll(Q,O.x-Q.x,O.y-Q.y,-X);var f=Rk(r,O),v=nf(r,O),M=Rk(O,l),Y=nf(O,l);D.removeAt($),D.add(4,$),D.add(4,$),u[t](I+1),u[t](I+1),u[S](O,I+1),u[S](Y,I+2),u[S](M,I+2),u[S](v,I+1),u[S](f,I+1)}else if(5===q){var O={x:n.x,y:n.y};D.add(2,$),O=Ll(Q,O.x-Q.x,O.y-Q.y,-X),u[S](O,I+1)}u.isClosePath()&&D.remove(5),u.setSegments(D);var x=u.getWidth(),V=u.getHeight(),U=u.p().x-x/2,o=u.p().y-V/2;U-=Q.x,o-=Q.y;var d=Od(u,{x:U,y:o,width:x,height:V},X,Q);u.p(d.x,d.y)}else if(u instanceof K){if("points"!==u.s("edge.type"))return C.endTransaction(),void 0;var H=u.s("edge.points");D=u.s("edge.segments"),H=Cm(y.getDataUI(u),H),D&&D.size()||(D=Br(H)),D=new i(D._as.slice(0)),H=new i(H._as.slice(0));var q=D.get($);if(2===q||1===q){var O={x:n.x,y:n.y};D.add(q,$),H.add(O,I+1)}else if(3===q){var r=H.get(I),l=H.get(I+2),O={x:n.x,y:n.y},f=Wc(r,O),v=Wc(O,l);D.removeAt($),D.add(3,$),D.add(3,$),H.set(I+1,O),H.add(v,I+2),H.add(f,I+1)}else if(4===q){var r=H.get(I),l=H.get(I+3),O={x:n.x,y:n.y},f=Rk(r,O),v=nf(r,O),M=Rk(O,l),Y=nf(O,l);D.removeAt($),D.add(4,$),D.add(4,$),H.removeAt(I+1),H.removeAt(I+1),H.add(O,I+1),H.add(Y,I+2),H.add(M,I+2),H.add(v,I+1),H.add(f,I+1)}u.s("edge.points",Om(H)),u.s("edge.segments",D)}}}C.endTransaction()},removeShapePoint:function(z,A){var j=this,D="removeAt",n=j.gv,T=n.dm();if(T.beginTransaction(),0===arguments.length&&(z=j._shape||j._edge,A=j._removePointIndex),A>=0&&(z instanceof c||z instanceof K)){var g=Gm(z,j.gv.getDataUI(z),A),w=A;if(z instanceof c){var H=z.p(),k=z.toSegments();k&&k.size()||(k=Br(z.getPoints()));var M=k.get(g),X="removePointAt";if(1===M&&0===w)if(z.getPoints().size()>1){var Y=k.get(g+1);k[D](g+1),3===Y?z[X](w+1):4===Y&&(z[X](w+2),z[X](w+1)),z[X](w)}else z.dm().remove(z);else 2===M||1===M?(k[D](g),z[X](w)):3===M?(k[D](g),z[X](w),z[X](w-1)):4===M&&(k[D](g),z[X](w),z[X](w-1),z[X](w-2));z.setSegments(k);var l=z.getWidth(),x=z.getHeight(),U=z.p().x-l/2,B=z.p().y-x/2;U-=H.x,B-=H.y;var v=Od(z,{x:U,y:B,width:l,height:x},z.getRotation(),H);z.p(v.x,v.y)}else if(z instanceof K){if("points"!==z.s("edge.type"))return T.endTransaction(),void 0;var R=z.s("edge.points");if(k=z.s("edge.segments"),R&&(R=Cm(j.gv.getDataUI(z),R),k&&k.size()||(k=Br(R))),0===A||A===R.size()-1)return T.endTransaction(),void 0;k=new i(k._as.slice(0)),R=new i(R._as.slice(0));var M=k.get(g);2===M||1===M?(k[D](g),R[D](w)):3===M?(k[D](g),R[D](w),R[D](w-1)):4===M&&(k[D](g),R[D](w),R[D](w-1),R[D](w-2)),z.s("edge.segments",k),z.s("edge.points",Om(R))}}T.endTransaction()},changeShapeSegment:function(E,m,o){var l=this,L=l.gv,r=L.dm();if(r.beginTransaction(),1!==arguments.length||isNaN(E)||(o=E,E=l._shape||l._edge,m=l._hoverSegmentIndex),E instanceof c||E instanceof K){var F=Rh(E,l.gv.getDataUI(E),m);if(!isNaN(m)&&!isNaN(F))if(E instanceof c){var a=E.p(),y=E.toSegments();y&&y.size()||(y=Br(E.getPoints()));var V=y.get(m),g=E.toPoints();if(1===o||2===o)1===V||2===V?y.set(m,o):3===V?(y.set(m,o),g.removeAt(F+1)):4===V&&(y.set(m,o),g.removeAt(F+1),g.removeAt(F+1));else if(3===o){var M=function(){var o=g.get(F),D=g.get(F+1),i=Wc(o,D);y.set(m,3),g.add(i,F+1)};2===V||1===V?M():4===V&&(g.removeAt(F+1),g.removeAt(F+1),M())}else if(4===o){var $=function(){var f=g.get(F),j=g.get(F+1),S=Rk(f,j),r=nf(f,j);y.set(m,4),g.add(S,F+1),g.add(r,F+2)};2===V||1===V?$():3===V&&(g.removeAt(F+1),$())}E.setSegments(y),E.setPoints(g);var A=E.getWidth(),S=E.getHeight(),k=E.p().x-A/2,x=E.p().y-S/2;k-=a.x,x-=a.y;var q=new Od(E,{x:k,y:x,width:A,height:S},E.getRotation(),a);E.p(q.x,q.y)}else if(E instanceof K){if("points"!==E.s("edge.type"))return r.endTransaction(),void 0;var g=E.s("edge.points");y=E.s("edge.segments"),g&&(g=Cm(l.gv.getDataUI(E),g),y&&y.size()||(y=Br(g))),y=new i(y._as.slice(0)),g=new i(g._as.slice(0));var V=y.get(m);if(1===o||2===o)1===V||2===V?y.set(m,o):3===V?(y.set(m,o),g.removeAt(F+1)):4===V&&(y.set(m,o),g.removeAt(F+1),g.removeAt(F+1));else if(3===o){var M=function(){var W=g.get(F),S=g.get(F+1),K=Wc(W,S);y.set(m,3),g.add(K,F+1)};2===V||1===V?M():4===V&&(g.removeAt(F+1),g.removeAt(F+1),M())}else if(4===o){var $=function(){var l=g.get(F),h=g.get(F+1),s=Rk(l,h),i=nf(l,h);y.set(m,4),g.add(s,F+1),g.add(i,F+2)};2===V||1===V?$():3===V&&(g.removeAt(F+1),$())}E.s("edge.points",Om(g)),E.s("edge.segments",y)}}r.endTransaction()},getDefaultSegments:function(P){var H=this.gv,d=H.getDataUI(P);if(P instanceof K){var t=P.s("edge.points");return t=Cm(d,t),Br(t)}if(P instanceof c){var t=P.getPoints(),b=P.getSegments();return b&&b.size()>0?b:Br(t)}},$43l:function(n){var Q=this;n&&(Q.$5l=1),Q._68I=1,Q._42()},_42:function(){var z=this;if(z._68I){delete z._68I;var I=z.gv,C=z.$5l,p=I.getZoom(),S=I.getEditPointSize(),E=S/2,O=new i,g=z._view,u=z._edge,H=z._shape,M=g.getContext("2d"),Z=I.tx(),j=I.ty(),J=a,A=I.getEditPointBackground(),X=I.getControlPointBackground(),m=I.getControlPointBorderColor(),P=I.getEditPointBorderColor(),_=I.getEditRectBorderColor(),q=I.getDirectionLineColor(),Y=I.getSegmentHoverColor(),L=I.getSnapPointBorderColor(),d=I.getJoinPointBackground(),t=I.getJoinPointBorderColor(),l=I.getSegmentHoverWidth(),y=[5,5],G=I.getEditRectBorderStyle();ub(I,function(B){I.isSelected(B)&&I.isVisible(B)&&O.add(B)}),M.clearRect(0,0,V(g.width),V(g.height)),M.save(),n.translateAndScale(M,Z,j,1);var N=a,k={x:0,y:0,width:0,height:0},r=0,e=0,x=0,b=0,D=0,R=0,Ae=0,wm=0,Ee=0,kk=0,mg=[];if(C?(delete z.$6l,delete z.$8l,delete z.$7l,delete z.$16l,delete z.$23l):(N=z.$6l,J=z.$7l),delete z.$68l,delete z.$69l,delete z.$71l,delete z.$70l,delete z.$82l,delete z.$83l,delete z._pointElevationHelperPoint,delete z.$90l,delete z.$91l,delete z.$75l,delete z.$74l,O.each(function(W){var U=I.getDataUI(W);if(U){var $=U._55O;if(I.isEditable(W))$._56O&&W instanceof w&&e++,mg.push(W),$._42O&&W instanceof w&&r++,I.isHelperEditable(W,"host")&&b++,I.isHelperEditable(W,"parent")&&x++,I.isHelperEditable(W,"remove")&&D++,I.isHelperEditable(W,"edge")&&R++,I.isHelperEditable(W,"source")&&Ae++,I.isHelperEditable(W,"target")&&wm++,I.isHelperEditable(W,"elevation")&&Ee++,I.isHelperEditable(W,"tall")&&kk++;else if(W instanceof h&&W.isExpanded()){var N=!0,y=I.getEditableFunc();y&&(N=y(W)),N&&(I.isHelperEditable(W,"host")&&b++,I.isHelperEditable(W,"parent")&&x++,I.isHelperEditable(W,"remove")&&D++,I.isHelperEditable(W,"edge")&&R++,I.isHelperEditable(W,"source")&&Ae++,I.isHelperEditable(W,"target")&&wm++,I.isHelperEditable(W,"elevation")&&Ee++,I.isHelperEditable(W,"tall")&&kk++,mg.push(W))}}}),M.beginPath(),M.lineWidth=1,M.strokeStyle=I.getNodeBorderColor(),mg.forEach(function(f){var A=I.getDataUI(f),t=A._55O;if(C)if(J==a&&(J=f instanceof K?0:f instanceof h&&f.isExpanded()?0:f.getRotation(),z.$7l=J),N==a){var v,Y,L;if(f instanceof h&&f.isExpanded()||f instanceof K){var R=I.getDataUIBounds(f);Y=R.width,L=R.height,v={x:R.x+Y/2,y:R.y+L/2}}else v=f.p(),Y=f.getWidth(),L=f.getHeight();N={x:v.x,y:v.y,width:0,height:0},k.x=v.x-Y/2,k.y=v.y-L/2,k.width=Y,k.height=L,N=T(N,k)}else{var v,Y,L,F,n=N.x+N.width/2,j=N.y+N.height/2,G={x:n,y:j};if(f instanceof h&&f.isExpanded()||f instanceof K){F=0;var R=I.getDataUIBounds(f);Y=R.width,L=R.height,v={x:R.x+Y/2,y:R.y+L/2}}else v=f.p(),Y=f.getWidth(),L=f.getHeight(),F=f.getRotation();var y={x:v.x-Y/2,y:v.y-L/2,width:Y,height:L},m={x:y.x,y:y.y},e={x:y.x+y.width,y:y.y},D={x:y.x,y:y.y+y.height},l={x:y.x+y.width,y:y.y+y.height},m=Ll(v,m.x-v.x,m.y-v.y,F),D=Ll(v,D.x-v.x,D.y-v.y,F),l=Ll(v,l.x-v.x,l.y-v.y,F),e=Ll(v,e.x-v.x,e.y-v.y,F),U=-J,V=Ll(G,m.x-G.x,m.y-G.y,U),c=Ll(G,e.x-G.x,e.y-G.y,U),B=Ll(G,D.x-G.x,D.y-G.y,U),u=Ll(G,l.x-G.x,l.y-G.y,U),q=Q([V,c,B,u]);N=T(N,q),N.x-=n,N.y-=j;var x=Od(a,N,J,G);N.x=x.x-N.width/2,N.y=x.y-N.height/2}if(r>1&&I.isEditable(f)&&I.isRectEditable(f)&&f instanceof w){var E=f.getRect(),g=t.$45l,X=cj(g[0],p),H=cj(g[2],p),P=cj(g[4],p),O=cj(g[6],p);f.getRotation()?(M.moveTo(X.x,X.y),M.lineTo(H.x,H.y),M.lineTo(P.x,P.y),M.lineTo(O.x,O.y),M.lineTo(X.x,X.y)):M.rect(E.x*p,E.y*p,E.width*p,E.height*p)}}),M.stroke(),N){z.$6l=s(N),W(N,I.getEditRectPadding()/p);var wi={x:N.x+N.width/2,y:N.y+N.height/2},tr=In(wi,N.width,N.height,J),sq=tr[0],hj=tr[1],Lj=tr[2],Pf=tr[3],rg=tr[4],Ul=tr[5],fd=tr[6],Gd=tr[7];if(sq=cj(tr[0],p),hj=cj(tr[1],p),Lj=cj(tr[2],p),Pf=cj(tr[3],p),rg=cj(tr[4],p),Ul=cj(tr[5],p),fd=cj(tr[6],p),Gd=cj(tr[7],p),z.$8l=N,r>0&&(z.$16l=[sq,rg,hj,Ul,Pf,fd,Lj,Gd],M.beginPath(),M.lineWidth=1,M.strokeStyle=_,"dashed"===G&&M.setLineDash&&M.setLineDash(y),M.moveTo(sq.x,sq.y),M.lineTo(hj.x,hj.y),M.lineTo(Pf.x,Pf.y),M.lineTo(Lj.x,Lj.y),M.lineTo(sq.x,sq.y),M.stroke(),"dashed"===G&&M.setLineDash&&M.setLineDash([])),M.beginPath(),M.lineWidth=1,M.fillStyle=A,M.strokeStyle=P,r>0){var zo=Ul.x-Gd.x,Zb=Ul.y-Gd.y,Xg=F(zo*zo+Zb*Zb),vq=rg.x-fd.x,dh=rg.y-fd.y,Am=F(vq*vq+dh*dh),qf=2*S;if(I.isDirectionEditable&&1===mg.length){var ng=mg[0],Cj=I.getDataUI(ng),mj=Cj._55O,sr=I.isDirectionEditable.bind(I);if(mj._42O){var ug,Gh,rc,od;sr(ng,"northwest")&&(ug=!0,M.rect(sq.x-E,sq.y-E,S,S)),sr(ng,"northeast")&&(Gh=!0,M.rect(hj.x-E,hj.y-E,S,S)),sr(ng,"southwest")&&(rc=!0,M.rect(Lj.x-E,Lj.y-E,S,S)),sr(ng,"southeast")&&(od=!0,M.rect(Pf.x-E,Pf.y-E,S,S)),sr(ng,"north")&&(ug&&Gh?Xg>qf&&M.rect(rg.x-E,rg.y-E,S,S):M.rect(rg.x-E,rg.y-E,S,S)),sr(ng,"south")&&(od&&rc?Xg>qf&&M.rect(fd.x-E,fd.y-E,S,S):M.rect(fd.x-E,fd.y-E,S,S)),sr(ng,"west")&&(rc&&ug?Am>qf&&M.rect(Gd.x-E,Gd.y-E,S,S):M.rect(Gd.x-E,Gd.y-E,S,S)),sr(ng,"east")&&(od&&Gh?Am>qf&&M.rect(Ul.x-E,Ul.y-E,S,S):M.rect(Ul.x-E,Ul.y-E,S,S))}}else Xg>qf&&(M.rect(rg.x-E,rg.y-E,S,S),M.rect(fd.x-E,fd.y-E,S,S)),Am>qf&&(M.rect(Ul.x-E,Ul.y-E,S,S),M.rect(Gd.x-E,Gd.y-E,S,S)),M.rect(sq.x-E,sq.y-E,S,S),M.rect(hj.x-E,hj.y-E,S,S),M.rect(Lj.x-E,Lj.y-E,S,S),M.rect(Pf.x-E,Pf.y-E,S,S)}if(e>0){var Pe=z.$23l=Ll(rg,0,2*-S,J);M.moveTo(Pe.x+E,Pe.y),M.arc(Pe.x,Pe.y,E,0,B,!1)}M.fill(),M.stroke(),z.$40l&&z.$44l(M,N,J);var wg,If,ch=I.getLeftTopHelpers(),tf=I.getRightTopHelpers(),Lp=I.getLeftBottomHelpers(),sg=I.getRightBottomHelpers(),Om=I.getEdgeHelpers(),Vi=I.getEditHelperSize(),cr=Vi/2,Wf=function(O,F,r,l){"leftTop"===F?(wg=N.x*p-Vi-E-("h"===l?r*(Vi+E):0)-1,If=N.y*p-Vi-E-("v"===l?r*(Vi+E):0)-1):"rightTop"===F?(wg=(N.x+N.width)*p+E+("h"===l?r*(Vi+E):0)+1,If=N.y*p-Vi-E-("v"===l?r*(Vi+E):0)-1):"leftBottom"===F?(wg=N.x*p-Vi-E-("h"===l?r*(Vi+E):0)-1,If=(N.y+N.height)*p+E+("v"===l?r*(Vi+E):0)+1):"rightBottom"===F&&(wg=(N.x+N.width)*p+E+("h"===l?r*(Vi+E):0)+1,If=(N.y+N.height)*p+E+("v"===l?r*(Vi+E):0)+1);var j=wg+cr,o=If+cr,W=(N.x+N.width/2)*p,B=(N.y+N.height/2)*p,e=Ll({x:W,y:B},j-W,o-B,J);if("host"===O){if(b>0)return z.$77l(M,J,e),!0}else if("edge"===O){if(R>0)return z.$80l(M,J,e),!0}else if("remove"===O){if(D>0)return mg&&1===mg.length&&mg[0]instanceof K?z.$81l(M,J,{x:W+Vi/2+5,y:B}):z.$81l(M,J,e),!0}else if("parent"===O){if(x>0)return mg&&1===mg.length&&mg[0]instanceof K?z.$76l(M,J,{x:W-Vi/2-5,y:B}):z.$76l(M,J,e),!0}else if("elevation"===O){if(Ee>0)return z.$85l(M,J,e),!0}else if("tall"===O){if(kk>0)return z.$86l(M,J,e),!0}else if("source"===O||"target"===O){var i=mg[0],u=I.getDataUI(i),H=Yd(u,!0),c=H[0],v=H[1];if(Ae&&"source"===O)return z.$84l(M,N,c,!0,i.isLooped(),F,r,l),!0;if(wm&&"target"===O)return z.$84l(M,N,v,!1,i.isLooped(),F,r,l),!0}};if(ch&&ch.length>0){var jf=0;ch.forEach(function(V){Wf(V,"leftTop",jf,I.getLeftTopHelpersAlign()||"h")&&jf++})}if(tf&&tf.length>0){var jf=0;tf.forEach(function(R){Wf(R,"rightTop",jf,I.getRightTopHelpersAlign()||"h")&&jf++})}if(Lp&&Lp.length>0){var jf=0;Lp.forEach(function(U){Wf(U,"leftBottom",jf,I.getLeftBottomHelpersAlign()||"h")&&jf++})}if(sg&&sg.length>0){var jf=0;sg.forEach(function(M){Wf(M,"rightBottom",jf,I.getRightBottomHelpersAlign()||"h")&&jf++})}if(Om&&Om.length>0&&((Ae||wm)&&mg&&1===mg.length&&mg[0]instanceof K?!0:!1)){var jf=0;Om.forEach(function(d){Wf(d,"edge",jf,"h")&&jf++})}if(z.$72l){var Id,ts=z.$67l,_m=z.$68l,Eq=z.$69l,qr=(z.$71l,z.$70l),Fi=z.$82l,Fj=z.$83l;if(1===ts?Id=_m:2===ts?Id=Eq:3===ts?Id=qr:5===ts?Id=Fi:6===ts&&(Id=Fj),Id){var Ig=I.lp(z.$72l),_r=I.getDataAt(z.$72l);if(_r&&_r instanceof w){var Hp,Tg,Ab;if(z.$73l=_r,1===ts)if(_r instanceof o.Grid)Hp=z.$75l=zh(_r,Ig);else if(_r instanceof o.Shape){Ab=z.$74l=hf(_r,Ig);var tc=_r.getPoints();if(Ab){var Pm=Ab.attachIndex,zr=Rh(_r,I.getDataUI(_r),Pm)+1,Jo=zr+1>=tc.size()?0:zr+1,tn=tc.get(zr),Co=tc.get(Jo),Hm=_r.p(),al=_r.getRotation();tn=Ll(Hm,tn.x-Hm.x,tn.y-Hm.y,al),Co=Ll(Hm,Co.x-Hm.x,Co.y-Hm.y,al),M.beginPath(),M.strokeStyle=Y,M.lineWidth=l,M.moveTo(tn.x*p,tn.y*p),M.lineTo(Co.x*p,Co.y*p),M.stroke()}}Hp?Tg=Hp.rect:(Tg=v.clone(I.getDataUIBounds(_r)),v.grow(Tg,2)),M.beginPath(),M.rect(Tg.x*p,Tg.y*p,Tg.width*p,Tg.height*p),M.strokeStyle=1===ts||4===ts||6===ts?f:U,M.lineWidth=2,M.setLineDash&&M.setLineDash([8,8]),M.stroke()}else delete z.$73l;Ig.x=Ig.x*p,Ig.y=Ig.y*p;var _j=fo(Id.x,Id.y,Ig.x,Ig.y),nd=Ll(Id,Ig.x-Id.x,Ig.y-Id.y,-_j),pk=nd.x-Id.x;M.save(),M.translate(Id.x,Id.y),M.rotate(_j),$.width=pk,$.height=40;var Ld=U;(1===ts||4===ts||6===ts)&&(Ld=f),$.comps[0].gradientColor=Ld,v.drawImage(M,$,0,-20,pk,40),M.restore()}}}if(O.each(function(y){var A=I.getDataUI(y);if(A){var o,b,J=A._55O,f=A._78o;if(J&&J._43O&&y instanceof c?(o=J.$15l,b=y.getSegments(),b&&b.size()||(b=Br(o)),y.isClosePath()&&b.indexOf(5)<0&&(b=new i(b._as),b.add(5))):J&&f&&J._43O&&(o=y.s("edge.points"),b=y.s("edge.segments"),o=Cm(A,o),b&&b.size()||(b=Br(o)),o&&(o=o._as)),o&&b){var S=0,V=b.size(),G=z._hoverSegmentIndex;o=o.slice(0);for(var k=0;k<o.length;k++)o[k]=cj(o[k],p);M.beginPath(),M.strokeStyle=q,M.lineWidth=1,S=0;for(var k=0;V>k;k++){var K=b.get(k);if(1===K||2===K)S++;else if(3===K){var g=o[S-1],C=o[S],n=o[S+1];M.moveTo(g.x,g.y),M.lineTo(C.x,C.y),M.lineTo(n.x,n.y),S+=2}else if(4===K){var g=o[S-1],F=o[S],N=o[S+1],n=o[S+2];M.moveTo(g.x,g.y),M.lineTo(F.x,F.y),M.moveTo(N.x,N.y),M.lineTo(n.x,n.y),S+=3}}if(M.stroke(),H===y||u===y&&"points"===u.s("edge.type")){M.beginPath(),S=0,M.strokeStyle=Y,M.lineWidth=l;for(var k=0;V>k;k++){var K=b.get(k);if(1===K||2===K){if(G===k){var g=o[S-1],n=o[S];M.moveTo(g.x,g.y),M.lineTo(n.x,n.y);break}S++}else if(3===K){if(G===k){var g=o[S-1],C=o[S],n=o[S+1];M.moveTo(g.x,g.y),M.quadraticCurveTo(C.x,C.y,n.x,n.y);break}S+=2}else if(4===K){if(G===k){var g=o[S-1],F=o[S],N=o[S+1],n=o[S+2];M.moveTo(g.x,g.y),M.bezierCurveTo(F.x,F.y,N.x,N.y,n.x,n.y);break}S+=3}else if(5===K&&G===k){var g=o[S-1],n=o[0];M.moveTo(g.x,g.y),M.lineTo(n.x,n.y);break}}M.stroke()}M.beginPath(),S=0,M.strokeStyle=t,M.lineWidth=1,M.fillStyle=d;for(var k=0;V>k;k++){var K=b.get(k);if(1===K||2===K){var n=o[S];M.moveTo(n.x+E,n.y),M.arc(n.x,n.y,E,0,B,!0),S++}else if(3===K){var n=o[S+1];M.moveTo(n.x+E,n.y),M.arc(n.x,n.y,E,0,B,!0),S+=2}else if(4===K){var n=o[S+2];M.moveTo(n.x+E,n.y),M.arc(n.x,n.y,E,0,B,!0),S+=3}}M.fill(),M.stroke(),M.beginPath(),S=0,M.strokeStyle=m,M.lineWidth=1,M.fillStyle=X;for(var k=0;V>k;k++){var K=b.get(k);if(1===K||2===K)S++;else if(3===K){var C=o[S];M.moveTo(C.x+E,C.y),M.arc(C.x,C.y,E,0,B,!0),S+=2}else if(4===K){var F=o[S],N=o[S+1];M.moveTo(F.x+E,F.y),M.arc(F.x,F.y,E,0,B,!0),M.moveTo(N.x+E,N.y),M.arc(N.x,N.y,E,0,B,!0),S+=3}}if(M.fill(),M.stroke(),M.beginPath(),S=0,M.strokeStyle=L,M.lineWidth=2,(H===y||u===y)&&z.$9l!=a){var n=o[z.$9l];M.moveTo(n.x+E,n.y),M.arc(n.x,n.y,E,0,B,!0),M.stroke()}}}}),z.$87l&&I.sm().contains(z.$87l)){var ho,Mp=z.$87l,wk=z.$88l,Vi=I.getEditHelperSize(),cr=Vi/2;if(I.isHelperEditable(Mp,"pointElevation"))if(Mp instanceof c){var ul=Mp.getPosition();ho=v.clone(Mp.getPoints().get(wk)),ho=Ll({x:ul.x,y:ul.y},ho.x-ul.x,ho.y-ul.y,Mp.getRotation()),ho.x*=p,ho.y*=p,M.translate(ho.x,ho.y),v.drawImage(M,v.getImage("xeditinteractor_elevationIcon"),cr,-cr,Vi,Vi),M.translate(-ho.x,-ho.y),z._pointElevationHelperPoint={x:ho.x+Vi,y:ho.y}}else if(Mp instanceof K){var Oj=Cm(I.getDataUI(Mp),Mp.s("edge.points")),ho=v.clone(Oj.get(wk));ho.x*=p,ho.y*=p,M.translate(ho.x,ho.y),v.drawImage(M,v.getImage("xeditinteractor_elevationIcon"),cr,-cr,Vi,Vi),M.translate(-ho.x,-ho.y),z._pointElevationHelperPoint={x:ho.x+Vi,y:ho.y}}}M.restore(),z.$5l=0}},$89l:function(V,q,J,T){V.save();var r=this,W=r.gv,e=W.getEditHelperSize(),G=e/2;V.beginPath(),V.translate(J.x,J.y),V.rotate(q),v.drawImage(V,T,-G,-G,e,e),V.restore()},$85l:function(A,w,_){var Q=this;Q.$90l=_,Q.$89l(A,w,_,v.getImage("xeditinteractor_elevationIcon"))},$86l:function(p,h,L){var F=this;F.$91l=L,F.$89l(p,h,L,v.getImage("xeditinteractor_tallIcon"))},$77l:function(x,M,$){var H=this;H.$68l=$,H.$89l(x,M,$,v.getImage("xeditinteractor_hostIcon"))},$80l:function(X,q,B){var V=this;V.$70l=B,V.$89l(X,q,B,v.getImage("xeditinteractor_edgeIcon"))},$81l:function(H,I,S){var u=this;u.$71l=S,u.$89l(H,I,S,v.getImage("xeditinteractor_removeIcon"))},$76l:function(o,b,l){var s=this;s.$69l=l,s.$89l(o,b,l,v.getImage("xeditinteractor_parentIcon"))},$84l:function(K,N,Y,i,n){var s,u=this,q=u.gv,l=q.getZoom(),Q=q.getEditHelperSize(),$=Q/2;Y.x*=l,Y.y*=l,n&&(i?Y.x-=$+5:Y.x+=$+5),Y.y-=Q-2,i?(u.$82l=Y,s=v.getImage("xeditinteractor_sourceIcon")):(u.$83l=Y,s=v.getImage("xeditinteractor_targetIcon")),K.beginPath(),K.translate(Y.x,Y.y),v.drawImage(K,s,-$,-$,Q,Q),K.translate(-Y.x,-Y.y)},$44l:function(J,x,i){J.save();var M=this.gv.getZoom(),I=F(j(x.width,2)+j(x.height,2))/2*M+10,e=I,v=e+8,N=e+18,g=i,l=x.x+x.width/2,t=x.y+x.height/2;J.translate(l*M,t*M),J.beginPath(),J.strokeStyle="rgb(150, 150, 150)";for(var D=0,R=0,Y=0,q=0,Z=0,B=0;360>B;B++)D=B*L/180,0===B%5&&(R=k(D)*e,Y=H(D)*e,q=k(D)*v,Z=H(D)*v,J.moveTo(R,Y),J.lineTo(q,Z)),0===B%45&&(R=k(D)*e,Y=H(D)*e,q=k(D)*N,Z=H(D)*N,J.moveTo(R,Y),J.lineTo(q,Z));J.stroke(),J.beginPath(),J.rotate(-d),J.beginPath(),J.fillStyle="rgba(255, 0, 0, 0.1)",J.strokeStyle="rgb(157, 157, 157)",J.moveTo(0,0),J.arc(0,0,N,0,i,!1),J.fill(),J.beginPath(),J.moveTo(0+N,0),J.arc(0,0,N,0,i,!1),J.stroke(),J.rotate(d),J.font="bold 12px Verdana, Arial";var Q=20*H(g),z=20*k(g),X=r(180*g/L)+"";J.textAlign="center",J.textBaseline="middle",J.beginPath();var u=J.measureText("365.").width;J.fillStyle="white",J.rect(Q-u/2,-z-10,u,20),J.fill(),J.beginPath(),J.fillStyle="rgb(79,79,79)",J.fillText(X,Q,-z),J.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);